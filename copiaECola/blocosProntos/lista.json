{"isCopyFromBlips":true,"originBot":"devspdfinalizacao1","blocksCode":"[{\"$contentActions\":[{\"action\":{\"$id\":\"b0f53b7f-d115-49d1-b8ab-03542936ca58\",\"$typeOfContent\":\"chat-state\",\"type\":\"SendMessage\",\"settings\":{\"id\":\"7aff57fb-5682-48b3-b5cf-74888b089efb\",\"type\":\"application/vnd.lime.chatstate+json\",\"content\":{\"state\":\"composing\",\"interval\":1000}},\"$cardContent\":{\"document\":{\"id\":\"7aff57fb-5682-48b3-b5cf-74888b089efb\",\"type\":\"application/vnd.lime.chatstate+json\",\"content\":{\"state\":\"composing\",\"interval\":1000}},\"editable\":true,\"deletable\":true,\"position\":\"left\"}},\"$invalid\":false,\"$$hashKey\":\"object:1414\"},{\"action\":{\"$id\":\"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb\",\"$typeOfContent\":\"raw-content\",\"type\":\"SendRawMessage\",\"settings\":{\"metadata\":{},\"type\":\"application/json\",\"rawContent\":\"{{dynamicContent}}\"}},\"$invalid\":false,\"$$hashKey\":\"object:1415\"},{\"input\":{\"bypass\":true,\"$cardContent\":{\"document\":{\"id\":\"1475eaee-7b62-434c-a6a2-9ec49debf18c\",\"type\":\"text/plain\",\"textContent\":\"Entrada do usuário\",\"content\":\"Entrada do usuário\"},\"editable\":false,\"deletable\":true,\"position\":\"right\",\"editing\":false},\"$invalid\":false},\"$invalid\":false,\"$$hashKey\":\"object:1416\"}],\"$conditionOutputs\":[{\"stateId\":\"2277261f-1fd3-4041-ad2a-494985ee2067\",\"typeOfStateId\":\"state\",\"$connId\":\"con_153\",\"$id\":\"b9ff35a7-e3f0-430a-9736-dbe6df9fda37\",\"conditions\":[{\"source\":\"input\",\"comparison\":\"exists\",\"values\":[],\"$$hashKey\":\"object:1437\"}],\"$invalid\":false,\"$$hashKey\":\"object:1423\"}],\"$enteringCustomActions\":[{\"$id\":\"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4\",\"$typeOfContent\":\"\",\"type\":\"ExecuteScript\",\"$title\":\"Process \\\"dynamicContent\\\"\",\"$invalid\":false,\"settings\":{\"function\":\"run\",\"source\":\"function run(cpfAppKey, ec) {\\n\\ttry {\\n\\t\\tlet defaultMenuOptions = [\\n\\t\\t\\t{\\n\\t\\t\\t\\t\\\"id\\\": \\\"1\\\",\\n\\t\\t\\t\\t\\\"title\\\": \\\"Menu principal\\\",\\n\\t\\t\\t\\t\\\"description\\\": \\\"\\\"\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\t\\\"id\\\": \\\"2\\\",\\n\\t\\t\\t\\t\\\"title\\\": \\\"Menu anterior\\\",\\n\\t\\t\\t\\t\\\"description\\\": \\\"\\\"\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\t\\\"id\\\": \\\"3\\\",\\n\\t\\t\\t\\t\\\"title\\\": \\\"Falar com gerente\\\",\\n\\t\\t\\t\\t\\\"description\\\": \\\"\\\"\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\t\\\"id\\\": \\\"4\\\",\\n\\t\\t\\t\\t\\\"title\\\": \\\"\\\",\\n\\t\\t\\t\\t\\\"description\\\": \\\"Encerrar\\\"\\n\\t\\t\\t}\\n\\t\\t]\\n\\t\\treturn {\\n\\t\\t\\t\\\"recipient_type\\\": \\\"individual\\\",\\n\\t\\t\\t\\\"type\\\": \\\"interactive\\\",\\n\\t\\t\\t\\\"interactive\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"list\\\",\\n\\t\\t\\t\\t\\\"header\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"body\\\": {\\n\\t\\t\\t\\t\\t\\\"text\\\": `Como deseja seguir?` // <---- Body\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"action\\\": {\\n\\t\\t\\t\\t\\t\\\"button\\\": \\\"Opções\\\", // <---- Titulo do botão\\n\\t\\t\\t\\t\\t\\\"sections\\\": [\\n\\t\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\t\\\"title\\\": \\\"\\\",\\n\\t\\t\\t\\t\\t\\t\\t\\\"rows\\\": defaultMenuOptions\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t]\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t} catch (err) {\\n\\t\\treturn false;\\n\\t}\\n}\",\"inputVariables\":[\"cpfAppKey\",\"selectedEc\"],\"outputVariable\":\"dynamicContent\",\"LocalTimeZoneEnabled\":false},\"conditions\":[]},{\"$id\":\"5f51d111-5dfe-4c05-b21b-610f9213816e\",\"$typeOfContent\":\"\",\"type\":\"TrackEvent\",\"$title\":\"Track \\\"{state.name} exibicao\\\"\",\"$invalid\":false,\"settings\":{\"extras\":{},\"category\":\"{{state.name}} exibicao\",\"action\":\"Exibição\"},\"conditions\":[]}],\"$leavingCustomActions\":[],\"$inputSuggestions\":[],\"$defaultOutput\":{\"stateId\":\"fallback\",\"$invalid\":false},\"isAiGenerated\":false,\"$tags\":[{\"id\":\"blip-tag-d64a35ea-0925-479f-86ce-99c5850f9487\",\"label\":\"ExecuteScript\",\"background\":\"#FF961E\",\"canChangeBackground\":false},{\"id\":\"blip-tag-586eea78-512b-491a-911a-beb24a011e86\",\"label\":\"TrackEvent\",\"background\":\"#61D36F\",\"canChangeBackground\":false},{\"id\":\"blip-tag-6521b481-d5d7-4f91-ba44-8340eeb0f1a5\",\"label\":\"SendMessage\",\"background\":\"#EE82EE\",\"canChangeBackground\":false}],\"id\":\"ed2a5fb2-da6f-4961-b14d-e302fa57b991\",\"root\":false,\"$title\":\"[F.4.0.0][MSG] MENU\",\"$position\":{\"top\":\"231.5px\",\"left\":\"1337px\"},\"$invalidContentActions\":false,\"$invalidOutputs\":false,\"$invalidCustomActions\":false,\"$invalid\":false},{\"$contentActions\":[{\"input\":{\"bypass\":false,\"$cardContent\":{\"document\":{\"id\":\"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0\",\"type\":\"text/plain\",\"textContent\":\"Entrada do usuário\",\"content\":\"Entrada do usuário\"},\"editable\":false,\"deletable\":true,\"position\":\"right\",\"editing\":false},\"$invalid\":false},\"$invalid\":false,\"$$hashKey\":\"object:1593\"}],\"$conditionOutputs\":[],\"$enteringCustomActions\":[],\"$leavingCustomActions\":[{\"$id\":\"98d8f680-0f33-40ef-ae64-e0eb576da038\",\"$typeOfContent\":\"\",\"type\":\"ExecuteScript\",\"$title\":\"Process \\\"userInput\\\"\",\"$invalid\":false,\"settings\":{\"function\":\"run\",\"source\":\"function escapeRegExp(string) {\\n    return string.replace(/[.*+?^${}()|[\\\\]\\\\\\\\]/g, '\\\\\\\\$&'); // $& means the whole matched string\\n}\\nfunction run(inputUsuario, dynamicContent) {\\n    const posicoes = {\\n        \\\"1\\\": \\\"primeir[oa]|u[mn]\\\",\\n        \\\"2\\\": \\\"segund[ao]|do[ie]s\\\",\\n        \\\"3\\\": \\\"terceir[ao]|tr[eê]s\\\",\\n        \\\"4\\\": \\\"quart[ao]|[qc]uat(r)?o\\\",\\n        \\\"5\\\": \\\"quint[ao]|[sc]inc[ou]\\\",\\n        \\\"6\\\": \\\"sext[ao]|[sc]inc[uo]\\\",\\n        \\\"7\\\": \\\"s[eé]tim[ao]|[sc]et[ei]\\\",\\n        \\\"8\\\": \\\"oitav[ao]|oit[ou]\\\",\\n        \\\"9\\\": \\\"non[ao]|nov[ei]\\\",\\n        \\\"10\\\": \\\"d[eé][cs]im[ou]|d[ée][sz]\\\"\\n    }\\n    try {\\n        if (!inputUsuario) return 'inatividade'\\n        const regexDictionary = {}\\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\\n        rows.forEach((button, index) => {\\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\\\"NFD\\\").replace(/[\\\\u0300-\\\\u036f]/g, \\\"\\\").toLowerCase())})$`\\n            regexDictionary[key] = button.title\\n        })\\n        for (let regex in regexDictionary) {\\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\\\"NFD\\\").replace(/[\\\\u0300-\\\\u036f]/g, \\\"\\\"))) {\\n                return regexDictionary[regex]\\n            }\\n        }\\n        return 'input inesperado'\\n    } catch (err) {\\n        return 'input inesperado'\\n    }\\n}\",\"inputVariables\":[\"input.content\",\"dynamicContent\"],\"outputVariable\":\"userInput\",\"LocalTimeZoneEnabled\":false},\"conditions\":[]},{\"$id\":\"27541523-9db3-45bb-925a-f96e659c35d3\",\"$typeOfContent\":\"\",\"type\":\"SetVariable\",\"$title\":\"Set \\\"exceptionType\\\" to \\\"lista\\\"\",\"$invalid\":false,\"settings\":{\"variable\":\"exceptionType\",\"value\":\"lista\"},\"conditions\":[{\"values\":[\"input inesperado\"],\"source\":\"context\",\"comparison\":\"equals\",\"variable\":\"userInput\"}]},{\"$id\":\"a88a9c41-3781-40c5-87d8-85cc4984829c\",\"$typeOfContent\":\"\",\"type\":\"TrackEvent\",\"$title\":\"Track \\\"{state.name} validação\\\"\",\"$invalid\":false,\"settings\":{\"extras\":{},\"category\":\"{{state.name}} validação\",\"action\":\"{{userInput}}\"},\"conditions\":[{\"comparison\":\"exists\",\"source\":\"context\",\"values\":[],\"variable\":\"userInput\"}]},{\"$id\":\"5f38ca73-16b6-465d-904a-fb43a3c9c385\",\"$typeOfContent\":\"\",\"type\":\"TrackEvent\",\"$title\":\"Track \\\"{state.name} input inesperado\\\"\",\"$invalid\":false,\"settings\":{\"extras\":{},\"category\":\"{{state.name}} input inesperado\",\"action\":\"{{input.content}}\"},\"conditions\":[{\"values\":[\"input inesperado\"],\"source\":\"context\",\"comparison\":\"equals\",\"variable\":\"userInput\"},{\"comparison\":\"exists\",\"source\":\"context\",\"values\":[],\"variable\":\"input.content\"}]}],\"$inputSuggestions\":[],\"$defaultOutput\":{\"stateId\":\"fallback\",\"$invalid\":false},\"isAiGenerated\":false,\"$tags\":[{\"id\":\"blip-tag-49cd1005-c17c-4d1a-a1fe-e3ffcdf7c619\",\"label\":\"ExecuteScript\",\"background\":\"#FF961E\",\"canChangeBackground\":false},{\"id\":\"blip-tag-5d598574-c680-4997-8f36-8f8dae904678\",\"label\":\"SetVariable\",\"background\":\"#FF4A1E\",\"canChangeBackground\":false},{\"id\":\"blip-tag-43d372f3-8713-4183-91fb-16e897ac5129\",\"label\":\"TrackEvent\",\"background\":\"#61D36F\",\"canChangeBackground\":false},{\"id\":\"blip-tag-f12fc96f-d44e-4236-b04b-2d877182f159\",\"label\":\"UserInput\",\"background\":\"#000000\",\"canChangeBackground\":false}],\"id\":\"2277261f-1fd3-4041-ad2a-494985ee2067\",\"root\":false,\"$title\":\"[F.4.0.0][INPUT] MENU\",\"$position\":{\"top\":\"408.75px\",\"left\":\"1337px\"},\"$invalidContentActions\":false,\"$invalidOutputs\":false,\"$invalidCustomActions\":false,\"$invalid\":false}]"}