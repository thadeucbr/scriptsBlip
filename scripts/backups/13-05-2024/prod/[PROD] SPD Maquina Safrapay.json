{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"db0ea0f3-01b3-4870-aa57-cfcfee9133fd","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{blockDestinationId}}","typeOfStateId":"variable","$id":"edae1c07-a6f0-4693-8aaa-942849aa4322","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"blockDestinationId"}],"$invalid":false},{"stateId":"a8a6dce4-5cf6-4ba8-9cc2-11ce2e81dbfd","typeOfStateId":"state","$connId":"con_3","$id":"ad210751-80e2-4c93-b8b8-8fa032005d0b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d3084a98-4e51-451d-a81c-0b8932f7a7fc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"blockDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(state, serviceName) {\n\ttry {\n\t\tconst { botDestination, stateDestination } = JSON.parse(state)\n\n\t\tif (stateDestination.match(/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/) && botDestination === serviceName) {\n\t\t\treturn stateDestination\n\t\t}\n\t\treturn false\n\t} catch (err) {\n\t\treturn err.message\n\t}\n}","inputVariables":["state","config.serviceName"],"outputVariable":"blockDestinationId","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a8a6dce4-5cf6-4ba8-9cc2-11ce2e81dbfd","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-65dfd3a6-38f3-4e6c-bc48-d7eda7d2bf18","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b4d34a10-b5b6-46f5-b3a5-2d8b35fdee08","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"In√≠cio","$position":{"top":"302px","left":"2205px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"38f6203a-20cd-4cb8-8867-b7bb3e0a1b62","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","typeOfStateId":"state","$connId":"con_8","$id":"aa7a1a1f-5a8a-4f5a-a771-2f8a9f126e13","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"198d42fb-9e7e-45e1-9204-4ccfa937ee3d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(previousBlockId, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `cascata ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-67c40800-bdfb-4724-a840-b810d7f34bae","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exce√ß√µes","$position":{"top":"233.667px","left":"1455.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a8a6dce4-5cf6-4ba8-9cc2-11ce2e81dbfd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"168598f7-bb5b-4eb0-a37e-45f8c48ccdde","typeOfStateId":"state","$connId":"con_13","$id":"01b18bc2-a84b-48b5-9651-d4870fd2764b","conditions":[{"source":"intent","comparison":"equals","values":["Consulta de Protocolo"]}],"$invalid":false},{"stateId":"c391e959-860e-4eaf-86b9-71fcd8888c86","typeOfStateId":"state","$connId":"con_18","$id":"453fd294-fc42-4cd3-9352-37c3a75f6a0a","conditions":[{"source":"intent","comparison":"equals","values":["Simulador de vendas"]}],"$invalid":false},{"stateId":"4b038e89-c130-4869-a541-4954e12ebf81","typeOfStateId":"state","$connId":"con_23","$id":"2afea773-15b9-4195-b689-a2750e7bd7bd","conditions":[{"source":"intent","comparison":"equals","values":["Venda n√£o recebida"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1971cd7e-aac1-4558-85df-ecc43dcb870a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquininha validar direcionamento dados\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquininha validar direcionamento dados","action":"{{input.intent.name}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"input.intent.name"}]}],"$leavingCustomActions":[{"$id":"51d5c3b3-7419-45bd-8374-1d9cb38f747a","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroGenerico"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c391e959-860e-4eaf-86b9-71fcd8888c86","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-f09a858f-a17a-435c-9144-522020cbe27c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fcecee20-c143-46f6-9a74-bc483e66dadf","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"a8a6dce4-5cf6-4ba8-9cc2-11ce2e81dbfd","$title":"[MS.1.0.0] Validar Direcionamento","$position":{"top":"555px","left":"2205px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"52bb9e4f-0d15-4790-a6b5-b4a8a2392541":{"$contentActions":[{"action":{"$id":"40903658-aa0b-4e95-8bad-c448c78bdc74","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ba886aab-9ea8-4434-832e-515d63705770","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ba886aab-9ea8-4434-832e-515d63705770","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0b49caf3-523f-46d6-832a-9f85f9f1d072","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9f0c0759-429f-4fbf-9a6f-b6dcc03f78e1","type":"text/plain","content":"{{mensagemConsultaProtocolo}}","metadata":{}},"$cardContent":{"document":{"id":"9f0c0759-429f-4fbf-9a6f-b6dcc03f78e1","type":"text/plain","content":"{{mensagemConsultaProtocolo}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"18cceb52-6442-467f-a213-a3de7eebb5ae","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"efdb7842-b731-48e4-a65b-73ccff4c6bf4","typeOfStateId":"state","$connId":"con_28","$id":"714c5340-cea6-4e31-ba67-ff53bbb5f0b1","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"statusDoProtocolo"}],"$invalid":false},{"stateId":"a4b3fb6b-80c0-4fcc-a766-487c4df25fe5","typeOfStateId":"state","$connId":"con_33","$id":"eae0c393-3a54-4313-b0fb-284aca9c57e3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0384f377-1a79-438f-805e-5b269ee08e66","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"58c780dc-012c-433e-8b4e-81d64643d911","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"mensagemConsultaProtocolo\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(status, statusConsultaProtocolo) {\n    try {\n        if (statusConsultaProtocolo != \"200\") {\n            return \"N√£o foi poss√≠vel encontrar o protocolo solicitado.\"\n        }\n        else if (status == \"false\") {\n            return \"N√£o foi poss√≠vel encontrar o protocolo solicitado.\"\n        } else {\n            return `Este √© o status do protocolo solicitado.üëá\\n\\n<b>${status}</b>.`\n        }\n    }\n    catch (e) {\n        return false;\n    }\n}","inputVariables":["statusDoProtocolo","statusConsultaProtocolo"],"outputVariable":"mensagemConsultaProtocolo","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"9cca15e0-5c15-40be-b277-fd2ab3c1281f","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR mensagemConsultaProtocolo","$invalid":false,"settings":{"variable":"mensagemConsultaProtocolo","expiration":1},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a4b3fb6b-80c0-4fcc-a766-487c4df25fe5","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-4e68076b-b2a8-4067-b2a1-406017758473","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b9b8f85f-0f66-49a1-aa1d-cd41b43c274e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2b5ca45a-64bf-4846-b34b-1ec25c5232a6","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f42392ab-7342-4c17-9fda-1c67997de586","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"52bb9e4f-0d15-4790-a6b5-b4a8a2392541","root":false,"$title":"[MS.3.1.0] [MSG] Mensagem Status Protocolo","$position":{"top":"1516px","left":"2204px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"a4b3fb6b-80c0-4fcc-a766-487c4df25fe5":{"$contentActions":[{"action":{"$id":"50e9f345-f01c-4419-a5fd-c9813eccfedc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3818d653-57a6-44fa-816d-bf2b8e43d968","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3818d653-57a6-44fa-816d-bf2b8e43d968","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6493ac36-7a3d-4e90-a3bf-b152d1e8ea6c","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1b46fdb-e03a-4cdc-9f02-8b9fa489f6f4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"94e5d020-fd04-423f-bedb-122e58229783","typeOfStateId":"state","$connId":"con_38","$id":"e9a15541-6359-4325-beae-5c811c715913","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"831860ca-f7a7-4a47-ac69-9cb277a0b699","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"1cad4baf-0b83-45eb-ac00-f3dacd10122a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"N√£o\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Falar com atendente\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Gostaria de consultar outro protocolo?üëá\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["salesType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-56092296-ad58-44d1-bd46-e619a0c5148e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c0fdb5c7-8152-4985-bfa9-6321d89016d8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7a56c8f7-af70-4998-84ed-00d3f9cc8f09","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a4b3fb6b-80c0-4fcc-a766-487c4df25fe5","root":false,"$title":"[MS.3.2.0] [MSG] Consultar Outro Protocolo","$position":{"top":"1750px","left":"2204px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"a9e33a63-d840-48ee-9cf9-91fd1cbd8ca5":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"eceade33-1f3d-4151-b69a-a681756f42a2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"numeroProtocolo"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"numeroProtocolo","expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7fb3904-9cc0-4f2c-9992-7a16c1b4df94","typeOfStateId":"state","$connId":"con_43","$id":"0a040f0f-5f66-49c1-b362-6358629b6012","conditions":[{"source":"context","comparison":"notEquals","values":["Input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"aa8ef3cb-9439-4d1b-8ac1-bba9623b490b","$typeOfContent":"","type":"SetVariable","$title":"Set \"lastInactiveStateId\"","$invalid":false,"settings":{"variable":"lastInactiveStateId","value":"{{state.previous.id}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"bb19dbdf-7604-4688-b763-c9df69486991","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n      if (!inputUsuario) {\n        return 'inatividade'\n      }\n      const regexDictionary = {\n        \"^\\\\d{1,14}$\": \"Protocolo v√°lido\"\n      }\n      for (let regex in regexDictionary) {\n        if (new RegExp(regex, 'i').test(inputUsuario)) {\n          return regexDictionary[regex]\n        }\n      }\n      return invalidInputMessage\n    } catch (err) {\n      return invalidInputMessage\n    }\n  }","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"883c546a-b6a2-4f9f-add4-89f4fa77ecb6","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.3.0.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.3.0.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"649dc44d-1a30-45ad-a2a4-94fb7a090d45","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"de2dbe37-9056-4bbd-9884-87fb2a92862d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-3e3f3665-41cb-4bc2-b3a0-957d449dc2c9","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-912afdd5-91e8-4af2-8b91-a96c493475e7","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-25978abf-5253-4ed9-b0a4-01cd338d2678","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c847cdc7-be5f-4a3f-817b-ba61797d9342","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"a9e33a63-d840-48ee-9cf9-91fd1cbd8ca5","root":false,"$title":"[MS.3.0.0] [INPUT] Consulta Status Protocolo","$position":{"top":"973.571px","left":"2205px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"4b038e89-c130-4869-a541-4954e12ebf81":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"{{msgSolicitarData}}","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"{{msgSolicitarData}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"2fb16e6f-8eda-4028-9569-fa101eca4467","typeOfStateId":"state","$connId":"con_48","$id":"b82393d2-bf88-4ed6-9287-893daf896caa","conditions":[{"source":"input","comparison":"equals","values":["sair"]}],"$invalid":false},{"stateId":"4b038e89-c130-4869-a541-4954e12ebf81","typeOfStateId":"state","$connId":"con_53","$id":"74dfbafe-0fc1-4b0f-a16c-3d6bf96ed9f2","conditions":[{"source":"context","comparison":"lessThan","values":["2"],"variable":"counterData"},{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"8bc01a45-d42c-4a37-8ca3-a44267903349","typeOfStateId":"state","$connId":"con_58","$id":"6770b003-dce9-49f8-add7-67e113774e1a","conditions":[{"source":"context","comparison":"equals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false},{"stateId":"42352582-3913-431e-976e-ad8494ad2445","typeOfStateId":"state","$connId":"con_63","$id":"ef04e652-526a-411f-9385-a603df4c7b38","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c7681872-4167-4c09-8efb-92d7c1ee5958","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgSolicitarData\"","$invalid":false,"settings":{"function":"run","source":"function formataData(data) {\n\ttry {\n\t\tconst [ano, mes, dia] = data.split('T')[0].split('-')\n\t\treturn `${dia}/${mes}/${ano}`\n\t} catch (err) {\n\t\treturn '07/03/2024'\n\t}\n}\n\nfunction run(counter, calendarDate) {\n\ttry {\n\t\tif (!counter || counter == 0) {\n\t\t\treturn `Por gentileza, informe a data da venda.\n\nComo neste exemplo üëâ ${formataData(calendarDate)}`\n\t\t}\n\n\t\tif (counter == 1) {\n\t\t\treturn `Hmm... a data informada n√£o est√° como no exemplo apresentado. ü§î\n\nVamos tentar novamente? \n\nInforme a data da venda, como neste exemplo: ${formataData(calendarDate)}`\n\t\t}\n\t\treturn `Por gentileza, informe a data da venda.\n\nComo neste exemplo üëâ ${formataData(calendarDate)}`\n\t} catch (err) {\n\t\treturn `Por gentileza, informe a data da venda.\n\nComo neste exemplo üëâ ${formataData(calendarDate)}`\n\t}\n}","inputVariables":["counterData","calendar.datetime"],"outputVariable":"msgSolicitarData","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2b828f03-88f9-4b8f-aa99-81f06732ded0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(data) {\n\ttry {\n\t\tconst regex = /^(\\d{2})[\\/\\-]?(\\d{2})[\\/\\-]?(\\d{4})$/;\n\t\tif (!regex.test(data)) return 'input inesperado';\n\n\t\tlet dia = parseInt(data.substring(0, 2));\n\t\tlet mes = parseInt(data.substring(3, 5));\n\t\tlet ano = parseInt(data.substring(6, 10));\n\n\t\tif (dia < 1 || dia > 31) return 'input inesperado';\n\t\tif (mes < 1 || mes > 12) return 'input inesperado';\n\t\tif ((mes == 4 || mes == 6 || mes == 9 || mes == 11) && dia == 31) return 'input inesperado';\n\t\tif (mes == 2) {\n\t\t\tconst bissexto = (ano % 4 == 0 && (ano % 100 != 0 || ano % 400 == 0));\n\t\t\tif (dia > 29 || (dia == 29 && !bissexto)) return 'input inesperado';\n\t\t}\n\t\treturn dia.toString().padStart(2, '0') + '/' + mes.toString().padStart(2, '0') + '/' + ano;\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"010c590c-aa18-4af4-beab-af976bce53ee","$typeOfContent":"","type":"MergeContact","$title":"Set \"DataVendaNaoRecebida\"","$invalid":false,"settings":{"extras":{"dataVendaNaoRecebida":"{{userInput}}"}},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"848fc281-774e-444c-a806-005aaf42ddc9","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"counterData\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(counterData, userInput) {\n\ttry {\n\t\tif (userInput !== 'input inesperado') {\n\t\t\treturn 0\n\t\t}\n\t\tlet errors = Number(counterData)\n\t\terrors += 1\n\t\treturn errors\n\t} catch (err) {\n\t\treturn 1\n\t}\n}","inputVariables":["counterData","userInput"],"outputVariable":"counterData","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a6ab0e22-9b79-4ede-801c-f05e254fc2b9","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"a9df706b-0d80-4c56-9453-563ddde8a263","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d5b79256-09f9-4381-8c5b-161830938143","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-250a4de0-10bc-4e24-b11c-f0c76bd254fd","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-909d5bc7-4da9-4ffb-944e-9128329c9f9d","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-fba9d9ad-8275-4da6-b1e6-356c58a7626c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-38765012-dc2b-4590-a6bd-9f44f3af1f47","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4b038e89-c130-4869-a541-4954e12ebf81","root":false,"$title":"[MS.4.0.0] Solicita data da venda","$position":{"top":"812px","left":"3510px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"42352582-3913-431e-976e-ad8494ad2445":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"{{msgSolicitarValor}}","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"{{msgSolicitarValor}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"2fb16e6f-8eda-4028-9569-fa101eca4467","typeOfStateId":"state","$connId":"con_68","$id":"525788c6-c1d1-4336-aafe-4f648e7abd2b","conditions":[{"source":"input","comparison":"equals","values":["sair"]}],"$invalid":false},{"stateId":"42352582-3913-431e-976e-ad8494ad2445","typeOfStateId":"state","$connId":"con_73","$id":"74dfbafe-0fc1-4b0f-a16c-3d6bf96ed9f2","conditions":[{"source":"context","comparison":"lessThan","values":["2"],"variable":"counterValor"},{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"8bc01a45-d42c-4a37-8ca3-a44267903349","typeOfStateId":"state","$connId":"con_78","$id":"e01e6903-9091-420a-b161-78f2c52741da","conditions":[{"source":"context","comparison":"equals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false},{"stateId":"7bde67fe-f1eb-4eed-a5d6-2d86d0bb146b","typeOfStateId":"state","$connId":"con_83","$id":"ed4b98d3-d6f8-4e76-9b69-fbeb08e72afd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c7681872-4167-4c09-8efb-92d7c1ee5958","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgSolicitarValor\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(counter) {\n\ttry {\n\t\tif (counter == 1) {\n\t\t\treturn `Hmm... o valor informado n√£o est√° como no exemplo apresentado. ü§î\n\nVamos tentar novamente? \n\nInforme o valor da venda, como neste exemplo üëâ 3.000,00 Reais.`\n\t\t}\n\t\treturn `Certo, agora informe qual o valor da venda.\n\nDigite como neste exemplo üëâ 3.000,00 Reais.`\n\t} catch (err) {\n\t\treturn `Certo, agora informe qual o valor da venda.\n\nDigite como neste exemplo üëâ 3.000,00 Reais.`\n\t}\n}","inputVariables":["counterValor"],"outputVariable":"msgSolicitarValor","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"bd384f45-15f6-4927-b877-d4104dd3211a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(valor, message) {\n    try {\n        const messageType = JSON.parse(message).type\n        if (messageType !== \"text/plain\") {\n            return 'input inesperado'\n        }\n\n        if (!/^\\d{1,3}(\\.\\d{3})*,\\d{2}$/.test(valor)) {\n            return 'input inesperado';\n        }\n\n        const valorNumerico = valor.replace(/\\./g, '').replace(',', '.');\n        const valorFormatado = parseFloat(valorNumerico).toFixed(2).replace('.', ',');\n        return 'R$ ' + valorFormatado;\n    } catch (err) {\n        return err.message\n    }\n}","inputVariables":["input.content","input.message"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"010c590c-aa18-4af4-beab-af976bce53ee","$typeOfContent":"","type":"MergeContact","$title":"Set \"DataVendaNaoRecebida\"","$invalid":false,"settings":{"extras":{"valorVendaNaoRecebida":"{{userInput}}"}},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"848fc281-774e-444c-a806-005aaf42ddc9","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"counterValor\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(counterData, userInput) {\n\ttry {\n\t\tif (userInput !== 'input inesperado') {\n\t\t\treturn 0\n\t\t}\n\t\tlet errors = Number(counterData)\n\t\terrors += 1\n\t\treturn errors\n\t} catch (err) {\n\t\treturn 1\n\t}\n}","inputVariables":["counterValor","userInput"],"outputVariable":"counterValor","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fc8709a7-d7bb-44dd-be41-fea8b632692d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"9f2acfeb-fe5e-469f-a895-8397c9edc1ea","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c20e2deb-e1c7-44b1-af8b-ab0497a3cb83","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-484bee8e-5d32-4062-a781-59fd2731d502","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6c5696ec-3020-4146-b947-aa29e1ffd541","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-a67c332c-5348-4086-be8e-c3d11d300ed5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-7d1956f7-8ce8-4147-9bf9-70f257b76e0d","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"42352582-3913-431e-976e-ad8494ad2445","root":false,"$title":"[MS.4.1.0] Solicita valor da venda","$position":{"top":"1109px","left":"3510px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8bc01a45-d42c-4a37-8ca3-a44267903349":{"$contentActions":[{"action":{"$id":"1931cebf-5909-45a0-9ee7-f69e0f715998","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"db3287c4-331e-4272-af17-4323bb410a00","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"db3287c4-331e-4272-af17-4323bb410a00","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"948d9f83-e2c9-4668-93e4-1fc3a7d25adb","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ed243323-8617-4a79-9b08-c9d0707e5790","type":"text/plain","content":"{{exceptionMessage}}","metadata":{}},"$cardContent":{"document":{"id":"ed243323-8617-4a79-9b08-c9d0707e5790","type":"text/plain","content":"{{exceptionMessage}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d607f1b8-4cd3-4227-a4fd-1b5789000092","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cbd4bf5f-4d43-4abd-824f-ac3e2884511d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cbd4bf5f-4d43-4abd-824f-ac3e2884511d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"66b02f8d-6ef8-480c-9af4-69a6cc48a68c","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"82551006-6dd0-4480-a5f6-42154adcfbaf","type":"application/vnd.lime.select+json","content":{"text":"Como deseja prosseguir?","scope":"immediate","options":[{"text":"Falar com humano","previewText":"Falar com humano","value":null,"index":0,"type":null},{"text":"Encerrar Atendimento","previewText":"Encerrar Atendimento","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"82551006-6dd0-4480-a5f6-42154adcfbaf","type":"application/vnd.lime.select+json","content":{"text":"Como deseja prosseguir?","scope":"immediate","options":[{"text":"Falar com humano","previewText":"Falar com humano","value":null,"index":0,"type":null},{"text":"Encerrar Atendimento","previewText":"Encerrar Atendimento","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"7d314ebe-5039-433a-801e-d498b7ffac9f","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"7a851126-77e7-49c3-9193-b1c9fa5015f0","typeOfStateId":"state","$connId":"con_88","$id":"d1f89d75-80d3-4612-86b4-509b54bc4c6b","conditions":[{"source":"input","comparison":"equals","values":["sair"]}],"$invalid":false},{"stateId":"7bde67fe-f1eb-4eed-a5d6-2d86d0bb146b","typeOfStateId":"state","$connId":"con_93","$id":"71e4d4ad-1595-49ac-b1d9-a38277de03f1","conditions":[{"source":"context","comparison":"equals","values":["Falar com humano"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3db0e444-860c-467c-811a-d6d8e9fe0357","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"ab426512-da8f-4a68-9de5-09c60331d980","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"exceptionMessage\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(previousBlockName, nome) {\n\tif (previousBlockName === '[MSP.1.0.0] Solicita data da venda') {\n\t\treturn `${nome}, a data informada ainda n√£o est√° como nos exemplos apresentados. ‚òπÔ∏è`\n\t}\n\tif (previousBlockName === '[MSP.2.0.0] Solicita valor da venda') {\n\t\treturn `${nome}, o valor informado ainda n√£o est√° como nos exemplos apresentados. ‚òπÔ∏è`\n\t}\n}","inputVariables":["state.previous.name","nome"],"outputVariable":"exceptionMessage","LocalTimeZoneEnabled":false},"conditions":[{"values":["[MSP.3.0.0] Exception Data e Valor"],"source":"context","comparison":"notEquals","variable":"state.previous.name"}]},{"$id":"91006314-5afe-4cf2-856a-e039c127f0c1","$typeOfContent":"","type":"SetVariable","$title":"Set \"counterValor\" to \"0\"","$invalid":false,"settings":{"variable":"counterValor","value":"0"},"conditions":[]},{"$id":"cbee6d6e-79a2-42dc-8f4b-070e9e7c3dfd","$typeOfContent":"","type":"SetVariable","$title":"Set \"counterData\" to \"0\"","$invalid":false,"settings":{"variable":"counterData","value":"0"},"conditions":[]}],"$leavingCustomActions":[{"$id":"f37062ba-cae7-44e5-a6b2-29e0d2d8fb9d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n\tconst invalidInputMessage = 'input inesperado'\n\ttry {\n\t\tconst regexDictionary = {\n\t\t\t\"^f[a√°]l[a√°]r?\\\\s*c[o√≥]m?\\\\s*h[u√∫]m[a√°]n[o√≥]$\": \"Falar com humano\",\n\t\t\t\"^enc[e√©]rr[a√°]r?\\\\s*[a√°]t[e√©]nd[i√≠]m[e√©]nt[o√≥]$\": \"Encerrar atendimento\"\n\t\t};\n\t\tfor (let regex in regexDictionary) {\n\t\t\tif (new RegExp(regex, 'i').test(inputUsuario)) {\n\t\t\t\treturn regexDictionary[regex];\n\t\t\t}\n\t\t}\n\t\treturn invalidInputMessage;\n\t} catch (err) {\n\t\treturn invalidInputMessage;\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"03be3369-7486-4e3b-9518-071f6e88542f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"f106ceb5-8e74-4969-803d-d12e49d85936","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Falar com humano","Encerrar Atendimento"],"$defaultOutput":{"stateId":"8bc01a45-d42c-4a37-8ca3-a44267903349","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e88722b1-8782-422b-ad52-8a129a0cb5ea","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fbf20418-93d1-47ba-a73f-c72114f30d8b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3ca9f238-d46d-49c2-bb6f-3abdb9f7425b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6d4b2a82-c664-4752-ad0c-dbe55ae3f234","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-67799f60-3842-4e9e-8dd9-60cef3123523","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"8bc01a45-d42c-4a37-8ca3-a44267903349","root":false,"$title":"[MS.4.2.0] Exception Data e Valor","$position":{"top":"1097.57px","left":"3824px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c391e959-860e-4eaf-86b9-71fcd8888c86":{"$contentActions":[{"action":{"$id":"9cf758d6-8e87-4998-85e6-1b2eaadd853e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f06f62a5-70c6-4221-8715-fdc4567381c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f06f62a5-70c6-4221-8715-fdc4567381c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6339baf9-b191-4c51-a549-917443160bd5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"27a005a8-7031-4512-b28e-093cdd4dc92a","type":"text/plain","content":"Voc√™ pode simular de duas formas:\n\n‚Ä¢ Quero cobrar:\n<b>Digitando o valor que voc√™ quer cobrar do seu cliente</b>, para saber quanto vai receber ap√≥s a aplica√ß√£o de taxas.\n\n‚Ä¢ Quero receber:\n<b>Digitando o valor l√≠quido que voc√™ gostaria de receber da sua venda</b>, ap√≥s a aplica√ß√£o dos descontos e taxas.","metadata":{}},"$cardContent":{"document":{"id":"27a005a8-7031-4512-b28e-093cdd4dc92a","type":"text/plain","content":"Voc√™ pode simular de duas formas:\n\n‚Ä¢ Quero cobrar:\n<b>Digitando o valor que voc√™ quer cobrar do seu cliente</b>, para saber quanto vai receber ap√≥s a aplica√ß√£o de taxas.\n\n‚Ä¢ Quero receber:\n<b>Digitando o valor l√≠quido que voc√™ gostaria de receber da sua venda</b>, ap√≥s a aplica√ß√£o dos descontos e taxas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f61f2d1c-79cd-42d3-8a2f-925a381b2d2b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"136deec1-b274-4d22-b9a2-021b3c27c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"136deec1-b274-4d22-b9a2-021b3c27c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6851e987-b421-4d6c-8039-304ed8ddac92","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"63e9145d-3760-4ef3-ba6e-88f41a491e41","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8f1c55b1-7d84-4727-a19c-145275d573e4","typeOfStateId":"state","$connId":"con_98","$id":"3e12632c-4292-499f-ad43-d2b0e19815a4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6cf082c9-1a1a-40b3-ba97-43413903f57d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"3343998f-7c5e-4b6a-89f2-74839c8a1a4c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Quero cobrar\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Quero receber\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Selecione abaixo qual simula√ß√£o voc√™ quer fazer. üëá\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"1cbc9288-6808-400f-b25b-b547323ee1cb","$typeOfContent":"","type":"SetVariable","$title":"pesquisa","$invalid":false,"settings":{"variable":"pesquisa","value":"ces"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ab8f43b9-267c-4559-b3c8-c5ffbe4efaa2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ac35a458-fb2d-4dce-b48f-5b19cb5b806b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bda6bdfb-63d8-428e-bce7-4442eaf924f7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c391e959-860e-4eaf-86b9-71fcd8888c86","root":false,"$title":"[MS.2.0.0] [MSG] Simulador de Vendas - M√°quina","$position":{"top":"812px","left":"1218px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8f1c55b1-7d84-4727-a19c-145275d573e4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"92e51a16-8e14-4d36-8a8e-16d9b0bf7031","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"890c6c8d-7503-4b06-a642-b00d277b6a13","typeOfStateId":"state","$connId":"con_103","$id":"5d0b076b-de59-45b2-8091-500419ad1681","conditions":[{"source":"context","comparison":"equals","values":["Quero Cobrar","Quero Receber"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"cd9835be-39c1-4ac3-92bc-f90336489c65","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"quero cobrar|cobrar\": \"Quero Cobrar\",\n      \"quero receber|receber\": \"Quero Receber\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4e5ef253-61f7-4835-9e45-f49e36ee8083","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesOrder\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesOrder = input.replace(`Quero Cobrar`, `cobrar`).replace(`Quero Receber`, `receber`)\n\t\treturn salesOrder;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesOrder","LocalTimeZoneEnabled":false},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"00ea8767-f905-43d2-b560-b45aedee1f32","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"473ff1dc-08f4-448d-82a9-ab4f95f65d1b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"1e361b76-2442-4144-b8f2-b73335978d59","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cdd37f67-c480-4118-bfe0-fda20085ea59","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c43e1219-35ba-46de-b143-b8f673e31c00","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-5f87b355-b657-4fda-bc48-83e6c831980f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6c0071b9-ffd9-4d95-a277-58ece46e0b16","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"8f1c55b1-7d84-4727-a19c-145275d573e4","root":false,"$title":"[MS.2.0.0] [INPUT] Simulador de Vendas - M√°quina","$position":{"top":"1034.5px","left":"1218.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"890c6c8d-7503-4b06-a642-b00d277b6a13":{"$contentActions":[{"action":{"$id":"b00b58af-c4a0-4b88-acc6-bfd375877d98","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87cd5126-0e6d-401b-8e15-fc57f4b1139f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c3541272-a652-4112-9a0f-665d23c0136e","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0f1cd996-d08a-4f2b-af89-445eaab54a00","typeOfStateId":"state","$connId":"con_108","$id":"5b0c583a-22c5-4c1f-91a9-584414441e83","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5de6066b-90d0-4776-9a2e-985420e55842","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"efc6afd4-c708-460d-842d-5021f952c686","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Venda f√≠sica\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Venda digital\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Qual seria o tipo de venda?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7e4998a1-5bcf-4a65-b798-147604ede389","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-225f520e-4a03-401a-8840-729c262a972b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7ec39616-ed01-4001-a864-ff671bd1b012","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"890c6c8d-7503-4b06-a642-b00d277b6a13","root":false,"$title":"[MS.2.1.0] [MSG] Tipo de venda","$position":{"top":"1272.67px","left":"1217.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0f1cd996-d08a-4f2b-af89-445eaab54a00":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"65afe46f-a05c-40b1-9f67-6b934b7f2eb6","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"fe58d380-8c87-45b9-ab44-64d5d37c1f51","typeOfStateId":"state","$connId":"con_113","$contentId":"9127595b-b2c0-41e3-a704-940de3cf87b7","$id":"d100409d-ed80-44b2-b907-3047dbc19aef","conditions":[{"source":"context","comparison":"equals","values":["Venda f√≠sica","Venda digital"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0c4de828-fe02-460d-9f56-b83a73c70346","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"6f67936b-305e-4906-9828-701ccf1247e8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"6659f598-65b1-4bfb-96d4-e7c12ff9c5f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"Venda f[√≠i]sica|f[√≠i]sica\": \"Venda f√≠sica\",\n      \"Venda digital|digital\": \"Venda digital\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"15920c9a-5270-44b6-9bef-a48d73598848","$typeOfContent":"","type":"ExecuteScript","$title":"Proces \"salesType\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesType = input.replace(`Venda f√≠sica`, `maquininha`).replace(`Venda digital`, `link`);\n\t\treturn salesType;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesType","LocalTimeZoneEnabled":false},"conditions":[{"values":["Input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"9038f508-01e7-4e0e-8165-1c46808638e9","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":["Venda f√≠sica","Venda digital"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-958c231f-920c-4c38-95ff-3701592f60a3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-839837ff-cf79-4257-ae7b-7245433b1192","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9ba32f47-2a82-438c-a866-96e0f8e27d00","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-155e3f72-dcc1-4c2e-b20e-3b461d46e712","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"0f1cd996-d08a-4f2b-af89-445eaab54a00","root":false,"$title":"[MS.2.1.0] [INPUT] Tipo de venda","$position":{"top":"1476px","left":"1218px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"90f43d6e-b4cd-42d8-a2a1-938c40d6e764":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a658b32f-2835-4b36-aa9d-ad3e817ae7ac","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:7"},"$invalid":false}],"$conditionOutputs":[{"stateId":"2379f037-b47b-4c61-b9b7-9ae97eb09f06","typeOfStateId":"state","$connId":"con_118","$id":"95b138d2-a2a1-4485-9e93-37af8373de42","conditions":[{"source":"context","comparison":"equals","values":["√â um valor v√°lido"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"9d2ab2f5-ccbc-479d-8842-e89a87616c1f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n        if (!inputUsuario) {\n            return 'inatividade'\n        }\n\n        let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi\n        let validInput = regex.test(inputUsuario)\n\n        if (validInput) {\n            let valor = inputUsuario.replace(/\\./g, '').replace(',', '.')\n            let valorFloat = parseFloat(valor)\n            if (valorFloat <= 10000 && valorFloat >= 1) {\n                return \"√â um valor v√°lido\"\n            }\n        }\n        return invalidInputMessage\n    } catch (err) {\n        return invalidInputMessage\n    }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7e0adafc-7741-452a-b0a9-9ac59e690382","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValue\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesValue = input.replace('.', '').replace(',', '.')\n\t\treturn salesValue;\n\t}\n\tcatch(err){\n\t\treturn false\n\t}\n}","inputVariables":["input.content"],"outputVariable":"salesValue","LocalTimeZoneEnabled":false},"conditions":[{"values":["√â um valor v√°lido"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"0f55c995-6169-457f-92c9-684fcde81211","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.2.1.1\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.2.1.1"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"764e8e9a-21da-4f52-84e7-a4b5a9c1f388","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"8d5fea91-f519-45eb-9277-2e003aae0255","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-18aef292-6abe-4cb3-978c-316e18169c6d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0bd24859-77e2-40f7-a58e-b3f31cd1034a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c4ecd07c-4e79-4449-adfe-c7f621d3ae5e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3dcefee6-1900-472f-b6c8-a6dd61d74a2c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"90f43d6e-b4cd-42d8-a2a1-938c40d6e764","root":false,"$title":"[MS.2.1.1] [INPUT] Valor simulacao","$position":{"top":"1914px","left":"1218.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2379f037-b47b-4c61-b9b7-9ae97eb09f06":{"$contentActions":[{"action":{"$id":"ed85b502-ff0c-43d5-82e0-15c14dd48d9a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f49aaae2-87e9-4dbe-9fd3-e3d8f822c2f0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f49aaae2-87e9-4dbe-9fd3-e3d8f822c2f0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a423db42-4ac7-4679-808c-9e92b91f4d47","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"23eea70d-2bde-4953-9ecf-8d398dc29017","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"cc7f677d-b3d8-4702-9b09-d8b346c229c9","typeOfStateId":"state","$connId":"con_123","$id":"a540e61c-119d-4581-81e0-d2ccd946d454","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"7a7df971-29d4-42a3-a16f-deadfb39fb27","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesType) {\n    try {\n        let buttons = [\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"1\",\n                    \"title\": \"Cr√©dito √† vista\"\n                }\n            },\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"2\",\n                    \"title\": \"Cr√©dito parcelado\"\n                }\n            }\n        ];\n        if (salesType === \"maquininha\") {\n            buttons = [\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"1\",\n                        \"title\": \"D√©bito √† vista \"\n                    }\n                },\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"2\",\n                        \"title\": \"Cr√©dito √† vista\"\n                    }\n                },\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"3\",\n                        \"title\": \"Cr√©dito parcelado\"\n                    }\n                }\n            ];\n        }\n\n        const headerText = \"Qual seria a forma de pagamento?\";\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"button\",\n                \"body\": {\n                    \"text\": headerText,\n                },\n                \"action\": {\n                    buttons\n                }\n            }\n        };\n    } catch (err) {\n        return false;\n    }\n}","inputVariables":["salesType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"466638f9-50be-454c-98a5-32ff70d87fb1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-97aae889-7247-43e8-baef-b43af5bed012","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8578e223-f377-420e-ab76-406dbaeb3d9e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-675f44b3-25a9-465b-bc1d-8856b788143b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2379f037-b47b-4c61-b9b7-9ae97eb09f06","root":false,"$title":"[MS.2.1.2] [MSG] Tipo pagamento","$position":{"top":"2132.67px","left":"1217.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fe58d380-8c87-45b9-ab44-64d5d37c1f51":{"$contentActions":[{"action":{"$id":"bf89849f-4fac-4e72-ad57-2cf54d9e1449","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5b9e2298-0f6c-49df-9404-20fdaa935223","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5b9e2298-0f6c-49df-9404-20fdaa935223","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f05f6bb7-26c4-4e8d-8d75-9cbe4fcf50ed","$typeOfContent":"text","type":"SendMessage","settings":{"id":"78721f34-9722-421b-8a1f-5f0f76d09c2e","type":"text/plain","content":"Ok! Digite um valor entre R$1,00 e R$10.000,00 para fazer a simula√ß√£o. Como neste exemplo üëâ 1.000,50.","metadata":{}},"$cardContent":{"document":{"id":"78721f34-9722-421b-8a1f-5f0f76d09c2e","type":"text/plain","content":"Ok! Digite um valor entre R$1,00 e R$10.000,00 para fazer a simula√ß√£o. Como neste exemplo üëâ 1.000,50."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a658b32f-2835-4b36-aa9d-ad3e817ae7ac","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"90f43d6e-b4cd-42d8-a2a1-938c40d6e764","typeOfStateId":"state","$connId":"con_128","$id":"415eafa1-240a-4b9b-8922-fe0eefe8735f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b93b86fe-471e-479e-8580-adc1c9bca4cf","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[{"$id":"9d2ab2f5-ccbc-479d-8842-e89a87616c1f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n        if (!inputUsuario) {\n            return 'inatividade'\n        }\n\n        let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi\n        let validInput = regex.test(inputUsuario)\n\n        if (validInput) {\n            let valor = inputUsuario.replace(/\\./g, '').replace(',', '.')\n            let valorFloat = parseFloat(valor)\n            if (valorFloat <= 10000 && valorFloat >= 1) {\n                return \"√â um valor v√°lido\"\n            }\n        }\n        return invalidInputMessage\n    } catch (err) {\n        return invalidInputMessage\n    }\n}","inputVariables":["input.content"],"outputVariable":"valorValido","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2bf0672f-852e-48c4-b3d5-7b4e048a5acd","$typeOfContent":"","type":"ExecuteScript","$title":"valorValido2","$invalid":false,"settings":{"function":"run","source":"\nfunction run(valor) {\n\t\n\tlet valor = valor.replace(',','.')\n\tvalor = parseFloat(valor)\n\tif(valor > 10000 || valor < 1){\n\t\treturn \"N√£o √© um valor v√°lido\"\n\t}else{\n\t\treturn \"√â um valor v√°lido\"\n\t}\n\t\n}","inputVariables":["valor"],"outputVariable":"valorValido","LocalTimeZoneEnabled":false},"conditions":[{"values":["√â um valor v√°lido"],"source":"context","comparison":"equals","variable":"valorValido"}]},{"$id":"764e8e9a-21da-4f52-84e7-a4b5a9c1f388","$typeOfContent":"","type":"TrackEvent","$title":"Registro de eventos","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{valor}}"},"conditions":[{"values":["√â um valor v√°lido"],"source":"context","comparison":"equals","variable":"valorValido"},{"comparison":"exists","source":"context","values":[],"variable":"valor"}]},{"$id":"8d5fea91-f519-45eb-9277-2e003aae0255","$typeOfContent":"","type":"TrackEvent","$title":"Registro de eventos","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["N√£o √© um valor v√°lido"],"source":"context","comparison":"equals","variable":"valorValido"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-457be5dc-03f9-46a7-81a6-16611b3ddbd9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-11325d71-61a6-4827-9849-6d002b4f1980","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5f74d4a6-6b84-4a4d-8f4c-47c17e348c17","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fe58d380-8c87-45b9-ab44-64d5d37c1f51","root":false,"$title":"[MS.2.1.1] [MSG] Valor simulacao","$position":{"top":"1716.67px","left":"1218.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cc7f677d-b3d8-4702-9b09-d8b346c229c9":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"23eea70d-2bde-4953-9ecf-8d398dc29017","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51","typeOfStateId":"state","$connId":"con_133","$contentId":"4174bb36-4a73-40d5-aa00-89b0e8fb5f4d","$id":"b5fd29d2-c696-41f3-a77b-322021c2a891","conditions":[{"source":"context","comparison":"equals","values":["D√©bito √† vista","Cr√©dito √† vista","Cr√©dito parcelado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"6d74e7a6-7a16-4cfd-a518-2df8063f42e3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, salesType) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Cr√©dito [√†a] vista\": \"Cr√©dito √† vista\",\n      \"Cr√©dito parcelado\": \"Cr√©dito parcelado\"\n    }\n    if (salesType == \"maquininha\") {\n      regexDictionary = {\n        \"d[√©e]bito [√†a] vista\": \"D√©bito √† vista\",\n        \"Cr√©dito [√†a] vista\": \"Cr√©dito √† vista\",\n        \"Cr√©dito parcelado\": \"Cr√©dito parcelado\"\n      }\n    }\n\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content","salesType"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4987bc1a-6b77-4b58-8c36-10f3b478d265","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"b53193f6-eae1-44e2-bf26-054f0d5f6513","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentType\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesPaymentType = input.replace(`D√©bito √† vista`, `debito`).replace(`Cr√©dito √† vista`, `creditoAVista`).replace(`Cr√©dito parcelado`, `creditoParcelado`)\n\t\treturn salesPaymentType;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesPaymentType","LocalTimeZoneEnabled":false},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"797027ce-ae92-4bdc-8f97-e0753faa452e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0be50b5b-1a79-4f1c-ab87-3b7fdf3cac3c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2746e625-d47d-4ad7-8b6f-f5d824209c56","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-372ad2b9-7873-4964-a681-43075fea8df6","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-642bc81d-b793-4a46-bd20-f201ef665bbe","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5829c2d2-f3c7-4131-a88a-920f8cffc41a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"cc7f677d-b3d8-4702-9b09-d8b346c229c9","root":false,"$title":"[MS.2.1.2] [INPUT] Tipo pagamento","$position":{"top":"2319px","left":"1219px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e4fd4a08-5cdf-4d34-99d3-74f9f5a9e3c1","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59d0589a-4bfe-427b-bcc3-37affdafab98","typeOfStateId":"state","$connId":"con_138","$id":"2fc6ef44-de2e-452b-926a-449aadab97db","conditions":[{"source":"context","comparison":"equals","values":["200"],"variable":"statusSimulacao"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9dc698f7-0f96-48d0-9aad-f9a4bb16b021","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP POST \"bodySimulacao\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}","Safra-Bot-ID":"{{application.identifier}}"},"method":"POST","body":"{\n  \"valorVenda\": \"{{salesValue}}\",\n  \"tipoSimulacao\": \"{{salesOrder}}\",\n  \"modalidade\": \"{{salesType}}\",\n  \"tipoPagamento\": \"{{salesPaymentType}}\"\n}","uri":"{{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/{{ec}}/vendas/simular","responseStatusVariable":"statusSimulacao","responseBodyVariable":"bodySimulacao"},"conditions":[]},{"$id":"225f7803-acb4-4143-a1ca-e64661f26a85","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusSimulacao"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ccc1c758-e359-4884-a1c2-9375288aa14e","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/{{ec}}/vendas/simular | POST | {{statusSimulacao}} | {{bodySimulacao}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"47920e81-494d-4445-9550-023cb2b80dd4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} api status\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} api status","action":"{{statusSimulacao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusSimulacao"}]},{"$id":"b19574bb-f2f6-4e43-be0b-5cf113d4556c","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"statusSimulacao"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-39438dc9-fa93-4b7a-b0e0-e40f614897f2","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-8e64822b-8759-4d4b-8523-0f05d1ecb5e0","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-865e0659-01b5-4094-b873-fd6426449c87","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2f685dab-64c7-44e2-85ff-d6e84e0a72d6","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51","root":false,"$title":"[MS.2.1.3] [HTTP] API Simular Vendas","$position":{"top":"2564px","left":"1218px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59d0589a-4bfe-427b-bcc3-37affdafab98":{"$contentActions":[{"action":{"$id":"c810e386-4922-4496-9cf5-fb65ca671e9a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"86f79972-a169-4480-babb-4261f1b5a4f4","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b38e7f6a-5a97-4966-ba49-f9b7915d436e","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"82f8e3d4-5db6-45e5-a221-5bf5526adc84","typeOfStateId":"state","$connId":"con_143","$id":"91858b4f-3baf-4f40-9b92-3f87eeccf56a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"43c3a7b6-6035-4c73-b26a-1dece10ecbee","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentType) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Master\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Visa\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Elo\"\n\t\t\t}\n\t\t]\n\t\tif (salesPaymentType != \"debito\") {\n\t\t\tdefaultMenuOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Master\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Visa\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Elo\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"4\",\n\t\t\t\t\t\"title\": \"Amex\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"5\",\n\t\t\t\t\t\"title\": \"Hiper\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual seria a bandeira? Escolha na lista a seguir.üëá`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Escolha uma op√ß√£o\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["salesPaymentType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"21292a72-3479-42d5-b52c-23bc2f5ddf51","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-16e57288-0a5b-4635-a477-373657ac6d25","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8e3e8f55-506f-4249-9204-0e58818b92a6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b6cfba36-a806-4bcd-a530-e9c12785b102","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"59d0589a-4bfe-427b-bcc3-37affdafab98","root":false,"$title":"[MS.2.1.4] [MSG] Selecao Bandeira","$position":{"top":"2814.57px","left":"1218px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"82f8e3d4-5db6-45e5-a221-5bf5526adc84":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"b38e7f6a-5a97-4966-ba49-f9b7915d436e","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"9ea4726f-a4a6-48be-81b6-48d3fed6c373","typeOfStateId":"state","$connId":"con_148","$contentId":"0312166f-fe1d-43d2-908e-70cfcb0fbde7","$id":"7603f757-e8f3-48cb-b0fb-18a6be76bfef","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["creditoParcelado"],"source":"context","comparison":"equals","variable":"salesPaymentType"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false},{"stateId":"e326f39c-d055-4f2e-9f16-85fe9685f1bf","typeOfStateId":"state","$connId":"con_153","$id":"7f358945-ad3f-4dff-98a8-aa47e0cf6ed2","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d1b72f4d-1312-4445-a40b-8e7867f801d1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, salesPaymentType) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Master\": \"Master\",\n      \"Visa\": \"Visa\",\n      \"Elo\": \"Elo\"\n    }\n    if (salesPaymentType != \"debito\") {\n      regexDictionary = {\n        \"Master\": \"Master\",\n        \"Visa\": \"Visa\",\n        \"Elo\": \"Elo\",\n        \"Amex\": \"Amex\",\n        \"Hiper\": \"Hiper\"\n      }\n    }\n\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content","salesPaymentType"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b139b8a2-c927-4b35-b7fc-96ce5bf3cf61","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d3a2dc1d-5dc7-4276-bce4-16516d931126","$typeOfContent":"","type":"SetVariable","$title":"Set \"salesCardFlag\" with \"userInput\"","$invalid":false,"settings":{"value":"{{userInput}}","variable":"salesCardFlag"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"c9be838f-a14c-43f5-9848-81148e6fd0d0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{input.content}}"},"conditions":[{"values":["Master","Visa","Elo","Amex","Hiper"],"source":"input","comparison":"equals"}]},{"$id":"6a5bb02b-81cf-45a9-84b7-59b24c21eaa0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["Master","Visa","Elo","Amex","Hiper"],"source":"input","comparison":"notEquals"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-28e696ca-b29b-4063-8f7a-b8dc87909d0c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c3d4095d-e3af-4958-bce5-c5dafba9672f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-888a99c5-38ab-46b6-a953-51b8c4ac8c65","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ecbf3333-775c-40b0-8c1c-7d7ac1a07c20","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"82f8e3d4-5db6-45e5-a221-5bf5526adc84","root":false,"$title":"[MS.2.1.4] [INPUT] Selecao Bandeira","$position":{"top":"3017px","left":"1218px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e326f39c-d055-4f2e-9f16-85fe9685f1bf":{"$contentActions":[{"action":{"$id":"3e6766d3-cb22-413c-ad12-96708648547f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"807942b6-4631-4f97-b507-ae0c612f10b7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"807942b6-4631-4f97-b507-ae0c612f10b7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ee2313b4-9206-4bb4-828e-823eddc4297b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"38a5b953-9f90-4ec0-8a50-c1c5bea4c638","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, segue a simula√ß√£o da sua venda: ü§ë","metadata":{}},"$cardContent":{"document":{"id":"38a5b953-9f90-4ec0-8a50-c1c5bea4c638","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, segue a simula√ß√£o da sua venda: ü§ë"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d042e3af-4a69-4123-b95c-437767a20806","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6ab58b7f-6395-4b8b-9e87-9b9de4be44fb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"6ab58b7f-6395-4b8b-9e87-9b9de4be44fb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"17fb4027-09dc-4ebc-819f-db705574644c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1dced7d9-ff9a-4b98-8451-b89cf31f6afd","type":"text/plain","content":"{{salesSufixStringfy}} \nTotal de taxas: R${{salesSimulation@valorTaxaTotal}}\nForma de pagamento:{{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}","metadata":{}},"$cardContent":{"document":{"id":"1dced7d9-ff9a-4b98-8451-b89cf31f6afd","type":"text/plain","content":"{{salesSufixStringfy}} \nTotal de taxas: R${{salesSimulation@valorTaxaTotal}}\nForma de pagamento:{{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6aca71a3-0115-4f8d-b282-3520108ce390","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","typeOfStateId":"state","$connId":"con_158","$id":"0446be5b-71cc-40ae-8599-b46bc6d89a5c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6add8cde-dd80-4194-ac00-970f1e1b58c3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"d5123ec5-117d-4570-8401-b754cfcea595","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentTypeStringfy){\n\tsalesPaymentTypeStringfy = salesPaymentTypeStringfy.replace(`debito`,`D√©bito √† vista`).replace(`creditoAVista`, `Cr√©dito √† vista`).replace(`creditoParcelado`, `Cr√©dito parcelado`)\n\treturn salesPaymentTypeStringfy; \n}","inputVariables":["salesPaymentType"],"outputVariable":"salesPaymentTypeStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a1efc857-fd50-44fc-960f-0b46409610bf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValueStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(valor) {\n  try {\n    const pontos = (valor.match(/\\./g) || []).length;\n    const virgulas = (valor.match(/\\,/g) || []).length;\n\n    if (pontos > 1 || virgulas > 1) {\n      valor = valor.replace(/\\./g, '').replace(',', '.');\n    } else if ((valor.split('.')[1] || []).length == 2 && pontos == 1) {\n      valor = valor.replace(',', '');\n    } else if ((valor.split(',')[1] || []).length == 2 && virgulas == 1) {\n      valor = valor.replace('.', '').replace(',', '.');\n    } else {\n      valor = valor.replace('.', '').replace(',', '.');\n    }\n\n    valor = parseFloat(valor);\n    let valorFormatado = valor.toFixed(2).replace('.', ',');\n    valorFormatado = valorFormatado.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1.');\n    return valorFormatado;\n  }\n  catch (e) {\n    return valor;\n  }\n};","inputVariables":["salesValue"],"outputVariable":"salesValueStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3b36deea-f469-4dd3-98be-ec3192d6727e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulation\"","$invalid":false,"settings":{"function":"run","source":"function run(bandeira, bodySimulacao,salesOrder) {\n\tlet bandeira = bandeira.toLowerCase();\n\tlet bodySimulacao = JSON.parse(bodySimulacao);\n\tconst formatValue = (valor) => {\n\t\treturn `${\n\t\t\tparseFloat(valor)\n\t\t\t\t.toFixed(2)\n\t\t\t\t.replace(\".\", \",\")\n\t\t\t\t.replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\")}`;\n\t}\n\tbodySimulacao = bodySimulacao.data[salesOrder].modalidades[0].bandeiras\n\tbodySimulacao = bodySimulacao.filter(bodySimulacao => (bodySimulacao.descricao == bandeira))\n\tbodySimulacao = bodySimulacao[0].simulacoes[0]\n\tbodySimulacao.valorFinal = formatValue(bodySimulacao.valorFinal)\n\tbodySimulacao.valorTaxaTotal = formatValue(bodySimulacao.valorTaxaTotal)\n\n\treturn JSON.stringify(bodySimulacao);\n}","inputVariables":["salesCardFlag","bodySimulacao","salesOrder"],"LocalTimeZoneEnabled":false,"outputVariable":"salesSimulation"},"conditions":[]},{"$id":"4595b17a-a56e-44db-9897-9cd6b8cb060d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSufixStringfy\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(salesOrder, salesSimulation, salesValueStringfy) {\n\ttry {\n\t\tsalesSimulation = JSON.parse(salesSimulation);\n\t\tif (salesOrder == \"receber\") {\n\t\t\treturn `Cobrando: R$${salesSimulation.valorFinal}\\nVoc√™ receber√°: R$${salesValueStringfy}`\n\t\t}\n\t\telse {\n\t\t\treturn `Cobrando: R$${salesValueStringfy}\\nVoc√™ receber√°: R$${salesSimulation.valorFinal}`\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["salesOrder","salesSimulation","salesValueStringfy"],"outputVariable":"salesSufixStringfy","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"9816d527-c78c-49d7-96b0-8f92c1bb0d1f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} dados\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} dados","action":"{{salesValueStringfy}} | {{salesSimulation@valorFinal}}| {{salesSimulation@valorTaxaTotal}} | {{salesPaymentTypeStringfy}} | {{salesCardFlag}}"},"conditions":[]},{"$id":"4237de2c-7614-4207-9d1c-680d9b0e8ce1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\" to {salesOrder} - Simulador de Vendas","$invalid":false,"settings":{"extras":{},"category":"assuntos","action":"{{salesOrder}} - Simulador de Vendas"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2ed34a52-344b-401d-92a4-eeacf573565a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-99d18ec6-351a-4ac3-bdf3-b0f2eec86b1c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-653523c6-6800-4ab5-aba9-8ed4305c48a5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e326f39c-d055-4f2e-9f16-85fe9685f1bf","root":false,"$title":"[MS.2.1.5] Cobrar / Receber (√Ä Vista)","$position":{"top":"3287px","left":"794px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9ea4726f-a4a6-48be-81b6-48d3fed6c373":{"$contentActions":[{"action":{"$id":"6d1d44df-ba3a-45d4-9c4c-3a861e11a3fa","$typeOfContent":"text","type":"SendMessage","settings":{"id":"85645144-8217-469b-b6e0-e0cf19ce752c","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, estas s√£o as condi√ß√µes para simula√ß√£o da sua venda.üëá","metadata":{}},"$cardContent":{"document":{"id":"85645144-8217-469b-b6e0-e0cf19ce752c","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, estas s√£o as condi√ß√µes para simula√ß√£o da sua venda.üëá"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fa3afb16-57ab-456a-915c-200409341287","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"57a1d723-25f8-4c86-8edb-7d404de2af0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"57a1d723-25f8-4c86-8edb-7d404de2af0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"05d4465a-fc3c-4b55-8d54-5b9b3b0ae296","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a6681907-19fe-44f3-b726-116820a92325","type":"text/plain","content":"{{salesSufixStringfy@value}} {{salesValueStringfy}}\nCom esta forma de pagamento: {{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}\n\n{{salesSufixStringfy@description}}","metadata":{}},"$cardContent":{"document":{"id":"a6681907-19fe-44f3-b726-116820a92325","type":"text/plain","content":"{{salesSufixStringfy@value}} {{salesValueStringfy}}\nCom esta forma de pagamento: {{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}\n\n{{salesSufixStringfy@description}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a22b2f21-b8c6-4a52-ab9c-638395cd32b9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7320621c-c487-43a2-ad97-616895b9066f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"1000"},"metadata":{}},"$cardContent":{"document":{"id":"7320621c-c487-43a2-ad97-616895b9066f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"1000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f53a5eca-bcb5-4c77-ac9f-5a631a90c079","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ef9c7209-878d-43b4-a1fc-6ba36f499a5d","type":"text/plain","content":"{{salesSimulationStringfy}}","metadata":{}},"$cardContent":{"document":{"id":"ef9c7209-878d-43b4-a1fc-6ba36f499a5d","type":"text/plain","content":"{{salesSimulationStringfy}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7c5d7584-fbf9-42c7-82a8-5dee75920c0f","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","typeOfStateId":"state","$connId":"con_163","$id":"f20f3b85-558b-4e67-89e2-4c42090b388f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"90351c88-2a18-47dc-9c31-dd69f99d4ce6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"0ce8dd0b-2d3f-47fc-b0e9-7495447ccbba","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentTypeStringfy){\n\tsalesPaymentTypeStringfy = salesPaymentTypeStringfy.replace(`debito`,`D√©bito √† vista`).replace(`creditoAVista`, `Cr√©dito √† vista`).replace(`creditoParcelado`, `Cr√©dito parcelado`)\n\treturn salesPaymentTypeStringfy; \n}","inputVariables":["salesPaymentType"],"outputVariable":"salesPaymentTypeStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7bf87283-4e09-4613-b57d-adfdd9be0c8a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValueStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(valor) {\n  try {\n    const pontos = (valor.match(/\\./g) || []).length;\n    const virgulas = (valor.match(/\\,/g) || []).length;\n\n    if (pontos > 1 || virgulas > 1) {\n      valor = valor.replace(/\\./g, '').replace(',', '.');\n    } else if ((valor.split('.')[1] || []).length == 2 && pontos == 1) {\n      valor = valor.replace(',', '');\n    } else if ((valor.split(',')[1] || []).length == 2 && virgulas == 1) {\n      valor = valor.replace('.', '').replace(',', '.');\n    } else {\n      valor = valor.replace('.', '').replace(',', '.');\n    }\n\n    valor = parseFloat(valor);\n    let valorFormatado = valor.toFixed(2).replace('.', ',');\n    valorFormatado = valorFormatado.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1.');\n    return valorFormatado;\n  }\n  catch (e) {\n    return valor;\n  }\n};","inputVariables":["salesValue"],"outputVariable":"salesValueStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a9437768-2ee8-4e93-9fd3-ae8af297900d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulation\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(bandeira, bodySimulacao,salesOrder) {\n\tlet bandeira = bandeira.toLowerCase();\n\tlet bodySimulacao =  JSON.parse(bodySimulacao);\n\tbodySimulacao = bodySimulacao.data[salesOrder].modalidades[0].bandeiras\n\tbodySimulacao = bodySimulacao.filter(bodySimulacao => (bodySimulacao.descricao == bandeira))\n\tbodySimulacao = bodySimulacao[0]\n\treturn JSON.stringify(bodySimulacao); \n}","inputVariables":["salesCardFlag","bodySimulacao","salesOrder"],"outputVariable":"salesSimulation","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0406d0a3-f748-47b3-a5cb-f2c85c97f78d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulationStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(simulacao) {\n  let simulacao = JSON.parse(simulacao);\n  let aux = ''\n  let count = 2\n  const formatValue = (valor) => {\n    return `${\n      parseFloat(valor)\n        .toFixed(2)\n        .replace(\".\", \",\")\n        .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\")}`;\n  }\n  simulacao.simulacoes.forEach(function (element) {\n    aux = aux.concat(\n\n      'R$ ',\n      formatValue(element.valorFinal),\n      ', se parcelado em ',\n      count,\n      'x\\n'\n    );\n    count++\n  });\n  return aux\n}","inputVariables":["salesSimulation"],"outputVariable":"salesSimulationStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ecc20e35-b3a3-4911-ad28-7b54759c82c2","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSufixStringfy\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(salesOrder) {\n\ttry {\n\t\tif (salesOrder == \"receber\") {\n\t\t\treturn {\n\t\t\t\t\"value\": \"Para receber este valor:R$\",\n\t\t\t\t\"description\": \"Voc√™ precisa cobrar:üëá\"\n\t\t\t}\n\n\t\t}\n\t\telse {\n\t\t\treturn {\n\t\t\t\t\"value\": \"Cobrando este valor: R$\",\n\t\t\t\t\"description\": \"Voc√™ ir√° receber:üëá\"\n\t\t\t}\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n\n}","inputVariables":["salesOrder"],"outputVariable":"salesSufixStringfy","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"6f6ee08b-5eb9-4fe7-86bc-d671a6e80f31","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} dados\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} dados","action":"{{salesValueStringfy}} | {{salesPaymentTypeStringfy}} | {{salesCardFlag}}"},"conditions":[]},{"$id":"21b80c91-dd54-4235-bdaa-4c0e93a49d51","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\" to {salesOrder} - Simulador de Vendas","$invalid":false,"settings":{"extras":{},"category":"assuntos","action":"Cr√©dito Parcelado - {{salesOrder}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-126d59f9-7a5e-43ef-b873-bbbb81912407","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e7294e81-f76e-4257-851c-7b75d7eaac8c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f62975ec-6a5a-48bb-af2b-51ed8be2f8d7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9ea4726f-a4a6-48be-81b6-48d3fed6c373","root":false,"$title":"[MS.2.1.6] Cobrar / Receber (Parcelado)","$position":{"top":"3281px","left":"1652px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3f1e37ee-597d-4dd0-a7e8-f146c51b710c":{"$contentActions":[{"action":{"$id":"975583b8-07ca-4a97-b58c-2719463968c3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"133e0afd-4f6d-48b8-b3eb-15d7fde2d269","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"133e0afd-4f6d-48b8-b3eb-15d7fde2d269","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0da0585f-5a91-4d13-aa9b-6aaae07f0b11","$typeOfContent":"select","type":"SendMessage","settings":{"id":"58b2ed53-6951-414c-a272-808a52593339","type":"application/vnd.lime.select+json","content":{"text":"Selecione uma das op√ß√µes abaixo üëá","options":[{"text":"Entender minhas taxas","previewText":"Entender minhas taxas","value":null,"index":1,"type":null},{"text":"Fazer outra simula√ß√£o","previewText":"Fazer outra simula√ß√£o","value":null,"index":2,"type":null}],"limitMenu":false},"metadata":{}},"$cardContent":{"document":{"id":"58b2ed53-6951-414c-a272-808a52593339","type":"application/vnd.lime.select+json","content":{"text":"Selecione uma das op√ß√µes abaixo üëá","options":[{"text":"Entender minhas taxas","previewText":"Entender minhas taxas","value":null,"index":1,"type":null},{"text":"Fazer outra simula√ß√£o","previewText":"Fazer outra simula√ß√£o","value":null,"index":2,"type":null}],"limitMenu":false}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b0dcdca2-e1e0-4def-91c6-4227e78fd7b0","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2","typeOfStateId":"state","$connId":"con_168","$id":"34fe817f-0df8-4ddb-ad6b-9d0c6773e217","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"278dfbdb-843d-4ee6-8e32-eaaa6b980bf8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"16dcdce7-f18f-4cff-9658-0aab61c38423","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesSimulation\"","$invalid":false,"settings":{"variable":"salesSimulation","expiration":1},"conditions":[]},{"$id":"51b01e5d-18ee-462d-ae8c-318b677d0a9d","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesValueStringfy\"","$invalid":false,"settings":{"variable":"salesValueStringfy","expiration":1},"conditions":[]},{"$id":"1d0f5dbb-42f8-4647-b2fc-bb0ee678b4e1","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"variable":"salesPaymentTypeStringfy","expiration":1},"conditions":[]},{"$id":"c0224af3-56dc-47bd-b612-9775a7a6587f","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesSufixStringfy\"","$invalid":false,"settings":{"variable":"salesSufixStringfy","expiration":1},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":["Entender minhas taxas","Fazer outra simula√ß√£o"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-83844e37-c661-410f-9547-a38d94daa5f5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d37e0127-c054-4a4c-8c1b-d67f609d0205","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-29decd3d-3d0a-4231-bd35-b783f83c6b9b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","root":false,"$title":"[MS.2.2.0] [MSG] Menu simula√ß√£o op√ß√µes","$position":{"top":"3613px","left":"1216px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"05d66083-4b28-4d00-9132-1a7a5ac7bd7b","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"20e6070d-ed99-4c03-8273-ed255c8c4868","typeOfStateId":"state","$connId":"con_173","$id":"cd83c5bd-0a7a-4fa9-bdbd-0bc60cd1f5b7","conditions":[{"source":"context","comparison":"equals","values":["Entender minhas taxas"],"variable":"userInput"}],"$invalid":false},{"stateId":"a862dc90-c7cf-421d-bdab-9d09ebe9f70c","typeOfStateId":"state","$connId":"con_178","$id":"f147e717-f486-4887-bbad-fbfadd071a0d","conditions":[{"source":"context","comparison":"equals","values":["Fazer outra simula√ß√£o"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"45a5eac9-9fdf-4977-b931-9f26587ce761","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Entender minhas taxas\": \"Entender minhas taxas\",\n      \"Fazer outra simula[√ßc][√£a]o\": \"Fazer outra simula√ß√£o\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ce6f4522-2c57-4255-b0ae-2cc41387c29a","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"9b491e16-ab09-47bd-a3f2-c938ee74e551","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"4e1c4b0e-c302-4012-821a-fe6e7a211bbd","$typeOfContent":"","type":"TrackEvent","$title":"SPD Maquina Safrapay {state.name} valida√ß√£o","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3f703ff1-40f7-4902-ac75-e741476a165e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e010145f-0c73-4fad-9d46-b91a60827f4a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6886474e-55ec-422b-88ea-4f64f9360c01","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4091db83-1868-49d6-ac9d-197169047693","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2","root":false,"$title":"[MS.2.2.0] [INPUT] Menu simula√ß√£o op√ß√µes","$position":{"top":"3840px","left":"1216px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"20e6070d-ed99-4c03-8273-ed255c8c4868":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Taxas e Condi√ß√µes ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"taxas de vendas\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}\n","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#FF4A1E","label":"Redirecionar","id":"blip-tag-4d87a2ac-c32b-355e-50e4-3a7f4256b2c6","canChangeBackground":false},{"id":"blip-tag-67e78775-58e9-45dc-8a9a-96dd46634278","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8a9850d2-4f5d-4a2a-bb4a-6f21aee11dee","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"20e6070d-ed99-4c03-8273-ed255c8c4868","root":false,"$title":"Redirect to Taxas de Vendas","$position":{"top":"4201px","left":"1055px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a862dc90-c7cf-421d-bdab-9d09ebe9f70c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"68cc914a-24f1-4052-be01-5cb85012d40a","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c391e959-860e-4eaf-86b9-71fcd8888c86","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"a862dc90-c7cf-421d-bdab-9d09ebe9f70c","root":false,"$title":"[GO TO] MS.2.0.0 Simula√ß√£o de vendas","$position":{"top":"4201px","left":"1332px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"85c901f2-e8b4-49ca-97d4-e1becccc4cb1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cede0f5a-5453-45c2-a4fd-e95e478bdd14","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c7eb5b06-ca45-4d7e-be53-b9e17da7fd6d","type":"Redirect","$title":"Redirect to {service} sending {state@lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-edc20d3c-3ee6-4b64-9258-274fb2ef4662","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","root":false,"$title":"Redirect to cascata","$position":{"top":"234px","left":"1722px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"168598f7-bb5b-4eb0-a37e-45f8c48ccdde":{"$contentActions":[{"action":{"$id":"148fa11d-98f9-423d-8409-0535104f394c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ff1480fb-cbe4-41a8-984c-a9407ee6fb1f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ff1480fb-cbe4-41a8-984c-a9407ee6fb1f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b60345ef-4f29-4fe4-a43d-f34b4f96deb2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f49f1007-952c-4329-9033-a55a9b4bc050","type":"text/plain","content":"Voc√™ pode consultar o status de sua solicita√ß√£o a partir do n√∫mero de seu protocolo com 14 d√≠gitos.","metadata":{}},"$cardContent":{"document":{"id":"f49f1007-952c-4329-9033-a55a9b4bc050","type":"text/plain","content":"Voc√™ pode consultar o status de sua solicita√ß√£o a partir do n√∫mero de seu protocolo com 14 d√≠gitos."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"03aad8d9-5b10-4bfb-b6e6-a15e05b51ce0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9b3c8634-e171-4440-80a6-fc89e34cf5ae","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9b3c8634-e171-4440-80a6-fc89e34cf5ae","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a1ad81ac-b0f3-47d5-810a-5d266d27196a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4b0cde3d-c788-42f7-8623-f3df6958a7d9","type":"text/plain","content":"Por favor, digite o seu n√∫mero de protocolo.üëá\n\nComo neste exemplo:\nüëâ 12345678910112","metadata":{}},"$cardContent":{"document":{"id":"4b0cde3d-c788-42f7-8623-f3df6958a7d9","type":"text/plain","content":"Por favor, digite o seu n√∫mero de protocolo.üëá\n\nComo neste exemplo:\nüëâ 12345678910112"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"eceade33-1f3d-4151-b69a-a681756f42a2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a9e33a63-d840-48ee-9cf9-91fd1cbd8ca5","typeOfStateId":"state","$connId":"con_183","$id":"a9dcb232-2792-47af-ac0a-494f6e5b658e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"93dcf09c-18c5-4f87-8f2d-1cb0f2041d7c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibi√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} exibi√ß√£o","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[{"$id":"80b71332-24de-4f67-84bb-08952331f174","$typeOfContent":"","type":"SetVariable","$title":"pesquisa","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"52bb9e4f-0d15-4790-a6b5-b4a8a2392541","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-a240c98e-3679-436b-bc55-5e67ce8a8963","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-30d9c0a3-acde-4200-8f6e-85eafba7f7ff","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"168598f7-bb5b-4eb0-a37e-45f8c48ccdde","root":false,"$title":"[MS.3.0.0][MSG] Consulta Status Protocolo","$position":{"top":"754px","left":"2205px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"820d335f-0c95-466f-9009-35cac24c6ea4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#FF4A1E","label":"Redirecionar","id":"blip-tag-4d87a2ac-c32b-355e-50e4-3a7f4256b2c6","canChangeBackground":false},{"id":"blip-tag-c0cdf481-43eb-4afb-bca3-f375bd3692d4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b1cd77c4-88fa-4e18-b303-59624b873e71","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"820d335f-0c95-466f-9009-35cac24c6ea4","root":false,"$title":"Redirect to Finalizacao (Welcome)","$position":{"top":"2213px","left":"2204px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"94e5d020-fd04-423f-bedb-122e58229783":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"d1b46fdb-e03a-4cdc-9f02-8b9fa489f6f4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b177480-5e59-40cc-b031-00f470617292","typeOfStateId":"state","$connId":"con_188","$id":"d99aa798-0d98-498b-8b87-c9aeda7f3cc0","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","typeOfStateId":"state","$connId":"con_193","$id":"95f6a5b4-a27f-4ca3-b23a-b48dda40edf4","conditions":[{"source":"context","comparison":"equals","values":["N√£o"],"variable":"userInput"}],"$invalid":false},{"stateId":"b1e8e3a2-b0ed-4a14-9403-72726ce8443a","typeOfStateId":"state","$connId":"con_198","$id":"96ec9fad-836e-4b62-918e-2cb8ebc9ff81","conditions":[{"source":"context","comparison":"equals","values":["Falar com atendente"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"dc10548f-8281-4b95-b230-d4aa34bc26e1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const validInputMessage = 'Protocolo Valido'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"sair\": \"Sair\",\n      \"n[√£a]o\": \"N√£o\",\n      \"sim|sin\": \"Sim\",\n      \"falar com atendente|falar com especialista|falar com humano\": \"Falar com atendente\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return validInputMessage\n  } catch (err) {\n    return validInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"64de63e3-4451-45d5-9d46-2d14632952e3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"886543f6-7c63-47cb-ac28-e1e243cf9cbc","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"d06575c1-70eb-4d3a-abc7-377d299225ca","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"24a6a86f-d944-493b-b01b-7d786f68c6c2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"Consulta de Protocolo\"","$invalid":false,"settings":{"extras":{},"category":"Consulta de Protocolo","action":"{{input.content}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-7d0443ce-9296-400b-9c14-0443b35d6a88","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4d6243c5-10c5-4625-8bdb-0f364cfd209e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-b99c9442-b671-4c82-9a6a-4b70fafc3af9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7b26fac4-c7ba-49f7-93ee-06a406442ed7","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"94e5d020-fd04-423f-bedb-122e58229783","root":false,"$title":"[MS.3.2.0] [INPUT] Consultar Outro Protocolo","$position":{"top":"1966px","left":"2204px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"b1e8e3a2-b0ed-4a14-9403-72726ce8443a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Inten√ß√µes ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"humano\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}\n","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#FF4A1E","label":"Redirecionar","id":"blip-tag-4d87a2ac-c32b-355e-50e4-3a7f4256b2c6","canChangeBackground":false},{"id":"blip-tag-7a225a78-58c8-405f-9aac-ee8dd70d3746","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3389da66-e4ac-4b2f-bce3-a404fb527779","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"b1e8e3a2-b0ed-4a14-9403-72726ce8443a","root":false,"$title":"Redirect to Inte√ß√µes (humano)","$position":{"top":"2172.67px","left":"1855px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"efdb7842-b731-48e4-a65b-73ccff4c6bf4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e38fd42f-e93d-4a4e-aaca-a4bd80a4eec8","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"168598f7-bb5b-4eb0-a37e-45f8c48ccdde","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"efdb7842-b731-48e4-a65b-73ccff4c6bf4","root":false,"$title":"[GO TO] MS.3.0.0 Tentar Novamente","$position":{"top":"1664.57px","left":"2548.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3b177480-5e59-40cc-b031-00f470617292":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e38fd42f-e93d-4a4e-aaca-a4bd80a4eec8","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"168598f7-bb5b-4eb0-a37e-45f8c48ccdde","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"3b177480-5e59-40cc-b031-00f470617292","root":false,"$title":"[GO TO] MS.3.0.0 Tentar Novamente","$position":{"top":"2204px","left":"2548px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2fb16e6f-8eda-4028-9569-fa101eca4467":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirect to {service} sending {state@lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#FF4A1E","label":"Redirecionar","id":"blip-tag-4d87a2ac-c32b-355e-50e4-3a7f4256b2c6","canChangeBackground":false},{"id":"blip-tag-323907ce-34d1-434c-9edd-9d963794f628","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b7b10c69-43e0-4d8c-8c13-71b90090541f","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"2fb16e6f-8eda-4028-9569-fa101eca4467","root":false,"$title":"Redirect to Finalizacao (Welcome)","$position":{"top":"978px","left":"3107.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7bde67fe-f1eb-4eed-a5d6-2d86d0bb146b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Inten√ß√µes ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"humano\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirect to {service} sending {state@lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#FF4A1E","label":"Redirecionar","id":"blip-tag-4d87a2ac-c32b-355e-50e4-3a7f4256b2c6","canChangeBackground":false},{"id":"blip-tag-e1704890-5ca0-4c83-a66d-0bb3fa641c35","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0950507d-1e7a-41c2-bb91-f5baf06d8dcb","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"7bde67fe-f1eb-4eed-a5d6-2d86d0bb146b","root":false,"$title":"Redirect to Inte√ß√µes (humano)","$position":{"top":"1579px","left":"3539px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7a851126-77e7-49c3-9193-b1c9fa5015f0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e403c7f2-e136-4b3f-a76a-6f2b75a66c43","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"2fb16e6f-8eda-4028-9569-fa101eca4467","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"7a851126-77e7-49c3-9193-b1c9fa5015f0","root":false,"$title":"[GO TO] Redirect to Finalizacao","$position":{"top":"1353px","left":"3971px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b7fb3904-9cc0-4f2c-9992-7a16c1b4df94":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"eceade33-1f3d-4151-b69a-a681756f42a2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"52bb9e4f-0d15-4790-a6b5-b4a8a2392541","typeOfStateId":"state","$connId":"con_203","$id":"0a040f0f-5f66-49c1-b362-6358629b6012","conditions":[{"source":"context","comparison":"equals","values":["200"],"variable":"statusConsultaProtocolo"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"4d018e54-23aa-487a-ab31-2ff4311ef2fe","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP POST \"bodyTokenProtocolo\" (Criacao Token)","$invalid":false,"settings":{"headers":{"Content-Type":"application/x-www-form-urlencoded","accept":"*/*","Connection":"keep-alive","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}"},"uri":"{{config.urlToken}}/api/oauth/token","method":"POST","body":"{{encodingUrl}}","responseStatusVariable":"statusTokenProtocolo","responseBodyVariable":"bodyTokenProtocolo"},"conditions":[]},{"$id":"796cad73-555d-454a-a112-e875d6811f44","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"tokenProtocoloBpm\" (Extrair Token)","$invalid":false,"settings":{"function":"run","source":"function run(token) {\n    try {\n        const { access_token } = JSON.parse(token);\n        return access_token;\n    }\n    catch (e) {\n        return false;\n    }\n}","inputVariables":["bodyTokenProtocolo"],"outputVariable":"tokenProtocoloBpm","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6771b7ba-b097-48a7-91b2-6932bf16b76c","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyConsultaProtocolo\" (Consultar Protocolo)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}"},"uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{numeroProtocolo}}","method":"GET","responseStatusVariable":"statusConsultaProtocolo","responseBodyVariable":"bodyConsultaProtocolo"},"conditions":[]},{"$id":"f230bb72-fbb7-4bf5-90e7-ce2f41746bd3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusConsultaProtocolo"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"987365aa-f2e7-40b7-b742-731e2de1f33c","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{},"category":"SPD Maquina Safrapay {{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{numeroProtocolo}} | GET| {{statusConsultaProtocolo}} | {{bodyConsultaProtocolo}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"883c546a-b6a2-4f9f-add4-89f4fa77ecb6","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"statusConsultaProtocolo"}]},{"$id":"508da016-b2a1-4870-bb30-778167cc7b22","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"consultaProtocolo\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaProtocolo) {\n    try {\n        const protocolo = JSON.parse(bodyConsultaProtocolo);\n\n        const objProtocolo = [];\n\n        protocolo.data.forEach((itens) => {\n            objProtocolo.push({\n                id: itens.id,\n                status: itens.status,\n                statusProcessamentoDescricao: itens.statusProcessamentoDescricao,\n                dataHoraInclusao: itens.dataHoraInclusao,\n                dataHoraEncerramento: itens.dataHoraEncerramento,\n                maiorSLAOcorrencia: itens.maiorSLAOcorrencia,\n                idCentralOrigem: itens.idCentralOrigem\n            })\n        })\n        return JSON.stringify(objProtocolo)\n    }\n    catch (e) {\n        return false;\n    }\n}","inputVariables":["bodyConsultaProtocolo"],"outputVariable":"consultaProtocolo","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a9481232-c0b8-4346-a5e8-61c246764120","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"statusDoProtocolo\"","$invalid":false,"settings":{"function":"run","source":"function run(consultaProtocolo) {\n    try {\n        const statusProtocolo = JSON.parse(consultaProtocolo)\n        if (statusProtocolo.length === 0) {\n            return \"false\"\n        } else {\n            return statusProtocolo[0].statusProcessamentoDescricao\n        }\n    }\n    catch (e) {\n        return false;\n    }\n}","inputVariables":["consultaProtocolo"],"outputVariable":"statusDoProtocolo","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-98553cb3-8b0d-4b7d-a323-bfb99b233ecf","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-4ac4ce39-ac02-41b1-957c-b332c8ad9c0c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5a871cf2-681a-4955-a3c4-0a73832dcf93","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-30f65293-f19f-41da-b239-ddfdf57585eb","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"b7fb3904-9cc0-4f2c-9992-7a16c1b4df94","root":false,"$title":"[MS.3.0.1] [HTTP] Api Consulta Status Protocolo","$position":{"top":"1237.57px","left":"2205px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false}},"configuration":{"builder:minimumIntentScore":"0.65","builder:stateTrack":"true","builder:#localTimeZone":"E. South America Standard Time","builder:useTunnelOwnerContext":"true","clientId":"BLIP","grantType":"client_credentials","urlToken":"https://sts-api.safra.com.br","urlCHT":"https://api.safra.com.br","clientSecret":"5312b6d5-acb8-4165-9458-ef445876473e","builder:stateExpiration":"0.00:15:00","TraceTargetType":"Http","TraceMode":"All","TraceTarget":"https://take-api-beholder.cs.blip.ai/api/traces/prodspdmaquinasafrapay","serviceName":"Bot M√°quina Safrapay","TraceCacheMode":0},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}