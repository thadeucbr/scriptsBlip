{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"d2712b4e-c844-4435-ba60-8364a32b3206","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{blockDestinationId}}","typeOfStateId":"variable","$id":"758d6d73-bfd9-4b90-8d14-29ccf8a8975a","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"blockDestinationId"}],"$invalid":false},{"stateId":"52a3d165-993d-416e-9066-566532ce4939","typeOfStateId":"state","$connId":"con_3","$id":"e6461817-3002-4995-abdf-568220f01ce1","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"78bdc058-ee64-454a-a1bc-caeb50bba482","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"blockDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(state, serviceName) {\n\ttry {\n\t\tconst { botDestination, stateDestination } = JSON.parse(state)\n\n\t\tif (stateDestination.match(/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/) && botDestination === serviceName) {\n\t\t\treturn stateDestination\n\t\t}\n\t\treturn false\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["state","config.serviceName"],"outputVariable":"blockDestinationId","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-010a4eaa-339a-4d46-8bd8-e9383b32cefc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4fbad542-54e1-49c4-8359-8aa69aa0c84d","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"In√≠cio","$position":{"top":"475.871px","left":"1627.68px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b687933a-994c-4382-8051-601710a0e8ea","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"928e1999-3310-4c4f-a25a-c051922b9862","typeOfStateId":"state","$connId":"con_8","$id":"d40c89b5-2225-49b2-b2f8-02689607aa97","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0f178887-bb6c-4a8a-88bb-3d322a12c893","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\" if input.content not exist","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n\tif (!inputUsuario) {\n\t\treturn 'inatividade'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"input.content"}]},{"$id":"9b9bb723-73cc-447f-91c0-1b0a8ed8cebe","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\t\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `cascata ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"928e1999-3310-4c4f-a25a-c051922b9862","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-abdb66c1-0ee4-4073-9499-ad7f96d5dd46","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exce√ß√µes","$position":{"top":"130px","left":"879px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"928e1999-3310-4c4f-a25a-c051922b9862":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5c1c7b30-f3c5-44d7-99a1-c0e259cae078","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c8764fbc-31a8-4587-a403-f626f06e3151","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"id":"blip-tag-f97f606e-62e8-4ae6-8242-3d395d1641b9","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"928e1999-3310-4c4f-a25a-c051922b9862","root":false,"$title":"[Redirect] To cascata","$position":{"top":"117px","left":"1115px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"52a3d165-993d-416e-9066-566532ce4939":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f3ddcbe5-6ae3-4fb6-9412-af4821ea1254","typeOfStateId":"state","$connId":"con_13","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Contrata√ß√£o\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Indeniza√ß√£o\",\n\t\t\t\t\"description\": \"Negativa de cobertura\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Pagamento em atraso\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Renova√ß√£o\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"5\",\n\t\t\t\t\"title\": \"Assist√™ncia funeral\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"6\",\n\t\t\t\t\"title\": \"Sinistro\",\n\t\t\t\t\"description\": \"Aviso ou consulta de sinistro\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"7\",\n\t\t\t\t\"title\": \"Cancelamento\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"id\": \"8\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"9\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"10\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// }\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, por aqui posso te ajudar com os seguintes assuntos.üëá` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Assuntos\", // <---- Titulo do bot√£o\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0ad0d065-98ac-4e71-a5f6-720d020b6ccb","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9bba1dae-3382-4c75-a1ab-f6751ab64140","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-12526b54-00d0-445c-988d-72aa41a3733f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"52a3d165-993d-416e-9066-566532ce4939","root":false,"$title":"[S.1.0.0][MSG] Menu Seguros","$position":{"top":"761.742px","left":"1627.58px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f3ddcbe5-6ae3-4fb6-9412-af4821ea1254":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"fbabf4b1-20f2-49a5-8880-f28aba086783","typeOfStateId":"state","$connId":"con_18","$id":"335e1176-6c13-4f3e-b496-d090d3d985b6","conditions":[{"source":"context","comparison":"equals","values":["Contrata√ß√£o"],"variable":"userInput"}],"$invalid":false},{"stateId":"03b1b07e-4e8a-4aa7-adfd-74ed5348ef6c","typeOfStateId":"state","$connId":"con_23","$id":"e8deffa5-756f-4901-81d9-75065064d9e3","conditions":[{"source":"context","comparison":"equals","values":["Indeniza√ß√£o"],"variable":"userInput"}],"$invalid":false},{"stateId":"f0e55e03-091d-42c4-8933-7e7faeed402e","typeOfStateId":"state","$connId":"con_28","$id":"185ba17e-8c1a-4820-86df-d86d2d41108e","conditions":[{"source":"context","comparison":"equals","values":["Pagamento em atraso"],"variable":"userInput"}],"$invalid":false},{"stateId":"5ab55f1a-8e76-4929-9733-1c1fb494d267","typeOfStateId":"state","$connId":"con_33","$id":"e0f0411d-d27c-43d1-977d-a32ce0f9b6ea","conditions":[{"source":"context","comparison":"equals","values":["Renova√ß√£o"],"variable":"userInput"}],"$invalid":false},{"stateId":"53889255-f226-48b8-8571-78623c739143","typeOfStateId":"state","$connId":"con_38","$id":"de2500a7-a1e2-4f41-a7ec-9af2f0cf9010","conditions":[{"source":"context","comparison":"equals","values":["Assist√™ncia funeral"],"variable":"userInput"}],"$invalid":false},{"stateId":"43ef0e44-bbe6-4986-9af4-ae84470a2536","typeOfStateId":"state","$connId":"con_43","$id":"c3652a34-bca9-4f01-a641-c7d3717ac542","conditions":[{"source":"context","comparison":"equals","values":["Sinistro"],"variable":"userInput"}],"$invalid":false},{"stateId":"d1b22fcc-aa02-45f7-8a1c-039de84ba40e","typeOfStateId":"state","$connId":"con_48","$id":"6e6cf97d-fe38-49db-8a65-f40647c09018","conditions":[{"source":"context","comparison":"equals","values":["Cancelamento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n\nfunction run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[e√™]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[e√©]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[e√©][cs]im[ou]|d[√©e][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-753d5e03-02da-4032-9e1d-ff311e323494","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-435aae5a-3139-46a5-aa1b-79ed7f26fc0e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-430f3969-2c95-461e-97c6-f9c3e39a6c88","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c9780c1a-4fc4-4c36-92e0-09b86802f526","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f3ddcbe5-6ae3-4fb6-9412-af4821ea1254","root":false,"$title":"[S.1.0.0][INPUT] Menu Seguros","$position":{"top":"1033.16px","left":"1627.58px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fbabf4b1-20f2-49a5-8880-f28aba086783":{"$contentActions":[{"action":{"$id":"3ae447e6-77e7-42a0-b1ce-0496d1201a75","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ccdbeab3-0e08-4fe7-b06b-4be26fd941e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ccdbeab3-0e08-4fe7-b06b-4be26fd941e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2e17403d-4308-4df6-9aa1-95af01174f9a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"93ca539a-9c80-49e0-950c-7fc746a97b49","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, voc√™ pode contratar um seguro diretamente na sua <b>ag√™ncia/Gerente</b> ou pelos <b>canais digitais</b> do banco Safra! \n\nCaso j√° tenha um seguro contratado <b>diretamente pela ag√™ncia/Gerente</b> e deseje apenas realizar uma consulta, pedimos que solicite o atendimento diretamente na sua ag√™ncia. üòä\n\nSe voc√™ deseja realizar a contrata√ß√£o atrav√©s de um dos nossos canais digitais, siga as orienta√ß√µes abaixo.üëá\n\nNo <b>Internet Banking</b>, a contrata√ß√£o pode ser feita acessando o menu <b>Seguros</b> atrav√©s do link:\nüëâ <i>Internet Banking Safra</i>: https://www.safra.com.br/pessoa-fisica\n\nNo <b>Aplicativo Safra Empresas</b>: Siga este passo a passo para contratar um seguro.üëá\n1. Selecione a op√ß√£o <b>Ver Mais</b>.\n2. Escolha <b>Seguros</b>.\n3. Por fim, selecione a op√ß√£o <b>Conhe√ßa nossos seguros</b>.","metadata":{"Internet Banking Safra.":"https://www.safra.com.br/pessoa-fisica.htm"}},"$cardContent":{"document":{"id":"93ca539a-9c80-49e0-950c-7fc746a97b49","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, voc√™ pode contratar um seguro diretamente na sua <b>ag√™ncia/Gerente</b> ou pelos <b>canais digitais</b> do banco Safra! \n\nCaso j√° tenha um seguro contratado <b>diretamente pela ag√™ncia/Gerente</b> e deseje apenas realizar uma consulta, pedimos que solicite o atendimento diretamente na sua ag√™ncia. üòä\n\nSe voc√™ deseja realizar a contrata√ß√£o atrav√©s de um dos nossos canais digitais, siga as orienta√ß√µes abaixo.üëá\n\nNo <b>Internet Banking</b>, a contrata√ß√£o pode ser feita acessando o menu <b>Seguros</b> atrav√©s do link:\nüëâ <i>Internet Banking Safra</i>: https://www.safra.com.br/pessoa-fisica\n\nNo <b>Aplicativo Safra Empresas</b>: Siga este passo a passo para contratar um seguro.üëá\n1. Selecione a op√ß√£o <b>Ver Mais</b>.\n2. Escolha <b>Seguros</b>.\n3. Por fim, selecione a op√ß√£o <b>Conhe√ßa nossos seguros</b>."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc563aa0-0c86-4516-b8ca-977f441ae6e1","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"368ed6d2-36d7-4631-a0b5-982523a88008","typeOfStateId":"state","$connId":"con_53","$id":"a367b283-8ece-4908-a86d-26f702a249d4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"02eaab49-a72e-45a3-ae99-a8e51825f845","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-669321b4-7483-496b-bbc1-0f329c47d845","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7976c33f-097f-46c7-ba75-f326de3403aa","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fbabf4b1-20f2-49a5-8880-f28aba086783","root":false,"$title":"[S.2.0.0][MSG] Contrata√ß√£o","$position":{"top":"1158.71px","left":"264.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"03b1b07e-4e8a-4aa7-adfd-74ed5348ef6c":{"$contentActions":[{"action":{"$id":"c0029e38-5518-4316-b95a-36e4a5f6ea1e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"66b39a13-e7d5-40f7-be07-c2445938de50","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"66b39a13-e7d5-40f7-be07-c2445938de50","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"867277a9-25ad-42c7-b27e-3e1b0793c800","$typeOfContent":"text","type":"SendMessage","settings":{"id":"04e4aab4-a7d1-451d-b21e-98eea53b8419","type":"text/plain","content":"Caso a indeniza√ß√£o seja negada, ser√° enviada uma formaliza√ß√£o por e-mail solicitando complementos ou a an√°lise de elegibilidade da cobertura.","metadata":{}},"$cardContent":{"document":{"id":"04e4aab4-a7d1-451d-b21e-98eea53b8419","type":"text/plain","content":"Caso a indeniza√ß√£o seja negada, ser√° enviada uma formaliza√ß√£o por e-mail solicitando complementos ou a an√°lise de elegibilidade da cobertura."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"698071fa-9076-4947-87b6-9e808f6c92d2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"765dc32a-fd68-4489-b77d-96e48c7499fb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-edd39271-3757-4b52-9e20-259bd980bb7f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-144a3d86-995f-48fe-9024-2dd95ff78915","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"03b1b07e-4e8a-4aa7-adfd-74ed5348ef6c","root":false,"$title":"[S.3.0.0][MSG] Indeniza√ß√£o","$position":{"top":"1353.57px","left":"1469.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f0e55e03-091d-42c4-8933-7e7faeed402e":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4e4d8166-c9f1-4d0b-a3c5-71c14a875a08","typeOfStateId":"state","$connId":"con_58","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Contratar\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Encerrar\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"type\": \"reply\",\n\t\t\t// \t\"reply\": {\n\t\t\t// \t\t\"id\": \"3\",\n\t\t\t// \t\t\"title\": \"\"\n\t\t\t// \t}\n\t\t\t// }\n\t\t];\n\t\tconst bodyText = `Para realizar um pagamento em atraso, basta deixar dispon√≠vel em conta o valor para pagamento.\n\nA cobran√ßa da mensalidade em atraso √© realizada diariamente, durante 90 dias, e neste per√≠odo comunicaremos a falta de pagamento mensalmente via correio.\n\nAp√≥s os 90 dias, o seguro √© cancelado. Ap√≥s o cancelamento, n√£o reativamos o seguro. Caso haja interesse, poder√° realizar uma nova contrata√ß√£o.üëá`; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-767fb0a6-2834-420e-ad33-6edfca0f82cd","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5b501a57-2ca4-4a7d-9f08-dd14e584658a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-663e7dac-fcfd-4fea-af5a-7dbf25a9da4c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f0e55e03-091d-42c4-8933-7e7faeed402e","root":false,"$title":"[S.3.0.0][MSG] Pagamento em atraso","$position":{"top":"1539.9px","left":"1212px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4e4d8166-c9f1-4d0b-a3c5-71c14a875a08":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f2d46b36-64ac-4b3d-898f-6470e3854551","typeOfStateId":"state","$connId":"con_63","$id":"ee701427-35c6-4957-ab27-6272b4ac529d","conditions":[{"source":"context","comparison":"equals","values":["Contratar"],"variable":"userInput"}],"$invalid":false},{"stateId":"9be1a043-8dcf-4aa5-a173-a3060636b4a4","typeOfStateId":"state","$connId":"con_68","$id":"c22e4c77-97b8-403d-a511-0f5ab6aca898","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n  \n  function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[e√™]s\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n  }","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5bdcca50-1f7b-443f-ac19-6b73de7ea897","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7b7ee531-0866-4b43-a503-2e831a264b92","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0bf8461d-c26f-4fa4-af3f-1b4e78334e19","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c4ab1714-2c7e-4439-9d77-0bcab2fe9cfa","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4e4d8166-c9f1-4d0b-a3c5-71c14a875a08","root":false,"$title":"[S.3.0.0][INPUT] Pagamento em atraso","$position":{"top":"1780px","left":"1212px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f2d46b36-64ac-4b3d-898f-6470e3854551":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3fcedf79-f98b-471d-8107-7c362e55a9aa","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fbabf4b1-20f2-49a5-8880-f28aba086783","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f2d46b36-64ac-4b3d-898f-6470e3854551","root":false,"$title":"[GO TO][S.2.0.0][MSG] Contrata√ß√£o","$position":{"top":"1949.57px","left":"973.714px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9be1a043-8dcf-4aa5-a173-a3060636b4a4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"485196ac-e923-4b29-bd37-5d653bda0265","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9be1a043-8dcf-4aa5-a173-a3060636b4a4","root":false,"$title":"[GO TO] Finaliza√ß√£o","$position":{"top":"1972px","left":"1460.86px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c8cceaf4-a986-4981-8641-44f25cf20cd2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a5083c5e-99bd-49de-8f9f-0e31802c294d","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c66dd273-2a36-45b3-a2ae-fc28bf533bf8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1b2de881-be07-4ea6-93d7-d191cca8e3f4","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-07a32a8a-4e25-491f-8c13-b181941c2eed","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"c8cceaf4-a986-4981-8641-44f25cf20cd2","root":false,"$title":"[Redirect] to Finalizacao (Welcome)","$position":{"top":"104.871px","left":"605.839px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5ab55f1a-8e76-4929-9733-1c1fb494d267":{"$contentActions":[{"action":{"$id":"01396c3b-5054-4863-afd8-1df44a2eabb5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3b26b9ec-5c02-449f-bd1a-b55123248be7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3b26b9ec-5c02-449f-bd1a-b55123248be7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"375e11c9-427c-44bb-b08d-d61319aa14a3","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2d3fff49-20a0-43b2-a076-fd617475d2f0","type":"text/plain","content":"Para os produtos eleg√≠veis, ap√≥s o per√≠odo de vig√™ncia inicial, a renova√ß√£o ser√° autom√°tica pelo mesmo per√≠odo de contrata√ß√£o, a menos que haja manifesta√ß√£o contr√°ria ou que seja cancelado pelo canal de contrata√ß√£o.","metadata":{}},"$cardContent":{"document":{"id":"2d3fff49-20a0-43b2-a076-fd617475d2f0","type":"text/plain","content":"Para os produtos eleg√≠veis, ap√≥s o per√≠odo de vig√™ncia inicial, a renova√ß√£o ser√° autom√°tica pelo mesmo per√≠odo de contrata√ß√£o, a menos que haja manifesta√ß√£o contr√°ria ou que seja cancelado pelo canal de contrata√ß√£o."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"3798cffd-a69d-4124-9abb-8ac7a74295e2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"368ed6d2-36d7-4631-a0b5-982523a88008","typeOfStateId":"state","$connId":"con_73","$id":"c7fb2d6f-12e4-40fe-9490-0137f8a61a5f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5156f045-53a4-41d8-911a-44f7d7413455","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ff138241-0c16-4f3d-b64c-737ddad90f79","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-37ddd55d-39d9-4c67-bd50-b809a29bf74d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5ab55f1a-8e76-4929-9733-1c1fb494d267","root":false,"$title":"[S.4.0.0][MSG] Renova√ß√£o","$position":{"top":"1255.29px","left":"454.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"53889255-f226-48b8-8571-78623c739143":{"$contentActions":[{"action":{"$id":"9a4e2e51-70ae-4821-b5d9-a3648851a7bf","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"72e59a80-0e14-4540-89f4-8d0bcf1900a4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"72e59a80-0e14-4540-89f4-8d0bcf1900a4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"19ab2c22-e6ec-4199-b9a5-829cbb85a9d8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a1bf25b8-a0db-4bf8-903b-e335e329cbe7","type":"text/plain","content":"Para assuntos sobre sepultamento ou crema√ß√£o √© necess√°rio entrar em contato pelos telefones.üëá \n\nNo Brasil (liga√ß√£o gratuita): 0800 702 0242 \nNo exterior (solicite liga√ß√£o a cobrar): 55 11 4689-5781","metadata":{}},"$cardContent":{"document":{"id":"a1bf25b8-a0db-4bf8-903b-e335e329cbe7","type":"text/plain","content":"Para assuntos sobre sepultamento ou crema√ß√£o √© necess√°rio entrar em contato pelos telefones.üëá \n\nNo Brasil (liga√ß√£o gratuita): 0800 702 0242 \nNo exterior (solicite liga√ß√£o a cobrar): 55 11 4689-5781"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ca1f78f7-743d-4f33-9e7c-7fb16e6314bd","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"75790ddc-c47d-4e79-ab0b-dd040f269ea6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-79b0cf57-d704-4197-bbd1-7eb39a3160ac","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-38529093-116b-4c6d-9042-06057486fe0e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"53889255-f226-48b8-8571-78623c739143","root":false,"$title":"[S.5.0.0][MSG] Assist√™ncia Funeral","$position":{"top":"1338px","left":"1770.65px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"43ef0e44-bbe6-4986-9af4-ae84470a2536":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"5c90e205-dc61-4c97-8272-dc2f0bf161bb","typeOfStateId":"state","$connId":"con_78","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Ag√™ncia/Gerente\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Canais Digitais\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"type\": \"reply\",\n\t\t\t// \t\"reply\": {\n\t\t\t// \t\t\"id\": \"3\",\n\t\t\t// \t\t\"title\": \"\"\n\t\t\t// \t}\n\t\t\t// }\n\t\t];\n\t\tconst bodyText = \"Certo, por onde voc√™ realizou a contrata√ß√£o do seu seguro?üëá\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-75d761e4-e73f-4198-955c-1c745d325508","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-250232e3-945c-4cab-81de-8dd3957081c5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1b90532e-2d0f-4b34-b153-ac6c0f120c2e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"43ef0e44-bbe6-4986-9af4-ae84470a2536","root":false,"$title":"[S.6.0.0][MSG] Sinistro","$position":{"top":"1436.77px","left":"2323.26px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5c90e205-dc61-4c97-8272-dc2f0bf161bb":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"50b59980-196c-44f8-85d2-2d41c28972e4","typeOfStateId":"state","$connId":"con_83","$id":"25048290-b4b6-448a-9b85-fc4da1577a87","conditions":[{"source":"context","comparison":"equals","values":["Ag√™ncia/Gerente"],"variable":"userInput"}],"$invalid":false},{"stateId":"25de4ad6-a4bf-4fef-8c2f-7d5c552e94ba","typeOfStateId":"state","$connId":"con_88","$id":"438a4eff-987c-4aaa-9e7b-4dcd40cf65fc","conditions":[{"source":"context","comparison":"equals","values":["Canais Digitais"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n  \n  function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[e√™]s\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n  }","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} valida√ß√£o\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} valida√ß√£o","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-077c35e0-c5f7-4172-bcb2-e2d028706922","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f091d179-3e52-4dd9-b25d-9e80d4c7cbbf","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-096ffe75-c91c-4188-9c38-e77ad244ef42","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-07a1a8ed-175c-4789-9f91-c584bafc91e7","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"5c90e205-dc61-4c97-8272-dc2f0bf161bb","root":false,"$title":"[S.6.0.0][INPUT] Sinistro","$position":{"top":"1679px","left":"2323.39px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"50b59980-196c-44f8-85d2-2d41c28972e4":{"$contentActions":[{"action":{"$id":"626d7033-83a9-4abc-9970-bb22dfdf4071","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"48fe95f5-1f05-4293-a4c6-b1a5d844a5d3","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Nesse caso, voc√™ tem a op√ß√£o de fazer o acionamento do sinistro pelo site institucional Safra no link abaixo: \n\nLink üëâ https://www.safra.com.br/servicos/pessoa-juridica/seguros-para-empresa-safra.htm\nAo final da p√°gina clique no link üëâ <b>Para Aviso de Sinistro</b>.\n\nPara d√∫vidas e acompanhamento do sinistro, acesse:\n\nLink üëâ https://forms.office.com/r/68wT3hkKx5","metadata":{}},"$cardContent":{"document":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Nesse caso, voc√™ tem a op√ß√£o de fazer o acionamento do sinistro pelo site institucional Safra no link abaixo: \n\nLink üëâ https://www.safra.com.br/servicos/pessoa-juridica/seguros-para-empresa-safra.htm\nAo final da p√°gina clique no link üëâ <b>Para Aviso de Sinistro</b>.\n\nPara d√∫vidas e acompanhamento do sinistro, acesse:\n\nLink üëâ https://forms.office.com/r/68wT3hkKx5"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"bd82eb2f-dcc4-44f7-a162-a24dcbdcaf9f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"93dd1c2c-1023-42f7-8d4c-dd649e51d0fd","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante</b>: O prazo do sinistro √© de at√© 30 dias √∫teis, e come√ßa a ser contabilizado somente com o envio da documenta√ß√£o completa.","metadata":{}},"$cardContent":{"document":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante</b>: O prazo do sinistro √© de at√© 30 dias √∫teis, e come√ßa a ser contabilizado somente com o envio da documenta√ß√£o completa."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4e8a638d-5c92-47aa-8443-7ce8fd3211fe","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"25eccedf-f9b1-4d47-ba63-a82b1d1a8463","typeOfStateId":"state","$connId":"con_93","$id":"287991b2-bd58-4a94-b468-b0908719b118","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5f7459ff-abe4-49f2-885a-3b74fe70b784","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"50b59980-196c-44f8-85d2-2d41c28972e4","root":false,"$title":"[S.6.1.0][MSG] Ag√™ncia/Gerente","$position":{"top":"1921px","left":"2096.87px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"25de4ad6-a4bf-4fef-8c2f-7d5c552e94ba":{"$contentActions":[{"action":{"$id":"626d7033-83a9-4abc-9970-bb22dfdf4071","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"48fe95f5-1f05-4293-a4c6-b1a5d844a5d3","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Nesse caso, siga as orienta√ß√µes abaixo.üëá\n\nNo <b>Internet Banking.</b>üëá\n\nPara <b>Aviso de sinistro:</b> V√° no <b>Menu Seguros</b>. Em seguida, <b>Seguros Ativos</b>. Por √∫ltimo, selecione o seguro que deseja avisar o sinistro.\n\nPara <b>Consulta de Aviso</b>: V√° no <b>Menu Seguros</b>. Em seguida, <b>Seguros Ativos</b>. Por √∫ltimo, selecione o seguro que deseja consultar.\n\nNo <b>Aplicativo Safra Empresas.</b>üëá\n\nPara <b>Aviso de Sinistro</b>: V√° no <b>Menu Ver mais</b>. Em seguida, <b>Seguros</b>. Depois, <b>Acessar meus seguros</b>. Por √∫ltimo, selecione o seguro que deseja avisar o sinistro.\n\nPara <b>Consulta de Aviso</b>: V√° Menu <b>Ver mais</b>.Em seguida,  <b>Seguros</b>. Depois, <b>Acessar meus seguros</b>. Selecione o seguro que deseja consultar. Por √∫ltimo, <b>Consultar sinistro</b>. Para mais detalhes veja o PDF.","metadata":{}},"$cardContent":{"document":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Nesse caso, siga as orienta√ß√µes abaixo.üëá\n\nNo <b>Internet Banking.</b>üëá\n\nPara <b>Aviso de sinistro:</b> V√° no <b>Menu Seguros</b>. Em seguida, <b>Seguros Ativos</b>. Por √∫ltimo, selecione o seguro que deseja avisar o sinistro.\n\nPara <b>Consulta de Aviso</b>: V√° no <b>Menu Seguros</b>. Em seguida, <b>Seguros Ativos</b>. Por √∫ltimo, selecione o seguro que deseja consultar.\n\nNo <b>Aplicativo Safra Empresas.</b>üëá\n\nPara <b>Aviso de Sinistro</b>: V√° no <b>Menu Ver mais</b>. Em seguida, <b>Seguros</b>. Depois, <b>Acessar meus seguros</b>. Por √∫ltimo, selecione o seguro que deseja avisar o sinistro.\n\nPara <b>Consulta de Aviso</b>: V√° Menu <b>Ver mais</b>.Em seguida,  <b>Seguros</b>. Depois, <b>Acessar meus seguros</b>. Selecione o seguro que deseja consultar. Por √∫ltimo, <b>Consultar sinistro</b>. Para mais detalhes veja o PDF."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"bd82eb2f-dcc4-44f7-a162-a24dcbdcaf9f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"93dd1c2c-1023-42f7-8d4c-dd649e51d0fd","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante</b>: O prazo do sinistro √© de at√© 30 dias √∫teis, e come√ßa a ser contabilizado somente com o envio da documenta√ß√£o completa.","metadata":{}},"$cardContent":{"document":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante</b>: O prazo do sinistro √© de at√© 30 dias √∫teis, e come√ßa a ser contabilizado somente com o envio da documenta√ß√£o completa."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4e8a638d-5c92-47aa-8443-7ce8fd3211fe","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"25eccedf-f9b1-4d47-ba63-a82b1d1a8463","typeOfStateId":"state","$connId":"con_98","$id":"d4ca250e-f64b-4a81-adeb-6863836c352c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cec1b5d0-6571-4a67-b57e-9c140c113666","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"25de4ad6-a4bf-4fef-8c2f-7d5c552e94ba","root":false,"$title":"[S.6.2.0][MSG] Canais Digitais","$position":{"top":"1918px","left":"2567.23px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d1b22fcc-aa02-45f7-8a1c-039de84ba40e":{"$contentActions":[{"action":{"$id":"5a383630-b887-41a5-ac72-4bece3a63d9f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b56359b7-3199-420d-9a8b-f95ff9ff14d9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b56359b7-3199-420d-9a8b-f95ff9ff14d9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6a818edb-b3c8-4f56-a8dd-49e925b06585","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4a1e323c-9512-4deb-8db7-9118a55d2678","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, se voc√™ possui um seguro contratado diretamente pela <b>ag√™ncia/Gerente</b> e deseja efetuar o cancelamento, pedimos que solicite o atendimento diretamente na sua ag√™ncia.\n\nSe voc√™ possui um seguro contratado por um dos nossos <b>canais digitais</b> e deseja cancelar, siga as orienta√ß√µes abaixo.üëá\n\nNo <b>Internet Banking</b>, v√° no <b>Menu Seguros</b>. Em seguida, selecione <b>Seguros Ativos</b>. Depois, escolha o seguro que deseja cancelar. Vale lembrar que ser√° necess√°rio senha e token para confirmar o cancelamento.\n\nNo <b>Aplicativo Safra Empresas</b>, no Menu <b>Ver mais</b> selecione <b>Seguros</b>, depois <b>Acessar meus seguros</b>. Em seguida, escolha o seguro que deseja cancelar e selecione a op√ß√£o <b>Cancelar</b>. Ser√° necess√°rio inserir sua senha para confirmar o cancelamento.","metadata":{}},"$cardContent":{"document":{"id":"4a1e323c-9512-4deb-8db7-9118a55d2678","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, se voc√™ possui um seguro contratado diretamente pela <b>ag√™ncia/Gerente</b> e deseja efetuar o cancelamento, pedimos que solicite o atendimento diretamente na sua ag√™ncia.\n\nSe voc√™ possui um seguro contratado por um dos nossos <b>canais digitais</b> e deseja cancelar, siga as orienta√ß√µes abaixo.üëá\n\nNo <b>Internet Banking</b>, v√° no <b>Menu Seguros</b>. Em seguida, selecione <b>Seguros Ativos</b>. Depois, escolha o seguro que deseja cancelar. Vale lembrar que ser√° necess√°rio senha e token para confirmar o cancelamento.\n\nNo <b>Aplicativo Safra Empresas</b>, no Menu <b>Ver mais</b> selecione <b>Seguros</b>, depois <b>Acessar meus seguros</b>. Em seguida, escolha o seguro que deseja cancelar e selecione a op√ß√£o <b>Cancelar</b>. Ser√° necess√°rio inserir sua senha para confirmar o cancelamento."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fea77331-938f-4e6a-9040-f08d6be03cf3","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"368ed6d2-36d7-4631-a0b5-982523a88008","typeOfStateId":"state","$connId":"con_103","$id":"b092e4d8-a02f-4b50-b228-3e602b75e3b7","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fbb27862-4b0c-4b95-b23f-294492ada129","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f2735844-807d-4fb1-be76-4dedd3cb5e67","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-dc5594fd-fc18-4259-92fe-ebaca0338c09","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d1b22fcc-aa02-45f7-8a1c-039de84ba40e","root":false,"$title":"[S.7.0.0][MSG] Cancelamento","$position":{"top":"1364.71px","left":"693.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"25eccedf-f9b1-4d47-ba63-a82b1d1a8463":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"485196ac-e923-4b29-bd37-5d653bda0265","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"25eccedf-f9b1-4d47-ba63-a82b1d1a8463","root":false,"$title":"[GO TO] Finaliza√ß√£o","$position":{"top":"2197.67px","left":"2342px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"368ed6d2-36d7-4631-a0b5-982523a88008":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d3f33e59-2d1a-4743-8950-eab3409746a4","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"40be20b8-777e-4426-8b10-5784fd180f18","typeOfStateId":"state","$connId":"con_108","$id":"ae3a7fbe-5e71-4316-9247-84e350d010e1","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"9654bbae-376f-439f-a7bd-5ce83c1939d4","typeOfStateId":"state","$connId":"con_113","$id":"3d82801a-bc18-492c-9c28-43985cb1a389","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1745a276-38a7-490b-a01d-9ae2a7722a87","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibi√ß√£o"},"conditions":[]},{"$id":"7bf85e68-666b-477b-8282-b3bbdb0b8a3f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} dados\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} dados","action":"{{contact.identity}} | {{state.previous.name}} | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e0c7e2b5-a5df-4dd6-b6cd-a5dddf08ae66","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"368ed6d2-36d7-4631-a0b5-982523a88008","root":false,"$title":"[SET] Valida Carteiriza√ß√£o","$position":{"top":"1547px","left":"264.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"40be20b8-777e-4426-8b10-5784fd180f18":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"845c49d1-02c2-4b51-b338-04c3bf582335","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b9a7f027-209a-4d73-ab4d-aa0086d480dc","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"40be20b8-777e-4426-8b10-5784fd180f18","root":false,"$title":"[GO TO] Redirect F.4.0.0 Finaliza√ß√£o","$position":{"top":"1839.57px","left":"101px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9654bbae-376f-439f-a7bd-5ce83c1939d4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d558b48c-877c-41c8-a585-da2d3573e6d4","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9654bbae-376f-439f-a7bd-5ce83c1939d4","root":false,"$title":"[GO TO] Redirect Finaliza√ß√£o F.0.0.0","$position":{"top":"1844.71px","left":"397.857px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b9a7f027-209a-4d73-ab4d-aa0086d480dc":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'ed2a5fb2-da6f-4961-b14d-e302fa57b991',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a5083c5e-99bd-49de-8f9f-0e31802c294d","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7eccb6f0-313c-49f4-a296-303b0a666314","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ac8d819e-6a9b-4695-a870-8ce8b9353657","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0607e040-8908-43a9-af65-3d0e811412f6","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"b9a7f027-209a-4d73-ab4d-aa0086d480dc","root":false,"$title":"[Redirect] to Finalizacao (F.4.0.0)","$position":{"top":"109px","left":"414px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"true","builder:#localTimeZone":"E. South America Standard Time","builder:useTunnelOwnerContext":"true","serviceName":"seguros","TraceTargetType":"Http","TraceMode":"All","TraceTarget":"https://take-api-beholder.cs.blip.ai/api/traces/betaspdseguros","TraceCacheMode":0},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"85406c16-888e-4e46-9ddf-78f6b8d0ef3c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"voltarState\"","$invalid":false,"settings":{"function":"run","source":"function ignoreBlock(stateName) {\n    try {\n        const match = stateName.match(/\\[(.*?)\\]/);\n        const stateNameOrigin = match ? match[1] : stateName;\n        const regex = /Redirect|Redirecionar/i;\n        const ignore = !regex.test(stateNameOrigin);\n        return ignore;\n    } catch (err) {\n        return false\n    }\n}\n\n\nfunction run(voltarState, blockId, botOrigin, lastVoltarState, previousStateName) {\n    const state = JSON.parse(voltarState)\n    try {\n        if (!voltarState) {\n            const state = {}\n            state[botOrigin] = [blockId]\n            return state\n        }\n        const isIgnoredBlock = ignoreBlock(previousStateName)\n        if (state[botOrigin][state[botOrigin].length - 1] !== blockId && blockId !== 'onboarding' && !isIgnoredBlock && blockId !== lastVoltarState) {\n            state[botOrigin].push(blockId)\n        }\n        return state\n    } catch (err) {\n        state[botOrigin] = [blockId]\n        return state\n    }\n}","inputVariables":["voltarState","state.previous.id","config.serviceName","lastVoltarState","state.previous.name"],"outputVariable":"voltarState","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}