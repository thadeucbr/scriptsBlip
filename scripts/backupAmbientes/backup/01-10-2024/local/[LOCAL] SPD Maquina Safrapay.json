{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"db0ea0f3-01b3-4870-aa57-cfcfee9133fd","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{blockDestinationId}}","typeOfStateId":"variable","$id":"edae1c07-a6f0-4693-8aaa-942849aa4322","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"blockDestinationId"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"3fb6be51-097f-4435-a48f-8e8b87931773","$typeOfContent":"","type":"TrackEvent","$title":"Track \"inicio\"","$invalid":false,"settings":{"extras":{"identity":"{{contact.identity}}","idSessao":"{{idSessao}}"},"category":"inicio","action":"{{config.serviceName}} | {{state@botOrigin}} | {{state@stateNameOrigin}} | {{input.content}} | {{input.intent.name}}"},"conditions":[]},{"$id":"d3084a98-4e51-451d-a81c-0b8932f7a7fc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"blockDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(state, serviceName) {\n\ttry {\n\t\tconst { botDestination, stateDestination } = JSON.parse(state)\n\n\t\tif (stateDestination.match(/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/) && botDestination === serviceName) {\n\t\t\treturn stateDestination\n\t\t}\n\t\treturn false\n\t} catch (err) {\n\t\treturn err.message\n\t}\n}","inputVariables":["state","config.serviceName"],"outputVariable":"blockDestinationId","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f145a963-6803-4c60-aea0-d9e746f9f7fa","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroGenerico\" if blockDestinationId is false","$invalid":false,"settings":{"variable":"exceptionType","value":"erroGenerico"},"conditions":[{"values":["false"],"source":"context","comparison":"equals","variable":"blockDestinationId"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e0d2ce64-3265-46bd-b396-f53ad65b26e6","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-bbb6c398-e5d8-4384-9d93-b5637f493386","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bd510cb2-f9d1-441d-85bc-02449997e655","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9b4dc40a-5b8c-4120-ac17-f6defe059316","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-074527bd-388c-4e31-9f19-3b6058dfc4ed","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Início","$position":{"top":"258px","left":"425px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"38f6203a-20cd-4cb8-8867-b7bb3e0a1b62","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","typeOfStateId":"state","$connId":"con_3","$id":"aa7a1a1f-5a8a-4f5a-a771-2f8a9f126e13","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f037dd4f-b303-4ace-94f1-8314ee5babbf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\" if input.content not exist","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n\tif (!inputUsuario) {\n\t\treturn 'inatividade'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"input.content"}]},{"$id":"a5cea299-45c6-4fa8-adca-4f657c82e3dd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(previousBlockId, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `cascata ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\t// stateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-21d3876b-910d-403b-88a8-e101fe8d529e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceções","$position":{"top":"259.5px","left":"676px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4b038e89-c130-4869-a541-4954e12ebf81":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, vale lembrar que as vendas feitas na sua maquininha podem demorar até <b>1 dia útil</b> para aparecer no seu extrato.","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, vale lembrar que as vendas feitas na sua maquininha podem demorar até <b>1 dia útil</b> para aparecer no seu extrato."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6d8ca87c-9cc8-42c0-86ce-be3e7935ff24","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e8398e93-5598-4d14-b3f3-b29855e4c9f7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e8398e93-5598-4d14-b3f3-b29855e4c9f7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4299f5bb-66a9-4b91-a2df-b40c83fad7a2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b1d08962-31af-41fb-86de-1edb67219403","type":"text/plain","content":"Você pode informar a data de venda, como neste exemplo: {{dataAtual@data}}?","metadata":{}},"$cardContent":{"document":{"id":"b1d08962-31af-41fb-86de-1edb67219403","type":"text/plain","content":"Você pode informar a data de venda, como neste exemplo: {{dataAtual@data}}?"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3363e5ff-e5bb-4373-a385-f4206fa54eba","typeOfStateId":"state","$connId":"con_8","$id":"ef04e652-526a-411f-9385-a603df4c7b38","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9b9baab9-2909-4eab-bbdb-87cf67b41795","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1e3d856e-f2ed-4f86-954f-1d30842892ec","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e79887c4-1d7b-4d59-803c-e122cb3581ae","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4b038e89-c130-4869-a541-4954e12ebf81","root":false,"$title":"[MS.4.0.0][MSG] Não recebi minha venda","$position":{"top":"476px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"42352582-3913-431e-976e-ad8494ad2445":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, agora informe qual o valor da venda, exemplo: 3.000,00.","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, agora informe qual o valor da venda, exemplo: 3.000,00."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3667b0cd-ad3b-4f05-a5de-144400562fd0","typeOfStateId":"state","$connId":"con_13","$id":"ed4b98d3-d6f8-4e76-9b69-fbeb08e72afd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bd384f45-15f6-4927-b877-d4104dd3211a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-42729f02-6eb5-4678-b7b4-6020c5cfb622","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f42fa3e5-ce09-42b7-b694-f697d5ce6916","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"42352582-3913-431e-976e-ad8494ad2445","root":false,"$title":"[MS.4.1.0][MSG] Solicita valor da venda","$position":{"top":"940px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c391e959-860e-4eaf-86b9-71fcd8888c86":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"63e9145d-3760-4ef3-ba6e-88f41a491e41","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c5482705-133e-4f31-b01e-7930e16e12a3","typeOfStateId":"state","$connId":"con_18","$id":"3e12632c-4292-499f-ad43-d2b0e19815a4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6cf082c9-1a1a-40b3-ba97-43413903f57d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"22d6b742-155e-4644-851e-fe36cfa633c5","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c10ad10d-8e84-49ff-bb7f-1e836f20f3ca","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f23443ad-0e9c-4c0e-908b-e231a3f14a63","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"c391e959-860e-4eaf-86b9-71fcd8888c86","root":false,"$title":"[MS.2.0.0] [SET] Simulador de Vendas Inicio","$position":{"top":"33px","left":"2763.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8f1c55b1-7d84-4727-a19c-145275d573e4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"92e51a16-8e14-4d36-8a8e-16d9b0bf7031","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"890c6c8d-7503-4b06-a642-b00d277b6a13","typeOfStateId":"state","$connId":"con_23","$id":"5d0b076b-de59-45b2-8091-500419ad1681","conditions":[{"source":"context","comparison":"equals","values":["Quero Cobrar","Quero Receber"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"cd9835be-39c1-4ac3-92bc-f90336489c65","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"quero cobrar|cobrar\": \"Quero Cobrar\",\n      \"quero receber|receber\": \"Quero Receber\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4e5ef253-61f7-4835-9e45-f49e36ee8083","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesOrder\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesOrder = input.replace(`Quero Cobrar`, `cobrar`).replace(`Quero Receber`, `receber`)\n\t\treturn salesOrder;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesOrder","LocalTimeZoneEnabled":false},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"00ea8767-f905-43d2-b560-b45aedee1f32","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"473ff1dc-08f4-448d-82a9-ab4f95f65d1b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"1e361b76-2442-4144-b8f2-b73335978d59","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e6fabfa3-dd47-4e29-af2e-a1196f7d987a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1b3993b2-aa56-45e7-aa07-52cd3ffb9052","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-69aba417-1d66-48fb-a200-de43e6bda633","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3e9e2a68-ab93-4a79-9e22-8266f7146e8c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"8f1c55b1-7d84-4727-a19c-145275d573e4","root":false,"$title":"[MS.2.0.1] [INPUT] Simulador de Vendas - Máquina","$position":{"top":"653px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"890c6c8d-7503-4b06-a642-b00d277b6a13":{"$contentActions":[{"action":{"$id":"b00b58af-c4a0-4b88-acc6-bfd375877d98","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87cd5126-0e6d-401b-8e15-fc57f4b1139f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c3541272-a652-4112-9a0f-665d23c0136e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0f1cd996-d08a-4f2b-af89-445eaab54a00","typeOfStateId":"state","$connId":"con_28","$id":"5b0c583a-22c5-4c1f-91a9-584414441e83","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5de6066b-90d0-4776-9a2e-985420e55842","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"efc6afd4-c708-460d-842d-5021f952c686","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Venda física\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Venda digital\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Qual seria o tipo de venda?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f92a2045-a450-4b0b-92f7-a202845908d6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1bd6355e-f088-4b0c-b4c9-0278ddc7ec3d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d2d1c3f1-6588-4230-abcb-78e0ed1d71e6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"890c6c8d-7503-4b06-a642-b00d277b6a13","root":false,"$title":"[MS.2.1.0] [MSG] Tipo de venda","$position":{"top":"869px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0f1cd996-d08a-4f2b-af89-445eaab54a00":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"65afe46f-a05c-40b1-9f67-6b934b7f2eb6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"fe58d380-8c87-45b9-ab44-64d5d37c1f51","typeOfStateId":"state","$connId":"con_33","$contentId":"9127595b-b2c0-41e3-a704-940de3cf87b7","$id":"d100409d-ed80-44b2-b907-3047dbc19aef","conditions":[{"source":"context","comparison":"equals","values":["Venda física","Venda digital"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0c4de828-fe02-460d-9f56-b83a73c70346","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"6f67936b-305e-4906-9828-701ccf1247e8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"6659f598-65b1-4bfb-96d4-e7c12ff9c5f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"Venda f[íi]sica|f[íi]sica\": \"Venda física\",\n      \"Venda digital|digital\": \"Venda digital\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"15920c9a-5270-44b6-9bef-a48d73598848","$typeOfContent":"","type":"ExecuteScript","$title":"Proces \"salesType\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesType = input.replace(`Venda física`, `maquininha`).replace(`Venda digital`, `link`);\n\t\treturn salesType;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesType","LocalTimeZoneEnabled":false},"conditions":[{"values":["Input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"9038f508-01e7-4e0e-8165-1c46808638e9","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":["Venda física","Venda digital"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a4ea967a-bdb7-4fb6-9fdc-3a601df7ccd2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d0ba694c-cf61-4910-8bfc-cbb85b557526","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fd4d0a4f-cf28-439d-bd7e-4b5cd1b6fe51","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e27d311e-ece2-4cca-a40a-19c20e00582b","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"0f1cd996-d08a-4f2b-af89-445eaab54a00","root":false,"$title":"[MS.2.1.0] [INPUT] Tipo de venda","$position":{"top":"1042px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"90f43d6e-b4cd-42d8-a2a1-938c40d6e764":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a658b32f-2835-4b36-aa9d-ad3e817ae7ac","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"2379f037-b47b-4c61-b9b7-9ae97eb09f06","typeOfStateId":"state","$connId":"con_38","$id":"95b138d2-a2a1-4485-9e93-37af8373de42","conditions":[{"source":"context","comparison":"equals","values":["É um valor válido"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"9d2ab2f5-ccbc-479d-8842-e89a87616c1f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n        if (!inputUsuario) {\n            return 'inatividade'\n        }\n\n        let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi\n        let validInput = regex.test(inputUsuario)\n\n        if (validInput) {\n            let valor = inputUsuario.replace(/\\./g, '').replace(',', '.')\n            let valorFloat = parseFloat(valor)\n            if (valorFloat <= 10000 && valorFloat >= 1) {\n                return \"É um valor válido\"\n            }\n        }\n        return invalidInputMessage\n    } catch (err) {\n        return invalidInputMessage\n    }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7e0adafc-7741-452a-b0a9-9ac59e690382","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValue\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesValue = input.replace('.', '').replace(',', '.')\n\t\treturn salesValue;\n\t}\n\tcatch(err){\n\t\treturn false\n\t}\n}","inputVariables":["input.content"],"outputVariable":"salesValue","LocalTimeZoneEnabled":false},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"0f55c995-6169-457f-92c9-684fcde81211","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.2.1.1\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.2.1.1"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"764e8e9a-21da-4f52-84e7-a4b5a9c1f388","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"8d5fea91-f519-45eb-9277-2e003aae0255","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8265d783-5357-4974-997c-be07766b192a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d6f55c6c-0df6-4399-8750-cca117b0e216","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-dbd97f70-2c73-4c4c-958f-5caf2978de9a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ec8f2615-e2a5-4330-861f-ea404b812968","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"90f43d6e-b4cd-42d8-a2a1-938c40d6e764","root":false,"$title":"[MS.2.1.1] [INPUT] Valor simulacao","$position":{"top":"1458px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2379f037-b47b-4c61-b9b7-9ae97eb09f06":{"$contentActions":[{"action":{"$id":"ed85b502-ff0c-43d5-82e0-15c14dd48d9a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f49aaae2-87e9-4dbe-9fd3-e3d8f822c2f0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f49aaae2-87e9-4dbe-9fd3-e3d8f822c2f0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a423db42-4ac7-4679-808c-9e92b91f4d47","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"23eea70d-2bde-4953-9ecf-8d398dc29017","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"cc7f677d-b3d8-4702-9b09-d8b346c229c9","typeOfStateId":"state","$connId":"con_43","$id":"a540e61c-119d-4581-81e0-d2ccd946d454","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"7a7df971-29d4-42a3-a16f-deadfb39fb27","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesType) {\n    try {\n        let buttons = [\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"1\",\n                    \"title\": \"Crédito à vista\"\n                }\n            },\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"2\",\n                    \"title\": \"Crédito parcelado\"\n                }\n            }\n        ];\n        if (salesType === \"maquininha\") {\n            buttons = [\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"1\",\n                        \"title\": \"Débito à vista \"\n                    }\n                },\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"2\",\n                        \"title\": \"Crédito à vista\"\n                    }\n                },\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"3\",\n                        \"title\": \"Crédito parcelado\"\n                    }\n                }\n            ];\n        }\n\n        const headerText = \"Qual seria a forma de pagamento?\";\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"button\",\n                \"body\": {\n                    \"text\": headerText,\n                },\n                \"action\": {\n                    buttons\n                }\n            }\n        };\n    } catch (err) {\n        return false;\n    }\n}","inputVariables":["salesType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"466638f9-50be-454c-98a5-32ff70d87fb1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cbd1e378-61eb-4954-845c-b524124a156b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f6a416dd-0f64-46be-a992-0e1989d3990b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f6a69fce-fbb3-43b5-aab1-00130202e39a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2379f037-b47b-4c61-b9b7-9ae97eb09f06","root":false,"$title":"[MS.2.1.2] [MSG] Tipo pagamento","$position":{"top":"1668px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fe58d380-8c87-45b9-ab44-64d5d37c1f51":{"$contentActions":[{"action":{"$id":"bf89849f-4fac-4e72-ad57-2cf54d9e1449","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5b9e2298-0f6c-49df-9404-20fdaa935223","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5b9e2298-0f6c-49df-9404-20fdaa935223","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f05f6bb7-26c4-4e8d-8d75-9cbe4fcf50ed","$typeOfContent":"text","type":"SendMessage","settings":{"id":"78721f34-9722-421b-8a1f-5f0f76d09c2e","type":"text/plain","content":"Agora, digite um valor entre R$1,00 e R$10.000,00 para fazer a simulação, como neste exemplo: 1.000,50.","metadata":{}},"$cardContent":{"document":{"id":"78721f34-9722-421b-8a1f-5f0f76d09c2e","type":"text/plain","content":"Agora, digite um valor entre R$1,00 e R$10.000,00 para fazer a simulação, como neste exemplo: 1.000,50."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a658b32f-2835-4b36-aa9d-ad3e817ae7ac","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"90f43d6e-b4cd-42d8-a2a1-938c40d6e764","typeOfStateId":"state","$connId":"con_48","$id":"415eafa1-240a-4b9b-8922-fe0eefe8735f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b93b86fe-471e-479e-8580-adc1c9bca4cf","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"9d2ab2f5-ccbc-479d-8842-e89a87616c1f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n        if (!inputUsuario) {\n            return 'inatividade'\n        }\n\n        let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi\n        let validInput = regex.test(inputUsuario)\n\n        if (validInput) {\n            let valor = inputUsuario.replace(/\\./g, '').replace(',', '.')\n            let valorFloat = parseFloat(valor)\n            if (valorFloat <= 10000 && valorFloat >= 1) {\n                return \"É um valor válido\"\n            }\n        }\n        return invalidInputMessage\n    } catch (err) {\n        return invalidInputMessage\n    }\n}","inputVariables":["input.content"],"outputVariable":"valorValido","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2bf0672f-852e-48c4-b3d5-7b4e048a5acd","$typeOfContent":"","type":"ExecuteScript","$title":"valorValido2","$invalid":false,"settings":{"function":"run","source":"\nfunction run(valor) {\n\t\n\tlet valor = valor.replace(',','.')\n\tvalor = parseFloat(valor)\n\tif(valor > 10000 || valor < 1){\n\t\treturn \"Não é um valor válido\"\n\t}else{\n\t\treturn \"É um valor válido\"\n\t}\n\t\n}","inputVariables":["valor"],"outputVariable":"valorValido","LocalTimeZoneEnabled":false},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"valorValido"}]},{"$id":"764e8e9a-21da-4f52-84e7-a4b5a9c1f388","$typeOfContent":"","type":"TrackEvent","$title":"Registro de eventos","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{valor}}"},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"valorValido"},{"comparison":"exists","source":"context","values":[],"variable":"valor"}]},{"$id":"8d5fea91-f519-45eb-9277-2e003aae0255","$typeOfContent":"","type":"TrackEvent","$title":"Registro de eventos","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["Não é um valor válido"],"source":"context","comparison":"equals","variable":"valorValido"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-60d1ac5a-7c0b-4036-acc0-cba9bf3ce642","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-137c85f0-199d-4866-bebb-2dd0abb38ba4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8da06729-fcca-4395-b1c3-8f5c39350877","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fe58d380-8c87-45b9-ab44-64d5d37c1f51","root":false,"$title":"[MS.2.1.1] [MSG] Valor simulacao","$position":{"top":"1263px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cc7f677d-b3d8-4702-9b09-d8b346c229c9":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"23eea70d-2bde-4953-9ecf-8d398dc29017","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51","typeOfStateId":"state","$connId":"con_53","$contentId":"4174bb36-4a73-40d5-aa00-89b0e8fb5f4d","$id":"b5fd29d2-c696-41f3-a77b-322021c2a891","conditions":[{"source":"context","comparison":"equals","values":["Débito à vista","Crédito à vista","Crédito parcelado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"6d74e7a6-7a16-4cfd-a518-2df8063f42e3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, salesType) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Crédito [àa] vista\": \"Crédito à vista\",\n      \"Crédito parcelado\": \"Crédito parcelado\"\n    }\n    if (salesType == \"maquininha\") {\n      regexDictionary = {\n        \"d[ée]bito [àa] vista\": \"Débito à vista\",\n        \"Crédito [àa] vista\": \"Crédito à vista\",\n        \"Crédito parcelado\": \"Crédito parcelado\"\n      }\n    }\n\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content","salesType"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4987bc1a-6b77-4b58-8c36-10f3b478d265","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"b53193f6-eae1-44e2-bf26-054f0d5f6513","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentType\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesPaymentType = input.replace(`Débito à vista`, `debito`).replace(`Crédito à vista`, `creditoAVista`).replace(`Crédito parcelado`, `creditoParcelado`)\n\t\treturn salesPaymentType;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesPaymentType","LocalTimeZoneEnabled":false},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"797027ce-ae92-4bdc-8f97-e0753faa452e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0be50b5b-1a79-4f1c-ab87-3b7fdf3cac3c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5add5fc9-39bc-4ddd-b009-047aaedb0e21","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ed276b0a-c49a-4de5-8885-21ca5dd92cbc","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-84a8cfd5-6f66-47e2-ab97-b28dd7808378","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-91471aa2-236f-4882-9824-f0943f72d7ea","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"cc7f677d-b3d8-4702-9b09-d8b346c229c9","root":false,"$title":"[MS.2.1.2] [INPUT] Tipo pagamento","$position":{"top":"1875px","left":"2759px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e4fd4a08-5cdf-4d34-99d3-74f9f5a9e3c1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59d0589a-4bfe-427b-bcc3-37affdafab98","typeOfStateId":"state","$connId":"con_58","$id":"2fc6ef44-de2e-452b-926a-449aadab97db","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9dc698f7-0f96-48d0-9aad-f9a4bb16b021","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP POST \"bodySimulacao\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}","Safra-Bot-ID":"{{application.identifier}}"},"method":"POST","body":"{\n  \"valorVenda\": \"{{salesValue}}\",\n  \"tipoSimulacao\": \"{{salesOrder}}\",\n  \"modalidade\": \"{{salesType}}\",\n  \"tipoPagamento\": \"{{salesPaymentType}}\"\n}","uri":"{{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/{{selectedEc@codigoEc}}/vendas/simular","responseStatusVariable":"statusSimulacao","responseBodyVariable":"bodySimulacao"},"conditions":[]},{"$id":"225f7803-acb4-4143-a1ca-e64661f26a85","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusSimulacao"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"b19574bb-f2f6-4e43-be0b-5cf113d4556c","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"statusSimulacao"}]},{"$id":"47920e81-494d-4445-9550-023cb2b80dd4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{statusSimulacao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusSimulacao"}]},{"$id":"7e499b58-233b-4582-bc0f-34e25c89fba0","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \" {state.name} api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/{{ec}}/vendas/simular | POST | {{statusSimulacao}} | {{bodySimulacao}}"},"conditions":[]},{"$id":"cca73fd6-c775-4717-a152-ecde9779883c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\"","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"idSessao","identity":"{{contact.identity}}","valorVenda":"{{salesValue}}","tipoSimulacao":"{{salesOrder}}","modalidade":"{{salesType}}","tipoPagamento":"{{salesPaymentType}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/selectedEc@codigoEc/vendas/simular | {{statusSimulacao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-68e258ab-d986-407e-85bf-83bb5787a2dd","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-af4c75fb-42ab-49be-a5d2-4d060a95e0cb","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-80e75334-3f58-4a15-9b04-80f86ee17693","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ae8f2063-461b-424c-9eaf-82a435570c93","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51","root":false,"$title":"[MS.2.1.3] [HTTP] API Simular Vendas","$position":{"top":"2091px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59d0589a-4bfe-427b-bcc3-37affdafab98":{"$contentActions":[{"action":{"$id":"c810e386-4922-4496-9cf5-fb65ca671e9a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"86f79972-a169-4480-babb-4261f1b5a4f4","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b38e7f6a-5a97-4966-ba49-f9b7915d436e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"82f8e3d4-5db6-45e5-a221-5bf5526adc84","typeOfStateId":"state","$connId":"con_63","$id":"91858b4f-3baf-4f40-9b92-3f87eeccf56a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"43c3a7b6-6035-4c73-b26a-1dece10ecbee","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentType) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Master\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Visa\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Elo\"\n\t\t\t}\n\t\t]\n\t\tif (salesPaymentType != \"debito\") {\n\t\t\tdefaultMenuOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Master\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Visa\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Elo\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"4\",\n\t\t\t\t\t\"title\": \"Amex\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"5\",\n\t\t\t\t\t\"title\": \"Hiper\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Você pode selecionar uma bandeira?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["salesPaymentType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"21292a72-3479-42d5-b52c-23bc2f5ddf51","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c2657ec5-d134-4955-8846-fa73ee2f8b7f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-dd3429b2-2f66-43da-993c-085a5951b312","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1aedc4ee-5e47-4bad-b007-3f20ae7c01c0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"59d0589a-4bfe-427b-bcc3-37affdafab98","root":false,"$title":"[MS.2.1.4] [MSG] Selecao Bandeira","$position":{"top":"2305px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"82f8e3d4-5db6-45e5-a221-5bf5526adc84":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"b38e7f6a-5a97-4966-ba49-f9b7915d436e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"9ea4726f-a4a6-48be-81b6-48d3fed6c373","typeOfStateId":"state","$connId":"con_68","$contentId":"0312166f-fe1d-43d2-908e-70cfcb0fbde7","$id":"7603f757-e8f3-48cb-b0fb-18a6be76bfef","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["creditoParcelado"],"source":"context","comparison":"equals","variable":"salesPaymentType"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false},{"stateId":"e326f39c-d055-4f2e-9f16-85fe9685f1bf","typeOfStateId":"state","$connId":"con_73","$id":"7f358945-ad3f-4dff-98a8-aa47e0cf6ed2","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d1b72f4d-1312-4445-a40b-8e7867f801d1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, salesPaymentType) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Master\": \"Master\",\n      \"Visa\": \"Visa\",\n      \"Elo\": \"Elo\"\n    }\n    if (salesPaymentType != \"debito\") {\n      regexDictionary = {\n        \"Master\": \"Master\",\n        \"Visa\": \"Visa\",\n        \"Elo\": \"Elo\",\n        \"Amex\": \"Amex\",\n        \"Hiper\": \"Hiper\"\n      }\n    }\n\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content","salesPaymentType"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b139b8a2-c927-4b35-b7fc-96ce5bf3cf61","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d3a2dc1d-5dc7-4276-bce4-16516d931126","$typeOfContent":"","type":"SetVariable","$title":"Set \"salesCardFlag\" with \"userInput\"","$invalid":false,"settings":{"value":"{{userInput}}","variable":"salesCardFlag"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"c9be838f-a14c-43f5-9848-81148e6fd0d0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{input.content}}"},"conditions":[{"values":["Master","Visa","Elo","Amex","Hiper"],"source":"input","comparison":"equals"}]},{"$id":"6a5bb02b-81cf-45a9-84b7-59b24c21eaa0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["Master","Visa","Elo","Amex","Hiper"],"source":"input","comparison":"notEquals"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-25d3806e-3add-4358-9590-47c816a117b2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b479fa78-9202-4422-9eda-0c149aaa7d98","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0b097639-dd18-448c-9d37-62d86cb629a3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4392c5bd-b2f6-4f24-98a9-30755ee3d93f","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"82f8e3d4-5db6-45e5-a221-5bf5526adc84","root":false,"$title":"[MS.2.1.4] [INPUT] Selecao Bandeira","$position":{"top":"2482px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e326f39c-d055-4f2e-9f16-85fe9685f1bf":{"$contentActions":[{"action":{"$id":"d042e3af-4a69-4123-b95c-437767a20806","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6ab58b7f-6395-4b8b-9e87-9b9de4be44fb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"6ab58b7f-6395-4b8b-9e87-9b9de4be44fb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"17fb4027-09dc-4ebc-819f-db705574644c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1dced7d9-ff9a-4b98-8451-b89cf31f6afd","type":"text/plain","content":"Simulei a sua venda, veja como ficou.\n\n{{salesSufixStringfy}} \nTotal de taxas: R${{salesSimulation@valorTaxaTotal}}\nForma de pagamento:{{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}","metadata":{}},"$cardContent":{"document":{"id":"1dced7d9-ff9a-4b98-8451-b89cf31f6afd","type":"text/plain","content":"Simulei a sua venda, veja como ficou.\n\n{{salesSufixStringfy}} \nTotal de taxas: R${{salesSimulation@valorTaxaTotal}}\nForma de pagamento:{{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fc65a89f-eaba-4134-97eb-fc5f17c3a8c8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a3ad8d74-d54e-4b86-bf20-a14dddbaceaa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a3ad8d74-d54e-4b86-bf20-a14dddbaceaa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"10220579-5828-4af6-b848-200c0489dadc","$typeOfContent":"text","type":"SendMessage","settings":{"id":"736c2fc5-8d90-4a79-b54e-f693659000a0","type":"text/plain","content":"Se houver antecipação contratada será cobrada juntamente com as taxas de vendas.","metadata":{}},"$cardContent":{"document":{"id":"736c2fc5-8d90-4a79-b54e-f693659000a0","type":"text/plain","content":"Se houver antecipação contratada será cobrada juntamente com as taxas de vendas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6aca71a3-0115-4f8d-b282-3520108ce390","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","typeOfStateId":"state","$connId":"con_78","$id":"0446be5b-71cc-40ae-8599-b46bc6d89a5c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6add8cde-dd80-4194-ac00-970f1e1b58c3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"d5123ec5-117d-4570-8401-b754cfcea595","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentTypeStringfy){\n\tsalesPaymentTypeStringfy = salesPaymentTypeStringfy.replace(`debito`,`Débito à vista`).replace(`creditoAVista`, `Crédito à vista`).replace(`creditoParcelado`, `Crédito parcelado`)\n\treturn salesPaymentTypeStringfy; \n}","inputVariables":["salesPaymentType"],"outputVariable":"salesPaymentTypeStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a1efc857-fd50-44fc-960f-0b46409610bf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValueStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(valor) {\n  try {\n    const pontos = (valor.match(/\\./g) || []).length;\n    const virgulas = (valor.match(/\\,/g) || []).length;\n\n    if (pontos > 1 || virgulas > 1) {\n      valor = valor.replace(/\\./g, '').replace(',', '.');\n    } else if ((valor.split('.')[1] || []).length == 2 && pontos == 1) {\n      valor = valor.replace(',', '');\n    } else if ((valor.split(',')[1] || []).length == 2 && virgulas == 1) {\n      valor = valor.replace('.', '').replace(',', '.');\n    } else {\n      valor = valor.replace('.', '').replace(',', '.');\n    }\n\n    valor = parseFloat(valor);\n    let valorFormatado = valor.toFixed(2).replace('.', ',');\n    valorFormatado = valorFormatado.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1.');\n    return valorFormatado;\n  }\n  catch (e) {\n    return valor;\n  }\n};","inputVariables":["salesValue"],"outputVariable":"salesValueStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3b36deea-f469-4dd3-98be-ec3192d6727e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulation\"","$invalid":false,"settings":{"function":"run","source":"function run(bandeira, bodySimulacao,salesOrder) {\n\tlet bandeira = bandeira.toLowerCase();\n\tlet bodySimulacao = JSON.parse(bodySimulacao);\n\tconst formatValue = (valor) => {\n\t\treturn `${\n\t\t\tparseFloat(valor)\n\t\t\t\t.toFixed(2)\n\t\t\t\t.replace(\".\", \",\")\n\t\t\t\t.replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\")}`;\n\t}\n\tbodySimulacao = bodySimulacao.data[salesOrder].modalidades[0].bandeiras\n\tbodySimulacao = bodySimulacao.filter(bodySimulacao => (bodySimulacao.descricao == bandeira))\n\tbodySimulacao = bodySimulacao[0].simulacoes[0]\n\tbodySimulacao.valorFinal = formatValue(bodySimulacao.valorFinal)\n\tbodySimulacao.valorTaxaTotal = formatValue(bodySimulacao.valorTaxaTotal)\n\n\treturn JSON.stringify(bodySimulacao);\n}","inputVariables":["salesCardFlag","bodySimulacao","salesOrder"],"LocalTimeZoneEnabled":false,"outputVariable":"salesSimulation"},"conditions":[]},{"$id":"4595b17a-a56e-44db-9897-9cd6b8cb060d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSufixStringfy\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(salesOrder, salesSimulation, salesValueStringfy) {\n\ttry {\n\t\tsalesSimulation = JSON.parse(salesSimulation);\n\t\tif (salesOrder == \"receber\") {\n\t\t\treturn `Cobrando: R$${salesSimulation.valorFinal}\\nVocê receberá: R$${salesValueStringfy}`\n\t\t}\n\t\telse {\n\t\t\treturn `Cobrando: R$${salesValueStringfy}\\nVocê receberá: R$${salesSimulation.valorFinal}`\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["salesOrder","salesSimulation","salesValueStringfy"],"outputVariable":"salesSufixStringfy","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"9816d527-c78c-49d7-96b0-8f92c1bb0d1f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} dados\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} dados","action":"{{salesValueStringfy}} | {{salesSimulation@valorFinal}}| {{salesSimulation@valorTaxaTotal}} | {{salesPaymentTypeStringfy}} | {{salesCardFlag}}"},"conditions":[]},{"$id":"4237de2c-7614-4207-9d1c-680d9b0e8ce1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\" to {salesOrder} - Simulador de Vendas","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{salesOrder}} - Simulador de Vendas"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f1d4dc66-2995-4741-aa34-1c8773d59382","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8c4f9869-280d-4018-9803-02523786655e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5e2b6202-3036-4f0b-9290-721b7e6b5cfe","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e326f39c-d055-4f2e-9f16-85fe9685f1bf","root":false,"$title":"[MS.2.1.5] Cobrar / Receber (À Vista)","$position":{"top":"2617px","left":"2334px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9ea4726f-a4a6-48be-81b6-48d3fed6c373":{"$contentActions":[{"action":{"$id":"fa3afb16-57ab-456a-915c-200409341287","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"57a1d723-25f8-4c86-8edb-7d404de2af0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"57a1d723-25f8-4c86-8edb-7d404de2af0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"05d4465a-fc3c-4b55-8d54-5b9b3b0ae296","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a6681907-19fe-44f3-b726-116820a92325","type":"text/plain","content":"Simulei a sua venda, veja como ficou.\n\n{{salesSufixStringfy@value}} {{salesValueStringfy}}\nCom esta forma de pagamento: {{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}\n\n{{salesSufixStringfy@description}}","metadata":{}},"$cardContent":{"document":{"id":"a6681907-19fe-44f3-b726-116820a92325","type":"text/plain","content":"Simulei a sua venda, veja como ficou.\n\n{{salesSufixStringfy@value}} {{salesValueStringfy}}\nCom esta forma de pagamento: {{salesPaymentTypeStringfy}}\nBandeira: {{salesCardFlag}}\n\n{{salesSufixStringfy@description}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a22b2f21-b8c6-4a52-ab9c-638395cd32b9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7320621c-c487-43a2-ad97-616895b9066f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"1000"},"metadata":{}},"$cardContent":{"document":{"id":"7320621c-c487-43a2-ad97-616895b9066f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"1000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f53a5eca-bcb5-4c77-ac9f-5a631a90c079","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ef9c7209-878d-43b4-a1fc-6ba36f499a5d","type":"text/plain","content":"{{salesSimulationStringfy}}","metadata":{}},"$cardContent":{"document":{"id":"ef9c7209-878d-43b4-a1fc-6ba36f499a5d","type":"text/plain","content":"{{salesSimulationStringfy}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6fb4b261-cb31-4b06-80c0-4253881b1c86","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c9c24b4a-5136-469a-805c-8c64039a712a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c9c24b4a-5136-469a-805c-8c64039a712a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"66f67fe5-e930-47ce-b9e2-2a18f98f5114","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4a35a014-f234-498b-84bd-6514ed8d2856","type":"text/plain","content":"Se houver antecipação contratada  será cobrada juntamente com as taxas de vendas.","metadata":{}},"$cardContent":{"document":{"id":"4a35a014-f234-498b-84bd-6514ed8d2856","type":"text/plain","content":"Se houver antecipação contratada  será cobrada juntamente com as taxas de vendas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7c5d7584-fbf9-42c7-82a8-5dee75920c0f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","typeOfStateId":"state","$connId":"con_83","$id":"f20f3b85-558b-4e67-89e2-4c42090b388f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"90351c88-2a18-47dc-9c31-dd69f99d4ce6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"0ce8dd0b-2d3f-47fc-b0e9-7495447ccbba","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentTypeStringfy){\n\tsalesPaymentTypeStringfy = salesPaymentTypeStringfy.replace(`debito`,`Débito à vista`).replace(`creditoAVista`, `Crédito à vista`).replace(`creditoParcelado`, `Crédito parcelado`)\n\treturn salesPaymentTypeStringfy; \n}","inputVariables":["salesPaymentType"],"outputVariable":"salesPaymentTypeStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7bf87283-4e09-4613-b57d-adfdd9be0c8a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValueStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(valor) {\n  try {\n    const pontos = (valor.match(/\\./g) || []).length;\n    const virgulas = (valor.match(/\\,/g) || []).length;\n\n    if (pontos > 1 || virgulas > 1) {\n      valor = valor.replace(/\\./g, '').replace(',', '.');\n    } else if ((valor.split('.')[1] || []).length == 2 && pontos == 1) {\n      valor = valor.replace(',', '');\n    } else if ((valor.split(',')[1] || []).length == 2 && virgulas == 1) {\n      valor = valor.replace('.', '').replace(',', '.');\n    } else {\n      valor = valor.replace('.', '').replace(',', '.');\n    }\n\n    valor = parseFloat(valor);\n    let valorFormatado = valor.toFixed(2).replace('.', ',');\n    valorFormatado = valorFormatado.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1.');\n    return valorFormatado;\n  }\n  catch (e) {\n    return valor;\n  }\n};","inputVariables":["salesValue"],"outputVariable":"salesValueStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a9437768-2ee8-4e93-9fd3-ae8af297900d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulation\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(bandeira, bodySimulacao,salesOrder) {\n\tlet bandeira = bandeira.toLowerCase();\n\tlet bodySimulacao =  JSON.parse(bodySimulacao);\n\tbodySimulacao = bodySimulacao.data[salesOrder].modalidades[0].bandeiras\n\tbodySimulacao = bodySimulacao.filter(bodySimulacao => (bodySimulacao.descricao == bandeira))\n\tbodySimulacao = bodySimulacao[0]\n\treturn JSON.stringify(bodySimulacao); \n}","inputVariables":["salesCardFlag","bodySimulacao","salesOrder"],"outputVariable":"salesSimulation","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0406d0a3-f748-47b3-a5cb-f2c85c97f78d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulationStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(simulacao) {\n  let simulacao = JSON.parse(simulacao);\n  let aux = ''\n  let count = 2\n  const formatValue = (valor) => {\n    return `${\n      parseFloat(valor)\n        .toFixed(2)\n        .replace(\".\", \",\")\n        .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\")}`;\n  }\n  simulacao.simulacoes.forEach(function (element) {\n    aux = aux.concat(\n\n      'R$ ',\n      formatValue(element.valorFinal),\n      ', se parcelado em ',\n      count,\n      'x\\n'\n    );\n    count++\n  });\n  return aux\n}","inputVariables":["salesSimulation"],"outputVariable":"salesSimulationStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ecc20e35-b3a3-4911-ad28-7b54759c82c2","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSufixStringfy\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(salesOrder) {\n\ttry {\n\t\tif (salesOrder == \"receber\") {\n\t\t\treturn {\n\t\t\t\t\"value\": \"Para receber este valor:R$\",\n\t\t\t\t\"description\": \"Você precisa cobrar:👇\"\n\t\t\t}\n\n\t\t}\n\t\telse {\n\t\t\treturn {\n\t\t\t\t\"value\": \"Cobrando este valor: R$\",\n\t\t\t\t\"description\": \"Você irá receber:👇\"\n\t\t\t}\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n\n}","inputVariables":["salesOrder"],"outputVariable":"salesSufixStringfy","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"6f6ee08b-5eb9-4fe7-86bc-d671a6e80f31","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} dados\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} dados","action":"{{salesValueStringfy}} | {{salesPaymentTypeStringfy}} | {{salesCardFlag}}"},"conditions":[]},{"$id":"21b80c91-dd54-4235-bdaa-4c0e93a49d51","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\" to {salesOrder} - Simulador de Vendas","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"Crédito Parcelado - {{salesOrder}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1bc88f1b-337b-40dc-90ac-37b3e2f097f6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bd053e69-f294-414b-a44f-bea4c5d4c891","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e3893ba5-e838-4ecf-b4a9-2878296950c1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9ea4726f-a4a6-48be-81b6-48d3fed6c373","root":false,"$title":"[MS.2.1.6] Cobrar / Receber (Parcelado)","$position":{"top":"2611px","left":"3192px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3f1e37ee-597d-4dd0-a7e8-f146c51b710c":{"$contentActions":[{"action":{"$id":"975583b8-07ca-4a97-b58c-2719463968c3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"133e0afd-4f6d-48b8-b3eb-15d7fde2d269","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"133e0afd-4f6d-48b8-b3eb-15d7fde2d269","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0da0585f-5a91-4d13-aa9b-6aaae07f0b11","$typeOfContent":"select","type":"SendMessage","settings":{"id":"58b2ed53-6951-414c-a272-808a52593339","type":"application/vnd.lime.select+json","content":{"text":"Selecione uma das opções abaixo 👇","options":[{"text":"Entender minhas taxas","previewText":"Entender minhas taxas","value":null,"index":1,"type":null},{"text":"Fazer outra simulação","previewText":"Fazer outra simulação","value":null,"index":2,"type":null}],"limitMenu":false},"metadata":{}},"$cardContent":{"document":{"id":"58b2ed53-6951-414c-a272-808a52593339","type":"application/vnd.lime.select+json","content":{"text":"Selecione uma das opções abaixo 👇","options":[{"text":"Entender minhas taxas","previewText":"Entender minhas taxas","value":null,"index":1,"type":null},{"text":"Fazer outra simulação","previewText":"Fazer outra simulação","value":null,"index":2,"type":null}],"limitMenu":false}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b0dcdca2-e1e0-4def-91c6-4227e78fd7b0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2","typeOfStateId":"state","$connId":"con_88","$id":"34fe817f-0df8-4ddb-ad6b-9d0c6773e217","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"278dfbdb-843d-4ee6-8e32-eaaa6b980bf8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"16dcdce7-f18f-4cff-9658-0aab61c38423","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesSimulation\"","$invalid":false,"settings":{"variable":"salesSimulation","expiration":1},"conditions":[]},{"$id":"51b01e5d-18ee-462d-ae8c-318b677d0a9d","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesValueStringfy\"","$invalid":false,"settings":{"variable":"salesValueStringfy","expiration":1},"conditions":[]},{"$id":"1d0f5dbb-42f8-4647-b2fc-bb0ee678b4e1","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"variable":"salesPaymentTypeStringfy","expiration":1},"conditions":[]},{"$id":"c0224af3-56dc-47bd-b612-9775a7a6587f","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesSufixStringfy\"","$invalid":false,"settings":{"variable":"salesSufixStringfy","expiration":1},"conditions":[]},{"$id":"5d1f1192-462e-4cda-8b39-54df1fabf290","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Entender taxas\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outra simulação\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Consigo te ajudar em algo mais?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":["Entender minhas taxas","Fazer outra simulação"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b0b949e0-9184-430c-bd40-4a6fe3d8e8f6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ef522b90-c4a0-439a-aaa1-dccbfb72c46f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-746b7ea8-cb41-477e-a116-14f62309e6b2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-228c2597-2b8e-48e8-8119-f22e9b73457b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","root":false,"$title":"[MS.2.2.0] [MSG] Menu simulação opções","$position":{"top":"2943px","left":"2756px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"05d66083-4b28-4d00-9132-1a7a5ac7bd7b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"29bd66a7-4ad7-49bb-94cd-e130dbbb90fe","typeOfStateId":"state","$connId":"con_93","$id":"cd83c5bd-0a7a-4fa9-bdbd-0bc60cd1f5b7","conditions":[{"source":"context","comparison":"equals","values":["Entender minhas taxas"],"variable":"userInput"}],"$invalid":false},{"stateId":"a862dc90-c7cf-421d-bdab-9d09ebe9f70c","typeOfStateId":"state","$connId":"con_98","$id":"f147e717-f486-4887-bbad-fbfadd071a0d","conditions":[{"source":"context","comparison":"equals","values":["Fazer outra simulação"],"variable":"userInput"}],"$invalid":false},{"stateId":"d5dc7576-7a47-4388-b7ee-115298ab5310","typeOfStateId":"state","$connId":"con_103","$id":"9b959394-ce4d-4113-b322-742076e9c116","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0731973d-fc4b-4b1f-9942-2dff4d91ccf5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1ba0f426-2760-4936-bfb4-40d19af622d4","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"24c3cc30-1f67-40f3-a43d-dcaa0015ab03","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"41e30686-f0c4-414e-bff3-2b21134849ff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8742a840-0b3e-484b-878a-971f32edec17","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ebb00649-7ca8-4982-8176-ae082b153269","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-67554f65-d643-41ae-9c08-1094a8766af0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-43f7743a-8e57-464a-8960-a6f276a0d9d9","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2","root":false,"$title":"[MS.2.2.0] [INPUT] Menu simulação opções","$position":{"top":"3170px","left":"2756px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a862dc90-c7cf-421d-bdab-9d09ebe9f70c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"68cc914a-24f1-4052-be01-5cb85012d40a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c391e959-860e-4eaf-86b9-71fcd8888c86","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"a862dc90-c7cf-421d-bdab-9d09ebe9f70c","root":false,"$title":"[GO TO] MS.2.0.0 Simulação de vendas","$position":{"top":"3513.5px","left":"2876.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"85c901f2-e8b4-49ca-97d4-e1becccc4cb1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cede0f5a-5453-45c2-a4fd-e95e478bdd14","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c7eb5b06-ca45-4d7e-be53-b9e17da7fd6d","type":"Redirect","$title":"Redirect to {service} sending {state@lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-43d3018d-951e-406d-8712-a62c30c9d6ea","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","root":false,"$title":"[Redirect] to cascata","$position":{"top":"418px","left":"676px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"820d335f-0c95-466f-9009-35cac24c6ea4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fc103ef4-dff2-44f7-8e0a-39b7348f43ee","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-dfadd853-b0c2-4fc7-88eb-cb2ebee28da5","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"820d335f-0c95-466f-9009-35cac24c6ea4","root":false,"$title":"[Redirect] to Finalizacao (Welcome)","$position":{"top":"247.5px","left":"1998px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5724999e-4ebb-443e-8b1d-4c15ef40251e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"53ecccb3-e087-49da-8667-d20438985d9a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"8d3a9912-951d-4bfc-ac47-2a281fc57f02","$typeOfContent":"","type":"SetVariable","$title":"Set \"atendimento\" to \"humano\"","$invalid":false,"settings":{"variable":"atendimento","value":"humano"},"conditions":[]},{"$id":"b0e87449-cedc-4403-99b9-f0a312c926bd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Whatsapp PJ ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"atendente\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\t// stateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a70cb04f-0d4c-47b7-8093-5e2df5401351","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]}],"$leavingCustomActions":[{"$id":"899b0fcf-a95a-42db-ab36-2b708dd3f4c9","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"atendente"},"address":"WhatsApp PJ"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-de786d09-35a0-4284-8eb9-eb9c8f7bbbc4","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-237b1639-bbf0-47e5-8de8-56af54b21948","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-acfd4a38-740c-4cfd-bef5-d585d7429b88","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"5724999e-4ebb-443e-8b1d-4c15ef40251e","root":false,"$title":"[Redirect] to WhatsApp PJ (atendente)","$position":{"top":"236px","left":"1018px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4f6e7e6d-21b4-4b11-9913-6aa5149a7469":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"562166b0-aef9-429b-9ea8-06a2f3a080f5","typeOfStateId":"state","$connId":"con_108","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fc5e1b09-cbde-410a-abd2-09f89a5d6b8a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Suporte\",\n        \"description\": \"Problemas na máquina\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Configurações\",\n        \"description\": \"Device lock, QR Code e outros\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Erros gerais\",\n        \"description\": \"Na máquina e na leitura do cartão\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Fica mais fácil te ajudar se a máquina estiver por perto. \n\nDo que você está precisando agora?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a6cd37c7-040b-4b19-a28c-e9f7313752f6","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"0e4d397e-8536-41a9-8b2d-30fbb16a6403","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"0239f4dc-4de2-469f-9330-cbea0ff02d80","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7f5af622-832a-49d3-a205-da1d1ae6c5bb","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-76fe8dbb-48fd-4e29-8671-f5999a51b1d0","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-83c23793-866b-4d3b-9615-c5504c7320b5","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-4c0863d9-7974-42f8-8908-023a3b70e65f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4f6e7e6d-21b4-4b11-9913-6aa5149a7469","root":false,"$title":"[MS.5.0.0][MSG] Menu Suporte e configurações","$position":{"top":"153px","left":"14555px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"562166b0-aef9-429b-9ea8-06a2f3a080f5":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"b838e923-9fa9-4c3b-a930-d5553fec5012","typeOfStateId":"state","$connId":"con_113","$id":"725bea47-375f-44b8-bc19-0ba3f9dbfb10","conditions":[{"source":"context","comparison":"equals","values":["Suporte"],"variable":"userInput"}],"$invalid":false},{"stateId":"faadc313-0a4d-4cd0-b4f1-95ff2c4027c8","typeOfStateId":"state","$connId":"con_118","$id":"bb4e725a-b76b-4189-b463-2332123f98df","conditions":[{"source":"context","comparison":"equals","values":["Configurações"],"variable":"userInput"}],"$invalid":false},{"stateId":"7eaa4922-911f-469d-be60-ea0ebb25000d","typeOfStateId":"state","$connId":"con_123","$id":"54638fa5-8e51-4732-b701-a7dfcc55fe35","conditions":[{"source":"context","comparison":"equals","values":["Erros gerais"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"72a59cf4-5008-497b-acdc-04e7364fa9d9","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-40876a19-986a-44b2-8f7e-2ad4690fbf18","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-df6fef09-1e8b-4742-8af3-93220c57a315","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f3f5da76-53fa-47b6-a5df-a46f734cba45","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7a230332-77fa-4f9b-a3e1-4edb4aa15110","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"562166b0-aef9-429b-9ea8-06a2f3a080f5","root":false,"$title":"[MS.5.0.0][INPUT] Menu suporte e configurações","$position":{"top":"454.545px","left":"14554.6px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b838e923-9fa9-4c3b-a930-d5553fec5012":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9ce2582d-a972-47a8-a0bd-fa4262629b1f","typeOfStateId":"state","$connId":"con_128","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e7b2a4aa-ed10-4f18-8031-ab497dc1f6bd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Ligar e desligar\",\n        \"description\": \"Máquina não liga, desligar máquina e máquina desliga após 5 minutos\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Problema na comunicação\",\n        \"description\": \"Máquina e bluetooth\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Voucher\",\n        \"description\": \"Cartões de benefícios VA, VR, Alelo e outros\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Status inválido\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Reinicialização\",\n        \"description\": \"Máquina reinicia sozinha\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"POS travando\"\n    },\n    {\n        \"id\": \"7\",\n        \"title\": \"Bateria\",\n        \"description\": \"Bateria fraca e problemas com carregador\"\n    },\n    {\n        \"id\": \"8\",\n        \"title\": \"Impressão\",\n        \"description\": \"Problemas com impressão\"\n    },\n    {\n        \"id\": \"9\",\n        \"title\": \"USB\",\n        \"description\": \"Aparece somente opção USB\"\n    },\n    {\n        \"id\": \"10\",\n        \"title\": \"Resetar máquina\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Vou precisar fazer algumas perguntas para  te ajudar. \n\nO que está acontecendo com a máquina?`\n                },\n                \"action\": {\n                    \"button\": \"Escolha uma opção\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"faaa7c75-3174-45c5-91b6-1a4f0aaf5b1d","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"d756db12-8349-45d1-a3b7-d480e98fa094","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"fdaa1dc0-54a2-4341-a20e-3e0d036d12b5","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a4155123-71ec-471d-a908-a7d1f115f16c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-46ce7758-c759-4adb-b940-fa8a8c7c6542","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4360347c-ef9a-4b71-8efe-23ae9197d07e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-4bfac257-960a-4070-96e6-aa05806eb9a0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b838e923-9fa9-4c3b-a930-d5553fec5012","root":false,"$title":"[MS.6.0.0][MSG] Menu Suporte","$position":{"top":"467.111px","left":"6350.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9ce2582d-a972-47a8-a0bd-fa4262629b1f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"7e827dd9-98be-4599-9ae0-afb9a8706c7c","typeOfStateId":"state","$connId":"con_133","$id":"635ee7c1-ae50-4f9c-b074-f2c72e0b78d7","conditions":[{"source":"context","comparison":"equals","values":["Ligar e Desligar"],"variable":"userInput"}],"$invalid":false},{"stateId":"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d","typeOfStateId":"state","$connId":"con_138","$id":"93ab7144-7483-4fb0-998d-5eb7d798086e","conditions":[{"source":"context","comparison":"equals","values":["Problema na comunicação"],"variable":"userInput"}],"$invalid":false},{"stateId":"c5e1371d-0301-4936-92d3-91d24c5b4949","typeOfStateId":"state","$connId":"con_143","$id":"c434775e-bf35-46ff-a494-d1c807143b97","conditions":[{"source":"context","comparison":"equals","values":["Voucher"],"variable":"userInput"}],"$invalid":false},{"stateId":"d0272082-89c5-4257-8575-de30b862afc0","typeOfStateId":"state","$connId":"con_148","$id":"79389d68-d6b3-4dc4-9a19-73c3492dd0b2","conditions":[{"source":"context","comparison":"equals","values":["Status inválido"],"variable":"userInput"}],"$invalid":false},{"stateId":"fd47adc2-0b46-4ea2-961f-137b246b4253","typeOfStateId":"state","$connId":"con_153","$id":"fc658aeb-8b27-42b3-a18c-1653af946ac5","conditions":[{"source":"context","comparison":"equals","values":["Reinicialização"],"variable":"userInput"}],"$invalid":false},{"stateId":"75f868ee-f775-4d6e-8c7d-e8315edf0847","typeOfStateId":"state","$connId":"con_158","$id":"f57e186d-6f69-4a68-9d8a-6e6f1ff581c4","conditions":[{"source":"context","comparison":"equals","values":["POS travando"],"variable":"userInput"}],"$invalid":false},{"stateId":"7bdc580c-ecf9-4f6c-9aa3-b16158ab7219","typeOfStateId":"state","$connId":"con_163","$id":"91b8daa3-8011-4427-86bb-a3648127970e","conditions":[{"source":"context","comparison":"equals","values":["Bateria"],"variable":"userInput"}],"$invalid":false},{"stateId":"db72de2b-8f60-4bb2-8191-6957300d488e","typeOfStateId":"state","$connId":"con_168","$id":"3dea0338-c13e-4d3e-a3a3-c5ad2acb0c5e","conditions":[{"source":"context","comparison":"equals","values":["Impressão"],"variable":"userInput"}],"$invalid":false},{"stateId":"0dde7099-56bd-4590-abff-25c9a550991e","typeOfStateId":"state","$connId":"con_173","$id":"70be7e38-7878-44dd-b9e4-5d7206406b18","conditions":[{"source":"context","comparison":"equals","values":["USB"],"variable":"userInput"}],"$invalid":false},{"stateId":"6c943cf9-ee58-4067-a079-7bdd0c20b21c","typeOfStateId":"state","$connId":"con_178","$id":"a7eed7f2-8cb1-4e29-8878-d6976fb194e1","conditions":[{"source":"context","comparison":"equals","values":["Resetar máquina"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-393934bd-a70b-4d58-9dd7-57ec95ae39b6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-597b720f-99c9-4528-8226-36b0dc88885e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0c27b3de-a9d2-4dd6-b0fe-93bf6a8960ab","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-17a01a29-01b4-4819-ac09-ecda8ec045f1","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9ce2582d-a972-47a8-a0bd-fa4262629b1f","root":false,"$title":"[MS.6.0.0][INPUT] Menu Suporte","$position":{"top":"914.286px","left":"6350.19px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7e827dd9-98be-4599-9ae0-afb9a8706c7c":{"$contentActions":[{"action":{"$id":"af4c80a5-9d06-4408-925e-f4205937cd6f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d6044fe3-1f38-441d-907f-d05847e6c372","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d6044fe3-1f38-441d-907f-d05847e6c372","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7c0cbf8c-87f8-4ef5-8df1-8695424a3e21","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"42607226-b95d-4272-87c8-de6d1739d600","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"49a69242-08d5-4f49-a0c3-82481949f658","typeOfStateId":"state","$connId":"con_183","$id":"9428ac03-8934-49dd-b11e-49733e5144e9","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b7e828f3-a734-4a6a-b58d-538f493ae255","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Máquina não liga\",\n\t\t\t\t// \"description\": \"Minha máquina não liga\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Desligar máquina\",\n\t\t\t\t// \"description\": \"Como desligar a minha máquina\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Máquina desligando\",\n\t\t\t\t// \"description\": \"Equipamento desliga após 5 minutos\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual seria o motivo?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"db8163c4-1eff-45bf-aee1-4a377af2ff53","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ca0e09c8-b419-4695-9e41-37ade0b2393d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-36a14176-08c7-4812-870d-38ad928ddb8a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1e98a786-d62c-4596-8ebb-24d0917e3ee1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7e827dd9-98be-4599-9ae0-afb9a8706c7c","root":false,"$title":"[MS.6.1.0][MSG] Menu Ligar e Desligar","$position":{"top":"1586px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"49a69242-08d5-4f49-a0c3-82481949f658":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"f86e1afc-51a9-44f3-a8a3-1bddc6647f30","typeOfStateId":"state","$connId":"con_188","$id":"be868053-e743-4582-b657-d7940c844003","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d16d76ed-caeb-4b05-90f8-464def78f661","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d31fbced-be77-470f-9fc6-f90991d67699","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e4c20626-4f13-4841-a1dc-13acd6cf3551","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8cd89330-ce42-4c85-b8a0-a9087ea50428","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"49a69242-08d5-4f49-a0c3-82481949f658","root":false,"$title":"[MS.6.1.0][INPUT] Menu Ligar e Desligar","$position":{"top":"1811.89px","left":"4682.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f86e1afc-51a9-44f3-a8a3-1bddc6647f30":{"$contentActions":[{"action":{"$id":"bc92a6ee-f22e-459a-b941-6e502d908393","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9088abfd-d7b5-41c6-9981-67c01ea86098","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c6a3a29-8422-4158-86c8-8d943bc427ab","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"49cf6fea-9926-4648-b45c-87b81b34b9eb","typeOfStateId":"state","$connId":"con_193","$id":"b2983e28-557a-4da9-9405-6789f732c757","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"eb9be5e2-0498-416f-b38f-c8e85945d1fb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n\ttry {\n\t\tif (userInput === 'Máquina não liga') {\n\t\t\treturn montaList([\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"POS fixo\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Move 5000/PAX S920\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t])\n\t\t}\n\t\tif (userInput === 'Desligar máquina') {\n\t\t\treturn montaList([\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Move 5000/PAX S920\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Link 2500\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t])\n\t\t}\n\t\tif (userInput === 'Máquina desligando') {\n\t\t\treturn montaQuickReply([\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\t\"reply\": {\n\t\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\t\"title\": \"Link 2500\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\t\"reply\": {\n\t\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t])\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}\n\nfunction montaList(botoes) {\n\treturn {\n\t\t\"recipient_type\": \"individual\",\n\t\t\"type\": \"interactive\",\n\t\t\"interactive\": {\n\t\t\t\"type\": \"list\",\n\t\t\t\"header\": {\n\t\t\t\t\"type\": \"text\",\n\t\t\t\t\"text\": \"\"\n\t\t\t},\n\t\t\t\"body\": {\n\t\t\t\t\"text\": `Entendi, e qual é o modelo da sua máquina?`\n\t\t\t},\n\t\t\t\"action\": {\n\t\t\t\t\"button\": \"Selecionar modelo\",\n\t\t\t\t\"sections\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\"rows\": botoes\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction montaQuickReply(buttons) {\n\treturn {\n\t\t\"recipient_type\": \"individual\",\n\t\t\"type\": \"interactive\",\n\t\t\"interactive\": {\n\t\t\t\"type\": \"button\",\n\t\t\t\"body\": {\n\t\t\t\t\"text\": 'Entendi, e qual é o modelo da sua máquina?',\n\t\t\t},\n\t\t\t\"action\": {\n\t\t\t\tbuttons\n\t\t\t}\n\t\t}\n\t}\n}","inputVariables":["userInput"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5107b5ac-79af-45c9-b6e0-2d649e38da64","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-53e2c163-bd2f-4b63-9332-ac3a39f6aaae","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2b63efba-9d4c-435c-8743-c8284cec0802","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-cda55d42-b546-4fc4-89a9-a1e964a39f37","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f86e1afc-51a9-44f3-a8a3-1bddc6647f30","root":false,"$title":"[MS.6.1.1][MSG] Menu selecionar modelo da maquina","$position":{"top":"2101px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"49cf6fea-9926-4648-b45c-87b81b34b9eb":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"1337352b-12ff-49c0-9fe2-10883e6e0862","typeOfStateId":"state","$connId":"con_198","$id":"5c7277eb-2b63-459a-8ddd-b5e03eed61e2","conditions":[{"source":"context","comparison":"equals","values":["Máquina desligando","Desligar máquina"],"variable":"subAssunto"},{"values":["Outro modelo"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"6fcc7b4d-2226-4a2c-bdef-5b5e7eadc1f5","typeOfStateId":"state","$connId":"con_203","$id":"5dd47c8a-f654-465b-90d5-e0d6b2ac415e","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4e836186-3ff6-41a1-88e6-094510a32b45","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cc767a34-0b48-48c7-91ce-bade3986f93b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0b1bb13e-865a-4ff3-acc2-c0c27a3f05ad","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-58c1dcbb-f62f-43e9-9b9a-cab7043446a3","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"49cf6fea-9926-4648-b45c-87b81b34b9eb","root":false,"$title":"[MS.6.1.1][INPUT] Menu selecionar modelo da maquina","$position":{"top":"2391px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6fcc7b4d-2226-4a2c-bdef-5b5e7eadc1f5":{"$contentActions":[{"action":{"$id":"cb31f40e-1f2a-45c4-b40c-a56473bd3b94","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a1431d2b-2ffb-4466-b650-2b993d0e36ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a1431d2b-2ffb-4466-b650-2b993d0e36ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"04b2ee48-8146-4c01-9e20-127ebda718a5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bed43ab0-b680-4960-ae29-0243163a2eaa","type":"text/plain","content":"{{equipamentoNaoLigaMsg}}","metadata":{}},"$cardContent":{"document":{"id":"bed43ab0-b680-4960-ae29-0243163a2eaa","type":"text/plain","content":"{{equipamentoNaoLigaMsg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b9efb61f-42a1-48ec-ad5e-117e25544a00","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_208","$id":"49a6d53c-1fa0-4d07-906a-d9d030a4154f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c6b457e5-57ab-4187-8169-d9e3fff56b38","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"equipamentoNaoLigaMsg\"","$invalid":false,"settings":{"function":"run","source":"const messages = {\n\t'Máquina desligando': {\n\t\t'link 2500': `É possível aumentar o tempo para até 3 horas.\n\nPara isso, faça o seguinte:\n\n1° Na sua máquina, selecione F1.\n\n2° Escolha a opção menu.\n\n3° Vá em configurações.\n\n4° Selecione auto desligamento.\n\n5° Para aumentar ou diminuir o tempo utilize os botões F1 e F2.\n`,\n\t\t'outra': ''\n\t},\n\t'Desligar máquina': {\n\t\t'move 5000/pax s920': `Vou te pedir para fazer o seguinte:\n\n1° Pressione o botão \"ponto\"    ( . ) e o botão amarelo ao    mesmo tempo.\n\n2° Certifique-se de que o equipamento não esteja conectado ao carregador.\n\n*Atenção*\nNo modelo *S920*, utilize o botão vermelho para ligar e desligar.\n `,\n\t\t'link 2500': `Para desligar a máquina, pressione simultaneamente o botão \"ponto\" ( . ) e o botão amarelo.\n\n*Importante*\nO equipamento não deve estar conectado ao carregador.\n`,\n\t\t'outra': ''\n\t},\n\t'Máquina não liga': {\n\t\t'pos fixo': `Vou te pedir para fazer o seguinte:\n \n1° Verifique se o terminal está conectado à rede de energia.\n\n2° Certifique-se de que a fonte de alimentação está devidamente conectada.\n\n3° Para ligar o equipamento, basta conectá-lo na tomada.\n`,\n\t\t'move 5000/pax s920': `Vou te pedir para fazer o seguinte:\n\nDesconecte a bateria e conecte-a novamente.\n`,\n\t\t'outro modelo': `Vou te pedir para fazer o seguinte:\n\n1° Verifique se o carregador está conectado na tomada.\n\n2° Verifique se a tomada está funcionando.\n\n3° Verifique se o cabo do carregador está conectado ao equipamento.\n\n4° Verifique se o carregador utilizado é original da máquina Safrapay.\n\n5° Abra a tampa traseira, desconecte o plug da bateria e aguarde 30 segundos.\n\n6° Reconecte a bateria e conecte o equipamento ao carregador. Agora, tente ligar a máquina novamente.\n`\n\t}\n}\nfunction run(userInput, subAssunto) {\n\ttry {\n\t\treturn messages[subAssunto][userInput.toLowerCase()] || false\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput","subAssunto"],"outputVariable":"equipamentoNaoLigaMsg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e4e40fba-4973-47a1-9c15-8d03a01e31ff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-85223962-d1a3-43b0-82fe-d7c531729ffc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e0e82c80-3918-47c8-8d00-1fd912dd763a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b4e99303-d9a6-4057-a19c-9e307dad1584","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6fcc7b4d-2226-4a2c-bdef-5b5e7eadc1f5","root":false,"$title":"[MS.6.1.2][MSG] Ligar e Desligar","$position":{"top":"2671px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b03d52e3-aeda-4505-8186-ca025fd17395":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1157b193-e683-4e3f-9870-67f7f645d0a0","typeOfStateId":"state","$connId":"con_213","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Deu certo?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ce58760b-6802-443d-b8f7-95b3d94b94bb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b0b718c8-ac86-404b-8b88-5c7a9dfed2a5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-17cebcd9-97e8-47a0-973c-5ce7d2a54e01","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-74bf8e18-09b5-40bd-9575-a85e72947051","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b03d52e3-aeda-4505-8186-ca025fd17395","root":false,"$title":"[MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"3117px","left":"5659px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1157b193-e683-4e3f-9870-67f7f645d0a0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"082428ef-bfa6-4828-9e9f-d64787844ea5","typeOfStateId":"state","$connId":"con_218","$id":"a260e0ba-0f00-4478-8e69-a82737cc2401","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"732efa55-d798-4f04-acb5-c306c0ebd203","typeOfStateId":"state","$connId":"con_223","$id":"539c890e-318d-41ba-b073-719ab90c6829","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e14ec5e0-5ba5-42df-b545-a5fea98816b1","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"17fe3ccf-b0b7-4cad-8bf5-ea77a2339ae2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"d8643fde-7bce-426e-a060-5d5034608dc4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7ffc2f64-e47a-4427-9d1b-51a889ea1792","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b0dfb72c-b8af-4fef-860e-c1711b44b752","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2573d32c-f31f-4feb-a171-ebc5f38c255d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bced1917-7ff4-43b6-8708-0bb78383e25c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1157b193-e683-4e3f-9870-67f7f645d0a0","root":false,"$title":"[MS.X.X.X][INPUT] Problema resolvido?","$position":{"top":"3406px","left":"5659px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d":{"$contentActions":[{"action":{"$id":"984ceb37-0e70-4d4f-8d21-ef457eb23a04","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"90748cdc-85f8-43e3-852e-d3ef01deb7b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"90748cdc-85f8-43e3-852e-d3ef01deb7b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"517dea2b-d0f8-4e18-afcd-0cf2e1bcb28f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4e16299b-40de-4b84-949d-bf717958dc4d","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local onde ele é inserido com um pano seco.\n\n4° Recoloque o chip no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação.","metadata":{}},"$cardContent":{"document":{"id":"4e16299b-40de-4b84-949d-bf717958dc4d","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local onde ele é inserido com um pano seco.\n\n4° Recoloque o chip no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5cc512f3-db31-40d3-9c06-ed4580f1eb5f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7825a4d1-a414-469b-9281-dc8f123bb7f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7825a4d1-a414-469b-9281-dc8f123bb7f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e7697dae-3714-43ee-b2b6-f1198a24736b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"dfff3c3c-7040-4e22-94e9-3a09317d1493","type":"text/plain","content":"A atualização foi realizada com sucesso?\n\n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste.","metadata":{}},"$cardContent":{"document":{"id":"dfff3c3c-7040-4e22-94e9-3a09317d1493","type":"text/plain","content":"A atualização foi realizada com sucesso?\n\n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"113933fc-84e1-43bf-b9be-c9df9c557da2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_228","$id":"a156d148-deeb-489a-be17-334a809a6308","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"71a6820d-6c6e-474c-a725-5ac6c020ad16","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ab22de1b-d916-4b14-9980-0caa1bf6e87d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1fcc094c-6f50-4fcf-b493-44075ede9a2d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d","root":false,"$title":"[MS.6.2.0][MSG] Problema/comunicação","$position":{"top":"1872.86px","left":"5547.49px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c5e1371d-0301-4936-92d3-91d24c5b4949":{"$contentActions":[{"action":{"$id":"f539c883-ed39-497a-9d9e-697165b819c7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0737a25c-d934-4c1f-bdba-0b54a188772c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0737a25c-d934-4c1f-bdba-0b54a188772c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b4b32043-81e7-4664-8930-3055d9fa4ac6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e9e4d083-711d-4ca4-aca2-1a9c5ccede01","type":"text/plain","content":"Você já solicitou a habilitação do voucher com a administradora?\n\n<b>Se sim:</b>\n- Realize o atalho 995\n- Realize o atalho 993\n- Realize uma transação de teste.\n\n<b>Se não:</b>\nVocê deve habilitar o voucher com a administradora.","metadata":{}},"$cardContent":{"document":{"id":"e9e4d083-711d-4ca4-aca2-1a9c5ccede01","type":"text/plain","content":"Você já solicitou a habilitação do voucher com a administradora?\n\n<b>Se sim:</b>\n- Realize o atalho 995\n- Realize o atalho 993\n- Realize uma transação de teste.\n\n<b>Se não:</b>\nVocê deve habilitar o voucher com a administradora."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d181641a-16b3-491e-90f5-aaa814dbc476","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"31b9294d-9c88-4389-9ba7-abcbd425bd9a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"31b9294d-9c88-4389-9ba7-abcbd425bd9a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"68a90e7a-2b1c-421f-8cee-822a0dfb3a63","$typeOfContent":"text","type":"SendMessage","settings":{"id":"6a1edb5c-1c54-4518-8b8a-93d616cf6774","type":"text/plain","content":"É importante lembrar que apenas estabelecimentos cadastrados como bares e restaurantes podem receber pagamentos com voucher (VA/VR).","metadata":{}},"$cardContent":{"document":{"id":"6a1edb5c-1c54-4518-8b8a-93d616cf6774","type":"text/plain","content":"É importante lembrar que apenas estabelecimentos cadastrados como bares e restaurantes podem receber pagamentos com voucher (VA/VR)."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e35a82c1-9753-4ac2-9b27-39f6132e45da","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_233","$id":"8119f298-791c-4606-a9b3-1fb6a4f3b620","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"54f020bd-48a4-44ff-a7e9-198be6350498","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9b464be6-8705-4cb8-831c-d6cb99e6ef2d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2d989a1c-886a-42a3-8498-6739b7f8a8e6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c5e1371d-0301-4936-92d3-91d24c5b4949","root":false,"$title":"[MS.6.3.0][MSG] Voucher","$position":{"top":"1875px","left":"5767px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d0272082-89c5-4257-8575-de30b862afc0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"314449b7-de1a-42cf-97bb-47babd3358bd","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6b9ecbae-d364-4510-9ec2-ff8f3a573cef","typeOfStateId":"state","$connId":"con_238","$id":"196fad90-e34b-4c79-b1cf-b817c5bb0f18","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"selectedEc"}],"$invalid":false},{"stateId":"1e2b8273-089f-41ba-a883-0bfd3497a275","typeOfStateId":"state","$connId":"con_243","$id":"2d80cf59-b28d-4b94-a93a-0f672ddbcd01","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"d0272082-89c5-4257-8575-de30b862afc0","root":false,"$title":"[MS.6.4.0][SET] Status inválido verifica EC","$position":{"top":"1478px","left":"6378.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6b9ecbae-d364-4510-9ec2-ff8f3a573cef":{"$contentActions":[{"action":{"$id":"421bc1c3-716a-410e-adfb-30fb4527c926","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e8bcbddf-29a4-44d8-90e6-28af62bafce2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e8bcbddf-29a4-44d8-90e6-28af62bafce2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4b5c414e-5ee0-44bf-bbb5-df5e2b6455af","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d5db6858-c5d5-42b5-8695-e4ab731e7fde","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Pressione o botão <b>ativar.</b>\n\nAtivou?\n\n- Se sim: Finalize.\n\n- Se não: Pode ser uma falha na configuração.Conecte-se ao Wi-Fi.","metadata":{}},"$cardContent":{"document":{"id":"d5db6858-c5d5-42b5-8695-e4ab731e7fde","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Pressione o botão <b>ativar.</b>\n\nAtivou?\n\n- Se sim: Finalize.\n\n- Se não: Pode ser uma falha na configuração.Conecte-se ao Wi-Fi."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9b234acc-b382-49f9-95d3-49b42ed1e226","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"16a3b030-226d-46cc-899e-3a65c5baa72c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"16a3b030-226d-46cc-899e-3a65c5baa72c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8be3e42f-8a78-4a7c-972d-90baf5e78b15","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f8b23ce0-222f-427a-b9b1-f652209c8cb1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b379a73a-4f4e-4600-83d9-ecd011d48b68","typeOfStateId":"state","$connId":"con_248","$id":"f7e558eb-e985-4b30-95ec-0aab28c16e5e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"2e1c83af-a9f1-4623-9d3c-3b905a6bfd14","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"A ativação foi concluída? 🤔\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"da55f580-d609-4118-99e9-015db713de5f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-02c743c3-7e35-470a-8cb2-dd0df1549d69","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-626cd555-098a-4a56-bcda-97a747e7cad7","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bf5ef3bb-5d1c-48a7-8279-df19f1137472","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6b9ecbae-d364-4510-9ec2-ff8f3a573cef","root":false,"$title":"[MS.6.4.0][MSG] Status inválido","$position":{"top":"2022.83px","left":"6350.29px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b379a73a-4f4e-4600-83d9-ecd011d48b68":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9f5e92f9-b17f-43c5-b1c6-d2f07698442c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"68a1f11d-7db3-4163-aee5-05d12419d448","typeOfStateId":"state","$connId":"con_253","$id":"11ff8786-e2aa-4d34-9b9b-b4b9ca07fdfd","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"1e2b8273-089f-41ba-a883-0bfd3497a275","typeOfStateId":"state","$connId":"con_258","$id":"262534ed-7e9a-4f2b-853a-ba34eb043106","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bb0e2c3c-2c27-411b-bb00-4b8d8b11700a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fc88824f-f212-44b2-8036-ca0e6b81a69a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"4be0c16f-b58e-483b-b371-9916b7a009ca","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1c2fab0e-506d-45fb-b10a-372db63f242c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f8d09610-2973-46f1-9d41-3155c6e159fa","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-787e8c0c-e6c7-45bc-b288-7ee33a6da857","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b379a73a-4f4e-4600-83d9-ecd011d48b68","root":false,"$title":"[MS.6.4.0][INPUT] Status inválido","$position":{"top":"2324px","left":"6350px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fd47adc2-0b46-4ea2-961f-137b246b4253":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7e8ae03d-9db1-496a-88c0-aa68720b4846","typeOfStateId":"state","$connId":"con_263","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e867fd85-0ad6-4b1e-99df-71994eb60c45","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Tela reiniciando\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Equipamento reiniciando\",\n\t\t\t\t\"description\": \"Máquina reiniciando sozinha\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Por gentileza, selecione o motivo.👇`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Motivo\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc5bb2de-59ca-47de-8be3-b3a63750d57a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-34e94d29-7de2-4d9e-92e7-7876cb513095","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1fe8c802-d649-4b33-9917-05e3bc58e180","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2f2bc649-2e60-4290-b33a-3cf14e600080","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fd47adc2-0b46-4ea2-961f-137b246b4253","root":false,"$title":"[MS.6.5.0][MSG] Menu Reinicialização","$position":{"top":"1426.62px","left":"7182.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7e8ae03d-9db1-496a-88c0-aa68720b4846":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"969f7264-dae7-49da-807b-c00e3554908e","typeOfStateId":"state","$connId":"con_268","$id":"6ba3c0e8-045c-49ba-bc3e-ffe0e150d3e4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-26299469-c92c-4d1b-893a-adc5c319f09f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e04c0e99-f973-4672-9bd2-d0043170610c","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-a44368db-c9d5-4b05-a51a-9aaa53cb5dd5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-91de12d3-094a-4e88-b88e-02f127f998c6","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7e8ae03d-9db1-496a-88c0-aa68720b4846","root":false,"$title":"[MS.6.5.0][INPUT] Equipamento reiniciando","$position":{"top":"1787.35px","left":"7182.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d3b5eb14-26fb-40a2-bdc7-b569e0ab13e7":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"1e2b8273-089f-41ba-a883-0bfd3497a275","typeOfStateId":"state","$connId":"con_273","$id":"a60da9d2-9a23-4941-a0b9-8f997f73ce47","conditions":[{"source":"context","comparison":"equals","values":["Outra"],"variable":"userInput"}],"$invalid":false},{"stateId":"4a5dc19c-766d-462a-95b6-60b15658e933","typeOfStateId":"state","$connId":"con_278","$id":"cd8f6373-2d4b-4ba0-8ea8-4cbccda667aa","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f43798cc-bb3d-4fd1-b08d-84ee0b11c838","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-73daef15-8f6a-4c7f-b83f-4671e344c173","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-a4a7c275-025f-4133-8716-4f98f352c860","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f2bc715f-46c9-40a6-af88-8c2f6951a8a8","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"d3b5eb14-26fb-40a2-bdc7-b569e0ab13e7","root":false,"$title":"[MS.6.5.1][INPUT] Menu selecionar modelo da maquina","$position":{"top":"2300.35px","left":"7181.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"969f7264-dae7-49da-807b-c00e3554908e":{"$contentActions":[{"action":{"$id":"bc92a6ee-f22e-459a-b941-6e502d908393","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9088abfd-d7b5-41c6-9981-67c01ea86098","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c6a3a29-8422-4158-86c8-8d943bc427ab","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d3b5eb14-26fb-40a2-bdc7-b569e0ab13e7","typeOfStateId":"state","$connId":"con_283","$id":"b2983e28-557a-4da9-9405-6789f732c757","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"eb9be5e2-0498-416f-b38f-c8e85945d1fb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n\ttry {\n\t\tlet defaultMenuOptions = []\n\t\tif (userInput === 'Tela reiniciando') {\n\t\t\tdefaultMenuOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outra\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\tif (userInput === 'Equipamento reiniciando') {\n\t\t\tdefaultMenuOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Move\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outra\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": 'Entendi, e qual é o modelo da sua máquina?'\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Modelo\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7109e9-6b91-4e3f-8971-587c48cf6635","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fd1e4cfd-4ebc-4a2f-9fa6-cbe2a3509aa5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c1b553e9-c0c8-4281-acb2-1ddcc7fa43e0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a734f00a-49fd-46bf-8f36-f38c898e64f0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"969f7264-dae7-49da-807b-c00e3554908e","root":false,"$title":"[MS.6.5.1][MSG] Menu selecionar modelo da maquina","$position":{"top":"2017px","left":"7183px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1e2b8273-089f-41ba-a883-0bfd3497a275":{"$contentActions":[{"action":{"$id":"6eb6ce31-2ac3-498f-8b2e-3e83c0ff2927","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"91e6dede-5cfd-4ab8-aa1d-de2c1b08a15a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"91e6dede-5cfd-4ab8-aa1d-de2c1b08a15a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6fd925d4-638c-4ba8-88ba-aeaef0469751","$typeOfContent":"text","type":"SendMessage","settings":{"id":"918b781f-209c-4e7f-ac86-d7ad69951ff5","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"918b781f-209c-4e7f-ac86-d7ad69951ff5","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f5fe563f-cc04-46b0-bfec-1ee436c8f912","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fb29668f-54eb-4217-9ad1-c97dd2a3100b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"1e2b8273-089f-41ba-a883-0bfd3497a275","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"2323.32px","left":"6764px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4a5dc19c-766d-462a-95b6-60b15658e933":{"$contentActions":[{"action":{"$id":"642b083e-914e-4603-b77f-5653c3abcea5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"42739401-1c49-4ea3-8d40-d310b13fae21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"42739401-1c49-4ea3-8d40-d310b13fae21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f11d16dc-201a-4769-b533-6620f2f1b030","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d7e9e2d5-0aa8-470b-b856-343e1c5efa55","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"d7e9e2d5-0aa8-470b-b856-343e1c5efa55","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ade84457-3f0c-4e5e-884e-b8c2c9bc1d7b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_288","$id":"73cbb258-28ea-43a1-9ff2-41b63d15579c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5f7bd682-ed76-41e5-9f97-f7bbf4b799b0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\t// Caso a mesma maquina possua mais de 1 assunto, ex: Smart tanto para Equipamento Reiniciando e Tela Reiniciando utilizar a variavel subAssunto ficando \"if(userInput === 'smart' && subAssunto === 'Equipamento Reiniciando')...\"\n\t\tif (userInput === 'Smart') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\t\t\t\n1° Mantenha o botão liga/desliga pressionado por 3 segundos.\n\n2° Se o modo avião estiver ativo: Desative-o e reinicie o equipamento. Ele voltará a funcionar normalmente.\n`\n\t\t}\n\t\tif (userInput === 'Move') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\nDesconecte a bateria e conecte-a novamente.`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e46d75f8-8961-4665-b746-fae319202d31","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c1c9f505-5a32-4af8-8b0c-e268de93f42b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-36ef7300-37de-40d3-a798-c4890d9f6944","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-eb311bf8-9916-46dd-b3aa-488360777b5c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4a5dc19c-766d-462a-95b6-60b15658e933","root":false,"$title":"[MS.6.5.2][MSG] Reinicialização","$position":{"top":"2564.35px","left":"7181.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"75f868ee-f775-4d6e-8c7d-e8315edf0847":{"$contentActions":[{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"fa4bbae8-f7ba-4b05-8c84-bd703cdd6b27","typeOfStateId":"state","$connId":"con_293","$id":"e596a57a-26f7-4ae3-8209-7b70be3018d2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, o equipamento travou no meio de um processamento?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f9499076-a2d7-4a23-b78e-827999b6fef8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-37a3da9a-6529-42f0-8b9a-27bfd2c39c5c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-81eab017-f65b-414f-be4f-8e9703c255ec","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-92a7333f-9edc-45d1-9134-cdf2cb8a5cb5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"75f868ee-f775-4d6e-8c7d-e8315edf0847","root":false,"$title":"[MS.6.6.0][MSG] POS travando","$position":{"top":"1367.55px","left":"7767.55px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fa4bbae8-f7ba-4b05-8c84-bd703cdd6b27":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"80842650-23df-4c88-b522-b3939ada67f4","typeOfStateId":"state","$connId":"con_298","$id":"87c6a4ad-3728-43c7-b981-fd3ad739bfbf","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d902dccd-9099-4c62-be74-7c835666d286","typeOfStateId":"state","$connId":"con_303","$id":"0d34cb8b-7a03-4514-a239-b586acce4adf","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"88f67449-b4c5-4b9a-963f-4c28bfea088c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"b79bf45b-4e09-4879-8e31-ccace8f31895","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7b00fb75-e077-4096-b5a7-ec3f814b230d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d726ce44-2f95-48f8-940b-0bf73bcf2f56","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-31b0feaf-759d-4cb2-b387-10703996562e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"fa4bbae8-f7ba-4b05-8c84-bd703cdd6b27","root":false,"$title":"[MS.6.6.0][INPUT] POS travando","$position":{"top":"1555.73px","left":"7768px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d902dccd-9099-4c62-be74-7c835666d286":{"$contentActions":[{"action":{"$id":"c7edad80-a823-4cbe-abd7-bc2ef0651949","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"30c19dae-3ccc-47c4-ad87-9e0963682ef8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o aparelho.","metadata":{}},"$cardContent":{"document":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o aparelho."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7053fa56-6018-4d7c-bf7d-23461b32f7b9","typeOfStateId":"state","$connId":"con_308","$id":"f89903d4-d4d7-4e7c-9c58-723cd29d1ce3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?  🤔\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e8646b62-a627-4ce1-81d3-268c38bb0939","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-da3ca3a7-2aff-43aa-9347-6eff903f5a32","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3e284136-9f79-4576-89da-c2e1acb0bc45","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-16b2e840-822f-47fe-a831-15de7c942189","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d902dccd-9099-4c62-be74-7c835666d286","root":false,"$title":"[MS.6.6.1][MSG] POS travando 2 instrução","$position":{"top":"2016px","left":"7674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7053fa56-6018-4d7c-bf7d-23461b32f7b9":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"76d93ebd-881e-4682-9989-0a698b111dcf","typeOfStateId":"state","$connId":"con_313","$id":"7f9f1ac7-0937-4b9f-ab6f-a9727787ea69","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"86806f3d-1dca-4a75-992a-358932a774b8","typeOfStateId":"state","$connId":"con_318","$id":"c375d7df-56a7-43d2-8f53-6e58ed2e0b3e","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d310e1ef-d914-416e-9d67-c832814b1aa8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"e17b607a-69cd-4b97-aef7-125f53ef7fb6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-eb28ed88-b073-4c72-b2b8-7c53756738ff","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-18ba2d54-e96e-46c5-ae31-f89e4a0f6f5c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0a252677-745a-4a9e-85e5-c680e1d96054","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7053fa56-6018-4d7c-bf7d-23461b32f7b9","root":false,"$title":"[MS.6.6.1][INPUT] POS travando 2 instrução","$position":{"top":"2364px","left":"7672.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"86806f3d-1dca-4a75-992a-358932a774b8":{"$contentActions":[{"action":{"$id":"3f853001-c982-41c5-897d-185cb67df129","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"72cd5f8b-e089-41dc-9387-10fe8162bd21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"72cd5f8b-e089-41dc-9387-10fe8162bd21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b682da27-37ce-4258-ab65-72dcff03c24c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b0c65704-1ae1-4e19-b756-bfd2657378f8","type":"text/plain","content":"Certo, vamos tentar atualizar.\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"b0c65704-1ae1-4e19-b756-bfd2657378f8","type":"text/plain","content":"Certo, vamos tentar atualizar.\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f1b0c231-d648-428b-a324-77e5bf617982","typeOfStateId":"state","$connId":"con_323","$id":"857f4512-08a7-4c90-92a3-d77f6bfef163","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?  🤔\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"95a8f162-d51d-413c-bbc5-d0157f5ba774","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d19c52ad-9bcd-49b3-bf86-59b3e1c22262","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3d4a663d-4cbd-46b1-82b0-8715c8a98628","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-69bf0f9e-d152-4f5b-96b6-650817a59459","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"86806f3d-1dca-4a75-992a-358932a774b8","root":false,"$title":"[MS.6.6.2][MSG] POS travando 3 instrução","$position":{"top":"2661px","left":"7672.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f1b0c231-d648-428b-a324-77e5bf617982":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"76d93ebd-881e-4682-9989-0a698b111dcf","typeOfStateId":"state","$connId":"con_328","$id":"955302d1-6333-40d0-bdaf-dc439da8075a","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"0da7e333-37dd-45c2-8d77-c272cffc8ae2","typeOfStateId":"state","$connId":"con_333","$id":"50e30f2c-cee3-4ddf-84b5-ce22dfe8e2dc","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"721dc388-3133-4fc8-9615-fb3c417d9cd4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"649b9096-61bf-4840-9b38-ecf3e62f1e41","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f5db7359-0e05-4f8a-b00d-259e552a24bf","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-151dd24a-9a17-4a5c-ba3c-d0d9dfc95e35","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-95eca3b1-e16a-44fd-b5ba-77b89f6b52d8","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f1b0c231-d648-428b-a324-77e5bf617982","root":false,"$title":"[MS.6.6.2][INPUT] POS travando 3 instrução","$position":{"top":"3148px","left":"7672.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0da7e333-37dd-45c2-8d77-c272cffc8ae2":{"$contentActions":[{"action":{"$id":"4e2b021f-7cc8-4fd4-bea5-3f7d7d83f91b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"07fa6cf4-2b5a-4123-afcd-ad33dac989aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"07fa6cf4-2b5a-4123-afcd-ad33dac989aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"147c5f18-430a-41d9-8329-63f17e391392","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2fb2e441-7f00-4fc0-aa4c-3cd32d5362e4","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\n1° Pressione o atalho 990.\n\n2° Em seguida, apague todos os arquivos.","metadata":{}},"$cardContent":{"document":{"id":"2fb2e441-7f00-4fc0-aa4c-3cd32d5362e4","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\n1° Pressione o atalho 990.\n\n2° Em seguida, apague todos os arquivos."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_338","$id":"b60d3600-a26c-4c1b-88a8-a1122992b2e3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O equipamento travou no meio de um processamento? 🤔\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4e57fbc4-7c42-4f9c-9e0f-27b8097e95c0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f700462a-3941-471e-94c1-649647a9d9c7","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0f155997-da4c-4bd2-8dd7-ab016d8386b2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4f09892a-382b-4ff7-9bc7-58f79f75811c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0da7e333-37dd-45c2-8d77-c272cffc8ae2","root":false,"$title":"[MS.6.6.3][MSG] POS travando 4 instrução","$position":{"top":"3147px","left":"7382.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"76d93ebd-881e-4682-9989-0a698b111dcf":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8ceb637d-6d0b-473a-bd2c-09eabac760be","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"76d93ebd-881e-4682-9989-0a698b111dcf","root":false,"$title":"[GO TO] Redirect to Finalização","$position":{"top":"2776px","left":"8199px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"704ba1d8-f466-4c8c-8e5d-843a53f45fbe":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"8b879571-dc70-4121-bcf1-19746d309ed3","typeOfStateId":"state","$connId":"con_343","$id":"88825009-f2d2-4681-8813-01dab08a4040","conditions":[{"source":"context","comparison":"equals","values":["Bateria fraca"],"variable":"userInput"},{"values":[],"source":"context","comparison":"exists","variable":"segundoAtendimentoBateriaFraca"}],"$invalid":false},{"stateId":"5c73495b-0ea3-440c-8c9b-0a5ae53bdb49","typeOfStateId":"state","$connId":"con_348","$id":"4f7796e5-e5cb-4139-b638-7bccc2f5045b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-99b2630d-3efc-422f-85bb-0937caac6b15","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a107038e-e064-46fa-9288-0f526582e673","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-01055a09-0235-41e0-916e-d0d332a1819f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a0aaf1bc-8f7d-4f7d-9f7e-c2d3f12060be","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"704ba1d8-f466-4c8c-8e5d-843a53f45fbe","root":false,"$title":"[MS.6.7.0][INPUT] Menu Bateria","$position":{"top":"1796.35px","left":"8303.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7bdc580c-ecf9-4f6c-9aa3-b16158ab7219":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"704ba1d8-f466-4c8c-8e5d-843a53f45fbe","typeOfStateId":"state","$connId":"con_353","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e867fd85-0ad6-4b1e-99df-71994eb60c45","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Bateria fraca\",\n\t\t\t\t\"description\": \"Bateria não segura carga\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Carregador\",\n\t\t\t\t\"description\": \"Problema com carregador\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Lembre-se: para garantir o bom funcionamento e a autonomia da bateria, é essencial utilizar *apenas* o *carregador original* que acompanha a máquina e sempre aguardar até 100% de carga antes de desconectar o carregador.\n\nToque no botão abaixo e selecione o motivo.`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7bdf2b7c-572d-43ba-93e4-36241df6c145","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-685c20fd-ccec-457f-8e28-e4fc9dbcdf3a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1061e20b-663c-47e3-ba4c-b5c3ea41905c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bbfb96d8-f571-4e7a-a77f-a9fb673e3960","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7bdc580c-ecf9-4f6c-9aa3-b16158ab7219","root":false,"$title":"[MS.6.7.0][MSG] Menu Bateria","$position":{"top":"1253px","left":"8302.59px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8b879571-dc70-4121-bcf1-19746d309ed3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8ca26c61-e538-44d0-a92f-f1be00bad11b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"8b879571-dc70-4121-bcf1-19746d309ed3","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1849px","left":"8053px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5c73495b-0ea3-440c-8c9b-0a5ae53bdb49":{"$contentActions":[{"action":{"$id":"35658236-4f5f-4eca-ac0d-39836e30679b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b995f318-5c8d-4f66-98f3-fe3a029266fe","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"01c70b32-e096-4e2a-82e8-9f764195fa81","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_358","$id":"45d2e78b-d7c2-4c88-a771-14fa225f4734","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c4f6078b-05dd-44fa-87b0-c33775a054f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (userInput === 'Bateria fraca') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (confirme com \"Sim\").\n\n5° Ative o terminal novamente.\n\n6° Pressione o atalho 993.\n\n7° Acompanhe a máquina até a carga atingir 100%.\n`\n\t\t}\n\t\tif (userInput === 'Carregador') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e aguarde 30 segundos.\n\n3° Recoloque a bateria e realize um novo teste com o carregador.\n\n4° Caso isso não resolva, teste com outro carregador e em outra tomada.\n`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5327d108-2d77-4491-84a7-afbba8de3ab3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"78bd3507-ba87-42d1-aaac-6e7385daf8f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"segundoAtendimentoBateriaFraca\" to \"48h\"","$invalid":false,"settings":{"variable":"segundoAtendimentoBateriaFraca","value":"true","expiration":172800},"conditions":[{"values":["Bateria fraca"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6d623820-bfd1-4ea8-8827-df7c07b12967","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f177cd53-c83f-4755-b49e-0f235b05baf6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e56d85d0-60bb-4c47-8040-6f28561e10ee","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-695de493-f4e7-42db-8dd1-b59b50f179f3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5c73495b-0ea3-440c-8c9b-0a5ae53bdb49","root":false,"$title":"[MS.6.7.1][MSG] Bateria","$position":{"top":"2075.35px","left":"8303.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a3585cdc-8039-46ad-adea-38491911c4c4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"a3585cdc-8039-46ad-adea-38491911c4c4","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2794px","left":"8787px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"db72de2b-8f60-4bb2-8191-6957300d488e":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"bcd3ab7a-ff38-47c7-ab44-58007db46c24","typeOfStateId":"state","$connId":"con_363","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e867fd85-0ad6-4b1e-99df-71994eb60c45","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Desliga ao imprimir\",\n\t\t\t\t\"description\": \"Impressão/Transação\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Impressão lenta\",\n\t\t\t\t\"description\": \"Equipamento imprime lentamente\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Instalação de bobina\",\n\t\t\t\t\"description\": \"Como instalar bobina\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Solicitar bobina\",\n\t\t\t\t\"description\": \"Como solicitar bobina\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual seria o motivo?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3a60886a-9452-4d2f-9640-e4fa007a6692","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-01f98ff7-a6e1-46f8-8720-c3386117a185","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d4246ef8-f4ea-45b9-ad6d-9eaa6db16a4f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-020deb8e-a1b0-443c-aa8a-311793691828","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"db72de2b-8f60-4bb2-8191-6957300d488e","root":false,"$title":"[MS.6.8.0][MSG] Menu Impressão","$position":{"top":"1178px","left":"8787px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bcd3ab7a-ff38-47c7-ab44-58007db46c24":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3ef48664-cbd0-49cc-9eef-ad2c3ee7fc74","typeOfStateId":"state","$connId":"con_368","$id":"5050403c-a9c4-4c19-8d82-2e517ba5b071","conditions":[{"source":"context","comparison":"equals","values":["Instalação de bobina"],"variable":"userInput"}],"$invalid":false},{"stateId":"b486fdc8-2791-43a1-adfd-12adbd00b1b8","typeOfStateId":"state","$connId":"con_373","$id":"4f7796e5-e5cb-4139-b638-7bccc2f5045b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b9ce547c-3c7a-49d0-8247-7f32a2623b1b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7f7e392c-152c-4bde-a025-8e73c60c2800","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-596ff8af-ec13-4955-85a7-5cf55d788409","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6a625cac-9110-4788-95a1-514fd098105e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"bcd3ab7a-ff38-47c7-ab44-58007db46c24","root":false,"$title":"[MS.6.8.0][INPUT] Menu Impressão","$position":{"top":"1811px","left":"8786px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b486fdc8-2791-43a1-adfd-12adbd00b1b8":{"$contentActions":[{"action":{"$id":"35658236-4f5f-4eca-ac0d-39836e30679b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b995f318-5c8d-4f66-98f3-fe3a029266fe","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"01c70b32-e096-4e2a-82e8-9f764195fa81","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_378","$id":"45d2e78b-d7c2-4c88-a771-14fa225f4734","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c4f6078b-05dd-44fa-87b0-c33775a054f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (userInput === 'Desliga ao imprimir') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n5° Ative o terminal novamente.\n\n°6 Pressione o atalho 993.\n`\n\t\t}\n\t\tif (userInput === 'Impressão lenta') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Verifique se há alguma peça danificada na tampa da bobina.\n\n2° Retire a bobina e substitua-a deixando um pouco de papel para fora.\n\n3° Pressione o atalho 995.\n\n4° Pressione o atalho 990.\n\n5° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n6° Ative o terminal novamente.\n\n7° Pressione o atalho 993.\n\n8° Realize uma venda de teste.\n`\n\t\t}\n\t\t\t\tif (userInput === 'Solicitar bobina') {\n\t\t\treturn `A bobina é solicitada pela prória máquina.\n\n1° Primeiro, cadastre a senha lojista.\n\n2° Aperte os três traços no canto superior esquerdo.\n\n3° Escolha menu > configurações > senha lojista ou alterar senha.\n\n4° Após configurar a senha, aperte os traços no canto superior esquerdo > menu> solicitar bobinas.\n`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"83762300-565d-4c37-b738-d0d7bbdd8f66","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"78bd3507-ba87-42d1-aaac-6e7385daf8f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"segundoAtendimentoBateriaFraca\" to \"48h\"","$invalid":false,"settings":{"variable":"segundoAtendimentoBateriaFraca","value":"true","expiration":172800},"conditions":[{"values":["Bateria fraca"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c11985d8-926a-4217-a45c-e28043a253b8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b334bcd3-f920-48d0-91d8-ffb811e38ce6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-295f988a-917c-43a0-8103-caec9a6c037e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-4e52e712-86a3-4d9b-a91a-47e2107485d2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b486fdc8-2791-43a1-adfd-12adbd00b1b8","root":false,"$title":"[MS.6.7.1][MSG] Impressão","$position":{"top":"2177.49px","left":"8786.79px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3ef48664-cbd0-49cc-9eef-ad2c3ee7fc74":{"$contentActions":[{"action":{"$id":"436e3891-145e-4d9f-8c88-31d0d71a07e3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"751fdef5-2627-49cc-9b09-6801b78e2743","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"751fdef5-2627-49cc-9b09-6801b78e2743","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2466ebbe-e53a-40d4-8765-069accebc36b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b2099b3a-88b7-47dd-afb0-73c817b149a7","type":"text/plain","content":"Confira na imagem abaixo, como instalar a bobina na sua máquina.👇","metadata":{}},"$cardContent":{"document":{"id":"b2099b3a-88b7-47dd-afb0-73c817b149a7","type":"text/plain","content":"Confira na imagem abaixo, como instalar a bobina na sua máquina.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"32efa4f3-f72e-4741-b663-74c38a344471","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cf642e9b-72a7-4b63-8c30-b4c3a11b9f52","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"cf642e9b-72a7-4b63-8c30-b4c3a11b9f52","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3e546048-05d0-4dd8-b29e-52d4b63fd7d4","$typeOfContent":"media","type":"SendMessage","settings":{"id":"83def372-dc0d-4561-ad0a-3295232df089","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_0b51f7b3-7408-4a41-909b-63ca0ef526c5","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"83def372-dc0d-4561-ad0a-3295232df089","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_0b51f7b3-7408-4a41-909b-63ca0ef526c5","aspectRatio":"1:1"},"metadata":{}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0ecd8658-78fc-4259-96bd-3c6cf817d947","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"2fae25a1-3fbb-44c0-9081-6578edc9985e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"39d927de-14c2-4d37-9e4d-c5b103569501","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"39d927de-14c2-4d37-9e4d-c5b103569501","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_383","$id":"37a5b3cb-d9e6-4ce7-b045-de33ad849018","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"664b3231-fa8b-453a-96b6-ca8fcd408335","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fc8e21f2-c392-454b-a608-012730d89e10","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3b1ae09c-0433-43b6-8c6a-6c978ba1dbd2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3ef48664-cbd0-49cc-9eef-ad2c3ee7fc74","root":false,"$title":"[MS.6.7.2][IMG] Instalação de bobina","$position":{"top":"1799px","left":"9070px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0dde7099-56bd-4590-abff-25c9a550991e":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f5c51002-8158-425a-b3de-80628270cb57","typeOfStateId":"state","$connId":"con_388","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e867fd85-0ad6-4b1e-99df-71994eb60c45","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"MP05 Bluetooth\",\n\t\t\t\t\"description\": \"Aparece somente opção USB\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"D175 Bluetooth\",\n\t\t\t\t\"description\": \"Aparece somente opção USB\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Entendi, e qual é o modelo da sua máquina?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Motivo\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b4b33907-63b6-4474-837e-086e82327b89","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a871cb46-9247-4a2c-ab7a-09a6d73247ce","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3943da67-a169-4282-9be9-e8b182bfa736","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-68a2aeb8-69f1-4dde-8c00-4e560a7b0f4c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0dde7099-56bd-4590-abff-25c9a550991e","root":false,"$title":"[MS.6.9.0][MSG] Menu USB","$position":{"top":"1086px","left":"9550px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f5c51002-8158-425a-b3de-80628270cb57":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"9b44bed9-fbe4-4523-917b-ea0b4ba59d45","typeOfStateId":"state","$connId":"con_393","$id":"02ac17dc-d279-41b8-9dd2-e34ca8064ec0","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"82d0f38a-e465-495b-bde0-a928fa3c9147","typeOfStateId":"state","$connId":"con_398","$id":"4f7796e5-e5cb-4139-b638-7bccc2f5045b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0a338995-901c-4088-a9c6-f70554aed7b1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b41af595-abac-4fa4-b3ff-f2c4654112c7","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-a6b7b308-12a1-4fba-b8e2-a1ebb2f4818b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-aa1c3974-c7bb-4503-ab88-2059f72a03b9","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f5c51002-8158-425a-b3de-80628270cb57","root":false,"$title":"[MS.6.9.0][INPUT] Menu USB","$position":{"top":"1795.5px","left":"9549.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"82d0f38a-e465-495b-bde0-a928fa3c9147":{"$contentActions":[{"action":{"$id":"35658236-4f5f-4eca-ac0d-39836e30679b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b995f318-5c8d-4f66-98f3-fe3a029266fe","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"01c70b32-e096-4e2a-82e8-9f764195fa81","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_403","$id":"45d2e78b-d7c2-4c88-a771-14fa225f4734","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c4f6078b-05dd-44fa-87b0-c33775a054f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (userInput === 'MP05 Bluetooth') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Desbloqueie o equipamento pressionando a tecla liga e desliga.\n\n2° Pressione uma vez o botão amarelo.\n\n3° Pressione duas vezes o botão verde.\n\n4° Aparecerá a mensagem \"Configuração de senha de acesso\".\n\n5° Digite a senha: 555555.\n\n6° Selecione a opção comunicação bluetooth.\n`\n\t\t}\n\t\tif (userInput === 'D175 Bluetooth') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Ligue o equipamento.\n\n2° Pressione sequencialmente Limpa > Entra > Anula.\n\n3° Insira a senha de acesso: 555555.\n\n4° Selecione a opção “Comunicação bluetooth”.\n\n5° A mensagem \"Comunicação Bluetooth ativada\" será exibida.\n\n6° Pressione anula e em seguida 0.\n`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}\n","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ac672394-b43c-4508-9360-7d3f61e36ca1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"78bd3507-ba87-42d1-aaac-6e7385daf8f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"segundoAtendimentoBateriaFraca\" to \"48h\"","$invalid":false,"settings":{"variable":"segundoAtendimentoBateriaFraca","value":"true","expiration":172800},"conditions":[{"values":["Bateria fraca"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-123bbb51-7a65-4333-af58-b7988259a9c6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-214dfa09-f893-4bc8-a47a-aa490acce1b4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e3b784bb-2d2b-4551-9844-2b8d43c84a10","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6a129a1e-4053-45ac-b058-b8082fa39ebf","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"82d0f38a-e465-495b-bde0-a928fa3c9147","root":false,"$title":"[MS.6.9.1][MSG] USB","$position":{"top":"2074.5px","left":"9549.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9b44bed9-fbe4-4523-917b-ea0b4ba59d45":{"$contentActions":[{"action":{"$id":"cfb3bcbb-7e1b-4a9a-b61a-36f968a288c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c7f0acbb-6a8b-49b4-987b-84c673ffb7ab","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c7f0acbb-6a8b-49b4-987b-84c673ffb7ab","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e0104d7-6a8d-4559-8ae4-0c224e8d216d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"baf03040-5091-4fc2-95d3-45bd4c0b68c9","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"baf03040-5091-4fc2-95d3-45bd4c0b68c9","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"68ae6232-fa34-42b4-a347-89aa668c385b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-203861d7-208f-4ae2-91c2-c902508d5b01","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9b44bed9-fbe4-4523-917b-ea0b4ba59d45","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1784px","left":"9324px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6c943cf9-ee58-4067-a079-7bdd0c20b21c":{"$contentActions":[{"action":{"$id":"18606df4-0b7a-42b9-a383-dcf17c8c57a7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"deb2653d-6e87-47f1-953c-6c74fe9e6246","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"deb2653d-6e87-47f1-953c-6c74fe9e6246","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"209027a3-c52b-46d9-a77f-780eca42ae8a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9a8c163b-4195-43da-9cc5-a2a676102d14","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n3° Ative o terminal novamente.\n\n4° Realize uma venda de teste.","metadata":{}},"$cardContent":{"document":{"id":"9a8c163b-4195-43da-9cc5-a2a676102d14","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n3° Ative o terminal novamente.\n\n4° Realize uma venda de teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6e4e0ea0-6d2b-45c7-99bb-7e5fa65ae094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"5f4a5491-d20a-47dd-b5f1-39f15cef7df1","typeOfStateId":"state","$connId":"con_408","$id":"9b00b5bc-cb24-4310-8df9-2387922db2c4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"99e18fd7-6b78-4aba-b6ca-072b2aaa9c4b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-672e0940-9d9b-488f-99cd-2ce62ed06ddd","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8799c56d-aa3c-4b9d-aab9-c469d6897bd9","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6c943cf9-ee58-4067-a079-7bdd0c20b21c","root":false,"$title":"[MS.6.10.0][MSG] Aplicação com problema","$position":{"top":"985.46px","left":"9914.17px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"68a1f11d-7db3-4163-aee5-05d12419d448":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"69b29d3d-3c1b-46c1-a7c2-f6e5c7d57bb9","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"68a1f11d-7db3-4163-aee5-05d12419d448","root":false,"$title":"[GO TO] Finalização","$position":{"top":"2334.59px","left":"6021.76px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"732efa55-d798-4f04-acb5-c306c0ebd203":{"$contentActions":[{"action":{"$id":"f95f3cfc-ffd1-4582-8c8e-728461044c7e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"44544660-4f1b-4f54-8595-2f1065a385b1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"44544660-4f1b-4f54-8595-2f1065a385b1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"59961218-785c-4ffc-bebb-0e690d313b96","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fff5c3d0-1095-433e-b6c2-fd3192cf2471","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"fff5c3d0-1095-433e-b6c2-fd3192cf2471","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"aa561499-e224-4dc2-a660-98a32a64ab6b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-004564e6-cfe7-426f-bef0-bcc967160f47","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"732efa55-d798-4f04-acb5-c306c0ebd203","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"3469px","left":"5374px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"082428ef-bfa6-4828-9e9f-d64787844ea5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5a5d6d96-c921-4e51-9d3b-5dbbb69acb28","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"082428ef-bfa6-4828-9e9f-d64787844ea5","root":false,"$title":"[GO TO] Finalização","$position":{"top":"3483px","left":"5926px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1337352b-12ff-49c0-9fe2-10883e6e0862":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ff08e673-15cb-4cef-b706-4c9652c266ac","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"1337352b-12ff-49c0-9fe2-10883e6e0862","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"2514px","left":"4970.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"db7da12e-ee1a-4614-9e43-e78c3c1432eb":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"53ecccb3-e087-49da-8667-d20438985d9a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"b0e87449-cedc-4403-99b9-f0a312c926bd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Whatsapp PJ ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"Suporte Tecnico\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\t// stateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d2de91b7-360e-4cfa-933f-0a4c0d2c685d","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]}],"$leavingCustomActions":[{"$id":"899b0fcf-a95a-42db-ab36-2b708dd3f4c9","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"Suporte Tecnico"},"address":"WhatsApp PJ"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-818ef309-da75-4f94-9bea-57fab659c327","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ebd4dc1a-a6ad-4c83-8644-793c4cdadbe6","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-319d3625-b5db-4678-914a-b9f7f0b5f613","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","root":false,"$title":"[Redirect] to WhatsApp PJ (Suporte Tecnico)","$position":{"top":"237px","left":"1399.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f0a8601f-5de1-4885-9b44-4f4a6e062c01":{"$contentActions":[{"action":{"$id":"e20e7f76-2c05-41e7-9ab4-52f715d23634","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8fddfe5b-92fa-4931-9029-f21bb1d652dc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8fddfe5b-92fa-4931-9029-f21bb1d652dc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e117627b-0a82-4ad3-9e69-7b9c4eae8999","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e66cc141-dc61-4ced-a46a-c57b82f9c75d","type":"text/plain","content":"<b>Importante</b>: Esta opção é destinada apenas para <b>Transações não autorizadas</b>.\n\nPara problemas com o <b>Token</b> ou <b>Senha</b>, entre em contato com a central de atendimento no número: (11) 3175-8248 \n\nNo caso de <b>cobranças indevidas</b>, digite <b>Menu inicial</b> e selecione:\nMáquina Safrapay> Condições e Taxas> Questionar uma cobrança.\n","metadata":{}},"$cardContent":{"document":{"id":"e66cc141-dc61-4ced-a46a-c57b82f9c75d","type":"text/plain","content":"<b>Importante</b>: Esta opção é destinada apenas para <b>Transações não autorizadas</b>.\n\nPara problemas com o <b>Token</b> ou <b>Senha</b>, entre em contato com a central de atendimento no número: (11) 3175-8248 \n\nNo caso de <b>cobranças indevidas</b>, digite <b>Menu inicial</b> e selecione:\nMáquina Safrapay> Condições e Taxas> Questionar uma cobrança.\n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"73c534ee-e740-472a-9918-ee93b813731b","typeOfStateId":"state","$connId":"con_413","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Débito\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Crédito\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"PIX\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Boleto\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"5\",\n\t\t\t\t\"title\": \"TED\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"6\",\n\t\t\t\t\"title\": \"Tributos\",\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, primeiro selecione no menu abaixo qual o tipo de transação.👇`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ed3f536c-f4dc-4ec4-bbe0-25ec0cf14b72","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"44c7c0da-61f2-48d0-9207-fed517685d9b","$typeOfContent":"","type":"SetVariable","$title":"Set \"transacoesNaoAutorizadas\" to \"\"","$invalid":false,"settings":{"variable":"transacoesNaoAutorizadas"},"conditions":[]},{"$id":"1fbd62f2-f214-4830-91de-2f440c5dbb9f","$typeOfContent":"","type":"SetVariable","$title":"Set \"nrTransacao\" to \"1\"","$invalid":false,"settings":{"variable":"nrTransacao","value":"1"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8b2425c3-841c-435a-9b11-f4ee3c8cde76","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8b1f6a53-e1a3-4b33-830e-572df0c02016","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9c7c9a57-605a-4512-90ad-5f4f8c51a648","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-516258fd-20f6-435f-af0a-63a2e7d27a3f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f0a8601f-5de1-4885-9b44-4f4a6e062c01","root":false,"$title":"[MS.7.0.1][MSG] Menu Transação não autorizada","$position":{"top":"55px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"73c534ee-e740-472a-9918-ee93b813731b":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"f8513f95-73e1-475b-957b-92397d444711","typeOfStateId":"state","$connId":"con_418","$id":"59b97e43-5e8c-4764-b4fe-820d64a7a4bb","conditions":[{"source":"context","comparison":"equals","values":["Débito"],"variable":"userInput"}],"$invalid":false},{"stateId":"08dc8989-b270-4fe0-827a-2169d261976b","typeOfStateId":"state","$connId":"con_423","$id":"9c8843e7-ce0c-4cff-bb26-c69c15205996","conditions":[{"source":"context","comparison":"equals","values":["Crédito"],"variable":"userInput"}],"$invalid":false},{"stateId":"53a02ba6-82b0-47a1-841c-0d320c69c82a","typeOfStateId":"state","$connId":"con_428","$id":"2cdb606a-0473-4f8b-ad89-144280dd8150","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"58714c55-3bde-4fcf-93ba-c78441038857","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivo\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"motivo","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"75e24a21-6a54-4507-8b5a-81b94ac89f94","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivoProtocolo\" to \"transacaoNaoAutorizadaIBouApp\"","$invalid":false,"settings":{"variable":"motivoProtocolo","value":"transacaoNaoAutorizadaIBouApp"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3c1bd975-c7a2-493d-b4ac-49af2f790c2f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bc3c4c1e-e1c5-4e31-a0eb-e347db5ed980","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-cf6be4ab-51e1-4d79-8b72-839224eea81e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3b4e7e7e-4424-4e69-9abb-f31064f1db4d","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"73c534ee-e740-472a-9918-ee93b813731b","root":false,"$title":"[MS.7.0.1][INPUT] Menu Transação não autorizada","$position":{"top":"387px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f8513f95-73e1-475b-957b-92397d444711":{"$contentActions":[{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a335ba2c-017d-47e8-8a10-c13ef581450e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f3d9d8f0-1d78-4d5d-9d0a-a1b643f7fe11","type":"text/plain","content":"Primeiro selecione o motivo nas opções abaixo.👇","metadata":{}},"$cardContent":{"document":{"id":"f3d9d8f0-1d78-4d5d-9d0a-a1b643f7fe11","type":"text/plain","content":"Primeiro selecione o motivo nas opções abaixo.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"38ccfbf5-e5d7-4291-bf70-edbda47dbe10","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d489c5ab-89c9-4aea-985f-0dea8c73e6b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d489c5ab-89c9-4aea-985f-0dea8c73e6b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8b8bf51d-3cea-454c-bf9c-68ed4014777e","typeOfStateId":"state","$connId":"con_433","$id":"e596a57a-26f7-4ae3-8209-7b70be3018d2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Não Autorizada\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não Reconhecida\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = '*1. Não Autorizada:* Você tentou utilizar o cartão e apareceu a mensagem de transação não autorizada ou a mensagem \"059 - Contate a central do seu cartão\\n\\n*2. Não Reconhecida:* Você não reconhece alguma transação realizada no débito. \"';\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7e8c6315-0052-4777-8c8f-c88b80f216f3","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivoProtocolo\" to \"transacaoNaoAutorizadaDebito\"","$invalid":false,"settings":{"variable":"motivoProtocolo","value":"transacaoNaoAutorizadaDebito"},"conditions":[]},{"$id":"9fb4a215-18f5-4bfa-8cd5-074133771e8c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c5142bb3-f00a-4603-ace2-fd2d4737d6d8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a77505b3-b82a-4de5-ae77-4da85ecc5011","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-80e61e11-e3cf-4a4a-a25b-8e610fe97f83","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f95efe49-f921-47ee-889c-2d46bbd8aad3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f8513f95-73e1-475b-957b-92397d444711","root":false,"$title":"[MS.7.1.0][MSG] Débito (motivo)","$position":{"top":"399px","left":"3812px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8b8bf51d-3cea-454c-bf9c-68ed4014777e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"53a02ba6-82b0-47a1-841c-0d320c69c82a","typeOfStateId":"state","$connId":"con_438","$id":"64ff39a2-403c-4bff-a326-5955bdfa492a","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n\tconst posicoes = {\n\t\t\"1\": \"primeir[oa]|u[mn]\",\n\t\t\"2\": \"segund[ao]|do[ie]s\",\n\t\t\"3\": \"terceir[ao]|tr[eê]s\",\n\t\t\"4\": \"quart[ao]|[qc]uat(r)?o\",\n\t\t\"5\": \"quint[ao]|[sc]inc[ou]\",\n\t\t\"6\": \"sext[ao]|[sc]inc[uo]\",\n\t\t\"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n\t\t\"8\": \"oitav[ao]|oit[ou]\",\n\t\t\"9\": \"non[ao]|nov[ei]\",\n\t\t\"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n\t}\n\ttry {\n\t\tif (!inputUsuario) return 'inatividade'\n\t\tconst regexDictionary = {}\n\t\tconst { buttons } = JSON.parse(dynamicContent).interactive.action\n\t\tbuttons.forEach((button, index) => {\n\t\t\tconst key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n\t\t\tregexDictionary[key] = button.reply.title\n\t\t})\n\t\tfor (let regex in regexDictionary) {\n\t\t\tif (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n\t\t\t\treturn regexDictionary[regex]\n\t\t\t}\n\t\t}\n\t\treturn 'input inesperado'\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1c2b585c-3581-4370-acf8-10cf776dfd12","$typeOfContent":"","type":"SetVariable","$title":"Set \"debitoMotivo\" to \"userInput\"","$invalid":false,"settings":{"variable":"debitoMotivo","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"61b4d786-28c7-4b2e-8aef-a681b33e359f","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"14103380-83e7-423c-bba2-e340be8d5cff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"29819d1a-16d8-4b67-812a-32bba8716f20","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e78f3600-123b-4503-90ae-e2d3b02e8865","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8cd1d3a2-fae1-4dc6-97a4-f81cc53f199d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-1ce9199c-0d2b-49e8-a753-e67a46e73c71","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0827aa16-f749-4d16-ad35-f9fdb0c4f55c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"8b8bf51d-3cea-454c-bf9c-68ed4014777e","root":false,"$title":"[MS.7.1.0][INPUT] Débito (motivo)","$position":{"top":"770px","left":"3812px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"08dc8989-b270-4fe0-827a-2169d261976b":{"$contentActions":[{"action":{"$id":"9d93483e-b7eb-499e-81e9-afda9216b885","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c4ca2590-60d8-4e88-8c5f-8b852f3327bc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c4ca2590-60d8-4e88-8c5f-8b852f3327bc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"49fc5493-d7fb-4437-b0f4-e2159f567a59","$typeOfContent":"text","type":"SendMessage","settings":{"id":"795e1c91-fa69-41df-b5a8-d1e802ccf0b4","type":"text/plain","content":"Nesse caso, pedimos que entre em contato com a Central de Cartões nos seguintes números.👇\n\n(11) 4001-4460 (Capital e Grande São Paulo) \n0800 728-4460 (para outras localidades)  \n24h, 7 dias por semana. \n ","metadata":{}},"$cardContent":{"document":{"id":"795e1c91-fa69-41df-b5a8-d1e802ccf0b4","type":"text/plain","content":"Nesse caso, pedimos que entre em contato com a Central de Cartões nos seguintes números.👇\n\n(11) 4001-4460 (Capital e Grande São Paulo) \n0800 728-4460 (para outras localidades)  \n24h, 7 dias por semana. \n "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2610844b-68a7-4a9b-bb0b-479c78ac6d0a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e335ceac-e744-405a-8be6-573e70ef7fc2","typeOfStateId":"state","$connId":"con_443","$id":"001ac4d0-b729-4d9f-8c8e-2d46b580d2b9","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e5fbef2d-b090-49e9-b1b7-604cf81b2d09","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-69ae8baa-e55a-4e88-8baf-c93d1a0b900a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a9f4a561-0aef-408a-b1f9-a4ddb50915a0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"08dc8989-b270-4fe0-827a-2169d261976b","root":false,"$title":"[MS.7.1.1][MSG] Credito","$position":{"top":"399px","left":"4507px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"53a02ba6-82b0-47a1-841c-0d320c69c82a":{"$contentActions":[{"action":{"$id":"ec0162d3-ea99-4dfb-9369-db95af1bee47","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e3beb374-e593-46e4-8793-6b1499d512fe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e3beb374-e593-46e4-8793-6b1499d512fe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b1f1183d-4ed7-4cea-a61b-94c6e70c2cf5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"cf630d4f-6445-4d12-85a0-16c8ddb89439","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"cf630d4f-6445-4d12-85a0-16c8ddb89439","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7102288f-f1d0-4ff5-8b94-555b70dd18be","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"39adec87-0ee9-4b29-83e0-1dd7073c8b1e","typeOfStateId":"state","$connId":"con_448","$id":"fdb80a4a-e789-4aa1-84cc-eaceb551217c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"976801af-d478-4326-8000-5775d8218436","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(debitoMotivo) {\n\ttry {\n\t\tif (debitoMotivo) {\n\t\t\treturn `Por gentileza, informe a quantidade de transações *${debitoMotivo || 'negadas'}*.\n\nPor exemplo, se foram quatro transações, digite apenas: *4*`\n\t\t}\n\t\treturn `Por gentileza, informe a quantidade de transações *negadas*.\n\nPor exemplo, se foram quatro transações, digite apenas: *4*`\n\t} catch (err) {\n\t\treturn `Por gentileza, informe a quantidade de transações *negadas*.\n\nPor exemplo, se foram quatro transações, digite apenas: *4*`\n\t}\n}","inputVariables":["debitoMotivo"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3e44f113-d491-4879-ba2e-d67b6e93e4b4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b03baa4a-00af-45c5-bb2b-0c4416100c2c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-57970216-4c68-4a3b-85c9-b947828e1183","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-93329262-7d24-4853-88be-2b3e95b93a60","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"53a02ba6-82b0-47a1-841c-0d320c69c82a","root":false,"$title":"[MS.7.2.0][MSG] Quantidade de transações","$position":{"top":"759px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"39adec87-0ee9-4b29-83e0-1dd7073c8b1e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"33800b2b-616d-4ee0-97b9-90d0a3b9ec16","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562","typeOfStateId":"state","$connId":"con_453","$id":"1e106c14-a970-4aaf-9d58-d87f10332598","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"530ac6ca-a843-4e64-ae8c-ece2e150a466","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (!userInput) {\n\t\t\treturn 'inatividade'\n\t\t}\n\t\tif (isNaN(userInput)) {\n\t\t\treturn 'input inesperado'\n\t\t}\n\t\treturn userInput\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f6c3d10e-5cf7-43cb-81bd-a63678b71cd3","$typeOfContent":"","type":"SetVariable","$title":"Set \"quantidade\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"quantidade","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"24866702-1f1e-47eb-b9da-a6beeef3d1f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"nrTransacao\" to \"1\"","$invalid":false,"settings":{"variable":"nrTransacao","value":"1"},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"nrTransacao"}]},{"$id":"5b18af91-de74-49c2-b9b1-c0c01c010ac6","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"MS.7.2.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.7.2.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"43aa61ec-997b-4819-a58f-d869cc8fef14","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"14433f83-fd76-4fda-b4bd-014f7fde89f1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e6a07459-75ce-4005-ace1-81f54381de15","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2f5a0804-fcc7-4ece-8cd4-5f80564721aa","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8acdd028-d4dd-40bb-8b35-ced26e2bc806","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0a5b8ec3-5be1-4d1a-b630-e503748a2cae","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"39adec87-0ee9-4b29-83e0-1dd7073c8b1e","root":false,"$title":"[MS.7.2.0][INPUT] Quantidade de transações","$position":{"top":"1054px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562":{"$contentActions":[{"action":{"$id":"4a9a46df-1ba2-4ec0-8082-25541ccee5a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5eb7aae8-22ed-44c5-86df-f59933232f30","$typeOfContent":"text","type":"SendMessage","settings":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"14e7e86d-d28d-4dcb-b463-a4227097faa5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"53edb4c4-13d3-462e-84a4-0339423c3e5f","typeOfStateId":"state","$connId":"con_458","$id":"6dfd6a45-e81f-4de7-aca8-55837bb486a6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"41a8e8c8-b7aa-485f-8572-9590ba681d9d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"function run(nrTransacao, quantidade) {\n\ttry {\n\t\tif (quantidade > 1) {\n\t\t\treturn `Certo, agora informe a data da ${nrTransacao}ª transação.\n\nComo neste exemplo:\n👉 07/04/2024`\n\t\t}\n\t\treturn `Certo, agora informe a data da transação.\n\nComo neste exemplo:\n👉 07/04/2024`\n\t} catch (err) {\n\t\treturn `Certo, agora informe a data da transação.\n\nComo neste exemplo:\n👉 07/04/2024`\n\t}\n}","inputVariables":["nrTransacao","quantidade"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"81efb074-c1c0-47bb-8be1-c8e5443824ec","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b95974d5-dd85-49f6-99ba-8ee7995aa2c8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ea35102b-05ab-40b5-9c66-75620ab46ed4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2f850cd6-a310-4c28-8603-43f79bc89c4b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562","root":false,"$title":"[MS.7.2.1][MSG] Data das transações","$position":{"top":"1322px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"53edb4c4-13d3-462e-84a4-0339423c3e5f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"6c049c5b-1cf2-4c61-89e0-9fa0e1ca9e12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"19d44d4c-a7a3-4456-8481-05c7d1410a6d","typeOfStateId":"state","$connId":"con_463","$id":"b63ef83f-cca2-477f-a1d3-b11aab2d0ff2","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f4d5dcea-6e27-42bc-bf84-0ad81308e107","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function validaData(data) {\n  if (!/^(\\d{2})[-/](\\d{2})[-/](\\d{4})$/.test(data)) {\n    return false;\n  }\n\n  const [dia, mes, ano] = data.split(/[-/]/).map(Number);\n\n  if (ano < 1000 || ano > 3000 || mes < 1 || mes > 12)\n    return false;\n\n  let diaMaximo;\n  switch (mes) {\n    case 4:\n    case 6:\n    case 9:\n    case 11:\n      diaMaximo = 30;\n      break;\n    case 2:\n      if ((ano % 4 === 0 && ano % 100 !== 0) || ano % 400 === 0)\n        diaMaximo = 29;\n      else\n        diaMaximo = 28;\n      break;\n    default:\n      diaMaximo = 31;\n  }\n\n  return dia > 0 && dia <= diaMaximo;\n}\n\nfunction run(input) {\n  if (!input) return 'inatividade'\n  try {\n    if (validaData(input)) {\n      return input\n    }\n    return 'input inesperado'\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"8cfb9434-fb93-4032-a9a1-644ec4b6e54c","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"MS.7.2.1\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.7.2.1"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"03db998d-bcf3-483b-9e85-3a18b3fa783a","$typeOfContent":"","type":"SetVariable","$title":"Set \"dataTransacao\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"dataTransacao","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"7a3da56a-dad1-45a4-952e-19e8a536d754","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"31fde080-94e2-4bf5-8369-3a4ace100b30","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5c392d82-b0b6-4ee9-828d-2c92152662d7","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b5b38ce4-0263-4636-9151-c693453e28f7","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-fab1326c-8719-446d-bfbc-16dbbabb4387","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c3ed155f-d1f5-4072-94a5-8c4bc766403d","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"53edb4c4-13d3-462e-84a4-0339423c3e5f","root":false,"$title":"[MS.7.2.1][INPUT] Data das transações","$position":{"top":"1585px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e9f10301-fc17-4518-8962-3c6960f66960":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"6c049c5b-1cf2-4c61-89e0-9fa0e1ca9e12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"0b7b93d1-cace-4366-bd46-782e761cc2a0","typeOfStateId":"state","$connId":"con_468","$id":"fdf06359-85eb-4694-a8ba-30d61542fa30","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"75557844-43bf-42f9-bd9d-7cab785bae50","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n\tif (!userInput) return 'inatividade'\n\ttry {\n\t\tconst regex = /^([01]?[0-9]|2[0-3])[h:][0-5][0-9]$/i;\n\n\t\tconst horarioValido = regex.test(userInput);\n\t\tif (horarioValido) {\n\t\t\treturn userInput.toLowerCase().replace('h', ':')\n\t\t}\n\t\treturn 'input inesperado'\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a67a078b-9a2e-4c57-964f-13cc878a82bf","$typeOfContent":"","type":"SetVariable","$title":"Set \"horarioTranscao\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"horarioTransacao","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"42fcaab1-a61f-48fc-bdee-95e6af6b6a39","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"hora\"","$invalid":false,"settings":{"variable":"exceptionType","value":"hora"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"e35566dc-48eb-4e9c-bfb5-d6333379ba00","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0a39895e-4378-42a0-a8d7-1bab3706e563","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-719bc191-eec8-4019-8d21-239c14d4cfb8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ba5fd7e5-4569-4678-a675-ec36a9ea9381","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-d1b24e7d-4819-4b2f-b01a-881500d13cae","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d4b9a5c7-743f-4817-b4c1-f56941bef053","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e9f10301-fc17-4518-8962-3c6960f66960","root":false,"$title":"[MS.7.2.2][INPUT] Horario das transações","$position":{"top":"2063px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"19d44d4c-a7a3-4456-8481-05c7d1410a6d":{"$contentActions":[{"action":{"$id":"4a9a46df-1ba2-4ec0-8082-25541ccee5a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5eb7aae8-22ed-44c5-86df-f59933232f30","$typeOfContent":"text","type":"SendMessage","settings":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Certo, informe o horário em que ocorreu a transação.\n\nComo neste exemplo:\n 👉 9:00","metadata":{}},"$cardContent":{"document":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Certo, informe o horário em que ocorreu a transação.\n\nComo neste exemplo:\n 👉 9:00"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"14e7e86d-d28d-4dcb-b463-a4227097faa5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e9f10301-fc17-4518-8962-3c6960f66960","typeOfStateId":"state","$connId":"con_473","$id":"6dfd6a45-e81f-4de7-aca8-55837bb486a6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0c3a234b-fd87-4a39-b093-f26018e7ed35","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-99c992ab-37af-48ec-b2e2-9c414d8f4a00","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-97b86714-b4f4-4160-b3f5-7add07282a8b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"19d44d4c-a7a3-4456-8481-05c7d1410a6d","root":false,"$title":"[MS.7.2.2][MSG] Horario das transações","$position":{"top":"1812px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b941efff-bd3d-45d1-a364-36e348a318ca":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"6c049c5b-1cf2-4c61-89e0-9fa0e1ca9e12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"78dfeca4-2819-4b41-a6ca-281834d77a89","typeOfStateId":"state","$connId":"con_478","$id":"e684a7ef-3a86-4514-89b2-906e9b3329b5","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"e7397ea5-e0cb-4a2c-b473-5e8a62d09d97","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado';\n  try {\n      if (!inputUsuario) {\n          return 'inatividade';\n      }\n\n      let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi;\n      let validInput = new RegExp(regex).test(inputUsuario);\n\n      if (validInput) {\n          return \"É um valor válido\";\n      }\n      return invalidInputMessage;\n  } catch (err) {\n      return invalidInputMessage;\n  }\n}\n","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"44562c08-7038-473c-9d49-d9d67c73098b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"valorTransacao\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\t// let salesValue = input.replace('.', '').replace(',', '.')\n\t\treturn input;\n\t}\n\tcatch(err){\n\t\treturn false\n\t}\n}","inputVariables":["input.content"],"outputVariable":"valorTransacao","LocalTimeZoneEnabled":false},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"62f9baff-9498-4587-a528-5a50167bca5a","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"valor\"","$invalid":false,"settings":{"variable":"exceptionType","value":"valor"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"6cf65f23-ab23-46c8-866b-9273ad91a7f0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"b2856156-08b5-413f-bb72-3110a3706c26","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1338a14f-5a3b-4bbb-8b1f-dc4504ff7f19","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b903dfb9-8551-43c0-8a0a-b569f38da902","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-44b4873c-fbf7-4252-8757-ac999ed966a6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5a38acd6-d4ef-4895-a9ae-c4e199de7f2f","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b941efff-bd3d-45d1-a364-36e348a318ca","root":false,"$title":"[MS.7.2.3][INPUT] Valor das transações","$position":{"top":"2632px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0b7b93d1-cace-4366-bd46-782e761cc2a0":{"$contentActions":[{"action":{"$id":"4a9a46df-1ba2-4ec0-8082-25541ccee5a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5eb7aae8-22ed-44c5-86df-f59933232f30","$typeOfContent":"text","type":"SendMessage","settings":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Por último, informe qual o valor da transação.\n\nDigite exatamente como no exemplo abaixo. \n\n👉 300,00","metadata":{}},"$cardContent":{"document":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Por último, informe qual o valor da transação.\n\nDigite exatamente como no exemplo abaixo. \n\n👉 300,00"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"14e7e86d-d28d-4dcb-b463-a4227097faa5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b941efff-bd3d-45d1-a364-36e348a318ca","typeOfStateId":"state","$connId":"con_483","$id":"6dfd6a45-e81f-4de7-aca8-55837bb486a6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"85f7cb42-180c-41bb-8803-efd48076e288","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1bc2d1dc-58d5-4903-9de2-eb1ef5650399","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a785985f-ab0b-401b-b574-6948d5485fc5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0b7b93d1-cace-4366-bd46-782e761cc2a0","root":false,"$title":"[MS.7.2.3][MSG] Valor das transações","$position":{"top":"2356px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"78dfeca4-2819-4b41-a6ca-281834d77a89":{"$contentActions":[{"action":{"$id":"096f4f12-6977-4d4f-a9ff-93e56528cc78","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"836f86c2-8b8e-4e4b-add0-c577ac4d95f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"836f86c2-8b8e-4e4b-add0-c577ac4d95f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"07398d6f-003a-44e6-a44f-c94dd3f9518c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1f1bee41-bc63-4a84-81d8-ca0393313f28","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"1f1bee41-bc63-4a84-81d8-ca0393313f28","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"cb395e28-8a99-4765-967d-b3dbf6972e30","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"db9f721c-ae8f-4559-a3c8-83c5a0f1a146","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"db9f721c-ae8f-4559-a3c8-83c5a0f1a146","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2b2ed92c-0493-4472-a2f0-1b0fe0592186","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"61685ad9-bbba-4a79-b141-938779902b12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b6fbea89-9880-45f1-bcb8-9431423e4dfc","typeOfStateId":"state","$connId":"con_488","$id":"99415175-09b4-4231-8ca0-c31c2e427096","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3d10a6d3-b1f9-485b-8188-c94ea74fabc1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"function run(nrTransacao, dataTransacao, horarioTransacao, valorTransacao, quantidade) {\n\ttry {\n\t\tif (quantidade > 1) {\n\t\t\treturn `${nrTransacao}ª transação\n\nData: ${dataTransacao}\nHora: ${horarioTransacao}\nValor:R$${valorTransacao}`\n\t\t}\n\t\treturn `Data: ${dataTransacao}\nHora: ${horarioTransacao}\nValor: R$${valorTransacao}`\n\t} catch (e) {\n\t\treturn e.message;\n\t}\n\n}","inputVariables":["nrTransacao","dataTransacao","horarioTransacao","valorTransacao","quantidade"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"58d65ccc-66dd-4ffb-ac44-e0dcdca2b8cc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Os dados da transação estão corretos?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"db1723b5-93a3-4233-b316-6e8850a0b127","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b563e924-56bd-4150-8617-901d12840f27","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e563ad2e-c2db-4a10-a921-c3f753eda28b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5f9aff81-38db-4fb9-913d-b2f2ec4f2421","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"78dfeca4-2819-4b41-a6ca-281834d77a89","root":false,"$title":"[MS.7.2.4][MSG] Confirma transaçao","$position":{"top":"2891px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"faadc313-0a4d-4cd0-b4f1-95ff2c4027c8":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7b9a02bf-fcae-47e2-8560-0498b9504d1f","typeOfStateId":"state","$connId":"con_493","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6ad3712a-6572-49b8-ae69-3556be70638b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Wi-fi\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Venda Parcelada\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Device lock/security\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Terminal não configurado\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Ativar o som da senha\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"QR Code\"\n    },\n    {\n        \"id\": \"7\",\n        \"title\": \"Sem SIM Card\"\n    },\n    {\n        \"id\": \"8\",\n        \"title\": \"Venda por aproximação\"\n    },\n    {\n        \"id\": \"9\",\n        \"title\": \"Senha cancelamento\",\n        \"description\": \"Cadastrar senha de cancelamento\"\n    },\n    {\n        \"id\": \"10\",\n        \"title\": \"Tamper Interruption\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `De que tipo de configuração?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1ae76a77-8d09-43a1-91bd-b85ecfb2d6ec","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"1499330e-d597-484e-8c60-b4dc5dac5794","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"4e36065f-30bb-4c43-92c3-6e088399e506","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1e2c5545-7793-4cbf-a5b8-553f4699afe4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-35538621-6fea-4f6f-b432-aec37e932537","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-55cf744d-7b9c-4da1-b854-9365d652c323","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-21986092-4aca-4776-91fd-7643fd01a020","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"faadc313-0a4d-4cd0-b4f1-95ff2c4027c8","root":false,"$title":"[MS.8.0.0][MSG] Menu Configurações","$position":{"top":"753px","left":"14555px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7b9a02bf-fcae-47e2-8560-0498b9504d1f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"06e838c6-506a-4218-ab86-691400ccd9f1","typeOfStateId":"state","$connId":"con_498","$id":"7b54cf8f-f025-4b1d-85fd-c2a83871caec","conditions":[{"source":"context","comparison":"equals","values":["Wi-fi"],"variable":"userInput"}],"$invalid":false},{"stateId":"e6ee92ea-dbc4-438e-bca7-7ed922c45ff6","typeOfStateId":"state","$connId":"con_503","$id":"447eafb9-eddc-4aec-83f9-840cbb58dae7","conditions":[{"source":"context","comparison":"equals","values":["Venda Parcelada"],"variable":"userInput"}],"$invalid":false},{"stateId":"0b29672c-d817-4b62-9949-ed97291bfc45","typeOfStateId":"state","$connId":"con_508","$id":"bc11eca8-1137-443e-aa48-ff65032ac040","conditions":[{"source":"context","comparison":"equals","values":["Device lock/security"],"variable":"userInput"}],"$invalid":false},{"stateId":"3ff3d066-d976-4502-bc8e-02f9751f4262","typeOfStateId":"state","$connId":"con_513","$id":"4702613c-b5e4-4674-9829-5d1bd6fcef2f","conditions":[{"source":"context","comparison":"equals","values":["Terminal não configurado"],"variable":"userInput"}],"$invalid":false},{"stateId":"b2242987-7cb8-43c3-aea0-bace4d12fed2","typeOfStateId":"state","$connId":"con_518","$id":"25bf24c6-676a-4e5e-8d5c-e4fb5d685d80","conditions":[{"source":"context","comparison":"equals","values":["Ativar o som da senha"],"variable":"userInput"}],"$invalid":false},{"stateId":"5f4cbb08-d885-49ac-98e1-be2385da8261","typeOfStateId":"state","$connId":"con_523","$id":"ca2228ae-6abe-4afb-8113-bbe653839536","conditions":[{"source":"context","comparison":"equals","values":["QR Code"],"variable":"userInput"}],"$invalid":false},{"stateId":"a7e4313e-7cbe-4041-8a76-6bdc16ea19de","typeOfStateId":"state","$connId":"con_528","$id":"3b9cb9c4-b92e-4475-b9c2-31a84465021f","conditions":[{"source":"context","comparison":"equals","values":["Sem SIM Card"],"variable":"userInput"}],"$invalid":false},{"stateId":"11f4bb15-03de-4faf-8559-823ff841ae4d","typeOfStateId":"state","$connId":"con_533","$id":"8ed6d8c3-160e-49ba-a57b-607b388375bd","conditions":[{"source":"context","comparison":"equals","values":["Venda por aproximação"],"variable":"userInput"}],"$invalid":false},{"stateId":"bfc3e239-79fc-47f9-b42e-edd37a453f99","typeOfStateId":"state","$connId":"con_538","$id":"22dd9c4b-0e70-4439-ba80-11b118d40b2b","conditions":[{"source":"context","comparison":"equals","values":["Senha cancelamento"],"variable":"userInput"}],"$invalid":false},{"stateId":"5eda88f3-1391-4839-bc30-77e98dcc1f00","typeOfStateId":"state","$connId":"con_543","$id":"af5f5f35-7133-4a57-a40b-b3d945df5304","conditions":[{"source":"context","comparison":"equals","values":["Tamper Interruption"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dfaf9052-9ce5-4acb-82df-415734fce971","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2e612238-da73-4b42-96bd-cdb03615fe82","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-9b7e8723-5a8e-488c-8a01-0213b1b376cb","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8390983b-930f-4d2f-aecd-d3a8b8a2acb5","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7b9a02bf-fcae-47e2-8560-0498b9504d1f","root":false,"$title":"[MS.8.0.0][INPUT] Menu Configurações","$position":{"top":"995px","left":"14555px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"06e838c6-506a-4218-ab86-691400ccd9f1":{"$contentActions":[{"action":{"$id":"c7edad80-a823-4cbe-abd7-bc2ef0651949","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"30c19dae-3ccc-47c4-ad87-9e0963682ef8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Configuração do Wi-Fi no POS:\n- Pressione o atalho 992.\n- Localize a rede Wi-Fi desejada.\n- Adicione a senha correta.\n\n2° Após a Configuração:\n- Verifique se a configuração foi realizada com êxito.\n- Realize uma venda teste para confirmar a conexão.","metadata":{}},"$cardContent":{"document":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Configuração do Wi-Fi no POS:\n- Pressione o atalho 992.\n- Localize a rede Wi-Fi desejada.\n- Adicione a senha correta.\n\n2° Após a Configuração:\n- Verifique se a configuração foi realizada com êxito.\n- Realize uma venda teste para confirmar a conexão."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_548","$id":"0d6db342-ba40-4d06-8ee4-e9de0958593a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e96d8631-b830-4a2d-bea8-216b36747355","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-795754f3-b727-42e7-84e7-9556b49f4ade","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fffed846-3bd9-4c92-9522-cf03ddfd444a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"06e838c6-506a-4218-ab86-691400ccd9f1","root":false,"$title":"[MS.8.1.0][MSG] Botao Configuração Wi-Fi","$position":{"top":"963.164px","left":"11432.9px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4ab87a03-9954-4336-a58a-9c4e8f66d4be":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"0b29672c-d817-4b62-9949-ed97291bfc45","typeOfStateId":"state","$connId":"con_553","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"c1842f3c-3273-4158-8b6d-9b1a5b7a86c7","typeOfStateId":"state","$connId":"con_558","$id":"7635d63c-55c1-4820-b71b-1815a3783cbd","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f0d3e4ee-cdb2-4af8-8fd2-3934f62676d3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-933b3d18-8d18-4867-b629-3f4a61129235","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-96f2a8f3-368b-4aba-8903-aa737d491859","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ad5b3888-cb7f-4730-9f4f-e3ec54802106","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4ab87a03-9954-4336-a58a-9c4e8f66d4be","root":false,"$title":"[MS.8.2.0][INPUT] Seleciona modelo de maquina","$position":{"top":"1410px","left":"12090px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e6ee92ea-dbc4-438e-bca7-7ed922c45ff6":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4ab87a03-9954-4336-a58a-9c4e8f66d4be","typeOfStateId":"state","$connId":"con_563","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Link 2500\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"86bb7ce6-5451-40d9-90bc-57ce7432f9b2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-879f8016-316f-4050-ac11-2609ee2e3459","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a2ef75ed-cc7c-44eb-9fce-d7824f10e2c4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f3ded9cb-eb82-45ad-959c-cb1b7878cb40","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e6ee92ea-dbc4-438e-bca7-7ed922c45ff6","root":false,"$title":"[MS.8.2.0][MSG] Seleciona modelo de maquina","$position":{"top":"1073.44px","left":"12090.8px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c1842f3c-3273-4158-8b6d-9b1a5b7a86c7":{"$contentActions":[{"action":{"$id":"c1047c8b-ccbc-4283-98c6-c12d7038044d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5fb68d4a-105d-44c4-9e4f-c6991094fdd3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5fb68d4a-105d-44c4-9e4f-c6991094fdd3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ad449fc9-9019-46c3-be50-8c8949b27d85","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bd568f5f-3abd-462f-8afc-22977929e905","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Informe o valor.\n\n3° Selecione a opção crédito.\n\n4° Escolha entre sem ou com juros.\n\n5° Utilize as teclas F2 e F3 para visualizar as demais parcelas.","metadata":{}},"$cardContent":{"document":{"id":"bd568f5f-3abd-462f-8afc-22977929e905","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Informe o valor.\n\n3° Selecione a opção crédito.\n\n4° Escolha entre sem ou com juros.\n\n5° Utilize as teclas F2 e F3 para visualizar as demais parcelas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"5bfd8fb0-0ec1-45dd-a4cf-6687a348a88f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_568","$id":"c4210371-58b1-4d31-94c6-c95838443d15","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6e1cccc7-f901-4890-b346-0051271776c8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ba5c1ae1-8c52-4f45-a075-95f31aead556","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-99ca8bcc-a1ab-46e6-a04b-c5180163ac11","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c1842f3c-3273-4158-8b6d-9b1a5b7a86c7","root":false,"$title":"[MS.8.2.1][MSG] Venda parcelada","$position":{"top":"1635.25px","left":"12091.1px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0b29672c-d817-4b62-9949-ed97291bfc45":{"$contentActions":[{"action":{"$id":"361c2d4c-9f8d-4f00-96e0-1ed3cea0c0d0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a4592510-908e-4562-ae94-36eef0992e5d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a4592510-908e-4562-ae94-36eef0992e5d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e815d1f2-f468-4a95-bd66-47c7a0228450","$typeOfContent":"text","type":"SendMessage","settings":{"id":"585c9ff4-c092-4876-9316-77f50499a2c4","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"585c9ff4-c092-4876-9316-77f50499a2c4","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dec59fc7-8399-440c-9da6-8e04b4a969ae","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0b29672c-d817-4b62-9949-ed97291bfc45","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1202px","left":"12437px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3ff3d066-d976-4502-bc8e-02f9751f4262":{"$contentActions":[{"action":{"$id":"7c2f36d6-241d-4cc1-9d11-198d38652dc5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"64f9ea7d-577a-4865-b46f-9dcbe4b55b27","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"64f9ea7d-577a-4865-b46f-9dcbe4b55b27","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"774fd5e4-11ad-4060-b018-e9516903da09","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b67ac3e4-23a2-4441-a1e0-7d045017f639","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\nPressione o botão ativar.\n\nAtivou?\n- Se sim, finalize.\n- Se não, conecte-se ao Wi-Fi.\n\nAtivação concluída?\n- Se sim, finalize.\n- Se não, pressione o atalho 2001 (Ativar).","metadata":{}},"$cardContent":{"document":{"id":"b67ac3e4-23a2-4441-a1e0-7d045017f639","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\nPressione o botão ativar.\n\nAtivou?\n- Se sim, finalize.\n- Se não, conecte-se ao Wi-Fi.\n\nAtivação concluída?\n- Se sim, finalize.\n- Se não, pressione o atalho 2001 (Ativar)."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fb06e4dd-e68b-494d-b52f-18f79f417768","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9bf09db0-b546-44ed-966d-e19e6062a4bb","typeOfStateId":"state","$connId":"con_573","$id":"08174c26-5abb-4d0f-8142-a433435aa7ce","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0e0d6f66-1c78-46d2-b2a0-add36767a2ec","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4bae0f86-0943-43ef-a6d5-4bfbbf0f45c0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8b18d009-645e-4dfe-b85d-d73bb001fb84","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3ff3d066-d976-4502-bc8e-02f9751f4262","root":false,"$title":"[MS.8.4.0][MSG] Terminal não configurado","$position":{"top":"1285.5px","left":"13086px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b2242987-7cb8-43c3-aea0-bace4d12fed2":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9b0b9616-6956-41d9-8986-a708750d932c","typeOfStateId":"state","$connId":"con_578","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"174200c2-0d56-49b2-9e20-b27c95e6404b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ba2479a5-90ca-4e8d-8a2b-23f1086e617f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1c9112f3-af0e-4860-bd75-6528eb75eca0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fe8b317c-90b0-4091-b579-730bbead41c6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b2242987-7cb8-43c3-aea0-bace4d12fed2","root":false,"$title":"[MS.8.5.0][MSG] Seleciona modelo de maquina","$position":{"top":"1407px","left":"13443px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9b0b9616-6956-41d9-8986-a708750d932c":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"4edeb2bf-a95a-49d5-be21-0583b1cfb9df","typeOfStateId":"state","$connId":"con_583","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outra"],"variable":"userInput"}],"$invalid":false},{"stateId":"c06c20ea-f066-409e-aa82-dfaf6d1cc863","typeOfStateId":"state","$connId":"con_588","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1d212d15-4e5e-4ee5-bb28-df421735c6f4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-29c33569-aa31-4ab6-a8ce-40a0f0e3fa46","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-49f6fd7c-0c8c-4a7f-90dd-928e904ffdd0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-cfd7f21f-e912-4fdb-9330-4bf37093387c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9b0b9616-6956-41d9-8986-a708750d932c","root":false,"$title":"[MS.8.5.0][INPUT] Seleciona modelo de maquina","$position":{"top":"1630.62px","left":"13442.9px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4edeb2bf-a95a-49d5-be21-0583b1cfb9df":{"$contentActions":[{"action":{"$id":"41e27025-039d-4fd5-afe8-bbc94e560f4b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3e906932-c27c-404c-9a8f-83397b995cb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3e906932-c27c-404c-9a8f-83397b995cb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7f3740b9-7a8d-4ac1-90f4-9a4e31081e0f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ae38d347-29e2-43f0-b1c1-5b23ab84a454","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"ae38d347-29e2-43f0-b1c1-5b23ab84a454","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5dac92a8-e61b-4ed4-87e1-9108bae35e08","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4edeb2bf-a95a-49d5-be21-0583b1cfb9df","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1641.69px","left":"13787.8px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c06c20ea-f066-409e-aa82-dfaf6d1cc863":{"$contentActions":[{"action":{"$id":"8e21f143-20b5-40f4-85b6-b707ae3732ef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b57687b0-386c-491f-abc2-d376f5e1155e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b57687b0-386c-491f-abc2-d376f5e1155e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"52b05e21-b561-4407-87c0-665470fd2066","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d052ca70-d1b6-48bf-873f-84db2400139d","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Coloque o valor.\n\n3° Quando aparecer a opção de colocar a senha, aumente ou diminua o volume usando os botões \"+\" e \"-\".","metadata":{}},"$cardContent":{"document":{"id":"d052ca70-d1b6-48bf-873f-84db2400139d","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Coloque o valor.\n\n3° Quando aparecer a opção de colocar a senha, aumente ou diminua o volume usando os botões \"+\" e \"-\"."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c0411a8a-b9d2-4ff1-9456-5c13e150f438","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_593","$id":"78700bd4-c3e7-4b8d-8fc9-af078265e460","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0e1057f1-1fa6-488a-99ce-b64fb930f053","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bdfe537f-6b47-4c41-80a0-1c040e827ac6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bc8f1c82-8a0b-4ce4-a305-43776a2594f2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c06c20ea-f066-409e-aa82-dfaf6d1cc863","root":false,"$title":"[MS.8.5.1] Ativar o som da senha","$position":{"top":"1954px","left":"13442.6px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5f4cbb08-d885-49ac-98e1-be2385da8261":{"$contentActions":[{"action":{"$id":"374fe35f-ec45-4cc1-a18e-db50a7a503d1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d2b46a92-a316-445d-b152-0f0081ec6edd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d2b46a92-a316-445d-b152-0f0081ec6edd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"61c104ab-84a8-4dfb-8417-14a8c88ba4d9","$typeOfContent":"text","type":"SendMessage","settings":{"id":"406907e4-509b-419c-9ca7-c71284fa6c62","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste.","metadata":{}},"$cardContent":{"document":{"id":"406907e4-509b-419c-9ca7-c71284fa6c62","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"04302724-1c6f-4d5c-a951-ccdb2090b010","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3dcf0ada-ed0f-4004-b236-93f4a91fb304","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3dcf0ada-ed0f-4004-b236-93f4a91fb304","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"eaf1037f-96eb-4317-8f24-f6fca38f771b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4c89fc77-396c-40d4-b006-6410a6f12e19","type":"text/plain","content":"<b>Importante</b>\nVendas por QR CODE débito e crédito,somente com o app AgZero ou cartão bandeira ELO.","metadata":{}},"$cardContent":{"document":{"id":"4c89fc77-396c-40d4-b006-6410a6f12e19","type":"text/plain","content":"<b>Importante</b>\nVendas por QR CODE débito e crédito,somente com o app AgZero ou cartão bandeira ELO."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4bb527e7-9943-4098-a917-2cc543de4d59","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_598","$id":"d6e934fe-7667-4650-9015-664aca19e125","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"2f4c7ecd-3cb6-45da-a6e2-27c6bbda8ac2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a4f18cc7-a701-4aca-a244-1155a21fa961","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-44b39f2b-8e8f-4a8d-9970-2f0f75256242","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5f4cbb08-d885-49ac-98e1-be2385da8261","root":false,"$title":"[MS.8.6.0][MSG] QR Code","$position":{"top":"2099px","left":"14157px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a7e4313e-7cbe-4041-8a76-6bdc16ea19de":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0a026452-b1e2-4eb7-839a-874f6dc07d26","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste.","metadata":{}},"$cardContent":{"document":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8c80961f-3443-4e58-8f55-c676db2aae66","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"999e316e-696e-4702-a95e-ceeacd887099","typeOfStateId":"state","$connId":"con_603","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"62c146b6-a638-438e-bf6f-1f12fc4db044","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4fb2cb0b-d47b-4749-a501-39b3d74c43e9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b408565d-ee96-465e-a5fc-fa3780b5ef25","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2e5a5acb-79f1-42eb-8dce-a2a4c88e8259","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a7e4313e-7cbe-4041-8a76-6bdc16ea19de","root":false,"$title":"[MS.8.7.0][MSG] Sem SIM Card","$position":{"top":"1770.38px","left":"14584.2px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"999e316e-696e-4702-a95e-ceeacd887099":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1","typeOfStateId":"state","$connId":"con_608","$id":"02182c79-f3c9-4b94-8878-5dcdbe74d809","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d5d2cccc-aa01-4b4e-b66d-a08672a6e228","typeOfStateId":"state","$connId":"con_613","$id":"9ce82690-4bdd-4f3b-81aa-c0e81acb579c","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ad01d54b-8ca0-466c-881d-35f730c5e0f1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"2ee040e0-fc8b-46f2-a882-df5a2ac7a5e3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a54f1353-a732-4a19-9d24-377ce6bdf904","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1dd22272-1b59-41cd-a63b-908761aed1ae","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-968ce0a4-ec52-4e68-8dff-65a6bc33968a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"999e316e-696e-4702-a95e-ceeacd887099","root":false,"$title":"[MS.8.7.0][INPUT] Sem SIM Card","$position":{"top":"2195px","left":"14584px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5a5d6d96-c921-4e51-9d3b-5dbbb69acb28","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1","root":false,"$title":"[GO TO] Finalização","$position":{"top":"2206.31px","left":"15015.8px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d5d2cccc-aa01-4b4e-b66d-a08672a6e228":{"$contentActions":[{"action":{"$id":"05a50a75-a02c-4987-985e-7fa53d8f4800","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e256fc49-f950-43a0-8bba-4f61da9eed16","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e256fc49-f950-43a0-8bba-4f61da9eed16","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0853eead-d27a-41ef-a760-614c58f04ed8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"94e0ba72-b752-4469-b093-4262025b1170","type":"text/plain","content":"Neste caso, realize o teste de comunicação.\n\nPara isso, pressione o atalho 9973.","metadata":{}},"$cardContent":{"document":{"id":"94e0ba72-b752-4469-b093-4262025b1170","type":"text/plain","content":"Neste caso, realize o teste de comunicação.\n\nPara isso, pressione o atalho 9973."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"110a4ce0-b82a-4ea7-8f3f-81c5cd4bac8b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_618","$id":"7e19bddf-a275-4ef8-8fb3-9f4910a9adce","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6503d109-a055-4475-8ea5-dd8f2ed240d5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f0dccb4a-f844-4737-91bb-073142f3e320","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6dd9797f-e575-4f9e-8a31-754599094174","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d5d2cccc-aa01-4b4e-b66d-a08672a6e228","root":false,"$title":"[MS.8.7.1][MSG] Sem Sim Card (Não deu certo)","$position":{"top":"2563px","left":"14584px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ee74906b-a573-4319-bb46-b76351bc8cb3":{"$contentActions":[{"action":{"$id":"60e9c4fb-7e3a-43db-bb0b-182c5cf99c65","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"db6e0b73-b6d9-456b-915e-77d64977ebb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"db6e0b73-b6d9-456b-915e-77d64977ebb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"faee21fa-1815-4fcf-bc64-7de2f7727a2e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"5032b63b-5ca0-4e06-9a37-6d1c86a9ad9c","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\nPara isso, pressione o atalho 990. Em seguida, selecione “apagar todos os arquivos” e confirme com “sim”.","metadata":{}},"$cardContent":{"document":{"id":"5032b63b-5ca0-4e06-9a37-6d1c86a9ad9c","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\nPara isso, pressione o atalho 990. Em seguida, selecione “apagar todos os arquivos” e confirme com “sim”."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fd75952d-b225-480d-a3d9-3d9650e3a71b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","typeOfStateId":"state","$connId":"con_623","$id":"ca9ba732-eee9-4e7c-a39a-470df975b2b3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"60a75d97-a62b-42d2-8471-d0c4be436ae5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e44e1d9e-0e4a-421f-8e70-d8095f10c897","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1bb0b076-e6e5-41ab-ae2f-db5761870050","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ee74906b-a573-4319-bb46-b76351bc8cb3","root":false,"$title":"[MS.8.8.1] Venda por aproximação (não deu certo)","$position":{"top":"2470px","left":"15492px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"11f4bb15-03de-4faf-8559-823ff841ae4d":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0a026452-b1e2-4eb7-839a-874f6dc07d26","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Digite o valor.\n\n2° Selecione uma opção: débito ou crédito.\n\n3° Aproxime o cartão.","metadata":{}},"$cardContent":{"document":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Digite o valor.\n\n2° Selecione uma opção: débito ou crédito.\n\n3° Aproxime o cartão."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8c80961f-3443-4e58-8f55-c676db2aae66","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3e641b5e-d55e-4bc1-b0bd-bac9422b5c76","typeOfStateId":"state","$connId":"con_628","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6ee57d62-6c6d-42a6-afc0-77af1a565bf6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c32641f4-20b8-43c6-956c-42bfc60dd8a6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-24f2d140-ad15-4503-bca8-2d6e5a47a893","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bf8c9711-6236-4f2e-acc1-6b4a4b2c806c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"11f4bb15-03de-4faf-8559-823ff841ae4d","root":false,"$title":"[MS.8.8.0][MSG] Venda por aproximação","$position":{"top":"1475.56px","left":"15492px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3e641b5e-d55e-4bc1-b0bd-bac9422b5c76":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1","typeOfStateId":"state","$connId":"con_633","$id":"02182c79-f3c9-4b94-8878-5dcdbe74d809","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"ee74906b-a573-4319-bb46-b76351bc8cb3","typeOfStateId":"state","$connId":"con_638","$id":"9ce82690-4bdd-4f3b-81aa-c0e81acb579c","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2b016e19-7978-469a-b8fd-edf8e73a149d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"2c7b9808-c8bf-4b33-82ce-4d5c14f1bbfd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ca90a2d5-1455-44b3-8f47-98356c16521d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7f3a820b-0de8-4a95-bd87-3426f6d9e619","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6134a63e-8198-436e-b39b-0ca4ba16f5d2","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3e641b5e-d55e-4bc1-b0bd-bac9422b5c76","root":false,"$title":"[MS.8.8.0][INPUT] Venda por aproximação","$position":{"top":"2182.5px","left":"15492px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bfc3e239-79fc-47f9-b42e-edd37a453f99":{"$contentActions":[{"action":{"$id":"af56ecb3-99b0-4ada-835f-a1bd261a468a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5b3d42de-eace-4958-bd41-7e27de0d80ec","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5b3d42de-eace-4958-bd41-7e27de0d80ec","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d8e7df4c-2ad0-4912-ae4b-cc68ae9c04de","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a05fe95a-cf53-471f-b1e5-2e5ff3625d5c","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 921.\n\n2° Duas mensagens podem aparecer:\n- Senha não cadastrada\n- Digite sua senha\n\n3° Para cadastrar sua senha:\n- Digite os 4 primeiros dígitos do CNPJ/CPF e confirme na tecla verde.\n- Digite o CEP do estabelecimento.\n- Cadastre uma nova senha de 4 dígitos, evitando números sequenciais ou repetidos.\n- Finalize o processo.","metadata":{}},"$cardContent":{"document":{"id":"a05fe95a-cf53-471f-b1e5-2e5ff3625d5c","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 921.\n\n2° Duas mensagens podem aparecer:\n- Senha não cadastrada\n- Digite sua senha\n\n3° Para cadastrar sua senha:\n- Digite os 4 primeiros dígitos do CNPJ/CPF e confirme na tecla verde.\n- Digite o CEP do estabelecimento.\n- Cadastre uma nova senha de 4 dígitos, evitando números sequenciais ou repetidos.\n- Finalize o processo."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b33dfddd-f1d4-43bd-8175-f7c7083ab3fc","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","typeOfStateId":"state","$connId":"con_643","$id":"e33170eb-ec65-4215-93fa-4175d5d81ac3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"a64d2b20-585a-4705-8d29-2c17808c6198","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-be5ee812-084e-4f2b-b41e-7cd4409aa3e3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9b541451-2749-4fbf-9972-467c9dcf48e1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bfc3e239-79fc-47f9-b42e-edd37a453f99","root":false,"$title":"[MS.8.9.0] Senha Cancelamento","$position":{"top":"1380.45px","left":"15892.1px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5eda88f3-1391-4839-bc30-77e98dcc1f00":{"$contentActions":[{"action":{"$id":"03e61454-3a73-487f-bf63-b8d1aa7ccbf9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f5a75f26-561c-44bf-9cf4-b450659c6423","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f5a75f26-561c-44bf-9cf4-b450659c6423","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"82dab2e4-55d2-46a9-ba40-6bf8060805e0","$typeOfContent":"text","type":"SendMessage","settings":{"id":"81348e18-fbf2-4049-9ab3-66bf1c2959d4","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o equipamento.","metadata":{}},"$cardContent":{"document":{"id":"81348e18-fbf2-4049-9ab3-66bf1c2959d4","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o equipamento."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"71ca5443-b934-48a2-837c-397ce02c7028","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","typeOfStateId":"state","$connId":"con_648","$id":"45b520f1-5b21-49b6-8d94-e8d8378d0dde","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"afcd392e-6ff3-4ebf-a1cc-29245c471c7c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4418c01f-a2d9-4f88-956d-770a8be2c586","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6f2d1837-9349-45d3-906f-7bd3936a7ed9","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5eda88f3-1391-4839-bc30-77e98dcc1f00","root":false,"$title":"[MS.8.10.0] Tamper Interruption","$position":{"top":"1202.81px","left":"16153.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a37832a1-3f3b-4ed4-8765-9bdffb110d80","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","root":false,"$title":"[GO TO][MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2479.5px","left":"16043px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3247102c-1355-4dde-b9b2-ad167274fd3c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"87ad707f-271a-4f0c-900d-f146266e9450","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"5fad1cb3-48f6-47ce-8ee8-4df8ad91c6e7","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"nrTransacao\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(quantidade, nrTransacao) {\n\ttry {\n\t\tlet parsedNumber = Number(nrTransacao)\n\t\treturn parsedNumber + 1\n\t} catch (err) {\n\t\treturn '1'\n\t}\n}","inputVariables":["quantidade","nrTransacao"],"outputVariable":"nrTransacao","LocalTimeZoneEnabled":false},"conditions":[{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"26b33e50-abbf-4cc6-ae1f-66301c4171e1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"quantidade\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(quantidade) {\n\tlet parsedQuantidade = Number(quantidade)\n\treturn parsedQuantidade - 1\n}","inputVariables":["quantidade"],"outputVariable":"quantidade","LocalTimeZoneEnabled":false},"conditions":[{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0895f6b8-c5d8-4a6f-b0ec-bd2b696e3b99","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"3247102c-1355-4dde-b9b2-ad167274fd3c","root":false,"$title":"[GO TO][MS.7.2.4] Data das transações","$position":{"top":"3150px","left":"3880px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b6fbea89-9880-45f1-bcb8-9431423e4dfc":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a400ddf2-fa79-4b2c-ab83-65eec2376bb4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3247102c-1355-4dde-b9b2-ad167274fd3c","typeOfStateId":"state","$connId":"con_653","$id":"0af7353f-9682-42d8-9a9a-e4fefc7c830f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"},{"values":["1"],"source":"context","comparison":"greaterThan","variable":"quantidade"}],"$invalid":false},{"stateId":"3247102c-1355-4dde-b9b2-ad167274fd3c","typeOfStateId":"state","$connId":"con_658","$id":"26a60b62-11a5-433a-bb32-823e9abf83f8","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false},{"stateId":"1f53a2ba-b515-46bf-a6cd-ab2a4a18420c","typeOfStateId":"state","$connId":"con_663","$id":"b3f7c3d1-fb79-43db-8dc3-9ba449913a51","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8725cef0-f51b-4331-9810-bf295f7e5fcb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6cd6f1dc-eb02-48a9-a406-96b1ee327899","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"19d870e4-e36b-43af-a3be-f2ea5b19ce81","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"transacoesNaoAutorizadas\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(transacoesNaoAutorizadas, dataTransacao, horarioTransacao, valorTransacao, nrTransacao, debitoMotivo, motivo, quantidade, contaSelecionada, identity) {\n\ttry {\n\t\tconst { doc } = JSON.parse(contaSelecionada)\n\t\tconst phone = identity.split('@')[0]\n\t\tif (!transacoesNaoAutorizadas) {\n\t\t\treturn `Criação automática WhatsApp PJ: Telefone: ${phone} CPF/CNPJ: ${doc} Motivo: ${motivo} ${debitoMotivo || ''} | Transação: ${nrTransacao} Data: ${dataTransacao} Horario: ${horarioTransacao} Valor: ${valorTransacao}`\n\t\t}\n\t\treturn transacoesNaoAutorizadas += ` | Transação: ${nrTransacao} Data: ${dataTransacao} Horario: ${horarioTransacao} Valor: ${valorTransacao}`\n\t} catch (err) {\n\t\tif (transacoesNaoAutorizadas) {\n\t\t\treturn transacoesNaoAutorizadas\n\t\t}\n\t\treturn `Criação automática WhatsApp PJ: Telefone: ${phone} CPF/CNPJ: ${doc} Motivo: ${motivo} ${debitoMotivo || \"\"} | Transação: ${nrTransacao} Data: ${dataTransacao} Horario: ${horarioTransacao} Valor: ${valorTransacao}`\n\t}\n}","inputVariables":["transacoesNaoAutorizadas","dataTransacao","horarioTransacao","valorTransacao","nrTransacao","debitoMotivo","motivo","quantidade","contaSelecionada","contact.identity"],"outputVariable":"transacoesNaoAutorizadas","LocalTimeZoneEnabled":false},"conditions":[{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"2c57e396-68e4-4c55-9251-92dfb8052d10","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"e683abdf-b128-4b62-8b4d-84ac44e172b8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bdc5cdae-3c2b-49ab-8b4f-81097a3758ee","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4d73cd7d-e5aa-40e8-9177-16f0f93498c6","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6e7691c9-cc0f-489d-9a3a-b3248fd89cd6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f76264f3-0930-4b71-92b2-2f7389192a44","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b6fbea89-9880-45f1-bcb8-9431423e4dfc","root":false,"$title":"[MS.7.2.4][INPUT] Confirma transação","$position":{"top":"3150px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7eaa4922-911f-469d-be60-ea0ebb25000d":{"$contentActions":[{"action":{"$id":"22dcc13b-98e5-4bbf-97fc-8b1a665106e7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"01831fd0-2581-4170-bd53-2725f868ec18","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"01831fd0-2581-4170-bd53-2725f868ec18","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8ababea9-4e47-41e5-a34a-1aac24533d6e","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"13e40b3d-fa46-4cec-90b7-cbe5b9456243","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e225d922-1307-429f-9d34-d00bee21cc4e","typeOfStateId":"state","$connId":"con_668","$id":"59b3caff-a159-49cc-8fd7-ae56d8818680","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"7bb7719f-81d3-41f1-85c3-f498def8e3ee","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"9d5c9138-62b8-472c-b488-e1842ee341cd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions =  [\n    {\n        \"id\": \"1\",\n        \"title\": \"Leitura do cartão\",\n        \"description\": \"Erro na leitura do cartão\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Acessar arquivo\",\n        \"description\": \"Erro ao acessar arquivo\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Ethernet\",\n        \"description\": \"Erro de comunicação Ethernet\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Discado\",\n        \"description\": \"Erro de comunicação discado\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Torre de celular com X\",\n        \"description\": \"Problemas com a torre de celular\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"Erro desfazimento\",\n        \"description\": \"Erro ao cancelar venda\"\n    },\n    {\n        \"id\": \"7\",\n        \"title\": \"Códigos de erro\",\n        \"description\": \"3-050, 3-051, 3-052,3-50,3-51 e 3-52\"\n    },\n    {\n        \"id\": \"8\",\n        \"title\": \"Atalhos\",\n        \"description\": \"Lista de atalhos da sua máquina\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Você pode escolher uma opção ou digitar o que precisa, exemplo: *erro de comunicação.*`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"991e81cb-67cc-4bb1-aa88-ef7fecdc9aa4","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"6758f485-4584-479c-984c-3bf87e0ed0e4","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"0c7c5b66-c9d3-45fa-a055-d7633f24ab4c","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e6f24760-f476-46d5-ab91-fe080c7ea056","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5d41e899-ef35-428f-938a-5d4cd2c71378","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f440f8b6-d17f-430e-8415-87e89a3723e0","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-498c7d5a-37c3-48e8-8380-4a53dd1971c8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7eaa4922-911f-469d-be60-ea0ebb25000d","root":false,"$title":"[MS.9.0.0][MSG] Menu Erros gerais","$position":{"top":"466px","left":"18673px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e225d922-1307-429f-9d34-d00bee21cc4e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"119bc7af-626d-44b3-9d63-4b262d5bd1bf","typeOfStateId":"state","$connId":"con_673","$id":"c7e70c64-4804-423d-8638-6a50a32a14b7","conditions":[{"source":"context","comparison":"equals","values":["Leitura do cartão"],"variable":"userInput"}],"$invalid":false},{"stateId":"848cebf5-0310-456a-95b0-0b2d4e5ae559","typeOfStateId":"state","$connId":"con_678","$id":"973b38d2-8dc8-42f8-a4bb-fd36f0a72f0f","conditions":[{"source":"context","comparison":"equals","values":["Acessar arquivo"],"variable":"userInput"}],"$invalid":false},{"stateId":"a0f4b4ef-0b45-4ffb-926e-d0d174420f34","typeOfStateId":"state","$connId":"con_683","$id":"28cbacd6-1c5c-45ba-8d1b-ef681ae4350d","conditions":[{"source":"context","comparison":"equals","values":["Ethernet"],"variable":"userInput"}],"$invalid":false},{"stateId":"65abd5f9-1bec-4b5b-8688-1efa12a63cc6","typeOfStateId":"state","$connId":"con_688","$id":"14980075-0e86-459f-a025-8ab8d80c4ea1","conditions":[{"source":"context","comparison":"equals","values":["Discado"],"variable":"userInput"}],"$invalid":false},{"stateId":"9358d504-8ea3-4711-9e34-4ed1b5978d61","typeOfStateId":"state","$connId":"con_693","$id":"16d35930-06a0-43f7-abf4-30772e33c7c8","conditions":[{"source":"context","comparison":"equals","values":["Torre de celular com X"],"variable":"userInput"}],"$invalid":false},{"stateId":"25cca5a7-86d4-4fdc-8365-7a0c5fb621e6","typeOfStateId":"state","$connId":"con_698","$id":"0ac2d79b-20e6-400a-a33e-ca4a97632686","conditions":[{"source":"context","comparison":"equals","values":["Erro desfazimento"],"variable":"userInput"}],"$invalid":false},{"stateId":"47c6e908-5e18-4f58-b4f2-9d29613f7e6d","typeOfStateId":"state","$connId":"con_703","$id":"3558246f-54cd-4aba-9b93-5b0d46916191","conditions":[{"source":"context","comparison":"equals","values":["Códigos de erro"],"variable":"userInput"}],"$invalid":false},{"stateId":"0d4f7110-4dfd-429a-a88a-cedec3b42217","typeOfStateId":"state","$connId":"con_708","$id":"e2aa8979-ee55-434b-a31b-b52c0e92d903","conditions":[{"source":"context","comparison":"equals","values":["Atalhos"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n\nfunction run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"e0beb31e-054f-4dc2-b737-09060d5b862e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"cc06cae1-6788-4f87-b094-d23fe76c196f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6b1f0384-c3e5-42a7-889d-4f5bc3420501","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-631ea8a6-3858-4739-a362-5de7f482286f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c1debafb-4c4c-479b-bc8b-0eea2f24ba58","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3c2bbe43-3b86-455b-bb2c-c72877140c41","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e225d922-1307-429f-9d34-d00bee21cc4e","root":false,"$title":"[MS.9.0.0][INPUT] Menu Erros gerais","$position":{"top":"689px","left":"18673px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"119bc7af-626d-44b3-9d63-4b262d5bd1bf":{"$contentActions":[{"action":{"$id":"77336a48-d4a3-408b-b09d-2d5d3430d42d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"04b8c027-f98d-43d1-b716-eeba77f2076d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"04b8c027-f98d-43d1-b716-eeba77f2076d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d8a8df90-3a15-4873-bfcf-79a8e557cbb2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bfeab220-a218-4112-b319-52661e32ad3d","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (Selecione \"Sim\").\n\n5° Ative o terminal novamente.\n\n6° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"bfeab220-a218-4112-b319-52661e32ad3d","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (Selecione \"Sim\").\n\n5° Ative o terminal novamente.\n\n6° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2516fc56-a65a-4d48-b4aa-b4bec0b3a665","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"bd347b5e-efc6-46d6-b70f-f2b20113bdd3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"91b981f6-b405-4401-b80f-1a0229bad7aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"91b981f6-b405-4401-b80f-1a0229bad7aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"62351bb7-2a04-4870-8545-31112cece2c5","typeOfStateId":"state","$connId":"con_713","$id":"d56848db-49a1-4048-b7b0-01cae7262e73","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0cd9d5e4-36e5-4c90-b460-d098d8733087","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5b5c9f1c-68b8-4a67-87a3-9273781d1bfa","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-720b3195-9416-4aec-abd6-a289e609ab36","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"119bc7af-626d-44b3-9d63-4b262d5bd1bf","root":false,"$title":"[MS.9.6.0][MSG] Informativo Leitura do cartão","$position":{"top":"1310px","left":"17679px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"848cebf5-0310-456a-95b0-0b2d4e5ae559":{"$contentActions":[{"action":{"$id":"149fd961-9c13-47ad-89a5-946382d994ed","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f87670e8-185b-43b6-bc6a-1cc4d5196bc4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f87670e8-185b-43b6-bc6a-1cc4d5196bc4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d229ec85-c756-4813-b783-824a07145279","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6f59b944-2e96-42e6-8d02-663706c6220c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7f64f93d-914a-45fc-9c38-15eafc970ed6","typeOfStateId":"state","$connId":"con_718","$id":"774b09cb-2bc5-4270-966e-af6a40392c01","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"65e01ca8-da38-446c-93e8-ea45bc03efaf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3bec231f-13ca-467e-9c30-067b845652b0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e1aa08fd-300b-44aa-918f-2691eb6530ec","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f921dd03-7536-432e-874b-62d7bc86ca4b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d287f00b-95ae-4d46-ae1b-852c59cd15cd","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"848cebf5-0310-456a-95b0-0b2d4e5ae559","root":false,"$title":"[MS.9.5.0][MSG] Menu Acessar arquivo","$position":{"top":"1321px","left":"18290px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a0f4b4ef-0b45-4ffb-926e-d0d174420f34":{"$contentActions":[{"action":{"$id":"96b65530-b74d-473c-adcc-c0c9572f83d7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0944dbce-bcb1-46af-b47d-b249459c328a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0944dbce-bcb1-46af-b47d-b249459c328a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"48647a94-48d5-4388-8dec-ae0ade8b38c6","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"34e7e277-e9d8-4d09-954a-5cecaef46b3a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3c3398a1-0b05-4599-9fbe-422d5796e9b4","typeOfStateId":"state","$connId":"con_723","$id":"1e201fa9-e53b-4d9b-86cd-e458492ec021","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bbc7cb49-de43-4ff7-a7fe-df7135256805","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"POS fixo\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4d56f672-2cca-4cb2-98d7-03ba50c2aac2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-97ac099f-1de2-438c-a4dd-11911bad1cc9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4dd1d9a3-9214-41d0-ac5a-9eea4f5d90f0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-224af10a-62b1-4cde-9ffc-ea2aa37ee2f3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a0f4b4ef-0b45-4ffb-926e-d0d174420f34","root":false,"$title":"[MS.9.4.0][MSG] Menu Ethernet","$position":{"top":"1331px","left":"18703px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"65abd5f9-1bec-4b5b-8688-1efa12a63cc6":{"$contentActions":[{"action":{"$id":"06834a9b-f14e-404c-a5ad-1a57294c0eac","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bdb10b36-e0c9-4ad8-b8c9-6be4dc7eec5a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bdb10b36-e0c9-4ad8-b8c9-6be4dc7eec5a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4b2295ae-6f1d-4392-bc0d-72dbb7dbc9e9","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2d0aac25-d49c-4932-9126-fc414fdaef75","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"71994ba1-b762-4b94-b3fd-aa615e4f5be6","typeOfStateId":"state","$connId":"con_728","$id":"1da66945-cc74-4e34-b7a1-b0a5ff66e396","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"08f16855-6814-4e17-94df-4f597c5e767d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"POS fixo\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ce01e544-397d-47f6-93b7-077a1afe9e13","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e939dca4-3883-45b2-9259-5c23644b8c96","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-76fe47c9-ab77-47a7-b270-a1a658048165","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b507fb54-14f7-40f1-bb71-3fbb2e3af985","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"65abd5f9-1bec-4b5b-8688-1efa12a63cc6","root":false,"$title":"[MS.9.3.0][MSG] Menu Discado","$position":{"top":"1374px","left":"19469px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9358d504-8ea3-4711-9e34-4ed1b5978d61":{"$contentActions":[{"action":{"$id":"f4bb5296-4030-4f47-b3d3-128ded0645b4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fa35c691-25b2-4f63-851d-6980deabd20a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fa35c691-25b2-4f63-851d-6980deabd20a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"cad60d92-9818-4708-88e9-b57433e28998","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e0c9a8af-9b75-40df-ba58-f44fbfebd980","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"fa590f70-d5a2-4829-ba75-1b1f379d2ef8","typeOfStateId":"state","$connId":"con_733","$id":"8d43a7f0-7fc9-45c7-b269-b64ccfdc08de","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"46147313-9d63-464a-83f6-aa33cbf2e163","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"d7e3cc3f-cb4b-43b3-8f17-7185ef65f15c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-42170e07-97e9-4ead-9d4e-55eedaba30f9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9873168f-67ab-4830-9f7a-f543b38cfd73","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f3486045-5dba-47dc-babd-ac04fe27d1f3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9358d504-8ea3-4711-9e34-4ed1b5978d61","root":false,"$title":"[MS.9.2.0][MSG] Menu Torre de celular com X","$position":{"top":"1364px","left":"19823px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"25cca5a7-86d4-4fdc-8365-7a0c5fb621e6":{"$contentActions":[{"action":{"$id":"09d5e6dc-254d-4dc8-bc2d-11eeb7180004","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d113787a-6ef9-4971-98f9-d84bff005672","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d113787a-6ef9-4971-98f9-d84bff005672","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a4acbd7d-6f10-40e0-a2b7-469f6ff3ba31","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b4bbf748-1e14-447d-a070-a5e14ff31bb9","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ace3440e-4fba-4fe7-ac92-302202b38274","typeOfStateId":"state","$connId":"con_738","$id":"518434b4-d90a-4f82-8c88-bb5506311e8b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"cf24c171-f3ab-4cf9-bad0-070e48bfc339","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"9f765c68-0f7b-49d8-9ec5-10608fd8458c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Você possui *OS de desinstalação* em aberto?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-810a0c34-7488-456a-8985-7b6f0918f400","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-682131a9-452a-4c28-9976-80a57a5ce213","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-73b20252-0b85-4402-9db6-7b39505d7a17","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"25cca5a7-86d4-4fdc-8365-7a0c5fb621e6","root":false,"$title":"[MS.9.1.0][MSG] Menu Erro desfazimento","$position":{"top":"1363px","left":"20562px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"62351bb7-2a04-4870-8545-31112cece2c5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"62351bb7-2a04-4870-8545-31112cece2c5","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"1825.48px","left":"17388.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"7f64f93d-914a-45fc-9c38-15eafc970ed6":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c8b02012-8d08-4154-81fc-c2138fed71c5","typeOfStateId":"state","$connId":"con_743","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"8ea6dad9-5026-46da-b3c4-c351fe56ab19","typeOfStateId":"state","$connId":"con_748","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Smart"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"cce8ed82-b220-4dd9-b77b-709d41a78ff1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"16df5799-7765-4307-991a-ade4f52e7e22","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"08517b9b-09d3-46e4-9d28-54c4caf0ce18","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-14b094ba-f938-4acb-b82a-b78018617276","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0e206fae-ed62-4039-9c7e-72ddd65a8039","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-00d478ce-66cc-42a7-8840-bb894a39c259","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-241f28d1-4911-48a0-95ec-1d2e8e6eae9f","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7f64f93d-914a-45fc-9c38-15eafc970ed6","root":false,"$title":"[MS.9.5.0][INPUT] Menu Acessar arquivo","$position":{"top":"1573px","left":"18290px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c8b02012-8d08-4154-81fc-c2138fed71c5":{"$contentActions":[{"action":{"$id":"ddc1ccb8-370b-4b96-b023-ef062a8c5954","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ec68cd12-6a93-4e5e-b6c8-4960d24c45e5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ec68cd12-6a93-4e5e-b6c8-4960d24c45e5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9bf944e9-7da4-4b8a-a3b2-5f11643d0d70","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4e75fc64-9e1b-4213-b723-adca8f4e03d0","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"4e75fc64-9e1b-4213-b723-adca8f4e03d0","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-257db89b-1e25-4c13-ad75-e96e9c6f164c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c8b02012-8d08-4154-81fc-c2138fed71c5","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1957px","left":"18473px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"8ea6dad9-5026-46da-b3c4-c351fe56ab19":{"$contentActions":[{"action":{"$id":"8de07203-cb7f-4e6f-ab9d-b789ccd0499c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6a32dea3-fc9b-44d7-8564-e0366d7776e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6a32dea3-fc9b-44d7-8564-e0366d7776e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"93d880cc-d2a4-43f9-8b5d-f9430ed0f40d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"433ef16e-dc38-476e-9a29-39a882d068ee","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione menu.\n\n2° Clique no símbolo da engrenagem.\n\n3° Digite a senha 1: 2001.\n\n4° Digite a senha 2: 260089.\n\n5° Acesse o menu app.\n\n6° Selecione Safra.\n\n7° Clique em Clear Data.\n\n8° Confirme com ok.\n\n9° Agora, reinicie e tente novamente.","metadata":{}},"$cardContent":{"document":{"id":"433ef16e-dc38-476e-9a29-39a882d068ee","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione menu.\n\n2° Clique no símbolo da engrenagem.\n\n3° Digite a senha 1: 2001.\n\n4° Digite a senha 2: 260089.\n\n5° Acesse o menu app.\n\n6° Selecione Safra.\n\n7° Clique em Clear Data.\n\n8° Confirme com ok.\n\n9° Agora, reinicie e tente novamente."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"35e68089-a26b-41bc-ba31-cc8ecb4d6a1e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"bbce0379-c441-4a6b-ab3a-dc9e82ac261d","typeOfStateId":"state","$connId":"con_753","$id":"f292124e-0014-470b-a1a6-f512f4b2526f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ec5f61d4-a042-4dfa-84e3-76be54c0231b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-62e3a3d8-c2e0-4ab0-a03c-a80c08253c7c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-203007df-0a46-4e53-9b82-fc98f01a5d25","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8ea6dad9-5026-46da-b3c4-c351fe56ab19","root":false,"$title":"[MS.9.5.1][MSG] Tutorial Acessar arquivo","$position":{"top":"1939px","left":"18116px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bbce0379-c441-4a6b-ab3a-dc9e82ac261d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"bbce0379-c441-4a6b-ab3a-dc9e82ac261d","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2172.67px","left":"18475px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"3c3398a1-0b05-4599-9fbe-422d5796e9b4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_758","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false,"stateId":"c8b02012-8d08-4154-81fc-c2138fed71c5"},{"stateId":"fc75e150-8d74-4b41-baf1-391aedc93056","typeOfStateId":"state","$connId":"con_763","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Outro modelo"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"5e85ca75-e129-4e38-8aef-5a2a0a281212","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a9cd518d-bb8f-4864-b24a-c79b105528a7","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"43e668f3-4c7a-46f8-8416-bff1820f0525","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"e25dc608-32bd-4d2e-92a1-9b370f509dcf","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5d48b1b6-475e-4b55-aa20-8e55010a2cf6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-95997224-dd2c-41cb-8474-d49814d0f8bf","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-d8c23ff3-cd08-40cc-887b-890da53d547e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c7e0c853-7046-447e-8405-a05cfd3c726a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3c3398a1-0b05-4599-9fbe-422d5796e9b4","root":false,"$title":"[MS.9.4.0][INPUT] Menu Ethernet","$position":{"top":"1595px","left":"18704px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"fc75e150-8d74-4b41-baf1-391aedc93056":{"$contentActions":[{"action":{"$id":"5c298983-3089-4666-b85b-2b503cfb5b9e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"083e6ba7-ee83-483c-a951-5a782b204ca5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"083e6ba7-ee83-483c-a951-5a782b204ca5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b77c258d-398e-40af-bb6f-f2db2de13c8a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"502adcb2-35f6-48a8-8c72-8fb8adbbf6ef","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n1° Verifique se o cabo de internet está conectado corretamente.\n\n2° Verifique se o cabo de internet não está com mau contato.\n\n3° Aperte o botão do lado direito para acessar a opção atalho.\n\n4° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"502adcb2-35f6-48a8-8c72-8fb8adbbf6ef","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n1° Verifique se o cabo de internet está conectado corretamente.\n\n2° Verifique se o cabo de internet não está com mau contato.\n\n3° Aperte o botão do lado direito para acessar a opção atalho.\n\n4° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"709fe4ca-f799-4b7d-9787-57c369566fda","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ad34ceea-a4a8-406b-b25e-e86e16870a9e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ad34ceea-a4a8-406b-b25e-e86e16870a9e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6792d24c-b97b-4308-bdad-cd6da317fc60","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a9436bed-3e52-4dc8-bead-529154df4c82","type":"text/plain","content":"Deu certo fazer isso?\n\nSe sim, o equipamento está pronto para transacionar. Finalizar.\n\nSe não, tente o seguinte:\n\n- Aperte o botão do lado direito para acessar a opção atalho.\n- Pressione o atalho 992.\n- Pressione a opção ETHERNET.\n- Selecione a opção \"tipo IP Dinâmico\" e pressione verde.\n- Pressione o atalho 933.","metadata":{}},"$cardContent":{"document":{"id":"a9436bed-3e52-4dc8-bead-529154df4c82","type":"text/plain","content":"Deu certo fazer isso?\n\nSe sim, o equipamento está pronto para transacionar. Finalizar.\n\nSe não, tente o seguinte:\n\n- Aperte o botão do lado direito para acessar a opção atalho.\n- Pressione o atalho 992.\n- Pressione a opção ETHERNET.\n- Selecione a opção \"tipo IP Dinâmico\" e pressione verde.\n- Pressione o atalho 933."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"93807f04-544b-45b5-9424-492ee4c5494e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"bbce0379-c441-4a6b-ab3a-dc9e82ac261d","typeOfStateId":"state","$connId":"con_768","$id":"e73f0c2e-f943-4789-9985-5afd962badd1","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ff8af79e-de34-403f-87bb-4d2a87fe5077","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e7d76fd6-83c2-4abc-9928-98e6f456a5d6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e7a5e7d9-1a33-42d0-a85c-9f2f8f95ee38","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fc75e150-8d74-4b41-baf1-391aedc93056","root":false,"$title":"[MS.9.4.0][MSG] Tutorial Ethernet","$position":{"top":"1955.67px","left":"18857px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"71994ba1-b762-4b94-b3fd-aa615e4f5be6":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"4ccf9b34-36af-4a74-aea4-44dc363f3353","typeOfStateId":"state","$connId":"con_773","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"f59a89a7-936c-4d02-a416-c052131b24eb","typeOfStateId":"state","$connId":"con_778","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["POS fixo"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f3d3f6ba-e9c1-4c7f-a424-10a4b213b0c6","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c93c9954-79f0-4239-b11d-d05520ac97b8","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"63c4809c-1365-40d7-b3e9-9e5f7433c1fa","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"bcb35483-3216-4adc-b8d6-9bcd39e2f186","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-107ac257-b8da-4247-bc1b-0559022d7450","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-34e1ab4f-bfc7-4e46-8644-78f4826e7025","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-5df11118-9eed-43da-9d8b-215dd977a3c9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b04d140e-d179-4be6-b21f-13de925871cb","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"71994ba1-b762-4b94-b3fd-aa615e4f5be6","root":false,"$title":"[MS.9.3.0][INPUT] Menu Discado","$position":{"top":"1623.67px","left":"19469px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f59a89a7-936c-4d02-a416-c052131b24eb":{"$contentActions":[{"action":{"$id":"6867ef5c-0600-4cc7-a4d5-c56f36c3c079","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"934aa63d-70be-431f-918b-4884eab1965e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"934aa63d-70be-431f-918b-4884eab1965e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"815f1f80-2b0f-49f7-816e-085a17d933ca","$typeOfContent":"text","type":"SendMessage","settings":{"id":"56946943-cfd5-41ee-9b78-f666ccaadfd0","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Certifique-se de que a linha telefônica esteja funcionando corretamente.\n\n2° Conecte o cabo no aparelho telefônico para verificar se há sinal através de um tom de discagem.\n\n3° Mude o terminal para outra linha telefônica.\n\n4° Aperte o botão do lado direito para acessar a opção atalho.\n\n5° Pressione o atalho 992.\n\n6° Pressione a opção discado.\n\n7° Selecione o tipo de conexão: PULSE.\n\n8° Caso tenha PABX, a opção para obter linha geralmente é 0 ou 9.\n\n9° Digite o número de inicialização: 0800 722 7287.\n\n10° Configure a velocidade de comunicação para 2400.\n\n11° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"56946943-cfd5-41ee-9b78-f666ccaadfd0","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Certifique-se de que a linha telefônica esteja funcionando corretamente.\n\n2° Conecte o cabo no aparelho telefônico para verificar se há sinal através de um tom de discagem.\n\n3° Mude o terminal para outra linha telefônica.\n\n4° Aperte o botão do lado direito para acessar a opção atalho.\n\n5° Pressione o atalho 992.\n\n6° Pressione a opção discado.\n\n7° Selecione o tipo de conexão: PULSE.\n\n8° Caso tenha PABX, a opção para obter linha geralmente é 0 ou 9.\n\n9° Digite o número de inicialização: 0800 722 7287.\n\n10° Configure a velocidade de comunicação para 2400.\n\n11° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cf60fda3-a781-47c3-909a-ba146e2b2c9f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f5497511-a788-4a38-9dc1-e57f10826795","typeOfStateId":"state","$connId":"con_783","$id":"900825f6-8685-47b7-9bc9-194d463f1fea","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"4a15384d-bb4e-4c87-8446-6af4acff6ac8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dff73186-7728-4fbd-8d42-c043b141b06d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fe485254-4d1a-4337-bbce-8b43daa137f7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f59a89a7-936c-4d02-a416-c052131b24eb","root":false,"$title":"[MS.9.3.1][MSG] Tutorial Discado","$position":{"top":"1961.67px","left":"19319px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4ccf9b34-36af-4a74-aea4-44dc363f3353":{"$contentActions":[{"action":{"$id":"9706e80c-077c-4077-a1e2-0f5221a22e46","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a35a6509-7137-4c11-8a3b-7c76da277263","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a35a6509-7137-4c11-8a3b-7c76da277263","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"dbda2370-4aa4-4a0c-9098-0891088dce4e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7a0688c1-edb3-4dd4-be6a-e3fe5efe0e30","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"7a0688c1-edb3-4dd4-be6a-e3fe5efe0e30","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b1851266-728b-4133-88ed-74b252065360","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4ccf9b34-36af-4a74-aea4-44dc363f3353","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1947px","left":"19646px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"f5497511-a788-4a38-9dc1-e57f10826795":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"f5497511-a788-4a38-9dc1-e57f10826795","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2191px","left":"19656px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"fa590f70-d5a2-4829-ba75-1b1f379d2ef8":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_788","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false,"stateId":"4ccf9b34-36af-4a74-aea4-44dc363f3353"},{"stateId":"ae9b55fe-db28-47d9-9216-b529f2f848e3","typeOfStateId":"state","$connId":"con_793","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Smart"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"7819e582-fd62-4bfb-a366-be34df9ad170","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f7a97479-bf44-4225-b63d-95c193a529ee","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"c9042d62-bad4-4ddb-960e-a582fbea0b46","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"2af45440-f9ff-4b10-8406-1c6315b0eb72","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c6a7e436-e534-40e6-b8f2-d0fd70f6a278","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b8e8b2cb-6c88-45d7-a741-9b6071213662","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ce237472-82bb-48d9-b1fc-a3a830259791","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ffdb4d4f-282f-4783-950f-817f5581204a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"fa590f70-d5a2-4829-ba75-1b1f379d2ef8","root":false,"$title":"[MS.9.2.0][INPUT] Menu Torre de celular com X","$position":{"top":"1605px","left":"19823px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"ae9b55fe-db28-47d9-9216-b529f2f848e3":{"$contentActions":[{"action":{"$id":"1eee978a-ae2b-424f-866b-67eefe7e37f8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8e41ea2d-f05e-4bf3-a08e-b2e68f3bb3e7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8e41ea2d-f05e-4bf3-a08e-b2e68f3bb3e7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1c636214-495b-4a5d-b21f-838c13a909b8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"eda644a6-0762-49a5-8c63-88b6bf4eb9e9","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local dele com um pano seco.\n\n4° Coloque o chip novamente no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação.","metadata":{}},"$cardContent":{"document":{"id":"eda644a6-0762-49a5-8c63-88b6bf4eb9e9","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local dele com um pano seco.\n\n4° Coloque o chip novamente no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"acce09ad-1976-418a-83d2-3e6d5c0cd85e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"435b39bc-fe24-4bb8-9a18-1dfface95021","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"435b39bc-fe24-4bb8-9a18-1dfface95021","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"664a77c1-37e1-4416-a94c-0897bfd4a601","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3c0c38d6-2c85-4d75-84a1-c98375184138","type":"text/plain","content":"Você conseguiu atualizar?  \n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste.","metadata":{}},"$cardContent":{"document":{"id":"3c0c38d6-2c85-4d75-84a1-c98375184138","type":"text/plain","content":"Você conseguiu atualizar?  \n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8ef56b72-ba3c-4d1b-8688-cb58563800d1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f5497511-a788-4a38-9dc1-e57f10826795","typeOfStateId":"state","$connId":"con_798","$id":"60e1a190-5164-45c3-bec8-58035b28fb93","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"71465794-1985-4807-8087-892a53b9bb91","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f31f5fa0-343a-4104-88ec-84d3ed154fa4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-dad6eb01-c6fe-44ae-87d0-1681de1c9614","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ae9b55fe-db28-47d9-9216-b529f2f848e3","root":false,"$title":"[MS.9.2.1][MSG] Tutorial Torre de celular com X","$position":{"top":"1976.67px","left":"20004px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"ace3440e-4fba-4fe7-ac92-302202b38274":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"826d67de-104b-43dd-b938-62696a7e494b","typeOfStateId":"state","$connId":"con_803","$id":"f33311be-7152-4ae3-8d40-1e1c7db088f5","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"8b75bf20-495b-4728-b6c9-61ca7451db67","typeOfStateId":"state","$connId":"con_808","$id":"5c30b03e-547e-4775-b07c-f602626ff1f8","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"75556b5e-8d16-4691-9bd0-7a7680bcee95","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"28d83ea2-5e70-48be-bd6e-10e8aa978ac5","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"34de07d9-c683-4939-8587-16544e835bea","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"8c1d5af2-2e19-44fa-bf9d-3f1eb9b9d2a1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b77634a2-29f2-4780-96e6-5ec386be6136","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9ef7a95f-7582-40e8-8983-233d237de205","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-95ef909b-9c03-4d6c-b2b5-78b3d71a727a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6a8d8a71-c09d-4e77-b031-c5f58a3d3a50","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"ace3440e-4fba-4fe7-ac92-302202b38274","root":false,"$title":"[MS.9.1.0][INPUT] Menu Erro desfazimento","$position":{"top":"1609.67px","left":"20559px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8b75bf20-495b-4728-b6c9-61ca7451db67":{"$contentActions":[{"action":{"$id":"09dd9cb1-1335-431d-ab6b-fdc67bb608f8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f8d71005-ef8c-40d3-88b2-33cfcbb8fc0a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f8d71005-ef8c-40d3-88b2-33cfcbb8fc0a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1f6623bc-6bb8-4866-acd4-0b0b8114928a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d90f6242-2971-4752-b622-c7fd3123568e","type":"text/plain","content":"Neste caso, realize o atalho 9990.","metadata":{}},"$cardContent":{"document":{"id":"d90f6242-2971-4752-b622-c7fd3123568e","type":"text/plain","content":"Neste caso, realize o atalho 9990."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"466ff8ab-ba31-44ff-9d68-9ee3206cb484","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a433dcaf-c60b-4227-b638-c6f9e6698090","typeOfStateId":"state","$connId":"con_813","$id":"c80da39a-59b5-4c1b-97f8-74311add3cd8","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"29d72261-ed27-4ca1-8a8e-8e6a31823ba5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a5221783-16d3-4301-929c-ded5fc7bbd0d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-78ba363e-1c07-4cce-a26d-aa1f3e57dfb9","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8b75bf20-495b-4728-b6c9-61ca7451db67","root":false,"$title":"[MS.9.1.1][MSG] Dica Erro desfazimento","$position":{"top":"1936px","left":"20461px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"826d67de-104b-43dd-b938-62696a7e494b":{"$contentActions":[{"action":{"$id":"3b9c4343-0d7a-4fd5-b995-79ebfa49a845","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"18d0fcd7-c2bf-4727-b14b-1af2a8677936","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"18d0fcd7-c2bf-4727-b14b-1af2a8677936","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"719b16ca-f66f-4c01-bfaa-d4955d4dd93e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1e317512-cd28-49c9-8bd4-189125afbe5c","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"1e317512-cd28-49c9-8bd4-189125afbe5c","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3c3aa56c-e2fd-4b4b-a8a4-4a1210667cb9","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"826d67de-104b-43dd-b938-62696a7e494b","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1929px","left":"20694px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"a433dcaf-c60b-4227-b638-c6f9e6698090":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"a433dcaf-c60b-4227-b638-c6f9e6698090","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2182.67px","left":"20461px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"47c6e908-5e18-4f58-b4f2-9d29613f7e6d":{"$contentActions":[{"action":{"$id":"9ef1675f-c8f5-4de0-a505-868769c3951a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d68cb396-b326-47d9-899f-be888a1d632e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d68cb396-b326-47d9-899f-be888a1d632e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4d0cb188-17e8-444c-b889-5a7e9aa469b8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9ec156da-adf6-4823-9ece-def818154534","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione a função atalho via app do cliente.\n\n2° Selecione a função 990.\n\n3° Confirme a atualização.\n\n4° Pressione novamente o atalho via app do cliente.\n\n5° Selecione a função 993.\n\n6° Equipamento reconfigurado.","metadata":{}},"$cardContent":{"document":{"id":"9ec156da-adf6-4823-9ece-def818154534","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione a função atalho via app do cliente.\n\n2° Selecione a função 990.\n\n3° Confirme a atualização.\n\n4° Pressione novamente o atalho via app do cliente.\n\n5° Selecione a função 993.\n\n6° Equipamento reconfigurado."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"9c80bc94-68d7-4dfb-a1be-5425784db1b4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"8a5361a8-de29-4f47-ac5e-b2f203bcfc84","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a0e5db2a-e050-4e9c-94a4-ceaaa10975d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"a0e5db2a-e050-4e9c-94a4-ceaaa10975d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"62351bb7-2a04-4870-8545-31112cece2c5","typeOfStateId":"state","$connId":"con_818","$id":"98ceb742-0f1f-4328-a1b1-db30b912177e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"70f2b1bc-ea89-40e0-8610-59f53b28dcad","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5529beaa-bd69-4d4b-b767-d74ed49e8a37","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7c1c9540-bf90-4199-b501-b867a1587d9b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"47c6e908-5e18-4f58-b4f2-9d29613f7e6d","root":false,"$title":"[MS.9.7.0][MSG] Informativo Códigos","$position":{"top":"1308px","left":"17389px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"0d4f7110-4dfd-429a-a88a-cedec3b42217":{"$contentActions":[{"action":{"$id":"539754ca-f29c-447f-be33-1221fd52fad3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"055c90c5-956d-4a1c-82b8-9a9c9773447d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"055c90c5-956d-4a1c-82b8-9a9c9773447d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"82d65c05-684c-4b84-932f-b9318f88c0d8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"98a5273d-2c41-4f63-ae97-b395e6184bc0","type":"text/plain","content":"Preparei uma lista de atalhos da sua máquina que pode te ajudar no dia a dia.","metadata":{}},"$cardContent":{"document":{"id":"98a5273d-2c41-4f63-ae97-b395e6184bc0","type":"text/plain","content":"Preparei uma lista de atalhos da sua máquina que pode te ajudar no dia a dia."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6e6d4eee-dbbd-4ce7-9bd5-98b23156216d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0c3b5bec-c62f-474c-85a3-bc7ee26549b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"0c3b5bec-c62f-474c-85a3-bc7ee26549b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ff20e41d-dd5d-4961-8f69-ad39faf05fd9","$typeOfContent":"media","type":"SendMessage","settings":{"id":"f9618269-b40c-46b7-a95b-1a97235960da","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/png","uri":"https://i.imgur.com/DL0qkZU.png","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"f9618269-b40c-46b7-a95b-1a97235960da","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/png","uri":"https://i.imgur.com/DL0qkZU.png","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"69256712-f738-4b82-9087-ccec82eff53b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"936c7f20-2d18-48a2-ab8c-3b8dda223a52","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b36ea4c7-17b2-4503-86e5-75352f1e81da","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"b36ea4c7-17b2-4503-86e5-75352f1e81da","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"62351bb7-2a04-4870-8545-31112cece2c5","typeOfStateId":"state","$connId":"con_823","$id":"99b44c24-4924-4862-b6f2-c92b40b652e7","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ac966489-70d7-478e-bde5-47d1bf73063c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7ac1c644-8f74-4bd0-900d-1ae253100a61","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5933ece6-0346-433b-922a-329441c0abb0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0d4f7110-4dfd-429a-a88a-cedec3b42217","root":false,"$title":"[MS.9.8.0][MSG] Informativo Atalhos","$position":{"top":"1309px","left":"17145px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"5f4a5491-d20a-47dd-b5f1-39f15cef7df1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"02bab647-2209-4b62-a370-2acb5ef95a73","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"5f4a5491-d20a-47dd-b5f1-39f15cef7df1","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"1243.5px","left":"9914.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"48fe2065-65c7-4601-b47d-6222ad48b7dd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2be08df4-eb13-4dfb-8f27-24992583fed5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"48fe2065-65c7-4601-b47d-6222ad48b7dd","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2531.67px","left":"11463px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9bf09db0-b546-44ed-966d-e19e6062a4bb":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2be08df4-eb13-4dfb-8f27-24992583fed5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9bf09db0-b546-44ed-966d-e19e6062a4bb","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"1581px","left":"13085px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"80842650-23df-4c88-b522-b3939ada67f4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"42d151ec-d972-4147-af06-f29a49a201d0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"80842650-23df-4c88-b522-b3939ada67f4","root":false,"$title":"[GO TO] MS.6.2.0 Problemas / comunicação","$position":{"top":"1579px","left":"7511px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1f53a2ba-b515-46bf-a6cd-ab2a4a18420c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"37286ef7-791d-4af5-938f-fd2600482e21","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"147d7713-1860-43c0-a094-4e2bf59b000c","typeOfStateId":"state","$connId":"con_828","$id":"fe0b12d8-a6b7-4f11-8011-6bb8511ef053","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"18eb9e2c-4309-4ebc-81ee-6eecba46c7a3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"d46ba7ea-d135-4cb2-9695-f43fc214c06e","type":"ExecuteScript","$title":"Process \"payloadProtocolo\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(contaSelecionada) {\n    const { doc, codigoSegmento } = JSON.parse(contaSelecionada)\n    const payload = JSON.stringify({\n        origemDesc: \"CLIENTE\",\n        idSegmento: parseInt(codigoSegmento),\n        CpfCnpj: doc,\n        canalDesc: \"WHATSAPP\",\n        statusDesc: 'ABERTO',\n        usuarioInclusao: 'USR_SPD'\n    })\n    return payload;\n}\n\n","inputVariables":["contaSelecionada"],"outputVariable":"payloadProtocolo","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"70cd3530-a826-4b84-9381-0f299c51e143","type":"ProcessHttp","$title":"HTTP POST \"bodyProtocoloBpm\" (Cria Protocolo no Front)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Correlation-ID":"{{random.guid}}"},"method":"POST","body":"{{payloadProtocolo}}","uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos","responseStatusVariable":"statusProtocoloBpm","responseBodyVariable":"bodyProtocoloBpm"},"conditions":[]},{"$id":"df5da49c-4330-4f1e-902f-115da63bca8a","type":"ExecuteScript","$title":"Process \"idProtocoloBpm\" (Pega Id do protocolo BPM)","$invalid":false,"settings":{"function":"run","source":"function run(protocolo) {\n    try {\n        const protocoloId = JSON.parse(protocolo);\n        return protocoloId.data.id;\n    }\n    catch (err) {\n        return \"Falha ao abrir protocolo, tente novamente em alguns instantes.\"\n    }\n}\n","inputVariables":["bodyProtocoloBpm"],"outputVariable":"idProtocoloBpm","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dd7ad50b-8d3d-4de6-b79e-0589d7bbb546","type":"ExecuteScript","$title":"Process \"payloadOcorrencia\" (Gera payload ocorrencia)","$invalid":false,"settings":{"function":"run","source":"function run(body, routerId, motivo, description) {\n    try {\n        const { tipoId, motivoId, subMotivoId } = JSON.parse(body)[routerId][motivo];\n        const newBody = {\n            tipoId,\n            motivoId,\n            subMotivoId,\n            statusProcessamentoDesc: 'ABERTO',\n            usuarioInclusao: 'USR_SPD',\n            observacaoSolucaoAtendimento: description || '',\n            origem: 'CLIENTE',\n        }\n        return newBody\n    } catch (err) {\n        return false\n    }\n}","inputVariables":["resource.taxionomiaProtocolos","tunnel.owner","motivoProtocolo","transacoesNaoAutorizadas"],"outputVariable":"payloadOcorrencia","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"statusProtocoloBpm","values":["200"]}]},{"$id":"fa02da61-b215-4245-b6e4-9797d84c4640","type":"ProcessHttp","$title":"HTTP POST \"bodyOcorrencia\" (Cria nova ocorrencia)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"POST","body":"{{payloadOcorrencia}}","uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}/ocorrencias","responseStatusVariable":"statusOcorrencia","responseBodyVariable":"bodyOcorrencia"},"conditions":[{"source":"context","comparison":"equals","variable":"statusProtocoloBpm","values":["200"]}]},{"$id":"8ad0987d-bfc1-4ff4-97a3-294b9bce7973","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyConsultaProtocolo\" (Consultar Protocolo)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}"},"uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}","method":"GET","responseStatusVariable":"statusConsultaProtocolo","responseBodyVariable":"bodyConsultaProtocolo"},"conditions":[]},{"$id":"67331b9a-87c1-4820-9546-16ab427bc93c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusOcorrencia","statusProtocoloBpm"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"78169064-335c-4db0-9d00-f96f4e2e6de6","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"statusOcorrencia"}]},{"$id":"cae6835d-0a22-48ea-a108-f105ab492384","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api resumo\" (POST) (PROTOCOLO)","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos | {{payloadProtocolo}} | {{statusProtocoloBpm}} | {{bodyProtocoloBpm}}","category":"{{state.name}} api resumo"},"conditions":[]},{"$id":"f79819f1-e657-40ba-b15b-e54ced0626d6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api resumo\" (POST) (OCORRENCIA)","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}/ocorrencias | {{payloadOcorrencia}} | {{statusOcorrencia}} | {{bodyOcorrencia}}","category":"{{state.name}} api resumo 2"},"conditions":[]},{"$id":"367a37f1-1d85-49e9-81f9-c53bf79a01d4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{apiStatus}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"apiStatus"}]},{"$id":"ced798ec-9ac1-44ae-9f7b-af6db889d520","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\" statusProtocoloBpm","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"{{idSessao}}","identity":"{{contact.identity}}","body":"{{payloadProtocolo}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos | {{statusProtocoloBpm}}"},"conditions":[]},{"$id":"350aad19-3862-405c-81b8-f579aeb2cee8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\" statusOcorrencia","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"{{idSessao}}","identity":"{{contact.identity}}","idProtocoloBpm":"{{idProtocoloBpm}}","payloadOcorrencia":"{{payloadOcorrencia}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/idProtocoloBpm/ocorrencias | {{statusOcorrencia}}"},"conditions":[]},{"$id":"193b1c75-f9f7-4910-81de-983384584e5f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\" statusConsultaProtocolo","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"{{idSessao}}","identity":"{{contact.identity}}","idProtocoloBpm":"{{idProtocoloBpm}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/idProtocoloBpm | {{statusConsultaProtocolo}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-92b3a54a-6da5-4e93-b220-291a7a7c0b8f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f29b29d5-32a3-4939-b307-1f1d66ebed6c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-31000551-18c9-41b8-8a19-a6f57042c871","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-6ae89bc9-93c8-46e7-8461-7bf4e0096069","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"1f53a2ba-b515-46bf-a6cd-ab2a4a18420c","root":false,"$title":"[MS.7.3.0][HTTP] API Protocolo","$position":{"top":"3423px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"147d7713-1860-43c0-a094-4e2bf59b000c":{"$contentActions":[{"action":{"$id":"45f97abd-40f1-49d2-b32d-5d2bd8d47b76","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"16b7394e-69a5-44f6-b7e5-801df45598c4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"16b7394e-69a5-44f6-b7e5-801df45598c4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f57aa66e-5e2d-4c76-a16b-b0edea72f473","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2f380a9e-1cc7-44d4-8275-a1aaa2a51f0c","type":"text/plain","content":"{{dynamicContent}}","metadata":{}},"$cardContent":{"document":{"id":"2f380a9e-1cc7-44d4-8275-a1aaa2a51f0c","type":"text/plain","content":"{{dynamicContent}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"89972cb3-737e-4e2a-b4bd-58d53d901764","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e0da63ed-873f-4a03-8d51-babc22749386","typeOfStateId":"state","$connId":"con_833","$id":"a6e628de-f141-4cfc-b534-8b7b8338da8c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6bc02259-d8c7-4507-93bf-4a83be51155d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\" (DadosDoProtocolo)","$invalid":false,"settings":{"function":"run","source":"function run(obj) {\n    try {\n        obj = JSON.parse(obj).data;\n        let msgsProtocolo = [];\n        let msg = `Agradecemos pelas informações. 😊\n\nSeguem os dados do seu protocolo.👇`\n        msgsProtocolo.push(msg);\n\n        for (let i = 0; i < obj.length; i++) {\n            let msg = `• *${obj[i].id}*\n• *Aberto em*: ${getDataFormatada(obj[i].dataHoraInclusao)}\n• *Retorno previsto*: ${getAddDoisDiasUteis(obj[i].dataHoraInclusao, obj[i].maiorSLAOcorrencia)}`;\n            msgsProtocolo.push(msg);\n        };\n        msgsProtocolo = msgsProtocolo.join(\"\\n\\n\");\n        return msgsProtocolo;\n    }\n    catch (e) {\n        return e.message;\n    }\n}\nfunction getDataFormatada(data) {\n    let dataHoraInclusao = new Date(data);\n    let dia = (\"0\" + dataHoraInclusao.getDate()).slice(-2);\n    let mes = (\"0\" + (dataHoraInclusao.getMonth() + 1)).slice(-2);\n    let ano = dataHoraInclusao.getFullYear();\n    return `${dia}/${mes}/${ano}`;\n};\n\nfunction getAddDoisDiasUteis(data, maiorSLAOcorrencia) {\n    data = new Date(data);\n    maiorSLAOcorrencia = maiorSLAOcorrencia ? parseInt(maiorSLAOcorrencia) : 4;\n    for (let i = 0; i < maiorSLAOcorrencia;) {\n        data.setDate(data.getDate() + 1);\n        if (data.getDay() !== 0 && data.getDay() !== 6) {\n            i++;\n        }\n    }\n    return getDataFormatada(data);\n}\n","inputVariables":["bodyConsultaProtocolo"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"004fc65a-b3f0-4473-a400-139e877103a4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dd84790b-9e44-4611-8b5d-6fb6585bee25","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-30c245f9-9be7-4209-97b3-72c1e9b04bcc","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a7deaeff-a40c-485a-903a-0ce7f19c5200","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"147d7713-1860-43c0-a094-4e2bf59b000c","root":false,"$title":"[MS.7.4.0][MSG] Status Protocolo Aberto","$position":{"top":"3661px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e0da63ed-873f-4a03-8d51-babc22749386":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d5a1d918-e12a-42a1-a7e2-278c000430f1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e0da63ed-873f-4a03-8d51-babc22749386","root":false,"$title":"[GO TO] Redirect to Finalizacao ","$position":{"top":"3880px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e335ceac-e744-405a-8be6-573e70ef7fc2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea7de052-de25-408e-a19f-dfa8bcd71cce","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e335ceac-e744-405a-8be6-573e70ef7fc2","root":false,"$title":"[GO TO] Redirect to Finalizacao","$position":{"top":"613px","left":"4507px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c5482705-133e-4f31-b01e-7930e16e12a3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '63897915-e896-4c66-ba27-f5cf84ea3f0a',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cbef1e34-7f2b-4d4a-82c4-8b080009f1b1","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"onboarding"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2303a119-c406-4094-9dcd-bc815c2f16fc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-67c42581-fb6f-4e24-ad86-9958bebf877e","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"c5482705-133e-4f31-b01e-7930e16e12a3","root":false,"$title":"[Redirect] To \"Autenticacao\" (Simulador de vendas)","$position":{"top":"238.333px","left":"2763.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"63897915-e896-4c66-ba27-f5cf84ea3f0a":{"$contentActions":[{"action":{"$id":"9cf758d6-8e87-4998-85e6-1b2eaadd853e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f06f62a5-70c6-4221-8715-fdc4567381c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f06f62a5-70c6-4221-8715-fdc4567381c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6339baf9-b191-4c51-a549-917443160bd5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"27a005a8-7031-4512-b28e-093cdd4dc92a","type":"text/plain","content":"Você pode simular de duas formas:\n\n<b>Quero cobrar:</b>\n- Insira o valor que deseja cobrar do cliente para ver quanto receberá após a aplicação das taxas.\n\n<b>Quero receber:</b>\n- Insira o valor líquido que deseja receber da venda, e o sistema calculará o valor a ser cobrado, considerando os descontos e taxas.","metadata":{}},"$cardContent":{"document":{"id":"27a005a8-7031-4512-b28e-093cdd4dc92a","type":"text/plain","content":"Você pode simular de duas formas:\n\n<b>Quero cobrar:</b>\n- Insira o valor que deseja cobrar do cliente para ver quanto receberá após a aplicação das taxas.\n\n<b>Quero receber:</b>\n- Insira o valor líquido que deseja receber da venda, e o sistema calculará o valor a ser cobrado, considerando os descontos e taxas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f61f2d1c-79cd-42d3-8a2f-925a381b2d2b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"136deec1-b274-4d22-b9a2-021b3c27c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"136deec1-b274-4d22-b9a2-021b3c27c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6851e987-b421-4d6c-8039-304ed8ddac92","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"63e9145d-3760-4ef3-ba6e-88f41a491e41","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8f1c55b1-7d84-4727-a19c-145275d573e4","typeOfStateId":"state","$connId":"con_838","$id":"3e12632c-4292-499f-ad43-d2b0e19815a4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6cf082c9-1a1a-40b3-ba97-43413903f57d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"3343998f-7c5e-4b6a-89f2-74839c8a1a4c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Quero cobrar\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Quero receber\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Selecione abaixo qual simulação você quer fazer. 👇\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d55d043b-14c9-4cdb-8ac7-8419d5c56db1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a98c4c12-64c2-4fc2-b3bd-ab691492fa81","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2d4ef011-480a-45c5-810a-2f275a435ed3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"63897915-e896-4c66-ba27-f5cf84ea3f0a","root":false,"$title":"[MS.2.0.1] [MSG] Simulador de Vendas - Máquina","$position":{"top":"455px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"47fe6812-1d71-4bbc-b0aa-0f28704aea00":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cd358a19-a561-4197-b16d-fb92953c8fa1","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"5724999e-4ebb-443e-8b1d-4c15ef40251e","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"47fe6812-1d71-4bbc-b0aa-0f28704aea00","root":false,"$title":"[GO TO] [Redirect] to WhatsApp PJ (atendente)","$position":{"top":"1364px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3363e5ff-e5bb-4373-a385-f4206fa54eba":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"42352582-3913-431e-976e-ad8494ad2445","typeOfStateId":"state","$connId":"con_843","$id":"ef04e652-526a-411f-9385-a603df4c7b38","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(data) {\n\ttry {\n\t\tif (!data) {\n\t\t\treturn 'inatividade'\n\t\t}\n\t\tconst regex = /^(\\d{2})[\\/\\-]?(\\d{2})[\\/\\-]?(\\d{4})$/;\n\t\tif (!regex.test(data)) return 'input inesperado';\n\n\t\tlet dia = parseInt(data.substring(0, 2));\n\t\tlet mes = parseInt(data.substring(3, 5));\n\t\tlet ano = parseInt(data.substring(6, 10));\n\n\t\tif (dia < 1 || dia > 31) return 'input inesperado';\n\t\tif (mes < 1 || mes > 12) return 'input inesperado';\n\t\tif ((mes == 4 || mes == 6 || mes == 9 || mes == 11) && dia == 31) return 'input inesperado';\n\t\tif (mes == 2) {\n\t\t\tconst bissexto = (ano % 4 == 0 && (ano % 100 != 0 || ano % 400 == 0));\n\t\t\tif (dia > 29 || (dia == 29 && !bissexto)) return 'input inesperado';\n\t\t}\n\t\treturn dia.toString().padStart(2, '0') + '/' + mes.toString().padStart(2, '0') + '/' + ano;\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ec82a1b2-65e4-4ae4-bc07-de805eef7dff","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.4.0.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.4.0.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"010c590c-aa18-4af4-beab-af976bce53ee","$typeOfContent":"","type":"MergeContact","$title":"Set \"DataVendaNaoRecebida\"","$invalid":false,"settings":{"extras":{"dataVendaNaoRecebida":"{{userInput}}"}},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"a6ab0e22-9b79-4ede-801c-f05e254fc2b9","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"a9df706b-0d80-4c56-9453-563ddde8a263","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a8fe6fdd-ec22-4cf8-8256-16552e62c9f5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-95b2a28e-9ba4-4d19-8e5a-c2560f39c8b2","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-9b1c075d-9259-4608-afce-632de13e7ff3","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-7f1553f8-7f8f-47c5-9f97-bf70c183b9ff","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e9ff17f5-04d3-4742-a507-eb4fc6770318","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3363e5ff-e5bb-4373-a385-f4206fa54eba","root":false,"$title":"[MS.4.0.0][INPUT] Não recebi minha venda","$position":{"top":"687px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3667b0cd-ad3b-4f05-a5de-144400562fd0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"47fe6812-1d71-4bbc-b0aa-0f28704aea00","typeOfStateId":"state","$connId":"con_848","$id":"ed4b98d3-d6f8-4e76-9b69-fbeb08e72afd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(valor, message) {\n    try {\n        if (!valor) {\n            return 'inatividade'\n        }\n        const messageType = JSON.parse(message).type\n        if (messageType !== \"text/plain\") {\n            return 'input inesperado'\n        }\n\n        if (!/^\\d{1,3}(\\.\\d{3})*,\\d{2}$/.test(valor)) {\n            return 'input inesperado';\n        }\n\n        const valorNumerico = valor.replace(/\\./g, '').replace(',', '.');\n        const valorFormatado = parseFloat(valorNumerico).toFixed(2).replace('.', ',');\n        return 'R$ ' + valorFormatado;\n    } catch (err) {\n        return err.message\n    }\n}","inputVariables":["input.content","input.message"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"785130e9-58c2-4e11-9bd8-75c1e56c45e0","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.4.1.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.4.1.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"010c590c-aa18-4af4-beab-af976bce53ee","$typeOfContent":"","type":"MergeContact","$title":"Set \"valorVendaNaoRecebida\"","$invalid":false,"settings":{"extras":{"valorVendaNaoRecebida":"{{userInput}}"}},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"fc8709a7-d7bb-44dd-be41-fea8b632692d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"9f2acfeb-fe5e-469f-a895-8397c9edc1ea","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-74191496-5ad6-4e41-ae59-d5d3e5a8b18a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-75a19fb0-a131-4aa7-9c09-a8be53646fe8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-279f9c03-4102-4e46-a7db-f9f488428fad","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-d41f464b-0abf-43e6-bf6c-ec12b97df782","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-73aa72f0-f49d-4276-831c-dfa929573a73","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3667b0cd-ad3b-4f05-a5de-144400562fd0","root":false,"$title":"[MS.4.1.0][INPUT] Solicita valor da venda","$position":{"top":"1146px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4051c1ad-de53-4ef3-bfa0-add7a989e960":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"63e9145d-3760-4ef3-ba6e-88f41a491e41","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"999f8756-0822-4b23-9887-f47836298b3a","typeOfStateId":"state","$connId":"con_853","$id":"3e12632c-4292-499f-ad43-d2b0e19815a4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6cf082c9-1a1a-40b3-ba97-43413903f57d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"22d6b742-155e-4644-851e-fe36cfa633c5","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"999f8756-0822-4b23-9887-f47836298b3a","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c72bbd5a-d0b9-46ed-bd11-4ec7cb1ede24","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a9021bb9-31a6-4297-84c8-87f645f7c4b0","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"4051c1ad-de53-4ef3-bfa0-add7a989e960","root":false,"$title":"[MS.4.0.0] [SET] Não recebi minha venda Inicio","$position":{"top":"27px","left":"3374px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"999f8756-0822-4b23-9887-f47836298b3a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '4b038e89-c130-4869-a541-4954e12ebf81',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cbef1e34-7f2b-4d4a-82c4-8b080009f1b1","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"onboarding"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-70933a87-4095-4360-bad1-7bad31f44249","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-98ba0ddd-3c9d-43ea-ac9b-d5c2bee8411f","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"999f8756-0822-4b23-9887-f47836298b3a","root":false,"$title":"[Redirect] To \"Autenticacao\" (Não recebi minha VD)","$position":{"top":"262px","left":"3374px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"a5ddf643-13c0-4a81-a174-e1aa9dd86873":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"5b733936-1903-4654-b904-fc7b72d289cc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Bot Taxas e Condições ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'a5ddf643-13c0-4a81-a174-e1aa9dd86873',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"d02ef8e1-41a6-4df8-ae88-9f54609b5548","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-5999ca3f-d588-4d63-86cd-ad429fa1fb8c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4167b5df-0ba2-4041-875d-94aa9bd91127","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$title":"[Redirect] To Taxas e condições","$position":{"top":"242.5px","left":"1610px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"e0d2ce64-3265-46bd-b396-f53ad65b26e6":{"$contentActions":[{"action":{"$id":"45773e89-c639-48b0-a84f-5f29fdb265ef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2b68cfc6-71ac-43dd-ba99-972954c677b2","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"26faef34-7912-4e02-b8a6-069c18b0a656","typeOfStateId":"state","$connId":"con_858","$id":"6fcdc215-f3c2-4ac1-9f5d-929f74d63d9f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"83551b1f-5996-47df-b780-cc7da6540faf","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77a9996e-b081-4071-9ad4-416c7805cd87","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n\t{\n\t\tid: '1',\n\t\ttitle: 'Suporte e configurações',\n\t\tdescription: 'Veja as orientações'\n\t},\n\t{\n\t\tid: '2',\n\t\ttitle: 'Taxas e condições',\n\t\tdescription: 'Taxas de venda, antecipação, pix na Safrapay e questionar cobrança'\n\t},\n\t{\n\t\tid: '3',\n\t\ttitle: 'Devolução da máquina',\n\t\tdescription: 'Saiba como realizar a devolução'\n\t},\n\t{\n\t\tid: '4',\n\t\ttitle: 'Vendas',\n\t\tdescription: 'Simular venda, venda não recebida, link de pagamento e cancelar venda'\n\t},\n\t{\n\t\tid: '5',\n\t\ttitle: 'Antecipação',\n\t\tdescription: 'Contratar, consultar ARV, valores bloqueados, taxas e cancelamento'\n\t},\n\t{\n\t\tid: '6',\n\t\ttitle: 'Ordem de serviço',\n\t\tdescription: 'Consultar o andamento da solicitação'\n\t},\n\t{\n\t\tid: '7',\n\t\ttitle: 'Upgrade e downgrade',\n\t\tdescription: 'Veja como trocar sua máquina por um outro modelo.'\n\t}\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n\tif (posicao > menuOptions.length) {\n\t\tposicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n\t}\n\tif (menuOptions.find(option => option.id == posicao)) {\n\t\tquantidadeItens = menuOptions.length\n\t\tfor (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n\t\t\tmenuOptions[i].id = (i + 2).toString()\n\t\t}\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72) || ''\n\t\t})\n\t} else {\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72)\n\t\t})\n\t}\n\tmenuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n\t// Parametro de busca é o title ou description da opção que deseja atualizar\n\tconst opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tmenuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n\tmenuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: '[extratoDeContaCorrente]' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao);\n\n\tif (!opcao) {\n\t\treturn;\n\t}\n\n\tconst hasPermission = permissoesNecessarias.some(necessaria => permissoes.includes(necessaria));\n\n\tif (hasPermission) {\n\t\treturn;\n\t}\n\n\tconst index = menuOptions.indexOf(opcao);\n\tif (index > -1) {\n\t\tmenuOptions.splice(index, 1);\n\t}\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions.splice(index, 1)\n}\n\nfunction removeDescricaoDoBotao({ tituloDoBotao, parteASerRemovida, listaPermissoes, permissaoNecessaria }) {\n\tif (listaPermissoes.includes(permissaoNecessaria)) {\n\t\treturn\n\t}\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions[index].description = menuOptions[index].description.replace(parteASerRemovida, '')\n}\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada, ecList) {\n\ttry {\n\t\tconst { ec, permissoes } = JSON.parse(contaSelecionada);\n\t\tconst ecListParsed = JSON.parse(ecList);\n\t\t// Simulador de vendas, Não recebi minha venda, Vendas Online, Cancelar Venda\n\t\tif (ecListParsed.allecQuantity && ecListParsed.allecQuantity < 1) {//Se a quantidade de EC for menos 1 remove a opcao retirada de maquina, independente de ser EC ativo ou cancelado.\n\t\t\tremoveOpcaoDoMenu({ tituloDoBotao: 'Devolução da máquina' })\n\t\t}\n\t\tif (!ec) {\n\t\t\tatualizaOpcaoMenu({ parametroDeBusca: 'Vendas', title: 'Vendas', description: 'Não recebi minha venda, Vendas online, Cancelar venda' })\n\t\t}\n\t\tremoveDescricaoDoBotao({\n\t\t\ttituloDoBotao: 'Vendas',\n\t\t\tparteASerRemovida: 'Não recebi minha venda, ',\n\t\t\tlistaPermissoes: permissoes,\n\t\t\tpermissaoNecessaria: 'naoRecebiAVenda'\n\t\t})\n\t\tremoveDescricaoDoBotao({\n\t\t\ttituloDoBotao: 'Antecipação',\n\t\t\tparteASerRemovida: ' e cancelamento ',\n\t\t\tlistaPermissoes: permissoes,\n\t\t\tpermissaoNecessaria: 'cancelarAntecipAutomatica'\n\t\t})\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Ótimo, o que você precisa sobre máquina Safrapay?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": menuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\terror: err.message,\n\t\t\texceptionType: 'reiniciarFluxo',\n\t\t\tdynamicContent: {\n\t\t\t\t\"type\": \"text/plain\",\n\t\t\t\t\"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n\t\t\t}\n\t\t}\n\t}\n}","inputVariables":["contaSelecionada","ecList"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b01ab217-20cc-4b44-8b8e-8ec8af27ceff","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"3c02d965-7713-4270-ba3a-219d42fd37a3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"58b41d22-b9c4-4c9d-aff5-5066e7a89cb4","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-414c83e3-9715-49de-a280-6b9474a7c6e0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-995997dd-bd77-4bab-8582-8e9d4a06eb6e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d4e2beba-cd27-4fe0-b46d-8a02baf01a73","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-96cd9946-b571-4d0f-a70f-e6520d841e12","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e0d2ce64-3265-46bd-b396-f53ad65b26e6","root":false,"$title":"[M.5.1.0][MSG] Menu - Máquinas Safrapay","$position":{"top":"481px","left":"1368px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"26faef34-7912-4e02-b8a6-069c18b0a656":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_863","$id":"7a42f34d-890f-4245-bf02-2faf05746dbf","conditions":[{"source":"context","comparison":"equals","values":["Taxas e condições"],"variable":"userInput"}],"$invalid":false,"stateId":"b33933ce-96ec-4f09-bd6f-b502c15124db"},{"stateId":"c5ef80ee-bfa5-4929-8017-4c78d9f86bbe","typeOfStateId":"state","$connId":"con_868","$id":"1c39db59-adf4-4f52-91dd-0a3e0c895e69","conditions":[{"source":"context","comparison":"equals","values":["Vendas"],"variable":"userInput"}],"$invalid":false},{"stateId":"e1aff5a0-e120-4e0e-a1a2-67fae556c4b9","typeOfStateId":"state","$connId":"con_873","$id":"bc070b11-ee9e-4c09-8d36-278ba77ec131","conditions":[{"source":"context","comparison":"equals","values":["Ordem de serviço"],"variable":"userInput"}],"$invalid":false},{"stateId":"f817dcce-1003-42db-a940-95c267d9a2c8","typeOfStateId":"state","$connId":"con_878","$id":"60b5c245-9a4b-453b-a4da-24ece8f604a2","conditions":[{"source":"context","comparison":"equals","values":["Suporte e configurações"],"variable":"userInput"}],"$invalid":false},{"stateId":"c7d28097-fb6e-4341-a690-b43b82085fad","typeOfStateId":"state","$connId":"con_883","$id":"bdcc229c-47ed-4d1a-b6b7-83f97652946c","conditions":[{"source":"context","comparison":"equals","values":["Upgrade e downgrade"],"variable":"userInput"}],"$invalid":false},{"stateId":"a4599177-c976-4921-9be9-ca6fa0d0d574","typeOfStateId":"state","$connId":"con_888","$id":"9023d425-ef88-4a26-9dbd-511ab7a6afdf","conditions":[{"source":"context","comparison":"equals","values":["Antecipação"],"variable":"userInput"}],"$invalid":false},{"stateId":"227c3938-627f-4a0a-8136-ddb558c334ed","typeOfStateId":"state","$connId":"con_893","$id":"c4db3528-ae20-4f07-b6c1-542a655fe51f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Devolução da máquina"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"b8f910d1-f140-4584-b031-aa6bdab8c585","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2c853ac7-fde1-4b0d-92c7-f60b245a9072","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"00fb1c58-ac94-4872-ae2e-4329d1889e8d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"95b3ca8c-7d57-4516-b57d-f7d5579948df","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"d67b36fe-d7aa-4b9c-9a59-b49a481f9b5d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c5b2edd6-9a39-47db-9831-c7ec002f8c18","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ebb52b30-e40e-49a9-95e4-fa3f09b3c470","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-bf8da6de-1cff-484c-8859-4a46eb6e82d7","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-cbd585bd-45a7-4f47-8320-d664432c0e25","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"26faef34-7912-4e02-b8a6-069c18b0a656","root":false,"$title":"[M.5.1.0][INPUT] Menu - Máquinas Safrapay","$position":{"top":"1073.5px","left":"1396.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"c5ef80ee-bfa5-4929-8017-4c78d9f86bbe":{"$contentActions":[{"action":{"$id":"45773e89-c639-48b0-a84f-5f29fdb265ef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2b68cfc6-71ac-43dd-ba99-972954c677b2","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"35a93cc9-44a0-4b9a-9214-c401f2bd5d9d","typeOfStateId":"state","$connId":"con_898","$id":"6fcdc215-f3c2-4ac1-9f5d-929f74d63d9f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f2b92728-adef-4dd3-ab47-b3c40cc6ac1e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77a9996e-b081-4071-9ad4-416c7805cd87","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Não recebi minha venda\",\n        \"description\": \"\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Vendas Online\",\n        \"description\": \"API Safrapay e TEF\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Cancelar venda\",\n        \"description\": \"\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao);\n\n    if (!opcao) {\n        return;\n    }\n\n    const hasPermission = permissoesNecessarias.some(necessaria => permissoes.includes(necessaria));\n\n    if (hasPermission) {\n        return;\n    }\n\n    const index = menuOptions.indexOf(opcao);\n    if (index > -1) {\n        menuOptions.splice(index, 1);\n    }\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeDescricaoDoBotao({ tituloDoBotao, parteASerRemovida, listaPermissoes, permissaoNecessaria }) {\n    if (listaPermissoes.includes(permissaoNecessaria)) {\n        return\n    }\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions[index].description = menuOptions[index].description.replace(parteASerRemovida, '')\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        const { ec, permissoes } = JSON.parse(contaSelecionada)\n        if (ec) {\n            adicionaOpcaoNoMenu({ posicao: 1, title: 'Simulador de vendas', description: '' })\n        }\n        verificaPermissao({ tituloDoBotao: 'Não recebi minha venda', permissoesNecessarias: ['naoRecebiAVenda'], permissoes })\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Separei alguns tópicos sobre vendas. \n\nDe qual deles você quer mais informações?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}\n","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c3c26b3e-34c9-4ae0-8a12-8f757a6961fa","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"fe0a0d4d-142c-4b01-8d19-6a8ff56540b4","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"b9dc014f-a0ef-4190-93b9-96b44ab6c0b8","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3a8dd1fa-1d77-4f44-94ec-428b7db5d27b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3abf2b67-9e96-4430-b71f-336765b3429b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f17a7b89-8cc0-4d0e-83f1-b0cb37cb6efb","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-daefca86-01a4-4945-90d8-1ec8afe041d6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c5ef80ee-bfa5-4929-8017-4c78d9f86bbe","root":false,"$title":"[M.5.1.2][MSG] Menu - Vendas","$position":{"top":"1354px","left":"903px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"35a93cc9-44a0-4b9a-9214-c401f2bd5d9d":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"4ad60f8f-8c23-44a7-8528-9dbd3c0c6536","typeOfStateId":"state","$connId":"con_903","$id":"ff07b176-98fd-4b3c-8d37-8fe147441bb3","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Vendas Online"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"6f1f1e0c-4552-4f1c-8756-7fe5e190db5a","typeOfStateId":"state","$connId":"con_908","$id":"0842f43f-db83-411f-b933-1298bfbb4bf1","conditions":[{"source":"context","comparison":"equals","values":["Simulador de vendas"],"variable":"userInput"}],"$invalid":false},{"stateId":"f043bcf4-0318-4aa7-91b7-4e76c9c3f701","typeOfStateId":"state","$connId":"con_913","$id":"f9dea011-8786-44c7-88bf-d033b2badc61","conditions":[{"source":"context","comparison":"equals","values":["Não recebi minha venda"],"variable":"userInput"}],"$invalid":false},{"stateId":"2f71ab30-8070-459a-8b4e-42e21a806b2c","typeOfStateId":"state","$connId":"con_918","$id":"2df10952-1179-4cc3-bcf0-2ef00ec5778c","conditions":[{"source":"context","comparison":"equals","values":["Cancelar venda"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f4dc1b2c-6916-4396-aecb-3d245a9e7e5e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2c853ac7-fde1-4b0d-92c7-f60b245a9072","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"00fb1c58-ac94-4872-ae2e-4329d1889e8d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"95b3ca8c-7d57-4516-b57d-f7d5579948df","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"d67b36fe-d7aa-4b9c-9a59-b49a481f9b5d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-639573e5-6da5-462d-9b6e-10803c133855","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-14cc94b3-d635-4d7f-9b3a-fea70e56f0e0","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-cf5d4b42-b936-46eb-9d97-e6c7ce18a9ff","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-83920945-0f90-4464-82f6-555bc5e8be90","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"35a93cc9-44a0-4b9a-9214-c401f2bd5d9d","root":false,"$title":"[M.5.1.2][INPUT] Menu - Vendas","$position":{"top":"1543px","left":"904px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"4ad60f8f-8c23-44a7-8528-9dbd3c0c6536":{"$contentActions":[{"action":{"$id":"b90564c6-ab1b-46ff-b1fc-76389c0697b9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"79389fea-5a22-4077-8848-84ecd36b4516","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"79389fea-5a22-4077-8848-84ecd36b4516","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"25b9a46f-db18-4f56-b1f1-e9ded665d894","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"34eb1c20-4a5f-446c-a191-30ba4fa348a3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7ca8f3e0-f81a-48a1-9a81-f5abf8969423","typeOfStateId":"state","$connId":"con_923","$id":"50649ead-7c41-45f4-9f73-389eeceaba17","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"7f62fac6-7150-4366-831d-a52a89217132","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"3a278e7a-a753-4c10-99be-17488089ee7a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n\t{\n\t\t\"id\": \"1\",\n\t\t\"title\": \"Link de Pagamento\",\n\t\t\"description\": \"\"\n\t},\n\t{\n\t\t\"id\": \"2\",\n\t\t\"title\": \"Portal Link\",\n\t\t\"description\": \"\"\n\t},\n\t{\n\t\t\"id\": \"3\",\n\t\t\"title\": \"API Safrapay\",\n\t\t\"description\": \"\"\n\t},\n\t{\n\t\t\"id\": \"4\",\n\t\t\"title\": \"TEF\",\n\t\t\"description\": \"\"\n\t}\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n\tif (posicao > menuOptions.length) {\n\t\tposicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n\t}\n\tif (menuOptions.find(option => option.id == posicao)) {\n\t\tquantidadeItens = menuOptions.length\n\t\tfor (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n\t\t\tmenuOptions[i].id = (i + 2).toString()\n\t\t}\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72) || ''\n\t\t})\n\t} else {\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72)\n\t\t})\n\t}\n\tmenuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n\t// Parametro de busca é o title ou description da opção que deseja atualizar\n\tconst opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tmenuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n\tmenuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (permissoes.includes(permissoesNecessarias)) {\n\t\treturn\n\t}\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n\ttry {\n\t\t// const { ec } = JSON.parse(contaSelecionada)\n\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, vale lembrar que as vendas feitas na sua maquininha podem demorar até *1 dia útil* para aparecer no seu extrato.\n\nVeja como posso te ajudar.`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": menuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\terror: err.message,\n\t\t\texceptionType: 'reiniciarFluxo',\n\t\t\tdynamicContent: {\n\t\t\t\t\"type\": \"text/plain\",\n\t\t\t\t\"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n\t\t\t}\n\t\t}\n\t}\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5e668d0a-4f52-4950-b1c9-72efe3575aea","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"a91879b4-dea1-43c1-977d-57bf11967d03","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"cea7b103-af81-404d-9f97-22f35bb58d22","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-356da400-8409-4e87-b37e-cdaad1d89d20","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d647d98d-84de-4cb1-9b21-43e56f0e2b25","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-20515e0f-7a40-48bf-a420-82c3983e062c","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-fa6a9aba-d7d6-42d4-afd3-b184fa201a57","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4ad60f8f-8c23-44a7-8528-9dbd3c0c6536","root":false,"$title":"[M.5.2.0][MSG] Venda Online","$position":{"top":"1807.67px","left":"544px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7ca8f3e0-f81a-48a1-9a81-f5abf8969423":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"c9016473-d211-44eb-97c7-e7bc60f461c1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"da2d874f-8dc3-430d-9e90-7cb00ac1bd57","typeOfStateId":"state","$connId":"con_928","$id":"2ba0ca5f-88e9-42bb-be58-4dc618a0628e","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["TEF"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"16c97c97-32b5-4249-a279-ba2c2ee817c9","typeOfStateId":"state","$connId":"con_933","$id":"705d3d41-9047-46a2-ac98-ae5722801cc1","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"1d9d8b89-4338-4fa7-9526-db7d677e1f11","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2eef2c40-51db-49e3-aea0-53a79ca131a5","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"ee723013-22a9-4e7f-b5aa-d05a1aa24fa3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-85dd06c0-3c77-49ac-a9ba-ccc38a6e9c21","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c3fb8ee6-6fd7-49d0-ac87-5de360880df8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-cb76f94a-c971-4a30-88c3-b687f5512cf5","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7ca8f3e0-f81a-48a1-9a81-f5abf8969423","root":false,"$title":"[M.5.2.0][INPUT] Venda Online","$position":{"top":"2006.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"16c97c97-32b5-4249-a279-ba2c2ee817c9":{"$contentActions":[{"action":{"$id":"4fdb0a5d-f536-4390-9bf1-bfcf87e81114","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4058f9ed-04ff-4401-b6e6-54bf1ce5bcb1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4058f9ed-04ff-4401-b6e6-54bf1ce5bcb1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28af84c1-1d5d-493c-8f82-979f92e86f4c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a8fcedce-c08e-468a-9aea-c7cb5c0f6659","type":"text/plain","content":"{{msgVendaOnline}}","metadata":{}},"$cardContent":{"document":{"id":"a8fcedce-c08e-468a-9aea-c7cb5c0f6659","type":"text/plain","content":"{{msgVendaOnline}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1456b57a-3dfc-4a28-81eb-519d6321e51f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9d2ac225-26f9-4cdf-b13c-1b86bef1d5c0","typeOfStateId":"state","$connId":"con_938","$id":"b4430d47-650b-43ca-b7ae-95c03d9dbf3b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"605603b4-ec2c-43e6-bcda-3bab5bb04f00","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgVendaOnline\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    const msg = input;\n \n    if (msg == \"Link de Pagamento\") {\n        return \"O *Link de pagamento* Safrapay é uma solução rápida e fácil que permite a você compartilhar um link pela internet para que seus clientes realizem pagamento à distância.\\n\\nAceite os principais meios de pagamento do mercado com maior segurança através do *Antifraude Safrapay.*\"\n    }\n \n    if (msg == \"Portal Link\") {\n        return \"Com *Portal Link* Safrapay, você tem acesso a uma ferramenta completa para aumentar sua gestão e acompanhamento. \\n\\nIsso possibilita criar usuários para acesso individualizado, detalhar as transações, exportar relatórios e gerar link de forma rápida. \\n\\nAlém disso, oferece um dashboard completo para acompanhamento da sua taxa de aprovação.\"\n    }    \n \n    if (msg == \"API Safrapay\") {\n        return \"Através da *API Safrapay*, tenha acesso a diversas funcionalidades para aumentar a conversão nas suas vendas online.\\n\\nAceite os principais meios de pagamento com maior segurança, ou, se preferir, faça sua integração conosco através dos gateways e plataformas parceiras.\"\n    }   \n}","inputVariables":["userInput"],"outputVariable":"msgVendaOnline","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6968d948-3b20-4624-a73a-45490d19fa09","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-32486e86-f8a1-4069-8f20-4943e126ff9b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-41ac79ad-aa78-48ee-9933-b2ddc0908553","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f980a3db-b239-461b-af61-5b47080e8277","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"16c97c97-32b5-4249-a279-ba2c2ee817c9","root":false,"$title":"[M.5.2.1][MSG] FAQ Venda Online","$position":{"top":"2211.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9d2ac225-26f9-4cdf-b13c-1b86bef1d5c0":{"$contentActions":[{"action":{"$id":"67e70cc9-6393-4d37-ba36-ab42735b0eed","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"2098d415-a968-45b8-b588-9b9cc6dcf4ef","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"2098d415-a968-45b8-b588-9b9cc6dcf4ef","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"39c28537-59ae-4084-b6af-709065d95861","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"230ef0f6-57ed-4fd0-9e7d-5b3ca97fa12d","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1062b696-f6b1-451a-b62a-58750c8bb9b4","typeOfStateId":"state","$connId":"con_943","$id":"9bd7e953-35f1-4655-ab3d-8151dbbc4797","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"03a443b4-a97a-48bb-9f3d-66c22dc4f02b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run() {\n\treturn {\n\n\t\t\"recipient_type\": \"individual\",\n\n\t\t\"type\": \"interactive\",\n\n\t\t\"interactive\": {\n\n\t\t\t\"type\": \"button\",\n\t\t\t\"body\": {\n\n\t\t\t\t\"text\": \"Consegui te ajudar?\"\n\n\t\t\t},\n\n\t\t\t\"action\": {\n\n\t\t\t\t\"buttons\": [\n\n\t\t\t\t\t{\n\n\t\t\t\t\t\t\"type\": \"reply\",\n\n\t\t\t\t\t\t\"reply\": {\n\n\t\t\t\t\t\t\t\"id\": \"unique-postback-id\",\n\n\t\t\t\t\t\t\t\"title\": \"Sim\"\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t},\n\n\t\t\t\t\t{\n\n\t\t\t\t\t\t\"type\": \"reply\",\n\n\t\t\t\t\t\t\"reply\": {\n\n\t\t\t\t\t\t\t\"id\": \"unique-id\",\n\n\t\t\t\t\t\t\t\"title\": \"Não\"\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t]\n\n\t\t\t}\n\n\t\t}\n\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e22386f9-dd5f-4f2d-8f57-a33d6822d920","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7dd02336-af05-45b6-be40-d48e00e9cee2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7c7b9813-2865-440d-9106-abf9676a712f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-62fe68b1-4ced-4757-9e21-788355272894","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9d2ac225-26f9-4cdf-b13c-1b86bef1d5c0","root":false,"$title":"[M.5.2.2][MSG] Resposta foi util","$position":{"top":"2464.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1062b696-f6b1-451a-b62a-58750c8bb9b4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"45bbe750-410e-4ed2-ae6b-af6797032ca6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b52fb46d-d8fc-42bd-b149-dc828615ec19","typeOfStateId":"state","$connId":"con_948","$id":"d68b370b-ee59-4445-88c0-64deb8ea831a","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"da2d874f-8dc3-430d-9e90-7cb00ac1bd57","typeOfStateId":"state","$connId":"con_953","$id":"4424960d-a89b-4570-adf8-8e658840c2f2","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Não"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"eda19762-f494-4434-8c94-b87edcd1f861","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"28a67ecc-7d99-43d3-a7d9-dd4856f341d7","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"b29a2d6b-f100-4c40-8979-81e6a45a518b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"861c93fb-7fe9-4f4f-b689-f0d96126b41b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2c34549b-a045-4e35-b8ba-5188a0a6116d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-92c3a22b-be9e-4e09-92a5-96a916c62189","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-3be40172-3750-461d-bddb-526b9d045c8a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-971cb073-dc54-4dc2-9b21-c6bf512dd2a9","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1062b696-f6b1-451a-b62a-58750c8bb9b4","root":false,"$title":"[M.5.2.2][INPUT] Resposta foi util","$position":{"top":"2690.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3bd1f502-d1bd-45b4-9021-a9a7c7f6d192":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"de0209ba-cc78-4ccc-a44d-8ebb5b84cd0a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"462596bd-3e1f-480a-85b5-4c2e948e4109","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tpreviousStateName: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: 'WhatsApp PJ',\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: 'Vendas Online',\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"088fa28a-94a8-4880-aa0f-da3b5b9fda81","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]}],"$leavingCustomActions":[{"$id":"d020a3f2-daee-4595-b129-c1d5f7d88fd6","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-090e25eb-2bb0-4828-9460-b3c7569d6802","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e47fe6fa-e3bb-4a34-9d87-2c5599dac6d9","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-68fb3e7a-8068-44f3-a22a-77bb8ac15063","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"3bd1f502-d1bd-45b4-9021-a9a7c7f6d192","root":false,"$title":"[Redirect] serviço WhatsApp PJ (Vendas Online)","$position":{"top":"236px","left":"1209px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b33933ce-96ec-4f09-bd6f-b502c15124db":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c111cfa0-c629-4daa-9680-3ce628c37eff","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"b33933ce-96ec-4f09-bd6f-b502c15124db","root":false,"$title":"[GO TO] Redirect to Taxas e Condicoes","$position":{"top":"972px","left":"1868.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e1aff5a0-e120-4e0e-a1a2-67fae556c4b9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"7d0c2e76-2030-441b-835d-09c8a72332bd","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"17c7dad6-772d-4ea0-820d-5f79af6b3d85","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e1aff5a0-e120-4e0e-a1a2-67fae556c4b9","root":false,"$title":"[GO TO] Redirect to Consultar OS","$position":{"top":"859.286px","left":"1868.86px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f817dcce-1003-42db-a940-95c267d9a2c8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e6338af4-643d-4aa8-955e-9e07b7d94922","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"4f6e7e6d-21b4-4b11-9913-6aa5149a7469","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f817dcce-1003-42db-a940-95c267d9a2c8","root":false,"$title":"[GO TO] MS.5.0.0 Suporte e Configurações","$position":{"top":"1109.67px","left":"1868px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"17c7dad6-772d-4ea0-820d-5f79af6b3d85":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"5b733936-1903-4654-b904-fc7b72d289cc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Bot OS ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'fb46f9fc-1dfe-45f8-a9c6-09bfd80f21db',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"d02ef8e1-41a6-4df8-ae88-9f54609b5548","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-613f5e80-da86-412a-9d75-74c3b64d5a8a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1a5d8567-d90c-4a15-beac-4be8edade9c4","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"17c7dad6-772d-4ea0-820d-5f79af6b3d85","$title":"[Redirect] To Consultar OS","$position":{"top":"247.5px","left":"1804px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"da2d874f-8dc3-430d-9e90-7cb00ac1bd57":{"$contentActions":[{"action":{"$id":"55d5c695-4011-4360-b296-a96112e2a753","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"20b06f5d-10be-4937-b1a3-4e14807d5938","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"20b06f5d-10be-4937-b1a3-4e14807d5938","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6c82c0c4-03da-4b05-9d39-28d25eafb334","$typeOfContent":"text","type":"SendMessage","settings":{"id":"41c3b137-9b08-423d-8f8d-ede53b58ed66","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"41c3b137-9b08-423d-8f8d-ede53b58ed66","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc3c9349-2f7a-499b-b122-83ad67de8220","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"3bd1f502-d1bd-45b4-9021-a9a7c7f6d192","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f67c24cd-a5c2-43c3-bce0-b5f335e1a6fd","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"da2d874f-8dc3-430d-9e90-7cb00ac1bd57","root":false,"$title":"[GO TO] Redirect To WhatsApp PJ (Vendas Online)","$position":{"top":"2313.67px","left":"146px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b52fb46d-d8fc-42bd-b149-dc828615ec19":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3dff3012-ad26-4244-93f5-c3d9a572fdc0","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"b52fb46d-d8fc-42bd-b149-dc828615ec19","root":false,"$title":"[GO TO] Redirect to Finalizacao","$position":{"top":"2925.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6f1f1e0c-4552-4f1c-8756-7fe5e190db5a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"38c7b810-b485-4fbf-bf2c-f6123f9d34d5","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c391e959-860e-4eaf-86b9-71fcd8888c86","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"6f1f1e0c-4552-4f1c-8756-7fe5e190db5a","root":false,"$title":"[GO TO] MS.2.0.0 Simulador de Vendas","$position":{"top":"1441.67px","left":"1374.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f043bcf4-0318-4aa7-91b7-4e76c9c3f701":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8b0c2584-0041-45c6-93a2-783de7a8a312","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"4051c1ad-de53-4ef3-bfa0-add7a989e960","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f043bcf4-0318-4aa7-91b7-4e76c9c3f701","root":false,"$title":"[GO TO] MS. 4.0.0 Não recebi minha venda","$position":{"top":"1632.67px","left":"1373px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"29bd66a7-4ad7-49bb-94cd-e130dbbb90fe":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8e566e96-9d61-4951-84fe-47f3cc1ff9e6","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"29bd66a7-4ad7-49bb-94cd-e130dbbb90fe","root":false,"$title":"[GO TO] Redirect to Taxas e Condicoes","$position":{"top":"3495.33px","left":"2623.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2f71ab30-8070-459a-8b4e-42e21a806b2c":{"$contentActions":[{"action":{"$id":"8e4fdbbf-4e88-4311-884d-736acff5a89e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"57690764-7fc0-4344-bc40-537e0f4e13a0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"57690764-7fc0-4344-bc40-537e0f4e13a0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c448e438-2477-433b-9126-5a7f08b2c6d4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4bbe4222-1e7a-4372-a068-f8e55d6f05b9","type":"text/plain","content":"Para cancelar qualquer venda, é necessário cadastrar uma senha na própria máquina.","metadata":{}},"$cardContent":{"document":{"id":"4bbe4222-1e7a-4372-a068-f8e55d6f05b9","type":"text/plain","content":"Para cancelar qualquer venda, é necessário cadastrar uma senha na própria máquina."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"65105f29-5fba-43a1-aaa4-e339c6d98c69","typeOfStateId":"state","$connId":"con_958","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Você já cadastrou essa senha?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7e5fedbd-d948-4ed6-97d8-03fcc1946c6c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-794a7448-41c0-4eec-94ca-1396439b7858","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9c3b33b2-d3a1-4794-9e38-392490871c4e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2f71ab30-8070-459a-8b4e-42e21a806b2c","root":false,"$title":"[M.5.3.0][MSG] Cancelar Venda","$position":{"top":"1991px","left":"1340.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"65105f29-5fba-43a1-aaa4-e339c6d98c69":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"179ca13e-2c68-4278-8949-4b2c081f3969","typeOfStateId":"state","$connId":"con_963","$id":"18a13bda-ca05-417e-bfee-5a9ffc6c570e","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"bd21149e-3257-4413-83d5-21fa41bbc4a6","typeOfStateId":"state","$connId":"con_968","$id":"2e19111b-9973-44c3-9ed9-38685b9b7c5c","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8578f1b6-6baa-4144-8c9c-295fbe8a9c27","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-91d4abcf-1a34-44a5-a529-2190d9e1fb29","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-bb20de95-3295-4ab2-88e0-688f154b179f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-87dd7aae-df9b-4255-9e76-213599f02054","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"65105f29-5fba-43a1-aaa4-e339c6d98c69","root":false,"$title":"[M.5.3.0][INPUT] Cancelar Venda","$position":{"top":"2197.67px","left":"1340.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bd21149e-3257-4413-83d5-21fa41bbc4a6":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"629d9776-b085-4867-83cd-dfc957f9fbce","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Neste caso, será necessário realizar o cadastro.\n\nPara isso:\n\n1° Pressione o atalho <b>921.</b>\n\n2° Podem aparecer duas mensagens: \"Senha não cadastrada\" ou \"Digite sua senha\".","metadata":{}},"$cardContent":{"document":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Neste caso, será necessário realizar o cadastro.\n\nPara isso:\n\n1° Pressione o atalho <b>921.</b>\n\n2° Podem aparecer duas mensagens: \"Senha não cadastrada\" ou \"Digite sua senha\"."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5bb2d9d9-d9ed-43fb-a090-640b60e9593e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ef6b9f7c-cf31-4ea6-9f93-9bfac09b0fc7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ef6b9f7c-cf31-4ea6-9f93-9bfac09b0fc7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5edffbbb-69fe-40d0-b888-0f7bec6a2a58","$typeOfContent":"text","type":"SendMessage","settings":{"id":"202e3971-3795-4c73-b96d-85d4331f10ea","type":"text/plain","content":"Caso seja solicitado, siga as instruções para cadastrar sua senha:\n\n1° Digite os <b>4 primeiros dígitos</b> do CNPJ/CPF e confirme pressionando a tecla <b>verde.</b>\n\n2° Insira o <b>CEP do estabelecimento.</b>\n\n3° Cadastre uma <b>nova senha de 4 dígitos,</b> evitando números sequenciais ou repetidos.\n\n4° Finalize o processo.","metadata":{}},"$cardContent":{"document":{"id":"202e3971-3795-4c73-b96d-85d4331f10ea","type":"text/plain","content":"Caso seja solicitado, siga as instruções para cadastrar sua senha:\n\n1° Digite os <b>4 primeiros dígitos</b> do CNPJ/CPF e confirme pressionando a tecla <b>verde.</b>\n\n2° Insira o <b>CEP do estabelecimento.</b>\n\n3° Cadastre uma <b>nova senha de 4 dígitos,</b> evitando números sequenciais ou repetidos.\n\n4° Finalize o processo."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"515e56f3-3b93-4b51-b51d-b5d36857e205","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"50a22384-776a-4f21-884f-fee87744d5c0","typeOfStateId":"state","$connId":"con_973","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Conseguiu cadastrar a sua senha?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-22e605ce-19f4-4776-b2e0-4b600e4cbd4f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1c04a336-0098-4347-9d8f-0f496e436f19","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-cc65c3a2-3f84-4a4a-be55-9fff1fa79d49","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bd21149e-3257-4413-83d5-21fa41bbc4a6","root":false,"$title":"[M.5.4.0][MSG] Instrucoes sem senha","$position":{"top":"2981px","left":"1842px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"50a22384-776a-4f21-884f-fee87744d5c0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"02b50670-f4e0-4b6e-aaa2-71f4fb57d53c","typeOfStateId":"state","$connId":"con_978","$id":"1153408b-20fa-4d80-ab52-f76af3e48242","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d3d438c4-7e57-440c-ae16-b78a24489e68","typeOfStateId":"state","$connId":"con_983","$id":"8528734e-f667-4480-a059-948d87079461","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4d97fdf6-b2b1-46a8-9dcf-455ce8c6da7f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-41e2e331-a924-41eb-8ff4-ada408d789b8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-40ff51d5-fbb1-4175-829b-3a5b21572396","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1d32a724-7e77-4f06-b641-f01212d2e29b","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"50a22384-776a-4f21-884f-fee87744d5c0","root":false,"$title":"[M.5.4.0][INPUT] Instrucoes sem senha","$position":{"top":"3282px","left":"1841.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"179ca13e-2c68-4278-8949-4b2c081f3969":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f795d57e-53c8-431f-bdfa-975adbd91cca","typeOfStateId":"state","$connId":"con_988","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Última Transação\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Transações do Dia\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Transações de outros dias\",\n\t\t\t\t\"description\": \"\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual transação deseja cancelar?` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\", // <---- Titulo do botão\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9cd18bb5-27fe-48c2-9bf5-22ff1a1572b1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b13d157f-21b8-4550-a173-ed254c4bf854","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-56bcf0a8-cf20-4388-9f9e-23afc7a8dc82","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"179ca13e-2c68-4278-8949-4b2c081f3969","root":false,"$title":"[M.5.3.1][MSG] Qual transacao","$position":{"top":"2633px","left":"1035px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f795d57e-53c8-431f-bdfa-975adbd91cca":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ee78bbc8-745c-4eed-ab7d-c35f0db195b3","typeOfStateId":"state","$connId":"con_993","$id":"b30733c4-d20c-4cd4-9c6e-6ca608b2e66c","conditions":[{"source":"context","comparison":"equals","values":["Última transação"],"variable":"userInput"}],"$invalid":false},{"stateId":"42169305-95d7-4178-8f73-a195425cfd74","typeOfStateId":"state","$connId":"con_998","$id":"39e5ed54-4a5b-4613-a0f8-364299d84746","conditions":[{"source":"context","comparison":"equals","values":["Transações do dia"],"variable":"userInput"}],"$invalid":false},{"stateId":"3577487a-9741-48f9-ad8b-c61134c88f7d","typeOfStateId":"state","$connId":"con_1003","$id":"371c95eb-1563-45a6-85cc-763298cd8a0e","conditions":[{"source":"context","comparison":"equals","values":["Transações de outros dias"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"861fc9b8-aa42-46b5-a3a0-0ea398840781","$typeOfContent":"","type":"SetVariable","$title":"Set \"tipoDeTransacaoCancelada\" with userInput","$invalid":false,"settings":{"variable":"tipoDeTransacaoCancelada","value":"{{userInput}}"},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1bbdbd88-87ff-4e30-a375-a0ef27799318","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b9f562bc-3f75-484c-8e5d-54e941552a60","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-dfb53280-ad46-4cac-a445-1c89adc9d682","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f7663734-57d5-4fe9-93a4-2b8aad432c76","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f795d57e-53c8-431f-bdfa-975adbd91cca","root":false,"$title":"[M.5.3.1][INPUT] Qual trasacao","$position":{"top":"2853.33px","left":"1034px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ee78bbc8-745c-4eed-ab7d-c35f0db195b3":{"$contentActions":[{"action":{"$id":"8f26a358-ffa2-496e-862f-8d76ebdbe59a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3324f5a6-5bef-4c62-9f9c-b394a20d8539","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3324f5a6-5bef-4c62-9f9c-b394a20d8539","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ddc61de6-586e-47d4-b888-2f750eb8e3a0","$typeOfContent":"text","type":"SendMessage","settings":{"id":"5b02b199-d66c-4b2e-aa2a-f97ed5748b2d","type":"text/plain","content":"Para cancelar a última transação:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>última</b> ou digite o atalho <b>81</b>.\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Insira, passe ou aproxime o cartão na máquina.","metadata":{}},"$cardContent":{"document":{"id":"5b02b199-d66c-4b2e-aa2a-f97ed5748b2d","type":"text/plain","content":"Para cancelar a última transação:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>última</b> ou digite o atalho <b>81</b>.\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Insira, passe ou aproxime o cartão na máquina."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"93086432-8017-4201-b419-005550333ac7","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1008","$id":"f0f55347-a21b-40d8-8a88-694a892de25b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false},{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1013","$id":"8f303af9-50d2-4968-b11a-ff86988c899f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b96d9f0a-30ab-404b-a884-31fa282751dc","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5ae95f54-2089-4097-a2cd-c7fee0635794","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-020ae525-953a-4264-b8dd-e64a6037250f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ee78bbc8-745c-4eed-ab7d-c35f0db195b3","root":false,"$title":"[M.5.3.2][MSG] Última transação","$position":{"top":"3160px","left":"771px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"42169305-95d7-4178-8f73-a195425cfd74":{"$contentActions":[{"action":{"$id":"2db82daa-9294-4dbf-99b3-3542877a3b77","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"54c0d85b-d4dc-47ef-b586-ae0d591e1e78","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"54c0d85b-d4dc-47ef-b586-ae0d591e1e78","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"053e1c04-5d9d-4394-bd23-6b77b91a73ec","$typeOfContent":"text","type":"SendMessage","settings":{"id":"df1ab2da-25ad-4fb0-9da6-41808eec238e","type":"text/plain","content":"Para cancelar demais transações no mesmo dia:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>\"por código\"</b> ou digite o atalho <b>82.</b>\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Informe o número do <b>NSU</b> da transação a ser cancelada e pressione <b>entra</b>.\n\n6. Insira, passe ou aproxime o cartão na máquina.","metadata":{}},"$cardContent":{"document":{"id":"df1ab2da-25ad-4fb0-9da6-41808eec238e","type":"text/plain","content":"Para cancelar demais transações no mesmo dia:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>\"por código\"</b> ou digite o atalho <b>82.</b>\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Informe o número do <b>NSU</b> da transação a ser cancelada e pressione <b>entra</b>.\n\n6. Insira, passe ou aproxime o cartão na máquina."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8e2f9e89-9cab-4ec4-ae36-9fbe655ebec8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1018","$id":"188a611a-483a-4a73-9bdb-789d9a15fd89","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false},{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1023","$id":"9ef309d1-c555-40aa-b764-f57e46543233","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"743dd78b-1294-4786-8338-45c01a72eeff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-16ec205a-23c5-4dd7-a2bb-d9aeed6e7c85","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-904d5668-308d-4897-a941-e75ececfd858","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"42169305-95d7-4178-8f73-a195425cfd74","root":false,"$title":"[M.5.3.3][MSG] Transações do dia","$position":{"top":"3158px","left":"1033px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3577487a-9741-48f9-ad8b-c61134c88f7d":{"$contentActions":[{"action":{"$id":"c917d87a-628f-441e-9896-6cfcd5cc0f7b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b861341d-3b69-4e23-ae68-2106feb44c4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b861341d-3b69-4e23-ae68-2106feb44c4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"88a1d591-faca-4a99-8617-dffeb5a7e4c6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"41c64726-32ae-40d6-be2d-07ff9aabf74b","type":"text/plain","content":"Para cancelar uma venda após o dia da transação:\n\n1° Acesse o site: www.safra.com.br/pessoa-juridica\n\n2° Clique em <b>“cancelamento de vendas”.</b>","metadata":{}},"$cardContent":{"document":{"id":"41c64726-32ae-40d6-be2d-07ff9aabf74b","type":"text/plain","content":"Para cancelar uma venda após o dia da transação:\n\n1° Acesse o site: www.safra.com.br/pessoa-juridica\n\n2° Clique em <b>“cancelamento de vendas”.</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"06041a8a-ef6c-481c-9e4b-f6653f7d9f6c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1028","$id":"3b132e1e-23f2-4764-9be8-0fd147c08e1d","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"51577fd5-61fa-48d4-b11a-6e2769630340","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a3096304-0fd4-471c-9eba-447e25b69e6c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4be04241-7558-42ce-aa9b-297128c389e3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3577487a-9741-48f9-ad8b-c61134c88f7d","root":false,"$title":"[M.5.3.4][MSG] Transações Outros Dias","$position":{"top":"3162px","left":"1319.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"68f61a0e-414c-4d79-bc30-3ea7af7d4ee2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"25991251-b486-423e-8a43-49f1c17ecef6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"656962f1-1814-43ee-9f4d-872a42f2f951","typeOfStateId":"state","$connId":"con_1033","$id":"53fa7443-3506-4fc7-9037-9b8b918c538a","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"728749a4-366a-4c0d-a3e1-464490888b52","typeOfStateId":"state","$connId":"con_1038","$id":"d27cf49b-94ee-4aed-bf88-7d4bb31c1379","conditions":[{"source":"context","comparison":"notExists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"293128be-9c10-41a4-a756-aeaae2dcf228","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"44cf9df6-0a6c-4fd4-ad05-64001a33cf75","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0d3bcf03-6abe-4fe8-b383-550d7f22af9f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"68f61a0e-414c-4d79-bc30-3ea7af7d4ee2","root":false,"$title":"[M.5.6.0][LOGIC] Cliente carterizado?","$position":{"top":"4055px","left":"1032px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cf24777b-0dc4-44b9-969f-a9c1c4e552fc":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7ec5eb0b-06f0-4ed0-9aa5-ede058ce49de","typeOfStateId":"state","$connId":"con_1043","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Menu Principal\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Menu Anterior\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Falar com gerente\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"id\": \"4\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"5\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"6\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"7\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"8\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"9\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"10\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// }\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, como podemos te ajudar?` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Assuntos\", // <---- Titulo do botão\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5803e8a6-5fac-4850-9d68-73b18897c4c0","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3394d810-bbec-4628-825b-29cb096ac591","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1a7e7782-3f4f-4acd-8fe5-102f7e8b3615","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"cf24777b-0dc4-44b9-969f-a9c1c4e552fc","root":false,"$title":"[M.5.7.0][MSG] Como podemos ajudar? (EMP1)","$position":{"top":"4593px","left":"1303px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7ec5eb0b-06f0-4ed0-9aa5-ede058ce49de":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_1048","$id":"9ce4999f-6b8b-4435-8cb9-fdf34c26823c","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Menu Principal"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false,"stateId":"779f3426-cb43-4e48-b325-afe9d7daed41"},{"stateId":"728749a4-366a-4c0d-a3e1-464490888b52","typeOfStateId":"state","$connId":"con_1053","$id":"4d9465dd-2dad-401f-8b69-540bf76f98f1","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Falar com gerente"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"d221250a-163d-488f-a84d-11538e4663b5","typeOfStateId":"state","$connId":"con_1058","$id":"97a6b7c5-e1e4-4148-9865-1aeabfb7b810","conditions":[{"source":"context","comparison":"equals","values":["Menu Anterior"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9593787a-0568-4a7f-b151-630b50023ece","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5cab82e8-4848-4d48-9c8c-4d237defb7d8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ed278a38-5775-4ce9-bea3-d1f5148d37be","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a8a3aa23-18d0-4826-8940-15c6afe426e5","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7ec5eb0b-06f0-4ed0-9aa5-ede058ce49de","root":false,"$title":"[M.5.7.0][INPUT] Como podemos ajudar? (EMP1)","$position":{"top":"4859px","left":"1022px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"656962f1-1814-43ee-9f4d-872a42f2f951":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"307f84bd-662a-49b4-9bf1-3772df28581b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"cf24777b-0dc4-44b9-969f-a9c1c4e552fc","typeOfStateId":"state","$connId":"con_1063","$id":"563aed27-41a6-4834-aaab-88bb3328f8b4","conditions":[{"source":"context","comparison":"equals","values":["emp1"],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"728749a4-366a-4c0d-a3e1-464490888b52","typeOfStateId":"state","$connId":"con_1068","$id":"7d78fa3e-7ca8-4b32-b30d-5bc1cbf2b8f2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1ee54c11-c7ad-46b5-b29c-4d4060b3026a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"e959fa2c-a861-466b-a6ec-f5b876ec8fdd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8b1a191d-9852-4918-a72d-120023fedf82","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"656962f1-1814-43ee-9f4d-872a42f2f951","root":false,"$title":"[M.5.7.0][LOGIC] Seguimento EMP1?","$position":{"top":"4383px","left":"1304px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"7a6f331a-100a-4030-b145-2116a835e888":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"2dd22f9a-89f5-4511-a4a3-2d5d2da457bb","typeOfStateId":"state","$connId":"con_1073","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Conseguimos te ajudar?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bf8f4071-175f-440f-91ac-279774d1b3b9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b9222124-377a-4414-9b1f-b4a3093f5a21","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f09cd489-26dc-4c6d-9e3d-489ccaa42a17","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7a6f331a-100a-4030-b145-2116a835e888","root":false,"$title":"[M.5.5.0][MSG] Conseguimos te ajudar?","$position":{"top":"3660px","left":"1032px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2dd22f9a-89f5-4511-a4a3-2d5d2da457bb":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"048f0bdd-8010-4f32-915c-a307fbec1701","typeOfStateId":"state","$connId":"con_1078","$id":"1a2890f7-e81c-4492-b80f-e928704ffabd","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d3d438c4-7e57-440c-ae16-b78a24489e68","typeOfStateId":"state","$connId":"con_1083","$id":"8c32a683-8ac5-4670-9773-826ed3726b8e","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-15ed7e06-c793-4296-81c4-bc30aa81ec0c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fbf276c1-3cdd-4e67-bdd2-291ff9f96153","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c08fad92-e800-434b-bc1c-ff9f46af1c06","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1c96556d-978f-481a-ad27-f3467072b6fe","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"2dd22f9a-89f5-4511-a4a3-2d5d2da457bb","root":false,"$title":"[M.5.5.0][INPUT] Conseguimos te ajudar?","$position":{"top":"3833px","left":"1032px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"048f0bdd-8010-4f32-915c-a307fbec1701":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"4931fe2b-740e-47cb-a7e5-a1537fa8944e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"048f0bdd-8010-4f32-915c-a307fbec1701","root":false,"$title":"[GO TO] Redirect Finalizacao","$position":{"top":"3855px","left":"761px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"728749a4-366a-4c0d-a3e1-464490888b52":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"6d0f93ba-75a0-44ed-8ce1-d210bdd8d423","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"728749a4-366a-4c0d-a3e1-464490888b52","root":false,"$title":"[GO TO] Redirect to Atendimento Humano","$position":{"top":"4373px","left":"713px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f2c4d052-2f9b-4aa8-9925-48aa824fc35c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"704dbd33-00b3-43d1-bd89-9dc566b692e1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `atendimentohumano ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7c5fc08a-b380-4fd2-a8e8-22e7c51e3bfd","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-20faaf6a-ad11-43ac-a858-de1e6c0926f9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e9a13def-201f-4dfd-a71f-160ae98d3d0b","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","root":false,"$title":"[Redirect] to Atendimento Humano","$position":{"top":"254px","left":"2197px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"779f3426-cb43-4e48-b325-afe9d7daed41":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"275da9c5-b39f-4c0d-8f37-793134f1fcf3","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"779f3426-cb43-4e48-b325-afe9d7daed41","root":false,"$title":"[GO TO] Redirect to Main (Menu Principal)","$position":{"top":"5070px","left":"726px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d221250a-163d-488f-a84d-11538e4663b5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"7e8e700c-f00b-49a8-8bb7-777d767809eb","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"2f71ab30-8070-459a-8b4e-42e21a806b2c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"d221250a-163d-488f-a84d-11538e4663b5","root":false,"$title":"[GO TO] MS.5.3.0 Cancelar Venda","$position":{"top":"5074.33px","left":"1301.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"02b50670-f4e0-4b6e-aaa2-71f4fb57d53c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cef173a7-afe9-40eb-8ef7-42b786979ec6","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"179ca13e-2c68-4278-8949-4b2c081f3969","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"02b50670-f4e0-4b6e-aaa2-71f4fb57d53c","root":false,"$title":"[GO TO][M.5.3.1][MSG] Qual transacao","$position":{"top":"3293px","left":"2060px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c7d28097-fb6e-4341-a690-b43b82085fad":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"629d9776-b085-4867-83cd-dfc957f9fbce","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Para fazer <b>upgrade</b> (trocar por um modelo superior) ou <b>downgrade</b> (trocar por um modelo mais simples) da sua máquina:\n\n1° Acesse o <b>Safra empresas.</b>\n\n2° Clique na opção <b>ver mais.</b>\n\n3° Selecione <b>maquininhas Safrapay.</b>\n\n4° Selecione <b>solicitar manutenção.</b>\n\n5° Clique em <b>trocar modelo.</b>","metadata":{}},"$cardContent":{"document":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Para fazer <b>upgrade</b> (trocar por um modelo superior) ou <b>downgrade</b> (trocar por um modelo mais simples) da sua máquina:\n\n1° Acesse o <b>Safra empresas.</b>\n\n2° Clique na opção <b>ver mais.</b>\n\n3° Selecione <b>maquininhas Safrapay.</b>\n\n4° Selecione <b>solicitar manutenção.</b>\n\n5° Clique em <b>trocar modelo.</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"515e56f3-3b93-4b51-b51d-b5d36857e205","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"14dba1a2-517a-47d8-ac26-9df544934baa","typeOfStateId":"state","$connId":"con_1088","$id":"079ac376-a4b5-4b87-a244-a12133dc2444","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Consegui te ajudar?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cefce38b-2a03-4c96-9c88-e6f6959aaec6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a46a8762-faf4-407e-a884-a971bb928501","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-63d1f118-988e-4cd2-b329-afe54c4c53f5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c7d28097-fb6e-4341-a690-b43b82085fad","root":false,"$title":"[MS.9.0.0][MSG] Como fazer Downgrade/Upgrade","$position":{"top":"1341.71px","left":"1867.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"14dba1a2-517a-47d8-ac26-9df544934baa":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9ef4fb9b-5db9-4b4e-8d3c-154e06f61eca","typeOfStateId":"state","$connId":"con_1093","$id":"1153408b-20fa-4d80-ab52-f76af3e48242","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"32a2ffb0-0b79-4710-bc8b-eb9ec0357bbe","typeOfStateId":"state","$connId":"con_1098","$id":"8528734e-f667-4480-a059-948d87079461","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-172ea953-be36-42eb-b54b-1e097ae5604a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2d614e8f-1940-44db-a751-0960b7d408f7","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-1a90987f-3f3e-424b-8155-4a7ba6a3ec59","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-90a6e69b-c393-4706-a820-07831917b48c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"14dba1a2-517a-47d8-ac26-9df544934baa","root":false,"$title":"[MS.9.0.0][INPUT] Como fazer Downgrade/Upgrade","$position":{"top":"1655.5px","left":"1867.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9ef4fb9b-5db9-4b4e-8d3c-154e06f61eca":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"792ab32f-cf42-4700-9585-20269c690fe2","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9ef4fb9b-5db9-4b4e-8d3c-154e06f61eca","root":false,"$title":"[GO TO] Redirect to Finalizacao  ","$position":{"top":"1900px","left":"1713.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"32a2ffb0-0b79-4710-bc8b-eb9ec0357bbe":{"$contentActions":[{"action":{"$id":"58e477d2-bc8d-49e6-894b-72e719609fd4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8bba8b96-4db0-4001-b2d5-80ad5b4019e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8bba8b96-4db0-4001-b2d5-80ad5b4019e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b3b475c7-8140-4f3a-9207-f8ae73986a22","$typeOfContent":"text","type":"SendMessage","settings":{"id":"def06af8-8e75-4157-8688-24007683cbed","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"def06af8-8e75-4157-8688-24007683cbed","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"951d823c-2e88-4b94-8aa7-456ce3babe9e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-84429f29-08fc-403a-9b09-4297348b80f8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"32a2ffb0-0b79-4710-bc8b-eb9ec0357bbe","root":false,"$title":"[GO TO] Redirect to Atendimento Humano ","$position":{"top":"1871px","left":"2056px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e36dcaa0-0665-4b22-ae98-3e8605d7e557":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"de7d8593-8bd0-4fb0-9c8b-bce0561fcf51","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"b039b1aa-719e-462d-aefc-de01bc0ddd7b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: '30e39880-1d2a-439a-a0ed-1e7210966286',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (error) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: error.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"b329fc66-8d30-44ed-8449-df875c5a9eb2","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b5fee981-56ee-4a25-9064-0171f81c3bbc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5535939a-200f-49e3-9fee-3e7455ad2970","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","root":false,"$title":"[Redirect] To Main (Menu inicial)","$position":{"top":"268.333px","left":"2387.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a5a5102b-730f-4d5a-92f4-190d1ada87ca":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4c237b9b-20cc-48a6-bee7-baefd00e0d43","typeOfStateId":"state","$connId":"con_1103","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Antecipação Automática\",\n        \"description\": \"Contratar antecipação automática\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Fazer a contratação\",\n        \"description\": \"Contratar antecipação eventual\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Outras credenciadoras\",\n        \"description\": \"\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Consulta status ARV\",\n        \"description\": \"Antecipação de recebíveis de vendas\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Valores bloqueados\",\n        \"description\": \"Meus valores estão bloqueados\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"Cancelamento\",\n        \"description\": \"Cancelar antecipação\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao);\n\n    if (!opcao) {\n        return;\n    }\n\n    const hasPermission = permissoesNecessarias.some(necessaria => permissoes.includes(necessaria));\n\n    if (hasPermission) {\n        return;\n    }\n\n    const index = menuOptions.indexOf(opcao);\n    if (index > -1) {\n        menuOptions.splice(index, 1);\n    }\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeDescricaoDoBotao({ tituloDoBotao, parteASerRemovida, listaPermissoes, permissaoNecessaria }) {\n    if (listaPermissoes.includes(permissaoNecessaria)) {\n        return\n    }\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions[index].description = menuOptions[index].description.replace(parteASerRemovida, '')\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        const { segmentoGerente, permissoes } = JSON.parse(contaSelecionada)\n\n        if (!segmentoGerente) {\n            removeOpcaoDoMenu({ tituloDoBotao: 'Outras credenciadoras' })\n        }\n\n        verificaPermissao({ tituloDoBotao: 'Cancelamento', permissoesNecessarias: ['cancelarAntecipAutomatica'], permissoes })\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Ótimo, o que você precisa sobre antecipação?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dcc9ffa9-70b9-4696-83c5-a2461736f608","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"4a8d8aa0-5345-46d7-8cd2-f51fb2274c53","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"26432abb-ada2-47d2-97c7-7213b7d91800","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9bffab6d-eaa6-4964-a2ba-1d94a6214551","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9d928a63-76c7-491f-b50d-b6141d4fc42f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6f914566-11e0-4e59-aafd-7dea706e9df1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-df3e2b97-6f23-4971-bf8d-8b092809be4b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a5a5102b-730f-4d5a-92f4-190d1ada87ca","root":false,"$title":"[MS.10.0.0][MSG] Menu Antecipação","$position":{"top":"3863px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4c237b9b-20cc-48a6-bee7-baefd00e0d43":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8f3f6d82-eb95-42af-82c6-86e9a4438a9c","typeOfStateId":"state","$connId":"con_1108","$id":"efe44cd9-a5f9-48db-99f5-d6b6640cf97b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Antecipação Automática"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"76280067-42cb-426f-8675-bf5e7bfe226a","typeOfStateId":"state","$connId":"con_1113","$id":"e4466e11-becb-4426-b060-4d21b7dedfb8","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Fazer a contratação"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"2ffe873a-3607-4860-b954-25c34139551a","typeOfStateId":"state","$connId":"con_1118","$id":"08a73cfe-70d5-4bfe-abae-9a84c8ec82c7","conditions":[{"source":"context","comparison":"equals","values":["Outras credenciadoras"],"variable":"userInput"}],"$invalid":false},{"stateId":"87114d80-0d65-4e2b-af38-cf5ba2c2ae03","typeOfStateId":"state","$connId":"con_1123","$id":"e5061ae7-3361-4c13-be9f-df6ec4b9388f","conditions":[{"source":"context","comparison":"notEquals","values":["Input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-47822d1f-01a5-4810-9792-9cc867e6f9e4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c4fb961b-2398-4e41-a966-91b5ca575a7b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e756e131-5319-4af8-a2ad-5a3b094e4737","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0dc557b3-b68a-4e8d-932c-dd1eb6511493","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4c237b9b-20cc-48a6-bee7-baefd00e0d43","root":false,"$title":"[MS.10.0.0][INPUT] Menu Antecipação","$position":{"top":"4165px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8f3f6d82-eb95-42af-82c6-86e9a4438a9c":{"$contentActions":[{"action":{"$id":"99a96b1a-b09c-4202-8862-d7b4602d7ac0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87d75b86-a144-4aa2-86ea-2431e4b6fe9a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação automática:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>habilitar</b>.\n\n3° Escolha a modalidade desejada: diária, semanal ou programada.\n\n4° Por fim, valide a contratação com sua senha.","metadata":{}},"$cardContent":{"document":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação automática:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>habilitar</b>.\n\n3° Escolha a modalidade desejada: diária, semanal ou programada.\n\n4° Por fim, valide a contratação com sua senha."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"200e12c3-550a-49e8-9d8e-2ee65440c421","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a860f92e-db91-4469-9f66-c60e4847cbe1","typeOfStateId":"state","$connId":"con_1128","$id":"b318c3d6-22ab-4fbf-817c-f50e7be3fec8","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"47f0eaf6-355b-4a3a-a3d1-4fa167d1ae6c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-27253621-0361-4a08-abf6-3af0a5d40ff1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3ebccad3-133e-43e9-913c-4c7a45eac809","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8f3f6d82-eb95-42af-82c6-86e9a4438a9c","root":false,"$title":"[MS.10.1.0][MSG] Contratar Antecipação Automatica","$position":{"top":"4451px","left":"2495px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"76280067-42cb-426f-8675-bf5e7bfe226a":{"$contentActions":[{"action":{"$id":"99a96b1a-b09c-4202-8862-d7b4602d7ac0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87d75b86-a144-4aa2-86ea-2431e4b6fe9a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação eventual:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>solicitar antecipação eventual</b>.\n\n3° Selecione a <b>bandeira</b> e o <b>valor</b> que deseja antecipar.\n\n4° Finalize a contratação com seus <b>dados</b> e <b>senha</b>.","metadata":{}},"$cardContent":{"document":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação eventual:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>solicitar antecipação eventual</b>.\n\n3° Selecione a <b>bandeira</b> e o <b>valor</b> que deseja antecipar.\n\n4° Finalize a contratação com seus <b>dados</b> e <b>senha</b>."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"200e12c3-550a-49e8-9d8e-2ee65440c421","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a860f92e-db91-4469-9f66-c60e4847cbe1","typeOfStateId":"state","$connId":"con_1133","$id":"f862d498-9b71-4765-b797-a6e5aa24e632","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"d90ce903-0495-4fc4-a438-060097e94d3e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-72ae3bff-de9f-424c-a797-543deb8042f5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6a870830-0e4a-4a45-8f03-a2bd06ed3fa3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"76280067-42cb-426f-8675-bf5e7bfe226a","root":false,"$title":"[MS.10.2.0][MSG]Contratar Antecipação Eventual","$position":{"top":"4455px","left":"2956px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2ffe873a-3607-4860-b954-25c34139551a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"185f44cf-e607-4877-927c-8a125625cbd9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"2ffe873a-3607-4860-b954-25c34139551a","root":false,"$title":"[GO TO] Redirect to Atendimento Humano","$position":{"top":"5531px","left":"2543px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a860f92e-db91-4469-9f66-c60e4847cbe1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"25991251-b486-423e-8a43-49f1c17ecef6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6dea6981-7b58-4bcb-8d42-ae88222752c3","typeOfStateId":"state","$connId":"con_1138","$id":"53fa7443-3506-4fc7-9037-9b8b918c538a","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"5b7baa1b-0a6b-46ec-ba01-89fe4abc0f96","typeOfStateId":"state","$connId":"con_1143","$id":"d27cf49b-94ee-4aed-bf88-7d4bb31c1379","conditions":[{"source":"context","comparison":"notExists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"293128be-9c10-41a4-a756-aeaae2dcf228","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"44cf9df6-0a6c-4fd4-ad05-64001a33cf75","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5c851a21-de5f-407e-bfd8-b42a8144179f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"a860f92e-db91-4469-9f66-c60e4847cbe1","root":false,"$title":"[M.10.3.0][LOGIC] Cliente carterizado?","$position":{"top":"4733.25px","left":"2757.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"72e19ac3-74de-4bab-9c2e-f61ec8323b7e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"307f84bd-662a-49b4-9bf1-3772df28581b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0e1b1b41-8bd0-4455-b681-89cb62d82eb3","typeOfStateId":"state","$connId":"con_1148","$id":"563aed27-41a6-4834-aaab-88bb3328f8b4","conditions":[{"source":"context","comparison":"equals","values":["emp1"],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"2ffe873a-3607-4860-b954-25c34139551a","typeOfStateId":"state","$connId":"con_1153","$id":"7d78fa3e-7ca8-4b32-b30d-5bc1cbf2b8f2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1ee54c11-c7ad-46b5-b29c-4d4060b3026a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"e959fa2c-a861-466b-a6ec-f5b876ec8fdd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-884e20f7-2224-4fee-bc9a-cc79bf177f0b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"72e19ac3-74de-4bab-9c2e-f61ec8323b7e","root":false,"$title":"[M.10.4.0][LOGIC] Seguimento EMP1?","$position":{"top":"5336px","left":"2960px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"0e1b1b41-8bd0-4455-b681-89cb62d82eb3":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0247a648-855d-4503-b0da-0881b9f5a533","typeOfStateId":"state","$connId":"con_1158","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Ver o menu incial\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Ver o menu anterior\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Falar com gerente\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Será que consigo te ajudar de outra forma?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dae74803-9bc0-4a43-a8f9-92d7a304579f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b6656e56-6f81-4aea-b05c-199fcfd7be5d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d7eb62b1-0cd2-4c59-a4af-6357a78c3a86","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0e1b1b41-8bd0-4455-b681-89cb62d82eb3","root":false,"$title":"[M.10.5.0][MSG] Como podemos ajudar? (EMP1)","$position":{"top":"5546.67px","left":"2960px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0247a648-855d-4503-b0da-0881b9f5a533":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_1163","$id":"9ce4999f-6b8b-4435-8cb9-fdf34c26823c","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Ver o menu incial"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false,"stateId":"7248b15d-01f6-44e7-ab77-ac9917d9b140"},{"stateId":"2ffe873a-3607-4860-b954-25c34139551a","typeOfStateId":"state","$connId":"con_1168","$id":"4d9465dd-2dad-401f-8b69-540bf76f98f1","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Falar com gerente"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"efb4fbac-3d65-441d-994d-1fe19448b82d","typeOfStateId":"state","$connId":"con_1173","$id":"4da266cf-7880-405d-9101-56dbbb1ea5b2","conditions":[{"source":"context","comparison":"equals","values":["Ver o menu anterior"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6a689ae5-e2eb-4dc3-bbbd-8f3b583c1e4e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-76afd9bb-5c0f-4a97-9384-d683e8c195a8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-17fc3ae3-8df8-4469-8b5d-fe430665bc2a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4ff9a74d-7c7c-4bbc-835b-1c5b0a1970bd","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"0247a648-855d-4503-b0da-0881b9f5a533","root":false,"$title":"[M.10.5.0][INPUT] Como podemos ajudar? (EMP1)","$position":{"top":"5817.33px","left":"2959.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"7248b15d-01f6-44e7-ab77-ac9917d9b140":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"275da9c5-b39f-4c0d-8f37-793134f1fcf3","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"7248b15d-01f6-44e7-ab77-ac9917d9b140","root":false,"$title":"[GO TO] Redirect to Main (Menu Principal)","$position":{"top":"5886.67px","left":"2407.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"efb4fbac-3d65-441d-994d-1fe19448b82d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea868f10-624c-4979-9a24-543bfe08cd94","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5a5102b-730f-4d5a-92f4-190d1ada87ca","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"efb4fbac-3d65-441d-994d-1fe19448b82d","root":false,"$title":"[GO TO] MS.10.0.0 Antecipação","$position":{"top":"5756.33px","left":"2407.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a4599177-c976-4921-9be9-ca6fa0d0d574":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"be41d916-189b-4c8e-b51d-7476b570afd3","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5a5102b-730f-4d5a-92f4-190d1ada87ca","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"a4599177-c976-4921-9be9-ca6fa0d0d574","root":false,"$title":"[GO TO] MS.10.0.0  Antecipacao","$position":{"top":"746.286px","left":"1871px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5b7baa1b-0a6b-46ec-ba01-89fe4abc0f96":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e0255a9a-6ef8-41b9-8702-3efb0baafc5e","typeOfStateId":"state","$connId":"con_1178","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Ver o menu incial\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Ver o menu anterior\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Encerrar atendimento\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"id\": \"4\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"5\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"6\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"7\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"8\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"9\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"10\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// }\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, como podemos te ajudar?` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Assuntos\", // <---- Titulo do botão\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-680ed08e-599a-4d65-89a0-23c388be7122","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ca0af784-64c8-44f1-92f5-33544d798bae","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d78beaf1-fca7-4e3b-814c-d62840d2ae5f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5b7baa1b-0a6b-46ec-ba01-89fe4abc0f96","root":false,"$title":"[M.10.3.1][MSG] Menu Sem Carteira","$position":{"top":"4929px","left":"2005px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e0255a9a-6ef8-41b9-8702-3efb0baafc5e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_1183","$id":"9ce4999f-6b8b-4435-8cb9-fdf34c26823c","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Ver o menu incial"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false,"stateId":"7248b15d-01f6-44e7-ab77-ac9917d9b140"},{"stateId":"efb4fbac-3d65-441d-994d-1fe19448b82d","typeOfStateId":"state","$connId":"con_1188","$id":"4da266cf-7880-405d-9101-56dbbb1ea5b2","conditions":[{"source":"context","comparison":"equals","values":["Ver o menu anterior"],"variable":"userInput"}],"$invalid":false},{"stateId":"0a14602f-f7b5-46eb-bbdd-c824fea248c9","typeOfStateId":"state","$connId":"con_1193","$id":"487d282c-05c5-4b52-a566-f51ac94b303d","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2cbbf842-9710-4e63-8114-aa6c784f5f23","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-56af3582-44df-4267-8ffa-be07d6807e09","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8737d187-e43a-42bb-91de-594a78b274d3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1bb2d8db-abf1-4407-b6bd-36199bfdd756","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e0255a9a-6ef8-41b9-8702-3efb0baafc5e","root":false,"$title":"[M.10.3.1][INPUT] Menu Sem Carteira","$position":{"top":"5804px","left":"2004px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"6dea6981-7b58-4bcb-8d42-ae88222752c3":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9b0b8b25-dfa1-437d-a2a2-1ee1d3c5ebe1","typeOfStateId":"state","$connId":"con_1198","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Consegui te ajudar?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b7375a28-76a9-43e6-9c02-922856b7da84","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-700405d0-7ff2-4b0b-989c-eb505a07b48b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a690d61a-5757-4d23-beab-da23c5c00bd4","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6dea6981-7b58-4bcb-8d42-ae88222752c3","root":false,"$title":"[M.10.3.1][MSG] Conseguimos te ajudar?","$position":{"top":"4921px","left":"2962px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9b0b8b25-dfa1-437d-a2a2-1ee1d3c5ebe1":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ee424cb6-5b7f-473c-9eaa-f22d58c1c686","typeOfStateId":"state","$connId":"con_1203","$id":"39187c73-d381-469f-a695-262719c7a4f1","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"72e19ac3-74de-4bab-9c2e-f61ec8323b7e","typeOfStateId":"state","$connId":"con_1208","$id":"b3983758-ac0e-4c89-aea6-c495831a7eab","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7a756d72-d3f9-41be-b17d-6a8705b875cb","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2246072a-581a-48c4-9dae-e84937b47c1e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-56faa3e3-f33d-4b11-8955-66025620e881","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-111b0266-023d-45b0-92cc-69fef5fe0a70","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9b0b8b25-dfa1-437d-a2a2-1ee1d3c5ebe1","root":false,"$title":"[M.10.3][INPUT] Conseguimos te ajudar?","$position":{"top":"5140.5px","left":"2960.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ee424cb6-5b7f-473c-9eaa-f22d58c1c686":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d24f1072-0226-4389-8fa4-1ef80bde80de","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"ee424cb6-5b7f-473c-9eaa-f22d58c1c686","root":false,"$title":"[GO TO] Finalizacao","$position":{"top":"5270px","left":"2684px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d3d438c4-7e57-440c-ae16-b78a24489e68":{"$contentActions":[{"action":{"$id":"c89a345c-0fb4-41e6-bd78-a3fb6eb746df","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bc151dc5-557e-406c-9f57-cd0434f1fa1b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bc151dc5-557e-406c-9f57-cd0434f1fa1b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fe9ca734-6683-4e14-989b-a6a9affc2c22","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1426b76c-fa01-43b2-81e1-baebcc331ecb","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"1426b76c-fa01-43b2-81e1-baebcc331ecb","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '5724999e-4ebb-443e-8b1d-4c15ef40251e',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Máquina Safrapay ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"71e66d5e-ddc0-48d4-930d-8630f59d2205","type":"Redirect","$title":"Redirect to {state} sending {userInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@userInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1ae47e37-0581-42af-8365-c0e76537e05f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c7129fee-4762-4000-8733-765826324aac","label":"Redirect","background":"#1EA1FF","canChangeBackground":false},{"id":"blip-tag-3260c416-32f5-4841-986f-11442834a1d8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d3d438c4-7e57-440c-ae16-b78a24489e68","root":false,"$title":"[Redirect] to Autenticacao (Falar sobre conta)","$position":{"top":"3833px","left":"1842px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fef763ef-e7cb-454e-9e26-e696b9b5a126":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9a883544-be29-422a-90f1-64d574057c1c","type":"text/plain","textContent":"User input","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-74f77261-33e4-4a80-aa4a-2aaa89682535","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"fef763ef-e7cb-454e-9e26-e696b9b5a126","root":false,"$title":"[GO TO] Finalizacao ","$position":{"top":"3575px","left":"1257px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c08c2e55-852c-49e8-a1e6-aa81bc5188fe":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '5724999e-4ebb-443e-8b1d-4c15ef40251e',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Máquina Safrapay ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"71e66d5e-ddc0-48d4-930d-8630f59d2205","type":"Redirect","$title":"Redirect to {state} sending {userInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@userInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0b30b51c-1062-4844-a534-62fad3e8bff4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1d06766b-f3c6-4f89-8bf0-78bb39202021","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"c08c2e55-852c-49e8-a1e6-aa81bc5188fe","root":false,"$title":"[Redirect] to Autenticacao (Whatsapp PJ Atendente)","$position":{"top":"4279px","left":"3441px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"227c3938-627f-4a0a-8136-ddb558c334ed":{"$contentActions":[{"action":{"$id":"dd75ec0c-0870-4f21-8e88-5b31268d8428","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"01a2b024-d22c-4132-8397-3573f32c0df1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"01a2b024-d22c-4132-8397-3573f32c0df1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28a40774-307d-444d-9191-b858ee050870","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3d3335a3-4747-4eb9-9469-0fd0bf163710","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"3d3335a3-4747-4eb9-9469-0fd0bf163710","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"53ecccb3-e087-49da-8667-d20438985d9a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"8d3a9912-951d-4bfc-ac47-2a281fc57f02","$typeOfContent":"","type":"SetVariable","$title":"Set \"atendimento\" to \"Caca_POS\"","$invalid":false,"settings":{"variable":"atendimento","value":"Caca_POS"},"conditions":[]},{"$id":"b0e87449-cedc-4403-99b9-f0a312c926bd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Whatsapp PJ ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"Caca_POS\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a70cb04f-0d4c-47b7-8093-5e2df5401351","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]},{"$id":"c9b1067a-9377-4513-b20a-b8916212b51c","$typeOfContent":"","type":"ProcessHttp","$title":"Process \"possuiMovimentacaoResponse\" using \"GET\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Aplicacao":"CHT","Safra-Correlation-ID":"{{random.guid}}","Safra-Bot-ID":"{{application.identifier}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/movimentacoes/verificar?codigoEC={{contaSelecionada@ec}}&qtdDiasApuracao=40","responseStatusVariable":"possuiMovimentacaoStatus","responseBodyVariable":"possuiMovimentacaoResponse"},"conditions":[]},{"$id":"5027774e-ab70-4033-8755-d02bdad8edcd","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/movimentacoes/verificar?codigoEC={{contaSelecionada@ec}}&qtdDiasApuracao=40 | GET | {{possuiMovimentacaoStatus}} | {{possuiMovimentacaoResponse}}"},"conditions":[]},{"$id":"0f7ba8ea-1b21-431f-92a7-ced3d7a0d706","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{possuiMovimentacaoStatus}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"possuiMovimentacaoStatus"}]},{"$id":"99c24419-0295-4d86-a26a-58a2ae6eca97","$typeOfContent":"","type":"SetVariable","$title":"Set \"possuiMovimentacao\"","$invalid":false,"settings":{"variable":"possuiMovimentacao","value":"{{possuiMovimentacaoResponse@data.possuiMovimentacao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"possuiMovimentacaoResponse@data.possuiMovimentacao"}]}],"$leavingCustomActions":[{"$id":"271f6538-acf2-4082-bbbc-5a1cbe0b5201","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\"","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"idSessao","identity":"{{contact.identity}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/movimentacoes/verificar?codigoEC=contaSelecionada@ec&qtdDiasApuracao=40 | {{possuiMovimentacaoStatus}}"},"conditions":[]},{"$id":"899b0fcf-a95a-42db-ab36-2b708dd3f4c9","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"caca_pos"},"address":"WhatsApp PJ"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7872cec6-c09f-4445-b2b1-d1354dbe0a1b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-cf17b582-1cf8-4259-b348-3362f8643528","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d91f917b-dd5e-4c9a-a134-fbcf043a8d5a","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-9cd5c147-f643-4139-9471-9ce8f2ddaf01","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8508960e-d3eb-4375-9521-6fb9091a8b15","label":"Redirect","background":"#1EA1FF","canChangeBackground":false},{"id":"blip-tag-68b6c98d-dae4-45ba-bd79-e90e673e0bbf","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"227c3938-627f-4a0a-8136-ddb558c334ed","root":false,"$title":"[Redirect] to WhatsApp PJ (Caca_POS)","$position":{"top":"575px","left":"1873px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d5dc7576-7a47-4388-b7ee-115298ab5310":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"26d2e917-0ce9-4b27-8a63-a8ac0ae41366","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"d5dc7576-7a47-4388-b7ee-115298ab5310","root":false,"$title":"[GO TO] Finalização","$position":{"top":"3193px","left":"2515px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"40aae674-ff83-4bc9-b589-08d3a89635a7":{"$contentActions":[{"action":{"$id":"0fcf96e0-9c36-4a02-a1f5-12c06318eaf1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fab11b19-866c-4da6-b5d3-3956c53392c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fab11b19-866c-4da6-b5d3-3956c53392c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ce0f816f-9d53-40fb-9f4b-0a4aecf5858e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f7743179-741d-495e-95b8-67a4d52ee18c","type":"text/plain","content":"Adicionar a ação\n\nProcess \"dataAtual\"","metadata":{}},"$cardContent":{"document":{"id":"f7743179-741d-495e-95b8-67a4d52ee18c","type":"text/plain","content":"Adicionar a ação\n\nProcess \"dataAtual\""},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b46843cb-db2a-4def-9063-b1600e845f90","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"1b355c16-05ba-468c-b659-0e52f008e774","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dataAtual\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\tconst date = new Date();\n\tconst pad = (num) => num.toString().padStart(2, '0');\n\n\tconst hora = `${pad(date.getHours())}:${pad(date.getMinutes())}`;\n\tconst data = `${pad(date.getDate())}/${pad(date.getMonth() + 1)}/${date.getFullYear()}`;\n\tconst dataHora = `${data} ${hora}`;\n\n\treturn {\n\t\tdata,\n\t\thora,\n\t\tdataHora\n\t};\n}","inputVariables":[],"outputVariable":"dataAtual","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7550b485-9977-4b6e-ad67-ff5c2e26278a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-17e26b74-9fee-40f7-a280-b20f7bb719e4","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"40aae674-ff83-4bc9-b589-08d3a89635a7","root":false,"$title":"ADICIONAR NAS AÇÕES GLOBAL","$position":{"top":"83px","left":"437px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0a14602f-f7b5-46eb-bbdd-c824fea248c9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d24f1072-0226-4389-8fa4-1ef80bde80de","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"0a14602f-f7b5-46eb-bbdd-c824fea248c9","root":false,"$title":"[GO TO] Finalizacao","$position":{"top":"5815px","left":"1756px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"87114d80-0d65-4e2b-af38-cf5ba2c2ae03":{"$contentActions":[{"action":{"$id":"3adeb1af-1cd3-45d4-acaf-8477bedd859a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3679a080-0806-4d60-9a37-516786491813","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3679a080-0806-4d60-9a37-516786491813","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3297a39e-96f2-4f6b-8389-d1713b172c49","$typeOfContent":"text","type":"SendMessage","settings":{"id":"23414342-d71e-45df-af16-624dee575ba3","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"23414342-d71e-45df-af16-624dee575ba3","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6fddc5f-8d04-424e-8503-88afe09e7373","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c08c2e55-852c-49e8-a1e6-aa81bc5188fe","typeOfStateId":"state","$connId":"con_1213","$id":"85b9c96e-b57a-4a95-a949-bc07de1a9d82","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f887d393-204c-44fe-985f-40659d0f5a7e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"87114d80-0d65-4e2b-af38-cf5ba2c2ae03","root":false,"$title":"[MS.10.0.2][MSG] Direcionamento humano","$position":{"top":"4302px","left":"3217px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.65","builder:stateTrack":"true","builder:#localTimeZone":"E. South America Standard Time","TraceTargetType":"Http","TraceMode":"All","TraceTarget":"https://take-api-beholder.cs.blip.ai/api/traces/devspdmaquinasafrapay2","builder:useTunnelOwnerContext":"true","builder:stateExpiration":"0.00:15:00","clientId":"BLIP","grantType":"client_credentials","urlToken":"https://sts-api-hml.safra.com.br","urlCHT":"https://api-hml.safra.com.br","clientSecret":"ee1f5004-2400-4ab1-9af7-d9168d517204","serviceName":"Bot Máquina Safrapay Dev","env":"Dev"},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"6847a189-7396-4144-b399-d99fac067b79","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"voltarState\"","$invalid":false,"settings":{"function":"run","source":"function ignoreBlock(stateName) {\n    try {\n        const match = stateName.match(/\\[(.*?)\\]/);\n        const stateNameOrigin = match ? match[1] : stateName;\n        const regex = /Redirect|Redirecionar/i;\n        const ignore = !regex.test(stateNameOrigin);\n        return ignore;\n    } catch (err) {\n        return false\n    }\n}\n\n\nfunction run(voltarState, blockId, botOrigin, lastVoltarState, previousStateName) {\n    const state = JSON.parse(voltarState)\n    try {\n        if (!voltarState) {\n            const state = {}\n            state[botOrigin] = [blockId]\n            return state\n        }\n        const isIgnoredBlock = ignoreBlock(previousStateName)\n        if (state[botOrigin][state[botOrigin].length - 1] !== blockId && blockId !== 'onboarding' && !isIgnoredBlock && blockId !== lastVoltarState) {\n            state[botOrigin].push(blockId)\n        }\n        return state\n    } catch (err) {\n        state[botOrigin] = [blockId]\n        return state\n    }\n}","inputVariables":["voltarState","state.previous.id","config.serviceName","lastVoltarState","state.previous.name"],"outputVariable":"voltarState"},"conditions":[]},{"$id":"1fafb7d9-c5e1-4fcf-adcd-173226207fb8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dataAtual\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\tconst date = new Date();\n\tconst pad = (num) => num.toString().padStart(2, '0');\n\n\tconst hora = `${pad(date.getHours())}:${pad(date.getMinutes())}`;\n\tconst data = `${pad(date.getDate())}/${pad(date.getMonth() + 1)}/${date.getFullYear()}`;\n\tconst dataHora = `${data} ${hora}`;\n\n\treturn {\n\t\tdata,\n\t\thora,\n\t\tdataHora\n\t};\n}","inputVariables":[],"outputVariable":"dataAtual"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}