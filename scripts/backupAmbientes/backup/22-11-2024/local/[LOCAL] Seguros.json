{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"d2712b4e-c844-4435-ba60-8364a32b3206","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{blockDestinationId}}","typeOfStateId":"variable","$id":"758d6d73-bfd9-4b90-8d14-29ccf8a8975a","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"blockDestinationId"}],"$invalid":false},{"stateId":"52a3d165-993d-416e-9066-566532ce4939","typeOfStateId":"state","$connId":"con_3","$id":"e6461817-3002-4995-abdf-568220f01ce1","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"14c70f18-f41f-4f9a-ab2f-b2fe9387fdde","$typeOfContent":"","type":"TrackEvent","$title":"Track \"inicio\"","$invalid":false,"settings":{"extras":{"identity":"{{contact.identity}}","idSessao":"{{idSessao}}"},"category":"inicio","action":"{{config.serviceName}} | {{state@botOrigin}} | {{state@stateNameOrigin}} | {{input.content}} | {{input.intent.name}}"},"conditions":[]},{"$id":"78bdc058-ee64-454a-a1bc-caeb50bba482","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"blockDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(state, serviceName) {\n\ttry {\n\t\tconst { botDestination, stateDestination } = JSON.parse(state)\n\n\t\tif (stateDestination.match(/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/) && botDestination === serviceName) {\n\t\t\treturn stateDestination\n\t\t}\n\t\treturn false\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["state","config.serviceName"],"outputVariable":"blockDestinationId","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8a1233f3-8b61-4b60-8a66-cc905b2d1491","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-92ee269c-4629-46c3-9e9c-bee3b38da54c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ea61ab5e-e342-41ab-a46e-648470e75705","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Início","$position":{"top":"475.871px","left":"1627.68px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b687933a-994c-4382-8051-601710a0e8ea","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"928e1999-3310-4c4f-a25a-c051922b9862","typeOfStateId":"state","$connId":"con_8","$id":"d40c89b5-2225-49b2-b2f8-02689607aa97","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0f178887-bb6c-4a8a-88bb-3d322a12c893","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\" if input.content not exist","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n\tif (!inputUsuario) {\n\t\treturn 'inatividade'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"input.content"}]},{"$id":"9b9bb723-73cc-447f-91c0-1b0a8ed8cebe","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\t\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `cascata ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"928e1999-3310-4c4f-a25a-c051922b9862","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-43a468e6-6718-4006-8584-efc9a0756862","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceções","$position":{"top":"130px","left":"879px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"928e1999-3310-4c4f-a25a-c051922b9862":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5c1c7b30-f3c5-44d7-99a1-c0e259cae078","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c8764fbc-31a8-4587-a403-f626f06e3151","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"id":"blip-tag-92cb1727-f542-4f16-a115-0db6500010f7","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"928e1999-3310-4c4f-a25a-c051922b9862","root":false,"$title":"[Redirect] To cascata","$position":{"top":"118px","left":"1112px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"52a3d165-993d-416e-9066-566532ce4939":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f3ddcbe5-6ae3-4fb6-9412-af4821ea1254","typeOfStateId":"state","$connId":"con_13","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Contratação\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Indenização\",\n\t\t\t\t\"description\": \"Negativa de cobertura\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Pagamento em atraso\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Renovação\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"5\",\n\t\t\t\t\"title\": \"Assistência funeral\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"6\",\n\t\t\t\t\"title\": \"Sinistro\",\n\t\t\t\t\"description\": \"Aviso ou consulta de sinistro\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"7\",\n\t\t\t\t\"title\": \"Cancelamento\",\n\t\t\t\t// \"description\": \"\"\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"id\": \"8\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"9\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"10\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// }\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Ótimo, o que você precisa sobre seguros?` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\", // <---- Titulo do botão\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b0a0ca38-a47d-4698-b995-e7efbd50236a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8cc449b0-da45-4004-93d8-a7ef4d7fe502","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5b839705-e911-473b-be50-00e1c464428d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"52a3d165-993d-416e-9066-566532ce4939","root":false,"$title":"[S.1.0.0][MSG] Menu Seguros","$position":{"top":"761.742px","left":"1627.58px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f3ddcbe5-6ae3-4fb6-9412-af4821ea1254":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"fbabf4b1-20f2-49a5-8880-f28aba086783","typeOfStateId":"state","$connId":"con_18","$id":"335e1176-6c13-4f3e-b496-d090d3d985b6","conditions":[{"source":"context","comparison":"equals","values":["Contratação"],"variable":"userInput"}],"$invalid":false},{"stateId":"03b1b07e-4e8a-4aa7-adfd-74ed5348ef6c","typeOfStateId":"state","$connId":"con_23","$id":"e8deffa5-756f-4901-81d9-75065064d9e3","conditions":[{"source":"context","comparison":"equals","values":["Indenização"],"variable":"userInput"}],"$invalid":false},{"stateId":"f0e55e03-091d-42c4-8933-7e7faeed402e","typeOfStateId":"state","$connId":"con_28","$id":"185ba17e-8c1a-4820-86df-d86d2d41108e","conditions":[{"source":"context","comparison":"equals","values":["Pagamento em atraso"],"variable":"userInput"}],"$invalid":false},{"stateId":"5ab55f1a-8e76-4929-9733-1c1fb494d267","typeOfStateId":"state","$connId":"con_33","$id":"e0f0411d-d27c-43d1-977d-a32ce0f9b6ea","conditions":[{"source":"context","comparison":"equals","values":["Renovação"],"variable":"userInput"}],"$invalid":false},{"stateId":"53889255-f226-48b8-8571-78623c739143","typeOfStateId":"state","$connId":"con_38","$id":"de2500a7-a1e2-4f41-a7ec-9af2f0cf9010","conditions":[{"source":"context","comparison":"equals","values":["Assistência funeral"],"variable":"userInput"}],"$invalid":false},{"stateId":"43ef0e44-bbe6-4986-9af4-ae84470a2536","typeOfStateId":"state","$connId":"con_43","$id":"c3652a34-bca9-4f01-a641-c7d3717ac542","conditions":[{"source":"context","comparison":"equals","values":["Sinistro"],"variable":"userInput"}],"$invalid":false},{"stateId":"d1b22fcc-aa02-45f7-8a1c-039de84ba40e","typeOfStateId":"state","$connId":"con_48","$id":"6e6cf97d-fe38-49db-8a65-f40647c09018","conditions":[{"source":"context","comparison":"equals","values":["Cancelamento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n\nfunction run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c7e6b516-2779-4d7c-a4b0-4fe794a7c623","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-31398d20-c977-4c22-be0e-85bb0283b8d0","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e69592e1-c84a-42c5-b293-78e90a2379a0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7436c1ec-ea64-4a9c-b795-9c8ad83e55dc","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f3ddcbe5-6ae3-4fb6-9412-af4821ea1254","root":false,"$title":"[S.1.0.0][INPUT] Menu Seguros","$position":{"top":"1033.16px","left":"1627.58px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fbabf4b1-20f2-49a5-8880-f28aba086783":{"$contentActions":[{"action":{"$id":"3ae447e6-77e7-42a0-b1ce-0496d1201a75","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ccdbeab3-0e08-4fe7-b06b-4be26fd941e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ccdbeab3-0e08-4fe7-b06b-4be26fd941e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2e17403d-4308-4df6-9aa1-95af01174f9a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"93ca539a-9c80-49e0-950c-7fc746a97b49","type":"text/plain","content":"Você pode contratar um seguro na sua agência, com seu gerente, ou pelos canais digitais do Banco Safra.\n\nSe já contratou o seguro diretamente na agência e deseja apenas consultar informações, entre em contato com sua agência.\n\nPara contratar pelos canais digitais, siga as orientações abaixo:\n\n<b>Internet Banking</b>\nAcesse o <b>menu seguros</b> no link:\nhttps://www.safra.com.br/pessoa-fisica\n\n<b>Aplicativo Safra Empresas</b>\n1° Selecione <b>ver mais.</b>\n\n2° Escolha <b>seguros.</b>\n\n3° Clique em <b>conheça nossos seguros.</b>","metadata":{"Internet Banking Safra.":"https://www.safra.com.br/pessoa-fisica.htm"}},"$cardContent":{"document":{"id":"93ca539a-9c80-49e0-950c-7fc746a97b49","type":"text/plain","content":"Você pode contratar um seguro na sua agência, com seu gerente, ou pelos canais digitais do Banco Safra.\n\nSe já contratou o seguro diretamente na agência e deseja apenas consultar informações, entre em contato com sua agência.\n\nPara contratar pelos canais digitais, siga as orientações abaixo:\n\n<b>Internet Banking</b>\nAcesse o <b>menu seguros</b> no link:\nhttps://www.safra.com.br/pessoa-fisica\n\n<b>Aplicativo Safra Empresas</b>\n1° Selecione <b>ver mais.</b>\n\n2° Escolha <b>seguros.</b>\n\n3° Clique em <b>conheça nossos seguros.</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc563aa0-0c86-4516-b8ca-977f441ae6e1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"368ed6d2-36d7-4631-a0b5-982523a88008","typeOfStateId":"state","$connId":"con_53","$id":"a367b283-8ece-4908-a86d-26f702a249d4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"02eaab49-a72e-45a3-ae99-a8e51825f845","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5ceb1754-79b5-4c66-a74f-a8294ea41e86","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7ceac981-d4fe-4f5f-baec-97c85fa77aa8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fbabf4b1-20f2-49a5-8880-f28aba086783","root":false,"$title":"[S.2.0.0][MSG] Contratação","$position":{"top":"1159px","left":"236px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"03b1b07e-4e8a-4aa7-adfd-74ed5348ef6c":{"$contentActions":[{"action":{"$id":"c0029e38-5518-4316-b95a-36e4a5f6ea1e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"66b39a13-e7d5-40f7-be07-c2445938de50","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"66b39a13-e7d5-40f7-be07-c2445938de50","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"867277a9-25ad-42c7-b27e-3e1b0793c800","$typeOfContent":"text","type":"SendMessage","settings":{"id":"04e4aab4-a7d1-451d-b21e-98eea53b8419","type":"text/plain","content":"Caso a indenização seja negada, será enviada uma formalização por e-mail solicitando complementos ou a análise de elegibilidade da cobertura.","metadata":{}},"$cardContent":{"document":{"id":"04e4aab4-a7d1-451d-b21e-98eea53b8419","type":"text/plain","content":"Caso a indenização seja negada, será enviada uma formalização por e-mail solicitando complementos ou a análise de elegibilidade da cobertura."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"698071fa-9076-4947-87b6-9e808f6c92d2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"765dc32a-fd68-4489-b77d-96e48c7499fb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-eecf5ebe-5e63-48fc-8706-017d41458d73","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ee5f9a24-2e6c-4961-8749-c6f1fbd22da3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"03b1b07e-4e8a-4aa7-adfd-74ed5348ef6c","root":false,"$title":"[S.3.0.0][MSG] Indenização","$position":{"top":"1353.57px","left":"1469.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f0e55e03-091d-42c4-8933-7e7faeed402e":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4e4d8166-c9f1-4d0b-a3c5-71c14a875a08","typeOfStateId":"state","$connId":"con_58","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Contratar\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Encerrar\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"type\": \"reply\",\n\t\t\t// \t\"reply\": {\n\t\t\t// \t\t\"id\": \"3\",\n\t\t\t// \t\t\"title\": \"\"\n\t\t\t// \t}\n\t\t\t// }\n\t\t];\n\t\tconst bodyText = `Para quitar um pagamento em atraso, basta manter o valor disponível em sua conta.\n\nA tentativa de cobrança ocorre diariamente por até 90 dias. \n\nDurante esse período, enviaremos notificações mensais por correio sobre a pendência.\n\nApós 90 dias sem pagamento, o seguro é cancelado, e não será reativado. Caso deseje, você poderá contratar um novo seguro.`; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c01a8ee4-b306-421a-9c7f-98029102fd03","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e797094b-32b6-4575-bf72-28044a277758","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-77aff650-709a-4bac-814e-985e42a380a7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f0e55e03-091d-42c4-8933-7e7faeed402e","root":false,"$title":"[S.3.0.0][MSG] Pagamento em atraso","$position":{"top":"1539.9px","left":"1212px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4e4d8166-c9f1-4d0b-a3c5-71c14a875a08":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f2d46b36-64ac-4b3d-898f-6470e3854551","typeOfStateId":"state","$connId":"con_63","$id":"ee701427-35c6-4957-ab27-6272b4ac529d","conditions":[{"source":"context","comparison":"equals","values":["Contratar"],"variable":"userInput"}],"$invalid":false},{"stateId":"9be1a043-8dcf-4aa5-a173-a3060636b4a4","typeOfStateId":"state","$connId":"con_68","$id":"c22e4c77-97b8-403d-a511-0f5ab6aca898","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n  \n  function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n  }","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6d106ea0-19df-4f90-a0f5-da6c64f162c4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-abed06df-357d-46fa-acd1-be8167372a52","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-4743c70d-9c2c-454a-9e30-1006036c84b6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-da2f646f-e24d-485b-958e-d4a4d8250f39","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4e4d8166-c9f1-4d0b-a3c5-71c14a875a08","root":false,"$title":"[S.3.0.0][INPUT] Pagamento em atraso","$position":{"top":"1780px","left":"1212px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f2d46b36-64ac-4b3d-898f-6470e3854551":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3fcedf79-f98b-471d-8107-7c362e55a9aa","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fbabf4b1-20f2-49a5-8880-f28aba086783","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f2d46b36-64ac-4b3d-898f-6470e3854551","root":false,"$title":"[GO TO][S.2.0.0][MSG] Contratação","$position":{"top":"1949.57px","left":"973.714px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9be1a043-8dcf-4aa5-a173-a3060636b4a4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"485196ac-e923-4b29-bd37-5d653bda0265","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9be1a043-8dcf-4aa5-a173-a3060636b4a4","root":false,"$title":"[GO TO] Finalização","$position":{"top":"1972px","left":"1460.86px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c8cceaf4-a986-4981-8641-44f25cf20cd2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a5083c5e-99bd-49de-8f9f-0e31802c294d","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5a638196-24c6-4f85-bd27-a921b1851dac","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8bba92e5-f567-48d0-ba55-73a1cdecf47c","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c9248d0d-d866-495f-80fe-1dad201b49c3","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"c8cceaf4-a986-4981-8641-44f25cf20cd2","root":false,"$title":"[Redirect] to Finalizacao (Welcome)","$position":{"top":"104.871px","left":"605.839px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5ab55f1a-8e76-4929-9733-1c1fb494d267":{"$contentActions":[{"action":{"$id":"01396c3b-5054-4863-afd8-1df44a2eabb5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3b26b9ec-5c02-449f-bd1a-b55123248be7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3b26b9ec-5c02-449f-bd1a-b55123248be7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"375e11c9-427c-44bb-b08d-d61319aa14a3","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2d3fff49-20a0-43b2-a076-fd617475d2f0","type":"text/plain","content":"Para os produtos elegíveis, a renovação será automática pelo mesmo período após o término, exceto se você solicitar o cancelamento ou optar por não renovar no canal de contratação.","metadata":{}},"$cardContent":{"document":{"id":"2d3fff49-20a0-43b2-a076-fd617475d2f0","type":"text/plain","content":"Para os produtos elegíveis, a renovação será automática pelo mesmo período após o término, exceto se você solicitar o cancelamento ou optar por não renovar no canal de contratação."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"3798cffd-a69d-4124-9abb-8ac7a74295e2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"368ed6d2-36d7-4631-a0b5-982523a88008","typeOfStateId":"state","$connId":"con_73","$id":"c7fb2d6f-12e4-40fe-9490-0137f8a61a5f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5156f045-53a4-41d8-911a-44f7d7413455","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3ef79ce3-0b03-4245-ab7c-b51c12e554fb","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e86503c2-2810-4489-9afd-1b988c65ba86","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5ab55f1a-8e76-4929-9733-1c1fb494d267","root":false,"$title":"[S.4.0.0][MSG] Renovação","$position":{"top":"1255.29px","left":"454.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"53889255-f226-48b8-8571-78623c739143":{"$contentActions":[{"action":{"$id":"9a4e2e51-70ae-4821-b5d9-a3648851a7bf","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"72e59a80-0e14-4540-89f4-8d0bcf1900a4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"72e59a80-0e14-4540-89f4-8d0bcf1900a4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"19ab2c22-e6ec-4199-b9a5-829cbb85a9d8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a1bf25b8-a0db-4bf8-903b-e335e329cbe7","type":"text/plain","content":"Para informações sobre sepultamento ou cremação, entre em contato pelos telefones abaixo:\n\n- No Brasil (ligação gratuita):\n0800 702 0242\n\n- No exterior (ligação a cobrar):\n+55 11 4689-5781","metadata":{}},"$cardContent":{"document":{"id":"a1bf25b8-a0db-4bf8-903b-e335e329cbe7","type":"text/plain","content":"Para informações sobre sepultamento ou cremação, entre em contato pelos telefones abaixo:\n\n- No Brasil (ligação gratuita):\n0800 702 0242\n\n- No exterior (ligação a cobrar):\n+55 11 4689-5781"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ca1f78f7-743d-4f33-9e7c-7fb16e6314bd","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"75790ddc-c47d-4e79-ab0b-dd040f269ea6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fb712495-58d7-41a3-978c-39406d286ec1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d20173f9-c36a-468f-83a5-f6a1d3e97f93","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"53889255-f226-48b8-8571-78623c739143","root":false,"$title":"[S.5.0.0][MSG] Assistência Funeral","$position":{"top":"1338px","left":"1770.65px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"43ef0e44-bbe6-4986-9af4-ae84470a2536":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"5c90e205-dc61-4c97-8272-dc2f0bf161bb","typeOfStateId":"state","$connId":"con_78","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Agência/Gerente\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Canais Digitais\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"type\": \"reply\",\n\t\t\t// \t\"reply\": {\n\t\t\t// \t\t\"id\": \"3\",\n\t\t\t// \t\t\"title\": \"\"\n\t\t\t// \t}\n\t\t\t// }\n\t\t];\n\t\tconst bodyText = \"Certo, por onde você realizou a contratação do seu seguro?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f9c68257-7665-4e71-a093-8de0647aa8ab","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-681fa013-1555-40e1-bbff-87e3fe525d21","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-38de7fc6-1ba3-4dae-8e21-fc06bf311572","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"43ef0e44-bbe6-4986-9af4-ae84470a2536","root":false,"$title":"[S.6.0.0][MSG] Sinistro","$position":{"top":"1436.77px","left":"2323.26px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5c90e205-dc61-4c97-8272-dc2f0bf161bb":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"50b59980-196c-44f8-85d2-2d41c28972e4","typeOfStateId":"state","$connId":"con_83","$id":"25048290-b4b6-448a-9b85-fc4da1577a87","conditions":[{"source":"context","comparison":"equals","values":["Agência/Gerente"],"variable":"userInput"}],"$invalid":false},{"stateId":"25de4ad6-a4bf-4fef-8c2f-7d5c552e94ba","typeOfStateId":"state","$connId":"con_88","$id":"438a4eff-987c-4aaa-9e7b-4dcd40cf65fc","conditions":[{"source":"context","comparison":"equals","values":["Canais Digitais"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n  \n  function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n  }","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7eca6bf2-833f-473f-91e1-a1eaadd4e485","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b974d726-ad0a-4bd0-9f0c-fa52ab55c886","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0e5f32f1-2d84-40e5-91d3-724911f31b1b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-44b90401-c25a-4986-abf8-57b86adbe16f","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"5c90e205-dc61-4c97-8272-dc2f0bf161bb","root":false,"$title":"[S.6.0.0][INPUT] Sinistro","$position":{"top":"1679px","left":"2323.39px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"50b59980-196c-44f8-85d2-2d41c28972e4":{"$contentActions":[{"action":{"$id":"626d7033-83a9-4abc-9970-bb22dfdf4071","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:405"},{"action":{"$id":"48fe95f5-1f05-4293-a4c6-b1a5d844a5d3","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Para acionar o sinistro:\n\n1° Acesse o site institucional do Safra pelo link:\nhttps://www.safra.com.br/servicos/pessoa-juridica/seguros-para-empresa-safra.htm\n\n2° Role até o final da página e clique em para aviso de sinistro.\n\nPara dúvidas e acompanhamento do sinistro, utilize o formulário abaixo:\n\nhttps://forms.office.com/r/68wT3hkKx5","metadata":{}},"$cardContent":{"document":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Para acionar o sinistro:\n\n1° Acesse o site institucional do Safra pelo link:\nhttps://www.safra.com.br/servicos/pessoa-juridica/seguros-para-empresa-safra.htm\n\n2° Role até o final da página e clique em para aviso de sinistro.\n\nPara dúvidas e acompanhamento do sinistro, utilize o formulário abaixo:\n\nhttps://forms.office.com/r/68wT3hkKx5"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:406"},{"action":{"$id":"bd82eb2f-dcc4-44f7-a162-a24dcbdcaf9f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:407"},{"action":{"$id":"93dd1c2c-1023-42f7-8d4c-dd649e51d0fd","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante:</b> O prazo para a conclusão do sinistro é de até 30 dias úteis e começa a ser contado a partir do recebimento de toda a documentação necessária.","metadata":{}},"$cardContent":{"document":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante:</b> O prazo para a conclusão do sinistro é de até 30 dias úteis e começa a ser contado a partir do recebimento de toda a documentação necessária."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:408"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4e8a638d-5c92-47aa-8443-7ce8fd3211fe","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:409"}],"$conditionOutputs":[{"stateId":"25eccedf-f9b1-4d47-ba63-a82b1d1a8463","typeOfStateId":"state","$connId":"con_93","$id":"287991b2-bd58-4a94-b468-b0908719b118","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:433"}],"$invalid":false,"$$hashKey":"object:419"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7005af3a-58d4-4d5b-a68a-92883d7e3500","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"50b59980-196c-44f8-85d2-2d41c28972e4","root":false,"$title":"[S.6.1.0][MSG] Agência/Gerente","$position":{"top":"1921px","left":"2096.87px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"25de4ad6-a4bf-4fef-8c2f-7d5c552e94ba":{"$contentActions":[{"action":{"$id":"626d7033-83a9-4abc-9970-bb22dfdf4071","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"84a26461-8024-44f9-add8-0b063eca235b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:808"},{"action":{"$id":"48fe95f5-1f05-4293-a4c6-b1a5d844a5d3","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Para aviso ou consulta de sinistro:\n\n<b>No Internet Banking:</b>\n\n- Para aviso de sinistro: Acesse o <b>menu seguros > seguros ativos</b> e selecione o seguro para o qual deseja avisar o sinistro.\n\n- Para consulta de sinistro: Acesse o <b>menu seguros > seguros ativos</b> e selecione o seguro que deseja consultar.\n\n<b>No aplicativo Safra Empresas:</b>\n\n- Para aviso de sinistro: Acesse o <b>menu ver mais > seguros > acessar meus seguros</b> e selecione o seguro para o qual deseja avisar o sinistro.\n\n- Para consulta de sinistro: Acesse o <b>menu ver mais > seguros > acessar meus seguros</b>, selecione o seguro e clique em Consultar sinistro. \n\n- Para mais detalhes, consulte o PDF disponível.","metadata":{}},"$cardContent":{"document":{"id":"bbf515f0-4646-4e52-820d-72ef922731c4","type":"text/plain","content":"Para aviso ou consulta de sinistro:\n\n<b>No Internet Banking:</b>\n\n- Para aviso de sinistro: Acesse o <b>menu seguros > seguros ativos</b> e selecione o seguro para o qual deseja avisar o sinistro.\n\n- Para consulta de sinistro: Acesse o <b>menu seguros > seguros ativos</b> e selecione o seguro que deseja consultar.\n\n<b>No aplicativo Safra Empresas:</b>\n\n- Para aviso de sinistro: Acesse o <b>menu ver mais > seguros > acessar meus seguros</b> e selecione o seguro para o qual deseja avisar o sinistro.\n\n- Para consulta de sinistro: Acesse o <b>menu ver mais > seguros > acessar meus seguros</b>, selecione o seguro e clique em Consultar sinistro. \n\n- Para mais detalhes, consulte o PDF disponível."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:809"},{"action":{"$id":"bd82eb2f-dcc4-44f7-a162-a24dcbdcaf9f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bc4ce21c-67fe-4531-b65b-cd79a73584ca","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:810"},{"action":{"$id":"93dd1c2c-1023-42f7-8d4c-dd649e51d0fd","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante:</b> O prazo para a conclusão do sinistro é de até 30 dias úteis e começa a ser contado a partir do recebimento de toda a documentação necessária.","metadata":{}},"$cardContent":{"document":{"id":"ea912078-95db-4c33-8aa5-109fabfb8093","type":"text/plain","content":"<b>Importante:</b> O prazo para a conclusão do sinistro é de até 30 dias úteis e começa a ser contado a partir do recebimento de toda a documentação necessária."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:811"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4e8a638d-5c92-47aa-8443-7ce8fd3211fe","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:812"}],"$conditionOutputs":[{"stateId":"25eccedf-f9b1-4d47-ba63-a82b1d1a8463","typeOfStateId":"state","$connId":"con_98","$id":"d4ca250e-f64b-4a81-adeb-6863836c352c","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:844"}],"$invalid":false,"$$hashKey":"object:834"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9ee48ed9-56c8-40ab-a40e-3bf4b697f934","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"25de4ad6-a4bf-4fef-8c2f-7d5c552e94ba","root":false,"$title":"[S.6.2.0][MSG] Canais Digitais","$position":{"top":"1918px","left":"2567px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d1b22fcc-aa02-45f7-8a1c-039de84ba40e":{"$contentActions":[{"action":{"$id":"5a383630-b887-41a5-ac72-4bece3a63d9f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b56359b7-3199-420d-9a8b-f95ff9ff14d9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b56359b7-3199-420d-9a8b-f95ff9ff14d9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:1024"},{"action":{"$id":"6a818edb-b3c8-4f56-a8dd-49e925b06585","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4a1e323c-9512-4deb-8db7-9118a55d2678","type":"text/plain","content":"Para cancelamento de seguro:\n\n<b>Seguro contratado na agência ou com o gerente:</b>\nSolicite o cancelamento diretamente na sua agência.\n\n<b>Seguro contratado pelos canais digitais:</b>\n\nNo <b>Internet Banking:</b>\n1° Acesse o <b>menu seguros.</b>\n\n2° Selecione <b>seguros ativos.</b>\n\n3° Escolha o seguro que deseja cancelar. (Será necessário inserir a senha e o token para confirmar o cancelamento.)\n\nNo <b>aplicativo Safra Empresas:</b>\n1° Acesse o <b>menu ver mais.</b>\n\n2° Selecione <b>seguros</b> e depois acesse <b>meus seguros.</b>\n\n3° Escolha o seguro que deseja cancelar e clique em <b>cancelar.</b> (Será necessário inserir sua senha para confirmar o cancelamento.)","metadata":{}},"$cardContent":{"document":{"id":"4a1e323c-9512-4deb-8db7-9118a55d2678","type":"text/plain","content":"Para cancelamento de seguro:\n\n<b>Seguro contratado na agência ou com o gerente:</b>\nSolicite o cancelamento diretamente na sua agência.\n\n<b>Seguro contratado pelos canais digitais:</b>\n\nNo <b>Internet Banking:</b>\n1° Acesse o <b>menu seguros.</b>\n\n2° Selecione <b>seguros ativos.</b>\n\n3° Escolha o seguro que deseja cancelar. (Será necessário inserir a senha e o token para confirmar o cancelamento.)\n\nNo <b>aplicativo Safra Empresas:</b>\n1° Acesse o <b>menu ver mais.</b>\n\n2° Selecione <b>seguros</b> e depois acesse <b>meus seguros.</b>\n\n3° Escolha o seguro que deseja cancelar e clique em <b>cancelar.</b> (Será necessário inserir sua senha para confirmar o cancelamento.)"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:1025"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fea77331-938f-4e6a-9040-f08d6be03cf3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:1026"}],"$conditionOutputs":[{"stateId":"368ed6d2-36d7-4631-a0b5-982523a88008","typeOfStateId":"state","$connId":"con_103","$id":"b092e4d8-a02f-4b50-b228-3e602b75e3b7","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:1048"}],"$invalid":false,"$$hashKey":"object:1038"}],"$enteringCustomActions":[{"$id":"fbb27862-4b0c-4b95-b23f-294492ada129","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-39e56176-4d99-4e13-8d4f-c89ac7f7fc63","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-adce3b2c-f13d-4e61-883c-97c4bf0deb8b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d1b22fcc-aa02-45f7-8a1c-039de84ba40e","root":false,"$title":"[S.7.0.0][MSG] Cancelamento","$position":{"top":"1364.71px","left":"693.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"25eccedf-f9b1-4d47-ba63-a82b1d1a8463":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"485196ac-e923-4b29-bd37-5d653bda0265","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"25eccedf-f9b1-4d47-ba63-a82b1d1a8463","root":false,"$title":"[GO TO] Finalização","$position":{"top":"2197.67px","left":"2342px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"368ed6d2-36d7-4631-a0b5-982523a88008":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d3f33e59-2d1a-4743-8950-eab3409746a4","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"40be20b8-777e-4426-8b10-5784fd180f18","typeOfStateId":"state","$connId":"con_108","$id":"ae3a7fbe-5e71-4316-9247-84e350d010e1","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"9654bbae-376f-439f-a7bd-5ce83c1939d4","typeOfStateId":"state","$connId":"con_113","$id":"3d82801a-bc18-492c-9c28-43985cb1a389","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1745a276-38a7-490b-a01d-9ae2a7722a87","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"7bf85e68-666b-477b-8282-b3bbdb0b8a3f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} dados\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} dados","action":"{{contact.identity}} | {{state.previous.name}} | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4d525ec1-6fea-42d2-bd76-f93c6340d07b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"368ed6d2-36d7-4631-a0b5-982523a88008","root":false,"$title":"[SET] Valida Carteirização","$position":{"top":"1547px","left":"264.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"40be20b8-777e-4426-8b10-5784fd180f18":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"845c49d1-02c2-4b51-b338-04c3bf582335","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b9a7f027-209a-4d73-ab4d-aa0086d480dc","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"40be20b8-777e-4426-8b10-5784fd180f18","root":false,"$title":"[GO TO] Redirect F.4.0.0 Finalização","$position":{"top":"1784px","left":"87px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9654bbae-376f-439f-a7bd-5ce83c1939d4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d558b48c-877c-41c8-a585-da2d3573e6d4","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c8cceaf4-a986-4981-8641-44f25cf20cd2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9654bbae-376f-439f-a7bd-5ce83c1939d4","root":false,"$title":"[GO TO] Redirect Finalização F.0.0.0","$position":{"top":"1791px","left":"444px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b9a7f027-209a-4d73-ab4d-aa0086d480dc":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'ed2a5fb2-da6f-4961-b14d-e302fa57b991',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a5083c5e-99bd-49de-8f9f-0e31802c294d","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-57f96aa5-532e-4a0f-ac7e-c4750ee1f20a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5798a842-4bcc-4c94-91f0-228675ec5b87","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-45281cb2-8881-4c47-91cb-323457a8f4c2","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"b9a7f027-209a-4d73-ab4d-aa0086d480dc","root":false,"$title":"[Redirect] to Finalizacao (F.4.0.0)","$position":{"top":"109px","left":"414px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"true","builder:#localTimeZone":"E. South America Standard Time","builder:useTunnelOwnerContext":"true","env":"Dev","serviceName":"seguros Dev"},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"6847a189-7396-4144-b399-d99fac067b79","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"voltarState\"","$invalid":false,"settings":{"function":"run","source":"function ignoreBlock(stateName) {\n    try {\n        const match = stateName.match(/\\[(.*?)\\]/);\n        const stateNameOrigin = match ? match[1] : stateName;\n        const regex = /Redirect|Redirecionar/i;\n        const ignore = !regex.test(stateNameOrigin);\n        return ignore;\n    } catch (err) {\n        return false\n    }\n}\n\n\nfunction run(voltarState, blockId, botOrigin, lastVoltarState, previousStateName) {\n    const state = JSON.parse(voltarState)\n    try {\n        if (!voltarState) {\n            const state = {}\n            state[botOrigin] = [blockId]\n            return state\n        }\n        const isIgnoredBlock = ignoreBlock(previousStateName)\n        if (state[botOrigin][state[botOrigin].length - 1] !== blockId && blockId !== 'onboarding' && !isIgnoredBlock && blockId !== lastVoltarState) {\n            state[botOrigin].push(blockId)\n        }\n        return state\n    } catch (err) {\n        state[botOrigin] = [blockId]\n        return state\n    }\n}","inputVariables":["voltarState","state.previous.id","config.serviceName","lastVoltarState","state.previous.name"],"outputVariable":"voltarState"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}