{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"db0ea0f3-01b3-4870-aa57-cfcfee9133fd","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{blockDestinationId}}","typeOfStateId":"variable","$id":"edae1c07-a6f0-4693-8aaa-942849aa4322","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"blockDestinationId"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"3fb6be51-097f-4435-a48f-8e8b87931773","$typeOfContent":"","type":"TrackEvent","$title":"Track \"inicio\"","$invalid":false,"settings":{"extras":{"identity":"{{contact.identity}}","idSessao":"{{idSessao}}"},"category":"inicio","action":"{{config.serviceName}} | {{state@botOrigin}} | {{state@stateNameOrigin}} | {{input.content}} | {{input.intent.name}}"},"conditions":[]},{"$id":"d3084a98-4e51-451d-a81c-0b8932f7a7fc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"blockDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(state, serviceName) {\n\ttry {\n\t\tconst { botDestination, stateDestination } = JSON.parse(state)\n\n\t\tif (stateDestination.match(/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/) && botDestination === serviceName) {\n\t\t\treturn stateDestination\n\t\t}\n\t\treturn false\n\t} catch (err) {\n\t\treturn err.message\n\t}\n}","inputVariables":["state","config.serviceName"],"outputVariable":"blockDestinationId","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f145a963-6803-4c60-aea0-d9e746f9f7fa","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroGenerico\" if blockDestinationId is false","$invalid":false,"settings":{"variable":"exceptionType","value":"erroGenerico"},"conditions":[{"values":["false"],"source":"context","comparison":"equals","variable":"blockDestinationId"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e0d2ce64-3265-46bd-b396-f53ad65b26e6","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-af9124ed-69d7-4400-aa8b-d2572b52c3ff","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bc3cdfef-2f1e-4baf-bc24-5fbb565937b6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5cd0026b-ce44-4366-a807-554e2d2a01c0","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-642a5a5d-bebc-4589-8e2e-9f7dc6685257","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Início","$position":{"top":"258px","left":"425px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"38f6203a-20cd-4cb8-8867-b7bb3e0a1b62","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","typeOfStateId":"state","$connId":"con_3","$id":"aa7a1a1f-5a8a-4f5a-a771-2f8a9f126e13","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f037dd4f-b303-4ace-94f1-8314ee5babbf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\" if input.content not exist","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n\tif (!inputUsuario) {\n\t\treturn 'inatividade'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"input.content"}]},{"$id":"a5cea299-45c6-4fa8-adca-4f657c82e3dd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(previousBlockId, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `cascata ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\t// stateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-a2ca062c-468a-4149-9b47-e56fceacd224","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceções","$position":{"top":"259.5px","left":"676px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4b038e89-c130-4869-a541-4954e12ebf81":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, vale lembrar que as vendas feitas na sua maquininha podem demorar até <b>1 dia útil</b> para aparecer no seu extrato.","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, vale lembrar que as vendas feitas na sua maquininha podem demorar até <b>1 dia útil</b> para aparecer no seu extrato."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6d8ca87c-9cc8-42c0-86ce-be3e7935ff24","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e8398e93-5598-4d14-b3f3-b29855e4c9f7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e8398e93-5598-4d14-b3f3-b29855e4c9f7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4299f5bb-66a9-4b91-a2df-b40c83fad7a2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b1d08962-31af-41fb-86de-1edb67219403","type":"text/plain","content":"Você pode informar a data de venda, como neste exemplo: {{dataAtual@data}}?","metadata":{}},"$cardContent":{"document":{"id":"b1d08962-31af-41fb-86de-1edb67219403","type":"text/plain","content":"Você pode informar a data de venda, como neste exemplo: {{dataAtual@data}}?"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3363e5ff-e5bb-4373-a385-f4206fa54eba","typeOfStateId":"state","$connId":"con_8","$id":"ef04e652-526a-411f-9385-a603df4c7b38","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9b9baab9-2909-4eab-bbdb-87cf67b41795","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f6a5b01e-d8f0-4389-897f-75633f291c5d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c00b7b15-0661-4e3d-9021-168d71962a4d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4b038e89-c130-4869-a541-4954e12ebf81","root":false,"$title":"[MS.4.0.0][MSG] Não recebi minha venda","$position":{"top":"476px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"42352582-3913-431e-976e-ad8494ad2445":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, agora informe qual o valor da venda, exemplo: 3.000,00.","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Certo, agora informe qual o valor da venda, exemplo: 3.000,00."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3667b0cd-ad3b-4f05-a5de-144400562fd0","typeOfStateId":"state","$connId":"con_13","$id":"ed4b98d3-d6f8-4e76-9b69-fbeb08e72afd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bd384f45-15f6-4927-b877-d4104dd3211a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ed4bb0e9-bd01-465a-a67d-a011360d9278","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d2ccaa93-f8cb-42ab-9c32-573722026222","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"42352582-3913-431e-976e-ad8494ad2445","root":false,"$title":"[MS.4.1.0][MSG] Solicita valor da venda","$position":{"top":"940px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c391e959-860e-4eaf-86b9-71fcd8888c86":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"63e9145d-3760-4ef3-ba6e-88f41a491e41","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c5482705-133e-4f31-b01e-7930e16e12a3","typeOfStateId":"state","$connId":"con_18","$id":"3e12632c-4292-499f-ad43-d2b0e19815a4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6cf082c9-1a1a-40b3-ba97-43413903f57d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"22d6b742-155e-4644-851e-fe36cfa633c5","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8e34e853-1c36-410a-98b8-0a86cd881ebd","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6e94390b-a5fd-465b-8b2e-8ca7600afbea","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"c391e959-860e-4eaf-86b9-71fcd8888c86","root":false,"$title":"[MS.2.0.0] [SET] Simulador de Vendas Inicio","$position":{"top":"33px","left":"2763.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8f1c55b1-7d84-4727-a19c-145275d573e4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"92e51a16-8e14-4d36-8a8e-16d9b0bf7031","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"890c6c8d-7503-4b06-a642-b00d277b6a13","typeOfStateId":"state","$connId":"con_23","$id":"5d0b076b-de59-45b2-8091-500419ad1681","conditions":[{"source":"context","comparison":"equals","values":["Quero Cobrar","Quero Receber"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"cd9835be-39c1-4ac3-92bc-f90336489c65","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"quero cobrar|cobrar\": \"Quero Cobrar\",\n      \"quero receber|receber\": \"Quero Receber\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4e5ef253-61f7-4835-9e45-f49e36ee8083","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesOrder\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesOrder = input.replace(`Quero Cobrar`, `cobrar`).replace(`Quero Receber`, `receber`)\n\t\treturn salesOrder;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesOrder","LocalTimeZoneEnabled":false},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"00ea8767-f905-43d2-b560-b45aedee1f32","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"473ff1dc-08f4-448d-82a9-ab4f95f65d1b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"1e361b76-2442-4144-b8f2-b73335978d59","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-12717dbe-f113-4de1-82e7-a6393b082427","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1e11abb1-6d4e-4e17-b36c-5d197845b60a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6cc5828b-442a-4453-a662-669f7b65bccb","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-44d460a8-b9ae-4ae5-9617-cce76f23528e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"8f1c55b1-7d84-4727-a19c-145275d573e4","root":false,"$title":"[MS.2.0.1] [INPUT] Simulador de Vendas - Máquina","$position":{"top":"653px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"890c6c8d-7503-4b06-a642-b00d277b6a13":{"$contentActions":[{"action":{"$id":"b00b58af-c4a0-4b88-acc6-bfd375877d98","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87cd5126-0e6d-401b-8e15-fc57f4b1139f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c3541272-a652-4112-9a0f-665d23c0136e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0f1cd996-d08a-4f2b-af89-445eaab54a00","typeOfStateId":"state","$connId":"con_28","$id":"5b0c583a-22c5-4c1f-91a9-584414441e83","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5de6066b-90d0-4776-9a2e-985420e55842","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"efc6afd4-c708-460d-842d-5021f952c686","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Venda física\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Venda digital\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Qual seria o tipo de venda?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-391c03ba-a0d4-4795-8f44-f3663c04b564","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-46c553b0-b642-43f5-af6e-60d5a1453081","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2073547c-3750-45b4-a9ee-7fc3f9e69c90","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"890c6c8d-7503-4b06-a642-b00d277b6a13","root":false,"$title":"[MS.2.1.0] [MSG] Tipo de venda","$position":{"top":"869px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0f1cd996-d08a-4f2b-af89-445eaab54a00":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"65afe46f-a05c-40b1-9f67-6b934b7f2eb6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"fe58d380-8c87-45b9-ab44-64d5d37c1f51","typeOfStateId":"state","$connId":"con_33","$contentId":"9127595b-b2c0-41e3-a704-940de3cf87b7","$id":"d100409d-ed80-44b2-b907-3047dbc19aef","conditions":[{"source":"context","comparison":"equals","values":["Venda física","Venda digital"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0c4de828-fe02-460d-9f56-b83a73c70346","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"6f67936b-305e-4906-9828-701ccf1247e8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"6659f598-65b1-4bfb-96d4-e7c12ff9c5f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"Venda f[íi]sica|f[íi]sica\": \"Venda física\",\n      \"Venda digital|digital\": \"Venda digital\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"15920c9a-5270-44b6-9bef-a48d73598848","$typeOfContent":"","type":"ExecuteScript","$title":"Proces \"salesType\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesType = input.replace(`Venda física`, `maquininha`).replace(`Venda digital`, `link`);\n\t\treturn salesType;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesType","LocalTimeZoneEnabled":false},"conditions":[{"values":["Input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"9038f508-01e7-4e0e-8165-1c46808638e9","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":["Venda física","Venda digital"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-30af0b7d-d4bf-43eb-9cd7-7d09eed3edb3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ac306f83-bd2c-47a7-b814-48c25f548616","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-03c6116e-a7b2-4162-9548-03085018a49f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-d9ed9cb1-66c0-4e67-814e-c59d9eb2cc8a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"0f1cd996-d08a-4f2b-af89-445eaab54a00","root":false,"$title":"[MS.2.1.0] [INPUT] Tipo de venda","$position":{"top":"1042px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"90f43d6e-b4cd-42d8-a2a1-938c40d6e764":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a658b32f-2835-4b36-aa9d-ad3e817ae7ac","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"2379f037-b47b-4c61-b9b7-9ae97eb09f06","typeOfStateId":"state","$connId":"con_38","$id":"95b138d2-a2a1-4485-9e93-37af8373de42","conditions":[{"source":"context","comparison":"equals","values":["É um valor válido"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"9d2ab2f5-ccbc-479d-8842-e89a87616c1f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n        if (!inputUsuario) {\n            return 'inatividade'\n        }\n\n        let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi\n        let validInput = regex.test(inputUsuario)\n\n        if (validInput) {\n            let valor = inputUsuario.replace(/\\./g, '').replace(',', '.')\n            let valorFloat = parseFloat(valor)\n            if (valorFloat <= 10000 && valorFloat >= 1) {\n                return \"É um valor válido\"\n            }\n        }\n        return invalidInputMessage\n    } catch (err) {\n        return invalidInputMessage\n    }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7e0adafc-7741-452a-b0a9-9ac59e690382","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValue\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesValue = input.replace('.', '').replace(',', '.')\n\t\treturn salesValue;\n\t}\n\tcatch(err){\n\t\treturn false\n\t}\n}","inputVariables":["input.content"],"outputVariable":"salesValue","LocalTimeZoneEnabled":false},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"0f55c995-6169-457f-92c9-684fcde81211","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.2.1.1\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.2.1.1"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"764e8e9a-21da-4f52-84e7-a4b5a9c1f388","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"8d5fea91-f519-45eb-9277-2e003aae0255","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a7bdcda5-afaa-4b08-b08e-f9d320a0f39d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-84320c58-accd-4389-8574-e84ee1eb7d4e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-11e0568b-2b16-451e-b398-5fb54cc94edd","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-27b1c32c-40a0-43d4-bbdb-66a637c93b2c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"90f43d6e-b4cd-42d8-a2a1-938c40d6e764","root":false,"$title":"[MS.2.1.1] [INPUT] Valor simulacao","$position":{"top":"1458px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2379f037-b47b-4c61-b9b7-9ae97eb09f06":{"$contentActions":[{"action":{"$id":"ed85b502-ff0c-43d5-82e0-15c14dd48d9a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f49aaae2-87e9-4dbe-9fd3-e3d8f822c2f0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f49aaae2-87e9-4dbe-9fd3-e3d8f822c2f0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a423db42-4ac7-4679-808c-9e92b91f4d47","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"23eea70d-2bde-4953-9ecf-8d398dc29017","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"cc7f677d-b3d8-4702-9b09-d8b346c229c9","typeOfStateId":"state","$connId":"con_43","$id":"a540e61c-119d-4581-81e0-d2ccd946d454","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"7a7df971-29d4-42a3-a16f-deadfb39fb27","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesType) {\n    try {\n        let buttons = [\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"1\",\n                    \"title\": \"Crédito à vista\"\n                }\n            },\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"2\",\n                    \"title\": \"Crédito parcelado\"\n                }\n            }\n        ];\n        if (salesType === \"maquininha\") {\n            buttons = [\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"1\",\n                        \"title\": \"Débito à vista \"\n                    }\n                },\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"2\",\n                        \"title\": \"Crédito à vista\"\n                    }\n                },\n                {\n                    \"type\": \"reply\",\n                    \"reply\": {\n                        \"id\": \"3\",\n                        \"title\": \"Crédito parcelado\"\n                    }\n                }\n            ];\n        }\n\n        const headerText = \"Qual seria a forma de pagamento?\";\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"button\",\n                \"body\": {\n                    \"text\": headerText,\n                },\n                \"action\": {\n                    buttons\n                }\n            }\n        };\n    } catch (err) {\n        return false;\n    }\n}","inputVariables":["salesType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"466638f9-50be-454c-98a5-32ff70d87fb1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-64abf1b7-643b-44e0-9421-44ab6d44eae5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-26524f08-c03e-4301-b7d5-b0f38351008d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-339f979b-9623-4ce9-bd9b-e074e7728cee","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2379f037-b47b-4c61-b9b7-9ae97eb09f06","root":false,"$title":"[MS.2.1.2] [MSG] Tipo pagamento","$position":{"top":"1668px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fe58d380-8c87-45b9-ab44-64d5d37c1f51":{"$contentActions":[{"action":{"$id":"bf89849f-4fac-4e72-ad57-2cf54d9e1449","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5b9e2298-0f6c-49df-9404-20fdaa935223","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5b9e2298-0f6c-49df-9404-20fdaa935223","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f05f6bb7-26c4-4e8d-8d75-9cbe4fcf50ed","$typeOfContent":"text","type":"SendMessage","settings":{"id":"78721f34-9722-421b-8a1f-5f0f76d09c2e","type":"text/plain","content":"Agora, digite um valor entre R$1,00 e R$10.000,00 para fazer a simulação, como neste exemplo: 1.000,50.","metadata":{}},"$cardContent":{"document":{"id":"78721f34-9722-421b-8a1f-5f0f76d09c2e","type":"text/plain","content":"Agora, digite um valor entre R$1,00 e R$10.000,00 para fazer a simulação, como neste exemplo: 1.000,50."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a658b32f-2835-4b36-aa9d-ad3e817ae7ac","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"90f43d6e-b4cd-42d8-a2a1-938c40d6e764","typeOfStateId":"state","$connId":"con_48","$id":"415eafa1-240a-4b9b-8922-fe0eefe8735f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b93b86fe-471e-479e-8580-adc1c9bca4cf","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {{state.name}} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"9d2ab2f5-ccbc-479d-8842-e89a87616c1f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n        if (!inputUsuario) {\n            return 'inatividade'\n        }\n\n        let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi\n        let validInput = regex.test(inputUsuario)\n\n        if (validInput) {\n            let valor = inputUsuario.replace(/\\./g, '').replace(',', '.')\n            let valorFloat = parseFloat(valor)\n            if (valorFloat <= 10000 && valorFloat >= 1) {\n                return \"É um valor válido\"\n            }\n        }\n        return invalidInputMessage\n    } catch (err) {\n        return invalidInputMessage\n    }\n}","inputVariables":["input.content"],"outputVariable":"valorValido","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2bf0672f-852e-48c4-b3d5-7b4e048a5acd","$typeOfContent":"","type":"ExecuteScript","$title":"valorValido2","$invalid":false,"settings":{"function":"run","source":"\nfunction run(valor) {\n\t\n\tlet valor = valor.replace(',','.')\n\tvalor = parseFloat(valor)\n\tif(valor > 10000 || valor < 1){\n\t\treturn \"Não é um valor válido\"\n\t}else{\n\t\treturn \"É um valor válido\"\n\t}\n\t\n}","inputVariables":["valor"],"outputVariable":"valorValido","LocalTimeZoneEnabled":false},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"valorValido"}]},{"$id":"764e8e9a-21da-4f52-84e7-a4b5a9c1f388","$typeOfContent":"","type":"TrackEvent","$title":"Registro de eventos","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{valor}}"},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"valorValido"},{"comparison":"exists","source":"context","values":[],"variable":"valor"}]},{"$id":"8d5fea91-f519-45eb-9277-2e003aae0255","$typeOfContent":"","type":"TrackEvent","$title":"Registro de eventos","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["Não é um valor válido"],"source":"context","comparison":"equals","variable":"valorValido"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c36111bd-5fb7-40bb-8ed1-0879677872ad","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e3c447a2-3e59-40a4-93a8-574571fffbb1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b7b4921a-a80b-49cd-a30a-1dd2087f11c0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fe58d380-8c87-45b9-ab44-64d5d37c1f51","root":false,"$title":"[MS.2.1.1] [MSG] Valor simulacao","$position":{"top":"1263px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cc7f677d-b3d8-4702-9b09-d8b346c229c9":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"23eea70d-2bde-4953-9ecf-8d398dc29017","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51","typeOfStateId":"state","$connId":"con_53","$contentId":"4174bb36-4a73-40d5-aa00-89b0e8fb5f4d","$id":"b5fd29d2-c696-41f3-a77b-322021c2a891","conditions":[{"source":"context","comparison":"equals","values":["Débito à vista","Crédito à vista","Crédito parcelado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"6d74e7a6-7a16-4cfd-a518-2df8063f42e3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, salesType) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Crédito [àa] vista\": \"Crédito à vista\",\n      \"Crédito parcelado\": \"Crédito parcelado\"\n    }\n    if (salesType == \"maquininha\") {\n      regexDictionary = {\n        \"d[ée]bito [àa] vista\": \"Débito à vista\",\n        \"Crédito [àa] vista\": \"Crédito à vista\",\n        \"Crédito parcelado\": \"Crédito parcelado\"\n      }\n    }\n\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content","salesType"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4987bc1a-6b77-4b58-8c36-10f3b478d265","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"b53193f6-eae1-44e2-bf26-054f0d5f6513","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentType\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\tlet salesPaymentType = input.replace(`Débito à vista`, `debito`).replace(`Crédito à vista`, `creditoAVista`).replace(`Crédito parcelado`, `creditoParcelado`)\n\t\treturn salesPaymentType;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"salesPaymentType","LocalTimeZoneEnabled":false},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"797027ce-ae92-4bdc-8f97-e0753faa452e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0be50b5b-1a79-4f1c-ab87-3b7fdf3cac3c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f007e5f4-de4b-4d47-8476-88fabb4dd1a5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1c96ae39-7125-4983-940a-6eb0b3e622ae","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-88b68c35-e0d0-404c-b283-5d41989963e6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-86543702-ad29-4d88-85af-3c2ebf249945","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"cc7f677d-b3d8-4702-9b09-d8b346c229c9","root":false,"$title":"[MS.2.1.2] [INPUT] Tipo pagamento","$position":{"top":"1875px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e4fd4a08-5cdf-4d34-99d3-74f9f5a9e3c1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59d0589a-4bfe-427b-bcc3-37affdafab98","typeOfStateId":"state","$connId":"con_58","$id":"2fc6ef44-de2e-452b-926a-449aadab97db","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9dc698f7-0f96-48d0-9aad-f9a4bb16b021","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP POST \"bodySimulacao\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}","Safra-Bot-ID":"{{application.identifier}}"},"method":"POST","body":"{\n  \"valorVenda\": \"{{salesValue}}\",\n  \"tipoSimulacao\": \"{{salesOrder}}\",\n  \"modalidade\": \"{{salesType}}\",\n  \"tipoPagamento\": \"{{salesPaymentType}}\"\n}","uri":"{{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/{{selectedEc@codigoEc}}/vendas/simular","responseStatusVariable":"statusSimulacao","responseBodyVariable":"bodySimulacao"},"conditions":[]},{"$id":"225f7803-acb4-4143-a1ca-e64661f26a85","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusSimulacao"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"b19574bb-f2f6-4e43-be0b-5cf113d4556c","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"statusSimulacao"}]},{"$id":"47920e81-494d-4445-9550-023cb2b80dd4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{statusSimulacao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusSimulacao"}]},{"$id":"7e499b58-233b-4582-bc0f-34e25c89fba0","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \" {state.name} api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/{{ec}}/vendas/simular | POST | {{statusSimulacao}} | {{bodySimulacao}}"},"conditions":[]},{"$id":"cca73fd6-c775-4717-a152-ecde9779883c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\"","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"idSessao","identity":"{{contact.identity}}","valorVenda":"{{salesValue}}","tipoSimulacao":"{{salesOrder}}","modalidade":"{{salesType}}","tipoPagamento":"{{salesPaymentType}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/safrapay/vendas-servicos/vendas/planejamentos-vendas/assistente-virtual/v1/estabelecimentos/selectedEc@codigoEc/vendas/simular | {{statusSimulacao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ecc1a407-a4ea-445b-9367-a46345719cc5","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-f1934824-c6e5-491e-9f96-5825f8d095a3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c49732fd-0ae1-44aa-bfb5-10db5acfd2ea","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-1638e229-de80-49e4-8368-97e95597b571","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"3c0ed335-3e5a-486b-8ae6-e0f7e7899c51","root":false,"$title":"[MS.2.1.3] [HTTP] API Simular Vendas","$position":{"top":"2091px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59d0589a-4bfe-427b-bcc3-37affdafab98":{"$contentActions":[{"action":{"$id":"c810e386-4922-4496-9cf5-fb65ca671e9a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"86f79972-a169-4480-babb-4261f1b5a4f4","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b38e7f6a-5a97-4966-ba49-f9b7915d436e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"82f8e3d4-5db6-45e5-a221-5bf5526adc84","typeOfStateId":"state","$connId":"con_63","$id":"91858b4f-3baf-4f40-9b92-3f87eeccf56a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"43c3a7b6-6035-4c73-b26a-1dece10ecbee","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentType) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Master\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Visa\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Elo\"\n\t\t\t}\n\t\t]\n\t\tif (salesPaymentType != \"debito\") {\n\t\t\tdefaultMenuOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Master\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Visa\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Elo\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"4\",\n\t\t\t\t\t\"title\": \"Amex\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"5\",\n\t\t\t\t\t\"title\": \"Hiper\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Você pode selecionar uma bandeira?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["salesPaymentType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"21292a72-3479-42d5-b52c-23bc2f5ddf51","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-33db905b-3874-45b0-bec9-6e0606cb590b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2b16ac01-0785-4e6c-b5bd-3f4e137afe28","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6b701d31-44e1-481c-a07a-d4cf20af03d8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"59d0589a-4bfe-427b-bcc3-37affdafab98","root":false,"$title":"[MS.2.1.4] [MSG] Selecao Bandeira","$position":{"top":"2305px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"82f8e3d4-5db6-45e5-a221-5bf5526adc84":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"b38e7f6a-5a97-4966-ba49-f9b7915d436e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"9ea4726f-a4a6-48be-81b6-48d3fed6c373","typeOfStateId":"state","$connId":"con_68","$contentId":"0312166f-fe1d-43d2-908e-70cfcb0fbde7","$id":"7603f757-e8f3-48cb-b0fb-18a6be76bfef","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["creditoParcelado"],"source":"context","comparison":"equals","variable":"salesPaymentType"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false},{"stateId":"e326f39c-d055-4f2e-9f16-85fe9685f1bf","typeOfStateId":"state","$connId":"con_73","$id":"7f358945-ad3f-4dff-98a8-aa47e0cf6ed2","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d1b72f4d-1312-4445-a40b-8e7867f801d1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, salesPaymentType) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Master\": \"Master\",\n      \"Visa\": \"Visa\",\n      \"Elo\": \"Elo\"\n    }\n    if (salesPaymentType != \"debito\") {\n      regexDictionary = {\n        \"Master\": \"Master\",\n        \"Visa\": \"Visa\",\n        \"Elo\": \"Elo\",\n        \"Amex\": \"Amex\",\n        \"Hiper\": \"Hiper\"\n      }\n    }\n\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content","salesPaymentType"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b139b8a2-c927-4b35-b7fc-96ce5bf3cf61","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d3a2dc1d-5dc7-4276-bce4-16516d931126","$typeOfContent":"","type":"SetVariable","$title":"Set \"salesCardFlag\" with \"userInput\"","$invalid":false,"settings":{"value":"{{userInput}}","variable":"salesCardFlag"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"c9be838f-a14c-43f5-9848-81148e6fd0d0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{input.content}}"},"conditions":[{"values":["Master","Visa","Elo","Amex","Hiper"],"source":"input","comparison":"equals"}]},{"$id":"6a5bb02b-81cf-45a9-84b7-59b24c21eaa0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["Master","Visa","Elo","Amex","Hiper"],"source":"input","comparison":"notEquals"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8a65fd3d-45fd-4ec0-b7e0-862ca5dd24ae","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-92199fdb-f979-411b-b8f1-b096e21a4c70","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0217f1c7-f05d-4d4f-bb92-23e05f2f2665","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fd03ed82-308f-40e4-b3c8-91faeadd2e1a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"82f8e3d4-5db6-45e5-a221-5bf5526adc84","root":false,"$title":"[MS.2.1.4] [INPUT] Selecao Bandeira","$position":{"top":"2482px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e326f39c-d055-4f2e-9f16-85fe9685f1bf":{"$contentActions":[{"action":{"$id":"d042e3af-4a69-4123-b95c-437767a20806","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6ab58b7f-6395-4b8b-9e87-9b9de4be44fb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"6ab58b7f-6395-4b8b-9e87-9b9de4be44fb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"17fb4027-09dc-4ebc-819f-db705574644c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1dced7d9-ff9a-4b98-8451-b89cf31f6afd","type":"text/plain","content":"Simulei a sua venda, veja como ficou.\n\n<b>{{salesCardFlag}}</b>\n<b>{{salesPaymentTypeStringfy}}</b>\n{{salesSufixStringfy}} \n<b>Total de taxas:</b> R${{salesSimulation@valorTaxaTotal}}","metadata":{}},"$cardContent":{"document":{"id":"1dced7d9-ff9a-4b98-8451-b89cf31f6afd","type":"text/plain","content":"Simulei a sua venda, veja como ficou.\n\n<b>{{salesCardFlag}}</b>\n<b>{{salesPaymentTypeStringfy}}</b>\n{{salesSufixStringfy}} \n<b>Total de taxas:</b> R${{salesSimulation@valorTaxaTotal}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fc65a89f-eaba-4134-97eb-fc5f17c3a8c8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a3ad8d74-d54e-4b86-bf20-a14dddbaceaa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a3ad8d74-d54e-4b86-bf20-a14dddbaceaa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"10220579-5828-4af6-b848-200c0489dadc","$typeOfContent":"text","type":"SendMessage","settings":{"id":"736c2fc5-8d90-4a79-b54e-f693659000a0","type":"text/plain","content":"Se houver antecipação contratada será cobrada juntamente com as taxas de vendas.","metadata":{}},"$cardContent":{"document":{"id":"736c2fc5-8d90-4a79-b54e-f693659000a0","type":"text/plain","content":"Se houver antecipação contratada será cobrada juntamente com as taxas de vendas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6aca71a3-0115-4f8d-b282-3520108ce390","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","typeOfStateId":"state","$connId":"con_78","$id":"0446be5b-71cc-40ae-8599-b46bc6d89a5c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6add8cde-dd80-4194-ac00-970f1e1b58c3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"d5123ec5-117d-4570-8401-b754cfcea595","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentTypeStringfy){\n\tsalesPaymentTypeStringfy = salesPaymentTypeStringfy.replace(`debito`,`Débito à vista`).replace(`creditoAVista`, `Crédito à vista`).replace(`creditoParcelado`, `Crédito parcelado`)\n\treturn salesPaymentTypeStringfy; \n}","inputVariables":["salesPaymentType"],"outputVariable":"salesPaymentTypeStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a1efc857-fd50-44fc-960f-0b46409610bf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValueStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(valor) {\n  try {\n    const pontos = (valor.match(/\\./g) || []).length;\n    const virgulas = (valor.match(/\\,/g) || []).length;\n\n    if (pontos > 1 || virgulas > 1) {\n      valor = valor.replace(/\\./g, '').replace(',', '.');\n    } else if ((valor.split('.')[1] || []).length == 2 && pontos == 1) {\n      valor = valor.replace(',', '');\n    } else if ((valor.split(',')[1] || []).length == 2 && virgulas == 1) {\n      valor = valor.replace('.', '').replace(',', '.');\n    } else {\n      valor = valor.replace('.', '').replace(',', '.');\n    }\n\n    valor = parseFloat(valor);\n    let valorFormatado = valor.toFixed(2).replace('.', ',');\n    valorFormatado = valorFormatado.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1.');\n    return valorFormatado;\n  }\n  catch (e) {\n    return valor;\n  }\n};","inputVariables":["salesValue"],"outputVariable":"salesValueStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3b36deea-f469-4dd3-98be-ec3192d6727e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulation\"","$invalid":false,"settings":{"function":"run","source":"function run(bandeira, bodySimulacao,salesOrder) {\n\tlet bandeira = bandeira.toLowerCase();\n\tlet bodySimulacao = JSON.parse(bodySimulacao);\n\tconst formatValue = (valor) => {\n\t\treturn `${\n\t\t\tparseFloat(valor)\n\t\t\t\t.toFixed(2)\n\t\t\t\t.replace(\".\", \",\")\n\t\t\t\t.replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\")}`;\n\t}\n\tbodySimulacao = bodySimulacao.data[salesOrder].modalidades[0].bandeiras\n\tbodySimulacao = bodySimulacao.filter(bodySimulacao => (bodySimulacao.descricao == bandeira))\n\tbodySimulacao = bodySimulacao[0].simulacoes[0]\n\tbodySimulacao.valorFinal = formatValue(bodySimulacao.valorFinal)\n\tbodySimulacao.valorTaxaTotal = formatValue(bodySimulacao.valorTaxaTotal)\n\n\treturn JSON.stringify(bodySimulacao);\n}","inputVariables":["salesCardFlag","bodySimulacao","salesOrder"],"LocalTimeZoneEnabled":false,"outputVariable":"salesSimulation"},"conditions":[]},{"$id":"4595b17a-a56e-44db-9897-9cd6b8cb060d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSufixStringfy\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(salesOrder, salesSimulation, salesValueStringfy) {\n\ttry {\n\t\tsalesSimulation = JSON.parse(salesSimulation);\n\t\tif (salesOrder == \"receber\") {\n\t\t\treturn `<b>Recebendo:</b>\\n<b>Valor bruto:</b> R$${salesSimulation.valorFinal}\\n<b>Valor líquido:</b> R$${salesValueStringfy}`\n\t\t}\n\t\telse {\n\t\t\treturn `<b>Cobrando:</b> R$${salesValueStringfy}\\n<b>Você receberá:</b> R$${salesSimulation.valorFinal}`\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["salesOrder","salesSimulation","salesValueStringfy"],"outputVariable":"salesSufixStringfy","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"9816d527-c78c-49d7-96b0-8f92c1bb0d1f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} dados\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} dados","action":"{{salesValueStringfy}} | {{salesSimulation@valorFinal}}| {{salesSimulation@valorTaxaTotal}} | {{salesPaymentTypeStringfy}} | {{salesCardFlag}}"},"conditions":[]},{"$id":"4237de2c-7614-4207-9d1c-680d9b0e8ce1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\" to {salesOrder} - Simulador de Vendas","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{salesOrder}} - Simulador de Vendas"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8ddd1167-42ef-41ee-a87f-840420c3842b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-de08c189-be4b-444c-8761-da28a08139e8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c826336a-6434-46a1-bb9f-cffb579cec99","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e326f39c-d055-4f2e-9f16-85fe9685f1bf","root":false,"$title":"[MS.2.1.5] Cobrar / Receber (À Vista)","$position":{"top":"2617px","left":"2334px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9ea4726f-a4a6-48be-81b6-48d3fed6c373":{"$contentActions":[{"action":{"$id":"a22b2f21-b8c6-4a52-ab9c-638395cd32b9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7320621c-c487-43a2-ad97-616895b9066f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"1000"},"metadata":{}},"$cardContent":{"document":{"id":"7320621c-c487-43a2-ad97-616895b9066f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"1000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f53a5eca-bcb5-4c77-ac9f-5a631a90c079","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ef9c7209-878d-43b4-a1fc-6ba36f499a5d","type":"text/plain","content":"{{salesSimulationStringfy}}","metadata":{}},"$cardContent":{"document":{"id":"ef9c7209-878d-43b4-a1fc-6ba36f499a5d","type":"text/plain","content":"{{salesSimulationStringfy}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6fb4b261-cb31-4b06-80c0-4253881b1c86","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c9c24b4a-5136-469a-805c-8c64039a712a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c9c24b4a-5136-469a-805c-8c64039a712a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"66f67fe5-e930-47ce-b9e2-2a18f98f5114","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4a35a014-f234-498b-84bd-6514ed8d2856","type":"text/plain","content":"Se houver <b>antecipação contratada</b> será cobrada juntamente com as <b>taxas de vendas.</b>","metadata":{}},"$cardContent":{"document":{"id":"4a35a014-f234-498b-84bd-6514ed8d2856","type":"text/plain","content":"Se houver <b>antecipação contratada</b> será cobrada juntamente com as <b>taxas de vendas.</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7c5d7584-fbf9-42c7-82a8-5dee75920c0f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","typeOfStateId":"state","$connId":"con_83","$id":"f20f3b85-558b-4e67-89e2-4c42090b388f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"90351c88-2a18-47dc-9c31-dd69f99d4ce6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"0ce8dd0b-2d3f-47fc-b0e9-7495447ccbba","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(salesPaymentTypeStringfy){\n\tsalesPaymentTypeStringfy = salesPaymentTypeStringfy.replace(`debito`,`Débito à vista`).replace(`creditoAVista`, `Crédito à vista`).replace(`creditoParcelado`, `Crédito parcelado`)\n\treturn salesPaymentTypeStringfy; \n}","inputVariables":["salesPaymentType"],"outputVariable":"salesPaymentTypeStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7bf87283-4e09-4613-b57d-adfdd9be0c8a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesValueStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(valor) {\n  try {\n    const pontos = (valor.match(/\\./g) || []).length;\n    const virgulas = (valor.match(/\\,/g) || []).length;\n\n    if (pontos > 1 || virgulas > 1) {\n      valor = valor.replace(/\\./g, '').replace(',', '.');\n    } else if ((valor.split('.')[1] || []).length == 2 && pontos == 1) {\n      valor = valor.replace(',', '');\n    } else if ((valor.split(',')[1] || []).length == 2 && virgulas == 1) {\n      valor = valor.replace('.', '').replace(',', '.');\n    } else {\n      valor = valor.replace('.', '').replace(',', '.');\n    }\n\n    valor = parseFloat(valor);\n    let valorFormatado = valor.toFixed(2).replace('.', ',');\n    valorFormatado = valorFormatado.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1.');\n    return valorFormatado;\n  }\n  catch (e) {\n    return valor;\n  }\n};","inputVariables":["salesValue"],"outputVariable":"salesValueStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a9437768-2ee8-4e93-9fd3-ae8af297900d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulation\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(bandeira, bodySimulacao,salesOrder) {\n\tlet bandeira = bandeira.toLowerCase();\n\tlet bodySimulacao =  JSON.parse(bodySimulacao);\n\tbodySimulacao = bodySimulacao.data[salesOrder].modalidades[0].bandeiras\n\tbodySimulacao = bodySimulacao.filter(bodySimulacao => (bodySimulacao.descricao == bandeira))\n\tbodySimulacao = bodySimulacao[0]\n\treturn JSON.stringify(bodySimulacao); \n}","inputVariables":["salesCardFlag","bodySimulacao","salesOrder"],"outputVariable":"salesSimulation","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0406d0a3-f748-47b3-a5cb-f2c85c97f78d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSimulationStringfy\"","$invalid":false,"settings":{"function":"run","source":"function run(simulacao, salesCardFlag, salesOrder, salesValue) {\n  try {\n  let simulacao = JSON.parse(simulacao);\n  const formatValue = (valor) => {\n    return `${\n      parseFloat(valor)\n        .toFixed(2)\n        .replace(\".\", \",\")\n        .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\")}`;\n  }\n  let salesOrderTransaction = ''\n  if (salesOrder === 'receber') {\n    salesOrderTransaction = `<b>Recebendo</b>\\n<b>Valor bruto:</b> R$ ${formatValue(salesValue)}`\n  } else {\n    salesOrderTransaction = `<b>Cobrando:</b> R$${formatValue(salesValue)}`\n  }\n  let salesSimulation = simulacao.simulacoes.map((taxa, index ) => `<b>Parcelando em ${index + 2}x</b>\\nVocê receberá: R$ ${formatValue(taxa.valorFinal)}\\nTaxa de: ${taxa.percentualTaxaTotal}%`).join('\\n\\n')\n\n  return `Simulei as condições da sua venda, veja como ficou.\\n\\n<b>${salesCardFlag}</b>\\n<b>Crédito parcelado</b>\\n${salesOrderTransaction}\\n\\n${salesSimulation}`\n  } catch (err) {\n    return err.message\n  }\n}","inputVariables":["salesSimulation","salesCardFlag","salesOrder","salesValue"],"outputVariable":"salesSimulationStringfy","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"21c45ae1-8225-4764-92c4-d53f0a8f4705","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"salesSufixStringfy\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(salesOrder, salesSimulation, salesValueStringfy) {\n\ttry {\n\t\tsalesSimulation = JSON.parse(salesSimulation);\n\t\tif (salesOrder == \"receber\") {\n\t\t\treturn `<b>Recebendo:</b>\\n<b>Valor bruto:</b> R$${salesSimulation.valorFinal}\\n<b>Valor líquido:</b> R$${salesValueStringfy}`\n\t\t}\n\t\telse {\n\t\t\treturn `<b>Cobrando:</b> R$${salesValueStringfy}\\n<b>Você receberá:</b> R$${salesSimulation.valorFinal}`\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n}","inputVariables":["salesOrder","salesSimulation","salesValueStringfy"],"outputVariable":"salesSufixStringfy","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"6f6ee08b-5eb9-4fe7-86bc-d671a6e80f31","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} dados\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} dados","action":"{{salesValueStringfy}} | {{salesPaymentTypeStringfy}} | {{salesCardFlag}}"},"conditions":[]},{"$id":"21b80c91-dd54-4235-bdaa-4c0e93a49d51","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\" to {salesOrder} - Simulador de Vendas","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"Crédito Parcelado - {{salesOrder}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-aa420801-586d-46bd-98c8-d660e347c11c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-17331c27-3270-4c2d-abc5-5edb331fda47","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9af66ddd-e7e6-4e6d-90c1-3b49d02995e5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9ea4726f-a4a6-48be-81b6-48d3fed6c373","root":false,"$title":"[MS.2.1.6] Cobrar / Receber (Parcelado)","$position":{"top":"2611px","left":"3192px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3f1e37ee-597d-4dd0-a7e8-f146c51b710c":{"$contentActions":[{"action":{"$id":"c6fb139e-e73d-4bbc-86c0-9f28be4e02f9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"28a61939-dd75-4bc9-ac27-bdc90dfaa12a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"28a61939-dd75-4bc9-ac27-bdc90dfaa12a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"83a96f34-cb53-4110-a7aa-e25f85ad037a","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b0dcdca2-e1e0-4def-91c6-4227e78fd7b0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2","typeOfStateId":"state","$connId":"con_88","$id":"34fe817f-0df8-4ddb-ad6b-9d0c6773e217","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"278dfbdb-843d-4ee6-8e32-eaaa6b980bf8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"16dcdce7-f18f-4cff-9658-0aab61c38423","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesSimulation\"","$invalid":false,"settings":{"variable":"salesSimulation","expiration":1},"conditions":[]},{"$id":"51b01e5d-18ee-462d-ae8c-318b677d0a9d","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesValueStringfy\"","$invalid":false,"settings":{"variable":"salesValueStringfy","expiration":1},"conditions":[]},{"$id":"1d0f5dbb-42f8-4647-b2fc-bb0ee678b4e1","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesPaymentTypeStringfy\"","$invalid":false,"settings":{"variable":"salesPaymentTypeStringfy","expiration":1},"conditions":[]},{"$id":"c0224af3-56dc-47bd-b612-9775a7a6587f","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"salesSufixStringfy\"","$invalid":false,"settings":{"variable":"salesSufixStringfy","expiration":1},"conditions":[]},{"$id":"5d1f1192-462e-4cda-8b39-54df1fabf290","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Entender taxas\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outra simulação\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Consigo te ajudar em algo mais?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5ae4484c-8e8d-4691-ad42-eabbc1f907d8","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8b313236-d869-45d0-9745-6c76aadf5160","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2b2ead4f-11d8-46c1-b8c5-a8ac4a0d3d50","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d4680ba0-f2eb-41e3-8d23-bcf9e3b4e78e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3f1e37ee-597d-4dd0-a7e8-f146c51b710c","root":false,"$title":"[MS.2.2.0] [MSG] Menu simulação opções","$position":{"top":"2943px","left":"2756px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"05d66083-4b28-4d00-9132-1a7a5ac7bd7b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"29bd66a7-4ad7-49bb-94cd-e130dbbb90fe","typeOfStateId":"state","$connId":"con_93","$id":"cd83c5bd-0a7a-4fa9-bdbd-0bc60cd1f5b7","conditions":[{"source":"context","comparison":"equals","values":["Entender taxas"],"variable":"userInput"}],"$invalid":false},{"stateId":"a862dc90-c7cf-421d-bdab-9d09ebe9f70c","typeOfStateId":"state","$connId":"con_98","$id":"f147e717-f486-4887-bbad-fbfadd071a0d","conditions":[{"source":"context","comparison":"equals","values":["Outra simulação"],"variable":"userInput"}],"$invalid":false},{"stateId":"d5dc7576-7a47-4388-b7ee-115298ab5310","typeOfStateId":"state","$connId":"con_103","$id":"9b959394-ce4d-4113-b322-742076e9c116","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0731973d-fc4b-4b1f-9942-2dff4d91ccf5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1ba0f426-2760-4936-bfb4-40d19af622d4","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"24c3cc30-1f67-40f3-a43d-dcaa0015ab03","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"41e30686-f0c4-414e-bff3-2b21134849ff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2a11c40b-aa50-4cc6-a2c7-91f2f5a4624e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-36d21cf1-ce0d-4538-abe8-b27bf1240d03","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-5adb5653-8bbc-40ef-88cb-2a5be9437fd0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-88a9f661-5b4e-4851-9e92-3b711d15db38","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e4719b75-ed3e-4b32-bb4c-3e2d491a8cb2","root":false,"$title":"[MS.2.2.0] [INPUT] Menu simulação opções","$position":{"top":"3170px","left":"2756px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a862dc90-c7cf-421d-bdab-9d09ebe9f70c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"68cc914a-24f1-4052-be01-5cb85012d40a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c391e959-860e-4eaf-86b9-71fcd8888c86","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"a862dc90-c7cf-421d-bdab-9d09ebe9f70c","root":false,"$title":"[GO TO] MS.2.0.0 Simulação de vendas","$position":{"top":"3513.5px","left":"2876.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"85c901f2-e8b4-49ca-97d4-e1becccc4cb1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cede0f5a-5453-45c2-a4fd-e95e478bdd14","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c7eb5b06-ca45-4d7e-be53-b9e17da7fd6d","type":"Redirect","$title":"Redirect to {service} sending {state@lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b22d24f2-af5c-4025-8a71-5c72ae58c2de","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","root":false,"$title":"[Redirect] to cascata","$position":{"top":"418px","left":"676px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"820d335f-0c95-466f-9009-35cac24c6ea4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9d02b4f1-5b74-4162-a500-ddb632958cc4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5ae29a63-aedd-4cbe-805e-0d19566756f9","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"820d335f-0c95-466f-9009-35cac24c6ea4","root":false,"$title":"[Redirect] to Finalizacao (Welcome)","$position":{"top":"247.5px","left":"1998px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5724999e-4ebb-443e-8b1d-4c15ef40251e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"53ecccb3-e087-49da-8667-d20438985d9a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"8d3a9912-951d-4bfc-ac47-2a281fc57f02","$typeOfContent":"","type":"SetVariable","$title":"Set \"atendimento\" to \"humano\"","$invalid":false,"settings":{"variable":"atendimento","value":"humano"},"conditions":[]},{"$id":"b0e87449-cedc-4403-99b9-f0a312c926bd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Whatsapp PJ ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"atendente\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\t// stateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a70cb04f-0d4c-47b7-8093-5e2df5401351","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]}],"$leavingCustomActions":[{"$id":"899b0fcf-a95a-42db-ab36-2b708dd3f4c9","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"atendente"},"address":"WhatsApp PJ"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4f9184b3-eade-4a66-9b36-be17c5b4c364","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f198b9a5-b78b-46a3-ac49-68c638ba4edd","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9fe8dd87-68a7-4833-a626-5b6b9a51fda9","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"5724999e-4ebb-443e-8b1d-4c15ef40251e","root":false,"$title":"[Redirect] to WhatsApp PJ (atendente)","$position":{"top":"236px","left":"1018px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4f6e7e6d-21b4-4b11-9913-6aa5149a7469":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"562166b0-aef9-429b-9ea8-06a2f3a080f5","typeOfStateId":"state","$connId":"con_108","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fc5e1b09-cbde-410a-abd2-09f89a5d6b8a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Suporte\",\n        \"description\": \"Problemas na máquina\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Configurações\",\n        \"description\": \"Device lock, QR Code e outros\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Erros gerais\",\n        \"description\": \"Na máquina e na leitura do cartão\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Fica mais fácil te ajudar se a máquina estiver por perto. \n\nDo que você está precisando agora?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a6cd37c7-040b-4b19-a28c-e9f7313752f6","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"0e4d397e-8536-41a9-8b2d-30fbb16a6403","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"0239f4dc-4de2-469f-9330-cbea0ff02d80","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"1c396286-bdb4-484f-aaf6-eb09d00dd08f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"selecaoMenuAnterior\"","$invalid":false,"settings":{"function":"run","source":"function run(stateId, serviceName) {\n\ttry {\n\t\treturn {\n\t\t\tstateId,\n\t\t\tserviceName\n\t\t}\n\t} catch (er) {\n\t\treturn {\n\t\t\tstateId: 'welcome',\n\t\t\tserviceName: 'Bot Main'\n\t\t}\n\t}\n}","inputVariables":["state.id","config.serviceName"],"outputVariable":"selecaoMenuAnterior","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-44c4544a-f722-433e-af15-1fa8c1d8bb16","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-63cf3441-1f38-4185-b322-3ddfd41b4588","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3365e5af-d101-4e09-941e-950bf017fe50","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-fc222345-8b6b-4951-9c90-c013dbacb2f2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4f6e7e6d-21b4-4b11-9913-6aa5149a7469","root":false,"$title":"[MS.5.0.0][MSG] Menu Suporte e configurações","$position":{"top":"153px","left":"14555px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"562166b0-aef9-429b-9ea8-06a2f3a080f5":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"b838e923-9fa9-4c3b-a930-d5553fec5012","typeOfStateId":"state","$connId":"con_113","$id":"725bea47-375f-44b8-bc19-0ba3f9dbfb10","conditions":[{"source":"context","comparison":"equals","values":["Suporte"],"variable":"userInput"}],"$invalid":false},{"stateId":"faadc313-0a4d-4cd0-b4f1-95ff2c4027c8","typeOfStateId":"state","$connId":"con_118","$id":"bb4e725a-b76b-4189-b463-2332123f98df","conditions":[{"source":"context","comparison":"equals","values":["Configurações"],"variable":"userInput"}],"$invalid":false},{"stateId":"7eaa4922-911f-469d-be60-ea0ebb25000d","typeOfStateId":"state","$connId":"con_123","$id":"54638fa5-8e51-4732-b701-a7dfcc55fe35","conditions":[{"source":"context","comparison":"equals","values":["Erros gerais"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"72a59cf4-5008-497b-acdc-04e7364fa9d9","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-355d13b3-dd8e-4b7e-9baa-35991b85b494","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-23ccfee3-82bd-472f-bd95-c27b89cfcdc3","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-762defc1-01a3-47cc-b1e5-8cc965eec237","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-15d61b93-5591-430a-b90f-d24e3160dc9a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"562166b0-aef9-429b-9ea8-06a2f3a080f5","root":false,"$title":"[MS.5.0.0][INPUT] Menu suporte e configurações","$position":{"top":"454.545px","left":"14554.6px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b838e923-9fa9-4c3b-a930-d5553fec5012":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9ce2582d-a972-47a8-a0bd-fa4262629b1f","typeOfStateId":"state","$connId":"con_128","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e7b2a4aa-ed10-4f18-8031-ab497dc1f6bd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Ligar e desligar\",\n        \"description\": \"Máquina não liga, desligar máquina e máquina desliga após 5 minutos\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Problema na comunicação\",\n        \"description\": \"Máquina e bluetooth\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Voucher\",\n        \"description\": \"Cartões de benefícios VA, VR, Alelo e outros\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Status inválido\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Reinicialização\",\n        \"description\": \"Máquina reinicia sozinha\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"POS travando\"\n    },\n    {\n        \"id\": \"7\",\n        \"title\": \"Bateria\",\n        \"description\": \"Bateria fraca e problemas com carregador\"\n    },\n    {\n        \"id\": \"8\",\n        \"title\": \"Impressão\",\n        \"description\": \"Problemas com impressão\"\n    },\n    {\n        \"id\": \"9\",\n        \"title\": \"USB\",\n        \"description\": \"Aparece somente opção USB\"\n    },\n    {\n        \"id\": \"10\",\n        \"title\": \"Resetar máquina\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Vou precisar fazer algumas perguntas para  te ajudar. \n\nO que está acontecendo com a máquina?`\n                },\n                \"action\": {\n                    \"button\": \"Escolha uma opção\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"faaa7c75-3174-45c5-91b6-1a4f0aaf5b1d","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"d756db12-8349-45d1-a3b7-d480e98fa094","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"fdaa1dc0-54a2-4341-a20e-3e0d036d12b5","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bf98d879-1735-42e1-b320-f692a131b213","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4f773e1e-5763-49c6-92b1-8a7ff0742ac1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a625ef86-f906-4213-8b9e-914a2fc2ef61","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8754f349-cde5-46a9-86e3-b01ae15ed7a0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b838e923-9fa9-4c3b-a930-d5553fec5012","root":false,"$title":"[MS.6.0.0][MSG] Menu Suporte","$position":{"top":"467.111px","left":"6350.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9ce2582d-a972-47a8-a0bd-fa4262629b1f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"7e827dd9-98be-4599-9ae0-afb9a8706c7c","typeOfStateId":"state","$connId":"con_133","$id":"635ee7c1-ae50-4f9c-b074-f2c72e0b78d7","conditions":[{"source":"context","comparison":"equals","values":["Ligar e Desligar"],"variable":"userInput"}],"$invalid":false},{"stateId":"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d","typeOfStateId":"state","$connId":"con_138","$id":"93ab7144-7483-4fb0-998d-5eb7d798086e","conditions":[{"source":"context","comparison":"equals","values":["Problema na comunicação"],"variable":"userInput"}],"$invalid":false},{"stateId":"c5e1371d-0301-4936-92d3-91d24c5b4949","typeOfStateId":"state","$connId":"con_143","$id":"c434775e-bf35-46ff-a494-d1c807143b97","conditions":[{"source":"context","comparison":"equals","values":["Voucher"],"variable":"userInput"}],"$invalid":false},{"stateId":"d0272082-89c5-4257-8575-de30b862afc0","typeOfStateId":"state","$connId":"con_148","$id":"79389d68-d6b3-4dc4-9a19-73c3492dd0b2","conditions":[{"source":"context","comparison":"equals","values":["Status inválido"],"variable":"userInput"}],"$invalid":false},{"stateId":"fd47adc2-0b46-4ea2-961f-137b246b4253","typeOfStateId":"state","$connId":"con_153","$id":"fc658aeb-8b27-42b3-a18c-1653af946ac5","conditions":[{"source":"context","comparison":"equals","values":["Reinicialização"],"variable":"userInput"}],"$invalid":false},{"stateId":"75f868ee-f775-4d6e-8c7d-e8315edf0847","typeOfStateId":"state","$connId":"con_158","$id":"f57e186d-6f69-4a68-9d8a-6e6f1ff581c4","conditions":[{"source":"context","comparison":"equals","values":["POS travando"],"variable":"userInput"}],"$invalid":false},{"stateId":"7bdc580c-ecf9-4f6c-9aa3-b16158ab7219","typeOfStateId":"state","$connId":"con_163","$id":"91b8daa3-8011-4427-86bb-a3648127970e","conditions":[{"source":"context","comparison":"equals","values":["Bateria"],"variable":"userInput"}],"$invalid":false},{"stateId":"db72de2b-8f60-4bb2-8191-6957300d488e","typeOfStateId":"state","$connId":"con_168","$id":"3dea0338-c13e-4d3e-a3a3-c5ad2acb0c5e","conditions":[{"source":"context","comparison":"equals","values":["Impressão"],"variable":"userInput"}],"$invalid":false},{"stateId":"0dde7099-56bd-4590-abff-25c9a550991e","typeOfStateId":"state","$connId":"con_173","$id":"70be7e38-7878-44dd-b9e4-5d7206406b18","conditions":[{"source":"context","comparison":"equals","values":["USB"],"variable":"userInput"}],"$invalid":false},{"stateId":"6c943cf9-ee58-4067-a079-7bdd0c20b21c","typeOfStateId":"state","$connId":"con_178","$id":"a7eed7f2-8cb1-4e29-8878-d6976fb194e1","conditions":[{"source":"context","comparison":"equals","values":["Resetar máquina"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b0c0806a-9ed2-4dfd-92f5-5d1dfdf94662","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-46ce6873-8056-474e-91e7-a76581f83d0a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e2012daa-851f-4b72-903a-283979e99c7d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2dc5c25f-9c00-4241-8336-6fe8aeea2de0","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9ce2582d-a972-47a8-a0bd-fa4262629b1f","root":false,"$title":"[MS.6.0.0][INPUT] Menu Suporte","$position":{"top":"914.286px","left":"6350.19px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7e827dd9-98be-4599-9ae0-afb9a8706c7c":{"$contentActions":[{"action":{"$id":"af4c80a5-9d06-4408-925e-f4205937cd6f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d6044fe3-1f38-441d-907f-d05847e6c372","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d6044fe3-1f38-441d-907f-d05847e6c372","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7c0cbf8c-87f8-4ef5-8df1-8695424a3e21","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"42607226-b95d-4272-87c8-de6d1739d600","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"49a69242-08d5-4f49-a0c3-82481949f658","typeOfStateId":"state","$connId":"con_183","$id":"9428ac03-8934-49dd-b11e-49733e5144e9","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b7e828f3-a734-4a6a-b58d-538f493ae255","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Máquina não liga\",\n\t\t\t\t// \"description\": \"Minha máquina não liga\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Desligar máquina\",\n\t\t\t\t// \"description\": \"Como desligar a minha máquina\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Máquina desligando\",\n\t\t\t\t// \"description\": \"Equipamento desliga após 5 minutos\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual seria o motivo?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"db8163c4-1eff-45bf-aee1-4a377af2ff53","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3e0ce802-fe81-4cb0-8fe5-80d7f851cc40","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ee67e4f8-7476-4294-ae31-126b9ee999c3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0030858d-8548-4a99-b47b-26eac1960719","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7e827dd9-98be-4599-9ae0-afb9a8706c7c","root":false,"$title":"[MS.6.1.0][MSG] Menu Ligar e Desligar","$position":{"top":"1586px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"49a69242-08d5-4f49-a0c3-82481949f658":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"f86e1afc-51a9-44f3-a8a3-1bddc6647f30","typeOfStateId":"state","$connId":"con_188","$id":"be868053-e743-4582-b657-d7940c844003","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8190e317-050b-4e37-a6c0-1de03937327a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e5149347-d6b4-4f52-b262-77157eb4c50d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-1c786f40-2958-479e-9462-cc5510d4d192","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d05bcc72-ed41-4b3c-870c-bc816b5a7041","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"49a69242-08d5-4f49-a0c3-82481949f658","root":false,"$title":"[MS.6.1.0][INPUT] Menu Ligar e Desligar","$position":{"top":"1811.89px","left":"4682.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f86e1afc-51a9-44f3-a8a3-1bddc6647f30":{"$contentActions":[{"action":{"$id":"bc92a6ee-f22e-459a-b941-6e502d908393","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9088abfd-d7b5-41c6-9981-67c01ea86098","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c6a3a29-8422-4158-86c8-8d943bc427ab","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"49cf6fea-9926-4648-b45c-87b81b34b9eb","typeOfStateId":"state","$connId":"con_193","$id":"b2983e28-557a-4da9-9405-6789f732c757","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"eb9be5e2-0498-416f-b38f-c8e85945d1fb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n\ttry {\n\t\tif (userInput === 'Máquina não liga') {\n\t\t\treturn montaList([\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"POS fixo\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Move 5000/PAX S920\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t])\n\t\t}\n\t\tif (userInput === 'Desligar máquina') {\n\t\t\treturn montaList([\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Move 5000/PAX S920\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Link 2500\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t])\n\t\t}\n\t\tif (userInput === 'Máquina desligando') {\n\t\t\treturn montaQuickReply([\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\t\"reply\": {\n\t\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\t\"title\": \"Link 2500\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\t\"reply\": {\n\t\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t])\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}\n\nfunction montaList(botoes) {\n\treturn {\n\t\t\"recipient_type\": \"individual\",\n\t\t\"type\": \"interactive\",\n\t\t\"interactive\": {\n\t\t\t\"type\": \"list\",\n\t\t\t\"header\": {\n\t\t\t\t\"type\": \"text\",\n\t\t\t\t\"text\": \"\"\n\t\t\t},\n\t\t\t\"body\": {\n\t\t\t\t\"text\": `Entendi, e qual é o modelo da sua máquina?`\n\t\t\t},\n\t\t\t\"action\": {\n\t\t\t\t\"button\": \"Selecionar modelo\",\n\t\t\t\t\"sections\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\"rows\": botoes\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction montaQuickReply(buttons) {\n\treturn {\n\t\t\"recipient_type\": \"individual\",\n\t\t\"type\": \"interactive\",\n\t\t\"interactive\": {\n\t\t\t\"type\": \"button\",\n\t\t\t\"body\": {\n\t\t\t\t\"text\": 'Entendi, e qual é o modelo da sua máquina?',\n\t\t\t},\n\t\t\t\"action\": {\n\t\t\t\tbuttons\n\t\t\t}\n\t\t}\n\t}\n}","inputVariables":["userInput"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5107b5ac-79af-45c9-b6e0-2d649e38da64","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-aaa0ac30-6d35-4b04-82bc-c1de67017c78","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a1096994-159f-4695-843f-8186658354e2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-71d958d5-80cd-4087-b2ad-124a0af7227f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f86e1afc-51a9-44f3-a8a3-1bddc6647f30","root":false,"$title":"[MS.6.1.1][MSG] Menu selecionar modelo da maquina","$position":{"top":"2101px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"49cf6fea-9926-4648-b45c-87b81b34b9eb":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"1337352b-12ff-49c0-9fe2-10883e6e0862","typeOfStateId":"state","$connId":"con_198","$id":"5c7277eb-2b63-459a-8ddd-b5e03eed61e2","conditions":[{"source":"context","comparison":"equals","values":["Máquina desligando","Desligar máquina"],"variable":"subAssunto"},{"values":["Outro modelo"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"6fcc7b4d-2226-4a2c-bdef-5b5e7eadc1f5","typeOfStateId":"state","$connId":"con_203","$id":"5dd47c8a-f654-465b-90d5-e0d6b2ac415e","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b7c290ab-77b1-4d96-b20c-333855b14cc5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-81f31633-8de0-4942-817d-0716238430b5","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-39c2a0a6-b193-4322-bd8b-c2f2fa14cd10","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7a22179f-5c2a-4f86-a8b0-7c9587f5362a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"49cf6fea-9926-4648-b45c-87b81b34b9eb","root":false,"$title":"[MS.6.1.1][INPUT] Menu selecionar modelo da maquina","$position":{"top":"2391px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6fcc7b4d-2226-4a2c-bdef-5b5e7eadc1f5":{"$contentActions":[{"action":{"$id":"cb31f40e-1f2a-45c4-b40c-a56473bd3b94","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a1431d2b-2ffb-4466-b650-2b993d0e36ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a1431d2b-2ffb-4466-b650-2b993d0e36ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"04b2ee48-8146-4c01-9e20-127ebda718a5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bed43ab0-b680-4960-ae29-0243163a2eaa","type":"text/plain","content":"{{equipamentoNaoLigaMsg}}","metadata":{}},"$cardContent":{"document":{"id":"bed43ab0-b680-4960-ae29-0243163a2eaa","type":"text/plain","content":"{{equipamentoNaoLigaMsg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b9efb61f-42a1-48ec-ad5e-117e25544a00","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_208","$id":"49a6d53c-1fa0-4d07-906a-d9d030a4154f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c6b457e5-57ab-4187-8169-d9e3fff56b38","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"equipamentoNaoLigaMsg\"","$invalid":false,"settings":{"function":"run","source":"const messages = {\n\t'Máquina desligando': {\n\t\t'link 2500': `É possível aumentar o tempo para até 3 horas.\n\nPara isso, faça o seguinte:\n\n1° Na sua máquina, selecione F1.\n\n2° Escolha a opção menu.\n\n3° Vá em configurações.\n\n4° Selecione auto desligamento.\n\n5° Para aumentar ou diminuir o tempo utilize os botões F1 e F2.\n`,\n\t\t'outra': ''\n\t},\n\t'Desligar máquina': {\n\t\t'move 5000/pax s920': `Vou te pedir para fazer o seguinte:\n\n1° Pressione o botão \"ponto\"    ( . ) e o botão amarelo ao    mesmo tempo.\n\n2° Certifique-se de que o equipamento não esteja conectado ao carregador.\n\n*Atenção*\nNo modelo *S920*, utilize o botão vermelho para ligar e desligar.\n `,\n\t\t'link 2500': `Para desligar a máquina, pressione simultaneamente o botão \"ponto\" ( . ) e o botão amarelo.\n\n*Importante*\nO equipamento não deve estar conectado ao carregador.\n`,\n\t\t'outra': ''\n\t},\n\t'Máquina não liga': {\n\t\t'pos fixo': `Vou te pedir para fazer o seguinte:\n \n1° Verifique se o terminal está conectado à rede de energia.\n\n2° Certifique-se de que a fonte de alimentação está devidamente conectada.\n\n3° Para ligar o equipamento, basta conectá-lo na tomada.\n`,\n\t\t'move 5000/pax s920': `Vou te pedir para fazer o seguinte:\n\nDesconecte a bateria e conecte-a novamente.\n`,\n\t\t'outro modelo': `Vou te pedir para fazer o seguinte:\n\n1° Verifique se o carregador está conectado na tomada.\n\n2° Verifique se a tomada está funcionando.\n\n3° Verifique se o cabo do carregador está conectado ao equipamento.\n\n4° Verifique se o carregador utilizado é original da máquina Safrapay.\n\n5° Abra a tampa traseira, desconecte o plug da bateria e aguarde 30 segundos.\n\n6° Reconecte a bateria e conecte o equipamento ao carregador. Agora, tente ligar a máquina novamente.\n`\n\t}\n}\nfunction run(userInput, subAssunto) {\n\ttry {\n\t\treturn messages[subAssunto][userInput.toLowerCase()] || false\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput","subAssunto"],"outputVariable":"equipamentoNaoLigaMsg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e4e40fba-4973-47a1-9c15-8d03a01e31ff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-47c28694-9258-4d76-bf75-1cf5adbd6ac6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1c3e2ce8-f89f-497e-8d73-ec6dda8f2b56","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-63e15bab-a44c-407e-ab78-9fb207643c17","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6fcc7b4d-2226-4a2c-bdef-5b5e7eadc1f5","root":false,"$title":"[MS.6.1.2][MSG] Ligar e Desligar","$position":{"top":"2671px","left":"4683px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b03d52e3-aeda-4505-8186-ca025fd17395":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1157b193-e683-4e3f-9870-67f7f645d0a0","typeOfStateId":"state","$connId":"con_213","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Deu certo?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ce58760b-6802-443d-b8f7-95b3d94b94bb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-eac40bcb-1211-44c3-91f9-bace40114869","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-33f0ec9f-a51e-4f2a-b3f3-9497817d1342","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b33e5522-f3af-4eeb-9b39-36b99f7af195","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b03d52e3-aeda-4505-8186-ca025fd17395","root":false,"$title":"[MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"3117px","left":"5659px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1157b193-e683-4e3f-9870-67f7f645d0a0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"082428ef-bfa6-4828-9e9f-d64787844ea5","typeOfStateId":"state","$connId":"con_218","$id":"a260e0ba-0f00-4478-8e69-a82737cc2401","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"732efa55-d798-4f04-acb5-c306c0ebd203","typeOfStateId":"state","$connId":"con_223","$id":"539c890e-318d-41ba-b073-719ab90c6829","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e14ec5e0-5ba5-42df-b545-a5fea98816b1","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"17fe3ccf-b0b7-4cad-8bf5-ea77a2339ae2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"d8643fde-7bce-426e-a060-5d5034608dc4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c1be8bbe-b351-4bb3-ba1d-7acdac9aa94d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d316dada-419f-42a8-9f91-ba90792011d0","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-dab54083-4a17-4e8c-8cee-0c0ca8586602","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bdb63f34-1b0b-481a-b5f2-1212e95a9732","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1157b193-e683-4e3f-9870-67f7f645d0a0","root":false,"$title":"[MS.X.X.X][INPUT] Problema resolvido?","$position":{"top":"3406px","left":"5659px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d":{"$contentActions":[{"action":{"$id":"984ceb37-0e70-4d4f-8d21-ef457eb23a04","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"90748cdc-85f8-43e3-852e-d3ef01deb7b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"90748cdc-85f8-43e3-852e-d3ef01deb7b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"517dea2b-d0f8-4e18-afcd-0cf2e1bcb28f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4e16299b-40de-4b84-949d-bf717958dc4d","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local onde ele é inserido com um pano seco.\n\n4° Recoloque o chip no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação.","metadata":{}},"$cardContent":{"document":{"id":"4e16299b-40de-4b84-949d-bf717958dc4d","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local onde ele é inserido com um pano seco.\n\n4° Recoloque o chip no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5cc512f3-db31-40d3-9c06-ed4580f1eb5f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7825a4d1-a414-469b-9281-dc8f123bb7f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7825a4d1-a414-469b-9281-dc8f123bb7f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e7697dae-3714-43ee-b2b6-f1198a24736b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"dfff3c3c-7040-4e22-94e9-3a09317d1493","type":"text/plain","content":"A atualização foi realizada com sucesso?\n\n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste.","metadata":{}},"$cardContent":{"document":{"id":"dfff3c3c-7040-4e22-94e9-3a09317d1493","type":"text/plain","content":"A atualização foi realizada com sucesso?\n\n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"113933fc-84e1-43bf-b9be-c9df9c557da2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_228","$id":"a156d148-deeb-489a-be17-334a809a6308","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"71a6820d-6c6e-474c-a725-5ac6c020ad16","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-944e5f03-422e-4db9-b5d4-6a9990389f50","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2a3917ae-4193-425c-bce9-8b65f0ee2819","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d","root":false,"$title":"[MS.6.2.0][MSG] Problema/comunicação","$position":{"top":"1872.86px","left":"5547.49px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c5e1371d-0301-4936-92d3-91d24c5b4949":{"$contentActions":[{"action":{"$id":"f539c883-ed39-497a-9d9e-697165b819c7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0737a25c-d934-4c1f-bdba-0b54a188772c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0737a25c-d934-4c1f-bdba-0b54a188772c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b4b32043-81e7-4664-8930-3055d9fa4ac6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e9e4d083-711d-4ca4-aca2-1a9c5ccede01","type":"text/plain","content":"Você já solicitou a habilitação do voucher com a administradora?\n\n<b>Se sim:</b>\n- Realize o atalho 995\n- Realize o atalho 993\n- Realize uma transação de teste.\n\n<b>Se não:</b>\nVocê deve habilitar o voucher com a administradora.","metadata":{}},"$cardContent":{"document":{"id":"e9e4d083-711d-4ca4-aca2-1a9c5ccede01","type":"text/plain","content":"Você já solicitou a habilitação do voucher com a administradora?\n\n<b>Se sim:</b>\n- Realize o atalho 995\n- Realize o atalho 993\n- Realize uma transação de teste.\n\n<b>Se não:</b>\nVocê deve habilitar o voucher com a administradora."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d181641a-16b3-491e-90f5-aaa814dbc476","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"31b9294d-9c88-4389-9ba7-abcbd425bd9a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"31b9294d-9c88-4389-9ba7-abcbd425bd9a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"68a90e7a-2b1c-421f-8cee-822a0dfb3a63","$typeOfContent":"text","type":"SendMessage","settings":{"id":"6a1edb5c-1c54-4518-8b8a-93d616cf6774","type":"text/plain","content":"É importante lembrar que apenas estabelecimentos cadastrados como bares e restaurantes podem receber pagamentos com voucher (VA/VR).","metadata":{}},"$cardContent":{"document":{"id":"6a1edb5c-1c54-4518-8b8a-93d616cf6774","type":"text/plain","content":"É importante lembrar que apenas estabelecimentos cadastrados como bares e restaurantes podem receber pagamentos com voucher (VA/VR)."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e35a82c1-9753-4ac2-9b27-39f6132e45da","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_233","$id":"8119f298-791c-4606-a9b3-1fb6a4f3b620","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"54f020bd-48a4-44ff-a7e9-198be6350498","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-35e8919b-3bd3-4738-99ee-21f32a9e05ff","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6dc46cf7-10c0-48be-b9a5-c5d8f5e7d98a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c5e1371d-0301-4936-92d3-91d24c5b4949","root":false,"$title":"[MS.6.3.0][MSG] Voucher","$position":{"top":"1875px","left":"5767px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d0272082-89c5-4257-8575-de30b862afc0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"314449b7-de1a-42cf-97bb-47babd3358bd","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6b9ecbae-d364-4510-9ec2-ff8f3a573cef","typeOfStateId":"state","$connId":"con_238","$id":"196fad90-e34b-4c79-b1cf-b817c5bb0f18","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"selectedEc"}],"$invalid":false},{"stateId":"1e2b8273-089f-41ba-a883-0bfd3497a275","typeOfStateId":"state","$connId":"con_243","$id":"2d80cf59-b28d-4b94-a93a-0f672ddbcd01","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"d0272082-89c5-4257-8575-de30b862afc0","root":false,"$title":"[MS.6.4.0][SET] Status inválido verifica EC","$position":{"top":"1478px","left":"6378.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6b9ecbae-d364-4510-9ec2-ff8f3a573cef":{"$contentActions":[{"action":{"$id":"421bc1c3-716a-410e-adfb-30fb4527c926","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e8bcbddf-29a4-44d8-90e6-28af62bafce2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e8bcbddf-29a4-44d8-90e6-28af62bafce2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4b5c414e-5ee0-44bf-bbb5-df5e2b6455af","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d5db6858-c5d5-42b5-8695-e4ab731e7fde","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Pressione o botão <b>ativar.</b>\n\nAtivou?\n\n- Se sim: Finalize.\n\n- Se não: Pode ser uma falha na configuração.Conecte-se ao Wi-Fi.","metadata":{}},"$cardContent":{"document":{"id":"d5db6858-c5d5-42b5-8695-e4ab731e7fde","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Pressione o botão <b>ativar.</b>\n\nAtivou?\n\n- Se sim: Finalize.\n\n- Se não: Pode ser uma falha na configuração.Conecte-se ao Wi-Fi."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f8b23ce0-222f-427a-b9b1-f652209c8cb1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"2e1c83af-a9f1-4623-9d3c-3b905a6bfd14","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"A ativação foi concluída? 🤔\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"da55f580-d609-4118-99e9-015db713de5f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b98fd764-83da-4468-b4c2-60688462f315","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5b072dcd-e8b8-4bd6-9f65-bd49970260b3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e68a8e9a-fb2e-4e0b-83fe-6e59a7da20d1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6b9ecbae-d364-4510-9ec2-ff8f3a573cef","root":false,"$title":"[MS.6.4.0][MSG] Status inválido","$position":{"top":"2022.83px","left":"6350.29px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b379a73a-4f4e-4600-83d9-ecd011d48b68":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9f5e92f9-b17f-43c5-b1c6-d2f07698442c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"68a1f11d-7db3-4163-aee5-05d12419d448","typeOfStateId":"state","$connId":"con_248","$id":"11ff8786-e2aa-4d34-9b9b-b4b9ca07fdfd","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"1e2b8273-089f-41ba-a883-0bfd3497a275","typeOfStateId":"state","$connId":"con_253","$id":"262534ed-7e9a-4f2b-853a-ba34eb043106","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bb0e2c3c-2c27-411b-bb00-4b8d8b11700a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fc88824f-f212-44b2-8036-ca0e6b81a69a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"4be0c16f-b58e-483b-b371-9916b7a009ca","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-78668c24-385a-4e2b-9484-ebc7f21c748f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-456c89dc-f922-48e7-a67a-6bb528213407","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-02186c01-5ac2-494f-ab9e-41d8fa0b7bd2","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b379a73a-4f4e-4600-83d9-ecd011d48b68","root":false,"$title":"[MS.6.4.0][INPUT] Status inválido","$position":{"top":"2324px","left":"6350px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fd47adc2-0b46-4ea2-961f-137b246b4253":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7e8ae03d-9db1-496a-88c0-aa68720b4846","typeOfStateId":"state","$connId":"con_258","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e867fd85-0ad6-4b1e-99df-71994eb60c45","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Tela reiniciando\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Equipamento reiniciando\",\n\t\t\t\t\"description\": \"Máquina reiniciando sozinha\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual seria o motivo?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Selecionar Motivo\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc5bb2de-59ca-47de-8be3-b3a63750d57a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-89ab2abb-26d9-42ce-89e4-458b82cfc474","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fc345d87-8ba2-4069-afae-b9eae16c75f5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3698df57-15e8-413a-a561-364e343769aa","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fd47adc2-0b46-4ea2-961f-137b246b4253","root":false,"$title":"[MS.6.5.0][MSG] Menu Reinicialização","$position":{"top":"1426.62px","left":"7182.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7e8ae03d-9db1-496a-88c0-aa68720b4846":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"969f7264-dae7-49da-807b-c00e3554908e","typeOfStateId":"state","$connId":"con_263","$id":"6ba3c0e8-045c-49ba-bc3e-ffe0e150d3e4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8b77ccd8-d903-4cc7-bda7-e2f0a931dac2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a076b2f9-0752-422f-a1be-b162b977eb1f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2a40a6ed-0b3c-4162-b289-cd97504dd351","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3667be64-a6d5-4f96-9bc1-37b3b645b4de","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7e8ae03d-9db1-496a-88c0-aa68720b4846","root":false,"$title":"[MS.6.5.0][INPUT] Equipamento reiniciando","$position":{"top":"1787.35px","left":"7182.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d3b5eb14-26fb-40a2-bdc7-b569e0ab13e7":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"1e2b8273-089f-41ba-a883-0bfd3497a275","typeOfStateId":"state","$connId":"con_268","$id":"a60da9d2-9a23-4941-a0b9-8f997f73ce47","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"4a5dc19c-766d-462a-95b6-60b15658e933","typeOfStateId":"state","$connId":"con_273","$id":"cd8f6373-2d4b-4ba0-8ea8-4cbccda667aa","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":[],"source":"input","comparison":"exists"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3a2c8c5c-0708-47ab-9c69-c4a341966c35","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-84a4c218-10eb-42eb-975e-3b49ba27e908","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-4e8b7892-c61e-4351-b30a-2fe0e6778ba4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1641a22c-55f5-46b3-aa1e-db4afcb1a671","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"d3b5eb14-26fb-40a2-bdc7-b569e0ab13e7","root":false,"$title":"[MS.6.5.1][INPUT] Menu selecionar modelo da maquina","$position":{"top":"2300.35px","left":"7181.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"969f7264-dae7-49da-807b-c00e3554908e":{"$contentActions":[{"action":{"$id":"bc92a6ee-f22e-459a-b941-6e502d908393","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"afccf1ac-4727-48cb-a24d-1c62737c428d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9088abfd-d7b5-41c6-9981-67c01ea86098","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c6a3a29-8422-4158-86c8-8d943bc427ab","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d3b5eb14-26fb-40a2-bdc7-b569e0ab13e7","typeOfStateId":"state","$connId":"con_278","$id":"b2983e28-557a-4da9-9405-6789f732c757","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"eb9be5e2-0498-416f-b38f-c8e85945d1fb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n\ttry {\n\t\tlet defaultMenuOptions = []\n\t\tif (userInput === 'Tela reiniciando') {\n\t\t\tdefaultMenuOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\tif (userInput === 'Equipamento reiniciando') {\n\t\t\tdefaultMenuOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Move\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": 'Entendi, e qual é o modelo da sua máquina?'\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Modelo\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["userInput"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7109e9-6b91-4e3f-8971-587c48cf6635","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cb8addce-1c1f-4e1e-b477-5c58ed91ee98","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c4c5b0ab-7150-457e-9274-3a74d10f82a6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f2adb698-a9f2-4f7d-bdd4-5740f44dec32","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"969f7264-dae7-49da-807b-c00e3554908e","root":false,"$title":"[MS.6.5.1][MSG] Menu selecionar modelo da maquina","$position":{"top":"2017px","left":"7183px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1e2b8273-089f-41ba-a883-0bfd3497a275":{"$contentActions":[{"action":{"$id":"6eb6ce31-2ac3-498f-8b2e-3e83c0ff2927","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"91e6dede-5cfd-4ab8-aa1d-de2c1b08a15a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"91e6dede-5cfd-4ab8-aa1d-de2c1b08a15a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6fd925d4-638c-4ba8-88ba-aeaef0469751","$typeOfContent":"text","type":"SendMessage","settings":{"id":"918b781f-209c-4e7f-ac86-d7ad69951ff5","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"918b781f-209c-4e7f-ac86-d7ad69951ff5","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f5fe563f-cc04-46b0-bfec-1ee436c8f912","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-668e8d22-f7cd-4d09-b324-121368939e5f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"1e2b8273-089f-41ba-a883-0bfd3497a275","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"2323.32px","left":"6764px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4a5dc19c-766d-462a-95b6-60b15658e933":{"$contentActions":[{"action":{"$id":"642b083e-914e-4603-b77f-5653c3abcea5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"42739401-1c49-4ea3-8d40-d310b13fae21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"42739401-1c49-4ea3-8d40-d310b13fae21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f11d16dc-201a-4769-b533-6620f2f1b030","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d7e9e2d5-0aa8-470b-b856-343e1c5efa55","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"d7e9e2d5-0aa8-470b-b856-343e1c5efa55","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ade84457-3f0c-4e5e-884e-b8c2c9bc1d7b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_283","$id":"73cbb258-28ea-43a1-9ff2-41b63d15579c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5f7bd682-ed76-41e5-9f97-f7bbf4b799b0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\t// Caso a mesma maquina possua mais de 1 assunto, ex: Smart tanto para Equipamento Reiniciando e Tela Reiniciando utilizar a variavel subAssunto ficando \"if(userInput === 'smart' && subAssunto === 'Equipamento Reiniciando')...\"\n\t\tif (userInput === 'Smart') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\t\t\t\n1° Mantenha o botão liga/desliga pressionado por 3 segundos.\n\n2° Se o modo avião estiver ativo: Desative-o e reinicie o equipamento. Ele voltará a funcionar normalmente.\n`\n\t\t}\n\t\tif (userInput === 'Move') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\nDesconecte a bateria e conecte-a novamente.`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e46d75f8-8961-4665-b746-fae319202d31","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-51821d45-d16e-4b51-9eae-842bb97b37ae","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6238694f-fe96-4c6d-aabf-60413efbd4e4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d6d2794d-1f3a-4196-907f-b1a319bb329e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4a5dc19c-766d-462a-95b6-60b15658e933","root":false,"$title":"[MS.6.5.2][MSG] Reinicialização","$position":{"top":"2564.35px","left":"7181.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"75f868ee-f775-4d6e-8c7d-e8315edf0847":{"$contentActions":[{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"fa4bbae8-f7ba-4b05-8c84-bd703cdd6b27","typeOfStateId":"state","$connId":"con_288","$id":"e596a57a-26f7-4ae3-8209-7b70be3018d2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, o equipamento travou no meio de um processamento?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f9499076-a2d7-4a23-b78e-827999b6fef8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e4e01220-fa08-4eee-84bb-0cefb4811aec","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-98b24966-ca3e-44d9-b5b3-104fa65faeab","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-68241139-d0c9-4198-a545-1b2f719bcc2d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"75f868ee-f775-4d6e-8c7d-e8315edf0847","root":false,"$title":"[MS.6.6.0][MSG] POS travando","$position":{"top":"1367.55px","left":"7767.55px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fa4bbae8-f7ba-4b05-8c84-bd703cdd6b27":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"80842650-23df-4c88-b522-b3939ada67f4","typeOfStateId":"state","$connId":"con_293","$id":"87c6a4ad-3728-43c7-b981-fd3ad739bfbf","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d902dccd-9099-4c62-be74-7c835666d286","typeOfStateId":"state","$connId":"con_298","$id":"0d34cb8b-7a03-4514-a239-b586acce4adf","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"88f67449-b4c5-4b9a-963f-4c28bfea088c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"b79bf45b-4e09-4879-8e31-ccace8f31895","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bd809992-3325-4e89-8085-fba2306fcf09","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fd123f1b-f73f-4aa5-b47c-b6346c2cdbdd","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-21786ba3-331f-486f-8fd0-bf551ecf7f9c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"fa4bbae8-f7ba-4b05-8c84-bd703cdd6b27","root":false,"$title":"[MS.6.6.0][INPUT] POS travando","$position":{"top":"1555.73px","left":"7768px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d902dccd-9099-4c62-be74-7c835666d286":{"$contentActions":[{"action":{"$id":"c7edad80-a823-4cbe-abd7-bc2ef0651949","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"30c19dae-3ccc-47c4-ad87-9e0963682ef8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o aparelho.","metadata":{}},"$cardContent":{"document":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o aparelho."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7053fa56-6018-4d7c-bf7d-23461b32f7b9","typeOfStateId":"state","$connId":"con_303","$id":"f89903d4-d4d7-4e7c-9c58-723cd29d1ce3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e8646b62-a627-4ce1-81d3-268c38bb0939","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d5f5e25a-d1ea-40c0-a14d-496e3d107b93","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-33536cae-1e27-4d8d-bd49-6974187c63c0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-571cac64-b307-452e-8843-f6329f2a80f1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d902dccd-9099-4c62-be74-7c835666d286","root":false,"$title":"[MS.6.6.1][MSG] POS travando 2 instrução","$position":{"top":"2016px","left":"7674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7053fa56-6018-4d7c-bf7d-23461b32f7b9":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"76d93ebd-881e-4682-9989-0a698b111dcf","typeOfStateId":"state","$connId":"con_308","$id":"7f9f1ac7-0937-4b9f-ab6f-a9727787ea69","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"86806f3d-1dca-4a75-992a-358932a774b8","typeOfStateId":"state","$connId":"con_313","$id":"c375d7df-56a7-43d2-8f53-6e58ed2e0b3e","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d310e1ef-d914-416e-9d67-c832814b1aa8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"e17b607a-69cd-4b97-aef7-125f53ef7fb6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-19ab7a58-2db3-4ff7-ab64-1b680841808d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-733b747c-19c4-429e-9db0-71ac1211c607","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-271d97ce-6806-438c-9459-48c980fdbdf6","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7053fa56-6018-4d7c-bf7d-23461b32f7b9","root":false,"$title":"[MS.6.6.1][INPUT] POS travando 2 instrução","$position":{"top":"2364px","left":"7672.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"86806f3d-1dca-4a75-992a-358932a774b8":{"$contentActions":[{"action":{"$id":"3f853001-c982-41c5-897d-185cb67df129","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"72cd5f8b-e089-41dc-9387-10fe8162bd21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"72cd5f8b-e089-41dc-9387-10fe8162bd21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b682da27-37ce-4258-ab65-72dcff03c24c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b0c65704-1ae1-4e19-b756-bfd2657378f8","type":"text/plain","content":"Certo, vamos tentar atualizar.\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"b0c65704-1ae1-4e19-b756-bfd2657378f8","type":"text/plain","content":"Certo, vamos tentar atualizar.\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f1b0c231-d648-428b-a324-77e5bf617982","typeOfStateId":"state","$connId":"con_318","$id":"857f4512-08a7-4c90-92a3-d77f6bfef163","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"95a8f162-d51d-413c-bbc5-d0157f5ba774","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dbdeb117-0581-4bc1-b0be-e41faf20fd61","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a381f5b3-ed96-4eaf-b4d3-0e1679f52e59","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5adbe4cc-a2ba-44f2-a7e1-623f15268360","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"86806f3d-1dca-4a75-992a-358932a774b8","root":false,"$title":"[MS.6.6.2][MSG] POS travando 3 instrução","$position":{"top":"2661px","left":"7672.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f1b0c231-d648-428b-a324-77e5bf617982":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"76d93ebd-881e-4682-9989-0a698b111dcf","typeOfStateId":"state","$connId":"con_323","$id":"955302d1-6333-40d0-bdaf-dc439da8075a","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"0da7e333-37dd-45c2-8d77-c272cffc8ae2","typeOfStateId":"state","$connId":"con_328","$id":"50e30f2c-cee3-4ddf-84b5-ce22dfe8e2dc","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"721dc388-3133-4fc8-9615-fb3c417d9cd4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"649b9096-61bf-4840-9b38-ecf3e62f1e41","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-74a35fcb-66de-4ff3-bff0-4fdad1139d14","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bae4e99d-d428-4247-a8ca-d0950ae75681","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9fc50090-e986-49fb-882b-12996966861e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f1b0c231-d648-428b-a324-77e5bf617982","root":false,"$title":"[MS.6.6.2][INPUT] POS travando 3 instrução","$position":{"top":"3148px","left":"7672.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0da7e333-37dd-45c2-8d77-c272cffc8ae2":{"$contentActions":[{"action":{"$id":"4e2b021f-7cc8-4fd4-bea5-3f7d7d83f91b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"07fa6cf4-2b5a-4123-afcd-ad33dac989aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"07fa6cf4-2b5a-4123-afcd-ad33dac989aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"147c5f18-430a-41d9-8329-63f17e391392","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2fb2e441-7f00-4fc0-aa4c-3cd32d5362e4","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\n1° Pressione o atalho 990.\n\n2° Em seguida, apague todos os arquivos.","metadata":{}},"$cardContent":{"document":{"id":"2fb2e441-7f00-4fc0-aa4c-3cd32d5362e4","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\n1° Pressione o atalho 990.\n\n2° Em seguida, apague todos os arquivos."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","typeOfStateId":"state","$connId":"con_333","$id":"b60d3600-a26c-4c1b-88a8-a1122992b2e3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O equipamento travou no meio de um processamento? 🤔\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4e57fbc4-7c42-4f9c-9e0f-27b8097e95c0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-11e07e70-c650-488d-9f2f-58a7758ae663","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cd7610f0-e90c-40c3-88e9-a47a09087f97","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-83fc665d-3fd7-4e40-be9f-7becafa0f00d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0da7e333-37dd-45c2-8d77-c272cffc8ae2","root":false,"$title":"[MS.6.6.3][MSG] POS travando 4 instrução","$position":{"top":"3147px","left":"7382.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"76d93ebd-881e-4682-9989-0a698b111dcf":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8ceb637d-6d0b-473a-bd2c-09eabac760be","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"76d93ebd-881e-4682-9989-0a698b111dcf","root":false,"$title":"[GO TO] Redirect to Finalização","$position":{"top":"2776px","left":"8199px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"704ba1d8-f466-4c8c-8e5d-843a53f45fbe":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"8b879571-dc70-4121-bcf1-19746d309ed3","typeOfStateId":"state","$connId":"con_338","$id":"88825009-f2d2-4681-8813-01dab08a4040","conditions":[{"source":"context","comparison":"equals","values":["Bateria fraca"],"variable":"userInput"},{"values":[],"source":"context","comparison":"exists","variable":"segundoAtendimentoBateriaFraca"}],"$invalid":false},{"stateId":"5c73495b-0ea3-440c-8c9b-0a5ae53bdb49","typeOfStateId":"state","$connId":"con_343","$id":"4f7796e5-e5cb-4139-b638-7bccc2f5045b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3a25b2f4-3759-4e3f-81ca-3364144dab75","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-503b4a62-d980-4b8a-9b23-b06fd9c8fd0a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ccc634b5-0177-4c6a-a319-042bd31e66f9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c9eae1ac-cb6d-4180-8c31-dbe40eb931d8","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"704ba1d8-f466-4c8c-8e5d-843a53f45fbe","root":false,"$title":"[MS.6.7.0][INPUT] Menu Bateria","$position":{"top":"1796.35px","left":"8303.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7bdc580c-ecf9-4f6c-9aa3-b16158ab7219":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"704ba1d8-f466-4c8c-8e5d-843a53f45fbe","typeOfStateId":"state","$connId":"con_348","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e867fd85-0ad6-4b1e-99df-71994eb60c45","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Bateria fraca\",\n\t\t\t\t\"description\": \"Bateria não segura carga\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Carregador\",\n\t\t\t\t\"description\": \"Problema com carregador\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Lembre-se: para garantir o bom funcionamento e a autonomia da bateria, é essencial utilizar *apenas* o *carregador original* que acompanha a máquina e sempre aguardar até 100% de carga antes de desconectar o carregador.\n\nToque no botão abaixo e selecione o motivo.`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7bdf2b7c-572d-43ba-93e4-36241df6c145","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a20f01cf-8792-4089-a260-6ba371ca1346","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-feae49b3-9b6a-4854-ab26-594380cdf7e7","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5b52a099-dec5-4e2b-9176-a2ede1259b23","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7bdc580c-ecf9-4f6c-9aa3-b16158ab7219","root":false,"$title":"[MS.6.7.0][MSG] Menu Bateria","$position":{"top":"1253px","left":"8302.59px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8b879571-dc70-4121-bcf1-19746d309ed3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8ca26c61-e538-44d0-a92f-f1be00bad11b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"8b879571-dc70-4121-bcf1-19746d309ed3","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1849px","left":"8053px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5c73495b-0ea3-440c-8c9b-0a5ae53bdb49":{"$contentActions":[{"action":{"$id":"35658236-4f5f-4eca-ac0d-39836e30679b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b995f318-5c8d-4f66-98f3-fe3a029266fe","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"01c70b32-e096-4e2a-82e8-9f764195fa81","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_353","$id":"45d2e78b-d7c2-4c88-a771-14fa225f4734","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c4f6078b-05dd-44fa-87b0-c33775a054f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (userInput === 'Bateria fraca') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (confirme com \"Sim\").\n\n5° Ative o terminal novamente.\n\n6° Pressione o atalho 993.\n\n7° Acompanhe a máquina até a carga atingir 100%.\n`\n\t\t}\n\t\tif (userInput === 'Carregador') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e aguarde 30 segundos.\n\n3° Recoloque a bateria e realize um novo teste com o carregador.\n\n4° Caso isso não resolva, teste com outro carregador e em outra tomada.\n`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5327d108-2d77-4491-84a7-afbba8de3ab3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"78bd3507-ba87-42d1-aaac-6e7385daf8f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"segundoAtendimentoBateriaFraca\" to \"48h\"","$invalid":false,"settings":{"variable":"segundoAtendimentoBateriaFraca","value":"true","expiration":172800},"conditions":[{"values":["Bateria fraca"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bf30e6ca-9884-41ca-8afc-26d05239393e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8c35491c-6c1f-4fa3-8d61-106117d4e36c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-83864713-6622-444b-b8c4-c328830c602c","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-9faffebb-9de1-4633-953c-7549c548e8a0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5c73495b-0ea3-440c-8c9b-0a5ae53bdb49","root":false,"$title":"[MS.6.7.1][MSG] Bateria","$position":{"top":"2075.35px","left":"8303.37px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a3585cdc-8039-46ad-adea-38491911c4c4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"a3585cdc-8039-46ad-adea-38491911c4c4","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2794px","left":"8787px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"db72de2b-8f60-4bb2-8191-6957300d488e":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"bcd3ab7a-ff38-47c7-ab44-58007db46c24","typeOfStateId":"state","$connId":"con_358","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e867fd85-0ad6-4b1e-99df-71994eb60c45","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Desliga ao imprimir\",\n\t\t\t\t\"description\": \"Impressão/Transação\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Impressão lenta\",\n\t\t\t\t\"description\": \"Equipamento imprime lentamente\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Instalação de bobina\",\n\t\t\t\t\"description\": \"Como instalar bobina\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Solicitar bobina\",\n\t\t\t\t\"description\": \"Como solicitar bobina\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual seria o motivo?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3a60886a-9452-4d2f-9640-e4fa007a6692","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e709bf1e-ffea-4528-b844-94406c1d4297","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-07a1a44a-558c-46a0-a381-52c88440a32c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7b2d7dcb-f231-45b5-85a9-b94f58c58e68","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"db72de2b-8f60-4bb2-8191-6957300d488e","root":false,"$title":"[MS.6.8.0][MSG] Menu Impressão","$position":{"top":"1178px","left":"8787px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bcd3ab7a-ff38-47c7-ab44-58007db46c24":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3ef48664-cbd0-49cc-9eef-ad2c3ee7fc74","typeOfStateId":"state","$connId":"con_363","$id":"5050403c-a9c4-4c19-8d82-2e517ba5b071","conditions":[{"source":"context","comparison":"equals","values":["Instalação de bobina"],"variable":"userInput"}],"$invalid":false},{"stateId":"b486fdc8-2791-43a1-adfd-12adbd00b1b8","typeOfStateId":"state","$connId":"con_368","$id":"4f7796e5-e5cb-4139-b638-7bccc2f5045b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"223a718d-e393-4d6f-a7e6-edba4fc09bd0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c62f944-913b-4582-a732-ad9834b65152","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a42df063-15a3-45a1-90eb-84291a5b0f00","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1d952635-48fc-47b2-9ab8-806299dced0d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-47fd9fd0-fe66-42e3-9c16-536a7ead11b8","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d3669979-0bae-4adf-b4a5-f0494f3dedfe","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"bcd3ab7a-ff38-47c7-ab44-58007db46c24","root":false,"$title":"[MS.6.8.0][INPUT] Menu Impressão","$position":{"top":"1811px","left":"8786px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b486fdc8-2791-43a1-adfd-12adbd00b1b8":{"$contentActions":[{"action":{"$id":"35658236-4f5f-4eca-ac0d-39836e30679b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b995f318-5c8d-4f66-98f3-fe3a029266fe","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"01c70b32-e096-4e2a-82e8-9f764195fa81","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_373","$id":"45d2e78b-d7c2-4c88-a771-14fa225f4734","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c4f6078b-05dd-44fa-87b0-c33775a054f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (userInput === 'Desliga ao imprimir') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n5° Ative o terminal novamente.\n\n6° Pressione o atalho 993.\n`\n\t\t}\n\t\tif (userInput === 'Impressão lenta') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Verifique se há alguma peça danificada na tampa da bobina.\n\n2° Retire a bobina e substitua-a deixando um pouco de papel para fora.\n\n3° Pressione o atalho 995.\n\n4° Pressione o atalho 990.\n\n5° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n6° Ative o terminal novamente.\n\n7° Pressione o atalho 993.\n\n8° Realize uma venda de teste.\n`\n\t\t}\n\t\t\t\tif (userInput === 'Solicitar bobina') {\n\t\t\treturn `A bobina é solicitada pela prória máquina.\n\n1° Primeiro, cadastre a senha lojista.\n\n2° Aperte os três traços no canto superior esquerdo.\n\n3° Escolha menu > configurações > senha lojista ou alterar senha.\n\n4° Após configurar a senha, aperte os traços no canto superior esquerdo > menu > solicitar bobinas.\n`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"83762300-565d-4c37-b738-d0d7bbdd8f66","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"78bd3507-ba87-42d1-aaac-6e7385daf8f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"segundoAtendimentoBateriaFraca\" to \"48h\"","$invalid":false,"settings":{"variable":"segundoAtendimentoBateriaFraca","value":"true","expiration":172800},"conditions":[{"values":["Bateria fraca"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-29594a95-a4c6-493f-bf5d-1431ab276ad6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-582af4cb-6311-43a6-930b-b926913e7698","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c66c6ae7-820f-427e-b46a-fcc05ebc1dd8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2fcee225-7ea5-44b8-a754-e640a6852c98","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b486fdc8-2791-43a1-adfd-12adbd00b1b8","root":false,"$title":"[MS.6.7.1][MSG] Impressão","$position":{"top":"2177px","left":"8787px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3ef48664-cbd0-49cc-9eef-ad2c3ee7fc74":{"$contentActions":[{"action":{"$id":"436e3891-145e-4d9f-8c88-31d0d71a07e3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"751fdef5-2627-49cc-9b09-6801b78e2743","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"751fdef5-2627-49cc-9b09-6801b78e2743","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2466ebbe-e53a-40d4-8765-069accebc36b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b2099b3a-88b7-47dd-afb0-73c817b149a7","type":"text/plain","content":"Confira na imagem abaixo, como instalar a bobina na sua máquina.","metadata":{}},"$cardContent":{"document":{"id":"b2099b3a-88b7-47dd-afb0-73c817b149a7","type":"text/plain","content":"Confira na imagem abaixo, como instalar a bobina na sua máquina."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"32efa4f3-f72e-4741-b663-74c38a344471","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cf642e9b-72a7-4b63-8c30-b4c3a11b9f52","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"cf642e9b-72a7-4b63-8c30-b4c3a11b9f52","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3e546048-05d0-4dd8-b29e-52d4b63fd7d4","$typeOfContent":"media","type":"SendMessage","settings":{"id":"83def372-dc0d-4561-ad0a-3295232df089","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_0b51f7b3-7408-4a41-909b-63ca0ef526c5","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"83def372-dc0d-4561-ad0a-3295232df089","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_0b51f7b3-7408-4a41-909b-63ca0ef526c5","aspectRatio":"1:1"},"metadata":{}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0ecd8658-78fc-4259-96bd-3c6cf817d947","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"2fae25a1-3fbb-44c0-9081-6578edc9985e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"39d927de-14c2-4d37-9e4d-c5b103569501","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"39d927de-14c2-4d37-9e4d-c5b103569501","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_378","$id":"37a5b3cb-d9e6-4ce7-b045-de33ad849018","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"664b3231-fa8b-453a-96b6-ca8fcd408335","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-09125746-badc-4ec8-877d-32c2b0003943","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e114acb0-e5c8-4a5e-be65-38d90dc75b7d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3ef48664-cbd0-49cc-9eef-ad2c3ee7fc74","root":false,"$title":"[MS.6.7.2][IMG] Instalação de bobina","$position":{"top":"1799px","left":"9070px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0dde7099-56bd-4590-abff-25c9a550991e":{"$contentActions":[{"action":{"$id":"e0629639-31fc-42d4-9f31-0d173529069b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f810b31-f1c9-45c9-bb92-32466eba9952","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e5898d5-bb60-4eb7-9fa4-4eab0ab6f4ad","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6c5b5734-f15d-45b3-a890-27a2ad2a22b5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f5c51002-8158-425a-b3de-80628270cb57","typeOfStateId":"state","$connId":"con_383","$id":"9092ae37-34e1-4dfa-8fa8-285f9f6ebfbe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b4b33907-63b6-4474-837e-086e82327b89","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"81634feb-adfb-413e-84b1-c26d928320dc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"MP05 bluetooth\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"D175 bluetooth\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-187cd19a-c3da-49f5-afb1-5ade2fcabf1f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-88053047-127e-4d5c-a01b-1661120281a3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b15e1365-7dff-40f8-8019-fa2299bedf9e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0dde7099-56bd-4590-abff-25c9a550991e","root":false,"$title":"[MS.6.9.0][MSG] Menu USB","$position":{"top":"1086px","left":"9550px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f5c51002-8158-425a-b3de-80628270cb57":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"8838f326-1b05-4714-9ac0-6aae762bb094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"9b44bed9-fbe4-4523-917b-ea0b4ba59d45","typeOfStateId":"state","$connId":"con_388","$id":"02ac17dc-d279-41b8-9dd2-e34ca8064ec0","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"82d0f38a-e465-495b-bde0-a928fa3c9147","typeOfStateId":"state","$connId":"con_393","$id":"4f7796e5-e5cb-4139-b638-7bccc2f5045b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c1a4c514-2d8a-49bf-82b1-a2d645d7b7cd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d6952d11-337b-4725-8dd7-8f46c385d1ac","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"609908c9-ad0a-4241-9b8a-16b79213f560","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"aa32ed0b-3ee4-48f1-b88b-3702c70e8eed","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"e0658468-8ec6-4742-8622-e580fe431cae","$typeOfContent":"","type":"SetVariable","$title":"Set \"subAssunto\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"subAssunto","value":"{{userInput}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7d9818a0-772f-4c95-829e-c6f5abb2c1a2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1a42848e-fd41-4073-8682-604b78759e86","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-7fd3edf9-c7ac-43cf-8b38-6c651a089d19","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-63768d67-e1c0-46f1-96da-9591f017dfd3","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f5c51002-8158-425a-b3de-80628270cb57","root":false,"$title":"[MS.6.9.0][INPUT] Menu USB","$position":{"top":"1795.5px","left":"9549.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"82d0f38a-e465-495b-bde0-a928fa3c9147":{"$contentActions":[{"action":{"$id":"35658236-4f5f-4eca-ac0d-39836e30679b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0eab649b-7c97-4ed1-b361-2865e894b7f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b995f318-5c8d-4f66-98f3-fe3a029266fe","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"2a41b876-3f07-495c-a61e-ae86c512ffa6","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"01c70b32-e096-4e2a-82e8-9f764195fa81","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a3585cdc-8039-46ad-adea-38491911c4c4","typeOfStateId":"state","$connId":"con_398","$id":"45d2e78b-d7c2-4c88-a771-14fa225f4734","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c4f6078b-05dd-44fa-87b0-c33775a054f5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (userInput === 'MP05 bluetooth') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Desbloqueie o equipamento pressionando a tecla liga e desliga.\n\n2° Pressione uma vez o botão amarelo.\n\n3° Pressione duas vezes o botão verde.\n\n4° Aparecerá a mensagem \"Configuração de senha de acesso\".\n\n5° Digite a senha: 555555.\n\n6° Selecione a opção comunicação bluetooth.\n`\n\t\t}\n\t\tif (userInput === 'D175 bluetooth') {\n\t\t\treturn `Vou te pedir para fazer o seguinte:\n\n1° Ligue o equipamento.\n\n2° Pressione sequencialmente Limpa > Entra > Anula.\n\n3° Insira a senha de acesso: 555555.\n\n4° Selecione a opção “Comunicação bluetooth”.\n\n5° A mensagem \"Comunicação Bluetooth ativada\" será exibida.\n\n6° Pressione anula e em seguida 0.\n`\n\t\t}\n\t} catch (err) {\n\t\treturn false\n\t}\n}\n","inputVariables":["userInput"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ac672394-b43c-4508-9360-7d3f61e36ca1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"78bd3507-ba87-42d1-aaac-6e7385daf8f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"segundoAtendimentoBateriaFraca\" to \"48h\"","$invalid":false,"settings":{"variable":"segundoAtendimentoBateriaFraca","value":"true","expiration":172800},"conditions":[{"values":["Bateria fraca"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-16b520c7-7989-4e27-b9b2-2406800c2a77","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6cc12f5a-cab7-4541-9254-842d1e65d905","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4062e5dd-d06e-49f9-babf-1cd22525a14b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-22a8fd90-ae0f-452b-995e-901084e3824d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"82d0f38a-e465-495b-bde0-a928fa3c9147","root":false,"$title":"[MS.6.9.1][MSG] USB","$position":{"top":"2074.5px","left":"9549.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9b44bed9-fbe4-4523-917b-ea0b4ba59d45":{"$contentActions":[{"action":{"$id":"cfb3bcbb-7e1b-4a9a-b61a-36f968a288c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c7f0acbb-6a8b-49b4-987b-84c673ffb7ab","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c7f0acbb-6a8b-49b4-987b-84c673ffb7ab","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0e0104d7-6a8d-4559-8ae4-0c224e8d216d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"baf03040-5091-4fc2-95d3-45bd4c0b68c9","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"baf03040-5091-4fc2-95d3-45bd4c0b68c9","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"68ae6232-fa34-42b4-a347-89aa668c385b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b479891a-cbf1-4d10-b75c-892963408c7b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9b44bed9-fbe4-4523-917b-ea0b4ba59d45","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1784px","left":"9324px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6c943cf9-ee58-4067-a079-7bdd0c20b21c":{"$contentActions":[{"action":{"$id":"18606df4-0b7a-42b9-a383-dcf17c8c57a7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"deb2653d-6e87-47f1-953c-6c74fe9e6246","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"deb2653d-6e87-47f1-953c-6c74fe9e6246","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"209027a3-c52b-46d9-a77f-780eca42ae8a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9a8c163b-4195-43da-9cc5-a2a676102d14","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n3° Ative o terminal novamente.\n\n4° Realize uma venda de teste.","metadata":{}},"$cardContent":{"document":{"id":"9a8c163b-4195-43da-9cc5-a2a676102d14","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 990.\n\n2° Apague todos os arquivos de dados (responda \"Sim\" à confirmação).\n\n3° Ative o terminal novamente.\n\n4° Realize uma venda de teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6e4e0ea0-6d2b-45c7-99bb-7e5fa65ae094","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"5f4a5491-d20a-47dd-b5f1-39f15cef7df1","typeOfStateId":"state","$connId":"con_403","$id":"9b00b5bc-cb24-4310-8df9-2387922db2c4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"99e18fd7-6b78-4aba-b6ca-072b2aaa9c4b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-717cb361-75fa-46a6-b5dd-0bb5fea8ec62","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-211c3b2b-b4bc-4f9b-8b45-2e65ec180293","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6c943cf9-ee58-4067-a079-7bdd0c20b21c","root":false,"$title":"[MS.6.10.0][MSG] Aplicação com problema","$position":{"top":"985.46px","left":"9914.17px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"68a1f11d-7db3-4163-aee5-05d12419d448":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"69b29d3d-3c1b-46c1-a7c2-f6e5c7d57bb9","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"68a1f11d-7db3-4163-aee5-05d12419d448","root":false,"$title":"[GO TO] Finalização","$position":{"top":"2334.59px","left":"6021.76px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"732efa55-d798-4f04-acb5-c306c0ebd203":{"$contentActions":[{"action":{"$id":"f95f3cfc-ffd1-4582-8c8e-728461044c7e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"44544660-4f1b-4f54-8595-2f1065a385b1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"44544660-4f1b-4f54-8595-2f1065a385b1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"59961218-785c-4ffc-bebb-0e690d313b96","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fff5c3d0-1095-433e-b6c2-fd3192cf2471","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"fff5c3d0-1095-433e-b6c2-fd3192cf2471","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"aa561499-e224-4dc2-a660-98a32a64ab6b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e1cb0a89-541c-4998-a7ef-b26acce585c1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"732efa55-d798-4f04-acb5-c306c0ebd203","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"3469px","left":"5374px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"082428ef-bfa6-4828-9e9f-d64787844ea5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5a5d6d96-c921-4e51-9d3b-5dbbb69acb28","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"082428ef-bfa6-4828-9e9f-d64787844ea5","root":false,"$title":"[GO TO] Finalização","$position":{"top":"3483px","left":"5926px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1337352b-12ff-49c0-9fe2-10883e6e0862":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ff08e673-15cb-4cef-b706-4c9652c266ac","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"1337352b-12ff-49c0-9fe2-10883e6e0862","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"2514px","left":"4970.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"db7da12e-ee1a-4614-9e43-e78c3c1432eb":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"53ecccb3-e087-49da-8667-d20438985d9a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"b0e87449-cedc-4403-99b9-f0a312c926bd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Whatsapp PJ ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"Suporte Tecnico\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\t// stateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d2de91b7-360e-4cfa-933f-0a4c0d2c685d","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]}],"$leavingCustomActions":[{"$id":"899b0fcf-a95a-42db-ab36-2b708dd3f4c9","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"Suporte Tecnico"},"address":"WhatsApp PJ"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-35e271de-03e6-4afd-bdca-09f03bb45686","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-27d11035-a8b3-46f2-a7d5-7226fc149bed","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2c74efc9-76be-4f2b-bae0-c389da8d4750","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","root":false,"$title":"[Redirect] to WhatsApp PJ (Suporte Tecnico)","$position":{"top":"237px","left":"1399.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f0a8601f-5de1-4885-9b44-4f4a6e062c01":{"$contentActions":[{"action":{"$id":"e20e7f76-2c05-41e7-9ab4-52f715d23634","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8fddfe5b-92fa-4931-9029-f21bb1d652dc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8fddfe5b-92fa-4931-9029-f21bb1d652dc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e117627b-0a82-4ad3-9e69-7b9c4eae8999","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e66cc141-dc61-4ced-a46a-c57b82f9c75d","type":"text/plain","content":"<b>Importante</b>: Esta opção é destinada apenas para <b>Transações não autorizadas</b>.\n\nPara problemas com o <b>Token</b> ou <b>Senha</b>, entre em contato com a central de atendimento no número: (11) 3175-8248 \n\nNo caso de <b>cobranças indevidas</b>, digite <b>Menu inicial</b> e selecione:\nMáquina Safrapay> Condições e Taxas> Questionar uma cobrança.\n","metadata":{}},"$cardContent":{"document":{"id":"e66cc141-dc61-4ced-a46a-c57b82f9c75d","type":"text/plain","content":"<b>Importante</b>: Esta opção é destinada apenas para <b>Transações não autorizadas</b>.\n\nPara problemas com o <b>Token</b> ou <b>Senha</b>, entre em contato com a central de atendimento no número: (11) 3175-8248 \n\nNo caso de <b>cobranças indevidas</b>, digite <b>Menu inicial</b> e selecione:\nMáquina Safrapay> Condições e Taxas> Questionar uma cobrança.\n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"73c534ee-e740-472a-9918-ee93b813731b","typeOfStateId":"state","$connId":"con_408","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Débito\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Crédito\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"PIX\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Boleto\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"5\",\n\t\t\t\t\"title\": \"TED\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"6\",\n\t\t\t\t\"title\": \"Tributos\",\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, primeiro selecione no menu abaixo qual o tipo de transação.👇`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ed3f536c-f4dc-4ec4-bbe0-25ec0cf14b72","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"44c7c0da-61f2-48d0-9207-fed517685d9b","$typeOfContent":"","type":"SetVariable","$title":"Set \"transacoesNaoAutorizadas\" to \"\"","$invalid":false,"settings":{"variable":"transacoesNaoAutorizadas"},"conditions":[]},{"$id":"1fbd62f2-f214-4830-91de-2f440c5dbb9f","$typeOfContent":"","type":"SetVariable","$title":"Set \"nrTransacao\" to \"1\"","$invalid":false,"settings":{"variable":"nrTransacao","value":"1"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-245ebd64-9be9-4886-bbf7-f29964dffc3a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b58bf3ee-3319-401c-b91a-821096836346","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1cf62a66-f679-46f8-8fae-5880d33ae7e8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2463d0d5-9376-44b7-bbe2-c585b8246ae7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f0a8601f-5de1-4885-9b44-4f4a6e062c01","root":false,"$title":"[MS.7.0.1][MSG] Menu Transação não autorizada","$position":{"top":"55px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"73c534ee-e740-472a-9918-ee93b813731b":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"f8513f95-73e1-475b-957b-92397d444711","typeOfStateId":"state","$connId":"con_413","$id":"59b97e43-5e8c-4764-b4fe-820d64a7a4bb","conditions":[{"source":"context","comparison":"equals","values":["Débito"],"variable":"userInput"}],"$invalid":false},{"stateId":"08dc8989-b270-4fe0-827a-2169d261976b","typeOfStateId":"state","$connId":"con_418","$id":"9c8843e7-ce0c-4cff-bb26-c69c15205996","conditions":[{"source":"context","comparison":"equals","values":["Crédito"],"variable":"userInput"}],"$invalid":false},{"stateId":"53a02ba6-82b0-47a1-841c-0d320c69c82a","typeOfStateId":"state","$connId":"con_423","$id":"2cdb606a-0473-4f8b-ad89-144280dd8150","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]},{"$id":"58714c55-3bde-4fcf-93ba-c78441038857","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivo\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"motivo","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"75e24a21-6a54-4507-8b5a-81b94ac89f94","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivoProtocolo\" to \"transacaoNaoAutorizadaIBouApp\"","$invalid":false,"settings":{"variable":"motivoProtocolo","value":"transacaoNaoAutorizadaIBouApp"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4fcf3300-bdd3-438a-a6ae-dbab5df7d820","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a40179e8-afb7-4f98-978c-ec73fc0ba48a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-bbc065b9-0cc1-4d9a-ab1b-ed9f10a67d66","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1a0edb21-9920-4ab3-a606-659e7ff0283e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"73c534ee-e740-472a-9918-ee93b813731b","root":false,"$title":"[MS.7.0.1][INPUT] Menu Transação não autorizada","$position":{"top":"387px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f8513f95-73e1-475b-957b-92397d444711":{"$contentActions":[{"action":{"$id":"0fe64b68-6625-4dc6-881a-c85806ccb2db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"504e7f7a-ce02-478f-9304-a4e6dd84cefe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a335ba2c-017d-47e8-8a10-c13ef581450e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f3d9d8f0-1d78-4d5d-9d0a-a1b643f7fe11","type":"text/plain","content":"Primeiro selecione o motivo nas opções abaixo.👇","metadata":{}},"$cardContent":{"document":{"id":"f3d9d8f0-1d78-4d5d-9d0a-a1b643f7fe11","type":"text/plain","content":"Primeiro selecione o motivo nas opções abaixo.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"38ccfbf5-e5d7-4291-bf70-edbda47dbe10","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d489c5ab-89c9-4aea-985f-0dea8c73e6b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d489c5ab-89c9-4aea-985f-0dea8c73e6b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00c9edd7-8eb9-4b86-a48b-528e00a835b3","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8b8bf51d-3cea-454c-bf9c-68ed4014777e","typeOfStateId":"state","$connId":"con_428","$id":"e596a57a-26f7-4ae3-8209-7b70be3018d2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"910471b5-c726-4207-8b8f-d4524f607afd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Não Autorizada\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não Reconhecida\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = '*1. Não Autorizada:* Você tentou utilizar o cartão e apareceu a mensagem de transação não autorizada ou a mensagem \"059 - Contate a central do seu cartão\\n\\n*2. Não Reconhecida:* Você não reconhece alguma transação realizada no débito. \"';\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7e8c6315-0052-4777-8c8f-c88b80f216f3","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivoProtocolo\" to \"transacaoNaoAutorizadaDebito\"","$invalid":false,"settings":{"variable":"motivoProtocolo","value":"transacaoNaoAutorizadaDebito"},"conditions":[]},{"$id":"9fb4a215-18f5-4bfa-8cd5-074133771e8c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cd4bae50-0e55-4e0c-b580-60fbfb1aded9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-06c56520-6efb-4af4-9572-0979cb56acdb","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ad832617-e1fb-4601-98c1-45eec6b6fb16","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e65fe088-2304-4799-a423-23064813b696","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f8513f95-73e1-475b-957b-92397d444711","root":false,"$title":"[MS.7.1.0][MSG] Débito (motivo)","$position":{"top":"399px","left":"3812px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8b8bf51d-3cea-454c-bf9c-68ed4014777e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"53a02ba6-82b0-47a1-841c-0d320c69c82a","typeOfStateId":"state","$connId":"con_433","$id":"64ff39a2-403c-4bff-a326-5955bdfa492a","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n\tconst posicoes = {\n\t\t\"1\": \"primeir[oa]|u[mn]\",\n\t\t\"2\": \"segund[ao]|do[ie]s\",\n\t\t\"3\": \"terceir[ao]|tr[eê]s\",\n\t\t\"4\": \"quart[ao]|[qc]uat(r)?o\",\n\t\t\"5\": \"quint[ao]|[sc]inc[ou]\",\n\t\t\"6\": \"sext[ao]|[sc]inc[uo]\",\n\t\t\"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n\t\t\"8\": \"oitav[ao]|oit[ou]\",\n\t\t\"9\": \"non[ao]|nov[ei]\",\n\t\t\"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n\t}\n\ttry {\n\t\tif (!inputUsuario) return 'inatividade'\n\t\tconst regexDictionary = {}\n\t\tconst { buttons } = JSON.parse(dynamicContent).interactive.action\n\t\tbuttons.forEach((button, index) => {\n\t\t\tconst key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n\t\t\tregexDictionary[key] = button.reply.title\n\t\t})\n\t\tfor (let regex in regexDictionary) {\n\t\t\tif (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n\t\t\t\treturn regexDictionary[regex]\n\t\t\t}\n\t\t}\n\t\treturn 'input inesperado'\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1c2b585c-3581-4370-acf8-10cf776dfd12","$typeOfContent":"","type":"SetVariable","$title":"Set \"debitoMotivo\" to \"userInput\"","$invalid":false,"settings":{"variable":"debitoMotivo","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"61b4d786-28c7-4b2e-8aef-a681b33e359f","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"14103380-83e7-423c-bba2-e340be8d5cff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"29819d1a-16d8-4b67-812a-32bba8716f20","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fcc9fe42-c9a1-477a-aa29-3813b79ae366","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-06fd8abb-562c-4f35-9884-78ecc7a6112f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-3dd0605a-b9eb-4059-b125-0214351b88f8","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3d5a921d-49bd-4c6b-a4f9-a7ed00dfefe4","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"8b8bf51d-3cea-454c-bf9c-68ed4014777e","root":false,"$title":"[MS.7.1.0][INPUT] Débito (motivo)","$position":{"top":"770px","left":"3812px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"08dc8989-b270-4fe0-827a-2169d261976b":{"$contentActions":[{"action":{"$id":"9d93483e-b7eb-499e-81e9-afda9216b885","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c4ca2590-60d8-4e88-8c5f-8b852f3327bc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c4ca2590-60d8-4e88-8c5f-8b852f3327bc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"49fc5493-d7fb-4437-b0f4-e2159f567a59","$typeOfContent":"text","type":"SendMessage","settings":{"id":"795e1c91-fa69-41df-b5a8-d1e802ccf0b4","type":"text/plain","content":"Nesse caso, pedimos que entre em contato com a Central de Cartões nos seguintes números.👇\n\n(11) 4001-4460 (Capital e Grande São Paulo) \n0800 728-4460 (para outras localidades)  \n24h, 7 dias por semana. \n ","metadata":{}},"$cardContent":{"document":{"id":"795e1c91-fa69-41df-b5a8-d1e802ccf0b4","type":"text/plain","content":"Nesse caso, pedimos que entre em contato com a Central de Cartões nos seguintes números.👇\n\n(11) 4001-4460 (Capital e Grande São Paulo) \n0800 728-4460 (para outras localidades)  \n24h, 7 dias por semana. \n "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2610844b-68a7-4a9b-bb0b-479c78ac6d0a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e335ceac-e744-405a-8be6-573e70ef7fc2","typeOfStateId":"state","$connId":"con_438","$id":"001ac4d0-b729-4d9f-8c8e-2d46b580d2b9","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e5fbef2d-b090-49e9-b1b7-604cf81b2d09","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-723698c9-0b2e-4363-a361-2fe500d163a1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-007b1288-6f3d-410b-95c4-e329c0e5f6ad","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"08dc8989-b270-4fe0-827a-2169d261976b","root":false,"$title":"[MS.7.1.1][MSG] Credito","$position":{"top":"399px","left":"4507px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"53a02ba6-82b0-47a1-841c-0d320c69c82a":{"$contentActions":[{"action":{"$id":"ec0162d3-ea99-4dfb-9369-db95af1bee47","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e3beb374-e593-46e4-8793-6b1499d512fe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e3beb374-e593-46e4-8793-6b1499d512fe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b1f1183d-4ed7-4cea-a61b-94c6e70c2cf5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"cf630d4f-6445-4d12-85a0-16c8ddb89439","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"cf630d4f-6445-4d12-85a0-16c8ddb89439","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7102288f-f1d0-4ff5-8b94-555b70dd18be","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"39adec87-0ee9-4b29-83e0-1dd7073c8b1e","typeOfStateId":"state","$connId":"con_443","$id":"fdb80a4a-e789-4aa1-84cc-eaceb551217c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"976801af-d478-4326-8000-5775d8218436","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(debitoMotivo) {\n\ttry {\n\t\tif (debitoMotivo) {\n\t\t\treturn `Por gentileza, informe a quantidade de transações *${debitoMotivo || 'negadas'}*.\n\nPor exemplo, se foram quatro transações, digite apenas: *4*`\n\t\t}\n\t\treturn `Por gentileza, informe a quantidade de transações *negadas*.\n\nPor exemplo, se foram quatro transações, digite apenas: *4*`\n\t} catch (err) {\n\t\treturn `Por gentileza, informe a quantidade de transações *negadas*.\n\nPor exemplo, se foram quatro transações, digite apenas: *4*`\n\t}\n}","inputVariables":["debitoMotivo"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3e44f113-d491-4879-ba2e-d67b6e93e4b4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cb1a6c12-9751-47e7-95ae-60bb87abff61","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e10fb84f-4b5c-4126-8205-296d7cc63220","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1c691064-399a-4183-a664-63ceba0c2710","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"53a02ba6-82b0-47a1-841c-0d320c69c82a","root":false,"$title":"[MS.7.2.0][MSG] Quantidade de transações","$position":{"top":"759px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"39adec87-0ee9-4b29-83e0-1dd7073c8b1e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"33800b2b-616d-4ee0-97b9-90d0a3b9ec16","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562","typeOfStateId":"state","$connId":"con_448","$id":"1e106c14-a970-4aaf-9d58-d87f10332598","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"530ac6ca-a843-4e64-ae8c-ece2e150a466","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(userInput) {\n\ttry {\n\t\tif (!userInput) {\n\t\t\treturn 'inatividade'\n\t\t}\n\t\tif (isNaN(userInput)) {\n\t\t\treturn 'input inesperado'\n\t\t}\n\t\treturn userInput\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f6c3d10e-5cf7-43cb-81bd-a63678b71cd3","$typeOfContent":"","type":"SetVariable","$title":"Set \"quantidade\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"quantidade","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"24866702-1f1e-47eb-b9da-a6beeef3d1f5","$typeOfContent":"","type":"SetVariable","$title":"Set \"nrTransacao\" to \"1\"","$invalid":false,"settings":{"variable":"nrTransacao","value":"1"},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"nrTransacao"}]},{"$id":"5b18af91-de74-49c2-b9b1-c0c01c010ac6","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"MS.7.2.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.7.2.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"43aa61ec-997b-4819-a58f-d869cc8fef14","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"14433f83-fd76-4fda-b4bd-014f7fde89f1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9a555050-1f28-44df-befc-0f5db9f54bca","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3dc22139-9b13-4a2e-a56a-90c12abc38a2","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-5118bef2-4bfd-4e5f-b6d8-a14b0ed1b3f2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f68390a2-bfe3-4290-934c-2f5fcfa6f74a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"39adec87-0ee9-4b29-83e0-1dd7073c8b1e","root":false,"$title":"[MS.7.2.0][INPUT] Quantidade de transações","$position":{"top":"1054px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562":{"$contentActions":[{"action":{"$id":"4a9a46df-1ba2-4ec0-8082-25541ccee5a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5eb7aae8-22ed-44c5-86df-f59933232f30","$typeOfContent":"text","type":"SendMessage","settings":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"14e7e86d-d28d-4dcb-b463-a4227097faa5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"53edb4c4-13d3-462e-84a4-0339423c3e5f","typeOfStateId":"state","$connId":"con_453","$id":"6dfd6a45-e81f-4de7-aca8-55837bb486a6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"41a8e8c8-b7aa-485f-8572-9590ba681d9d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"function run(nrTransacao, quantidade) {\n\ttry {\n\t\tif (quantidade > 1) {\n\t\t\treturn `Certo, agora informe a data da ${nrTransacao}ª transação.\n\nComo neste exemplo:\n👉 07/04/2024`\n\t\t}\n\t\treturn `Certo, agora informe a data da transação.\n\nComo neste exemplo:\n👉 07/04/2024`\n\t} catch (err) {\n\t\treturn `Certo, agora informe a data da transação.\n\nComo neste exemplo:\n👉 07/04/2024`\n\t}\n}","inputVariables":["nrTransacao","quantidade"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"81efb074-c1c0-47bb-8be1-c8e5443824ec","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-01bfcbc3-c844-49ab-b3f2-ac8c81165d73","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1436ceb0-3624-4695-bee5-b38033f99a8a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3453028b-21c3-4238-afa8-5b283cfaf868","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562","root":false,"$title":"[MS.7.2.1][MSG] Data das transações","$position":{"top":"1322px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"53edb4c4-13d3-462e-84a4-0339423c3e5f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"6c049c5b-1cf2-4c61-89e0-9fa0e1ca9e12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"19d44d4c-a7a3-4456-8481-05c7d1410a6d","typeOfStateId":"state","$connId":"con_458","$id":"b63ef83f-cca2-477f-a1d3-b11aab2d0ff2","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f4d5dcea-6e27-42bc-bf84-0ad81308e107","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function validaData(data) {\n  if (!/^(\\d{2})[-/](\\d{2})[-/](\\d{4})$/.test(data)) {\n    return false;\n  }\n\n  const [dia, mes, ano] = data.split(/[-/]/).map(Number);\n\n  if (ano < 1000 || ano > 3000 || mes < 1 || mes > 12)\n    return false;\n\n  let diaMaximo;\n  switch (mes) {\n    case 4:\n    case 6:\n    case 9:\n    case 11:\n      diaMaximo = 30;\n      break;\n    case 2:\n      if ((ano % 4 === 0 && ano % 100 !== 0) || ano % 400 === 0)\n        diaMaximo = 29;\n      else\n        diaMaximo = 28;\n      break;\n    default:\n      diaMaximo = 31;\n  }\n\n  return dia > 0 && dia <= diaMaximo;\n}\n\nfunction run(input) {\n  if (!input) return 'inatividade'\n  try {\n    if (validaData(input)) {\n      return input\n    }\n    return 'input inesperado'\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"8cfb9434-fb93-4032-a9a1-644ec4b6e54c","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"MS.7.2.1\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.7.2.1"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"03db998d-bcf3-483b-9e85-3a18b3fa783a","$typeOfContent":"","type":"SetVariable","$title":"Set \"dataTransacao\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"dataTransacao","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"7a3da56a-dad1-45a4-952e-19e8a536d754","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"31fde080-94e2-4bf5-8369-3a4ace100b30","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5e453818-233b-48af-bb8d-0e4aab8a418d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-66fa933c-41f7-4793-a7cf-eb6950947d03","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-045fa345-0c96-4ea7-91bf-c7a058811031","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2e8a38e0-0725-4de0-b78d-240f427908c8","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"53edb4c4-13d3-462e-84a4-0339423c3e5f","root":false,"$title":"[MS.7.2.1][INPUT] Data das transações","$position":{"top":"1585px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e9f10301-fc17-4518-8962-3c6960f66960":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"6c049c5b-1cf2-4c61-89e0-9fa0e1ca9e12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"0b7b93d1-cace-4366-bd46-782e761cc2a0","typeOfStateId":"state","$connId":"con_463","$id":"fdf06359-85eb-4694-a8ba-30d61542fa30","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"75557844-43bf-42f9-bd9d-7cab785bae50","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n\tif (!userInput) return 'inatividade'\n\ttry {\n\t\tconst regex = /^([01]?[0-9]|2[0-3])[h:][0-5][0-9]$/i;\n\n\t\tconst horarioValido = regex.test(userInput);\n\t\tif (horarioValido) {\n\t\t\treturn userInput.toLowerCase().replace('h', ':')\n\t\t}\n\t\treturn 'input inesperado'\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a67a078b-9a2e-4c57-964f-13cc878a82bf","$typeOfContent":"","type":"SetVariable","$title":"Set \"horarioTranscao\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"horarioTransacao","value":"{{userInput}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"42fcaab1-a61f-48fc-bdee-95e6af6b6a39","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"hora\"","$invalid":false,"settings":{"variable":"exceptionType","value":"hora"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"e35566dc-48eb-4e9c-bfb5-d6333379ba00","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0a39895e-4378-42a0-a8d7-1bab3706e563","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f6a5852d-103a-4120-9b3d-e0cc84dd5e39","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-25388252-b4e5-44f3-ba5f-9f2afd251d84","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-74626549-78af-4a84-8093-c241a8c603f1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ec13d135-48ec-4100-80ab-582e759557a0","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e9f10301-fc17-4518-8962-3c6960f66960","root":false,"$title":"[MS.7.2.2][INPUT] Horario das transações","$position":{"top":"2063px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"19d44d4c-a7a3-4456-8481-05c7d1410a6d":{"$contentActions":[{"action":{"$id":"4a9a46df-1ba2-4ec0-8082-25541ccee5a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5eb7aae8-22ed-44c5-86df-f59933232f30","$typeOfContent":"text","type":"SendMessage","settings":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Certo, informe o horário em que ocorreu a transação.\n\nComo neste exemplo:\n 👉 9:00","metadata":{}},"$cardContent":{"document":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Certo, informe o horário em que ocorreu a transação.\n\nComo neste exemplo:\n 👉 9:00"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"14e7e86d-d28d-4dcb-b463-a4227097faa5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e9f10301-fc17-4518-8962-3c6960f66960","typeOfStateId":"state","$connId":"con_468","$id":"6dfd6a45-e81f-4de7-aca8-55837bb486a6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0c3a234b-fd87-4a39-b093-f26018e7ed35","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6096159d-06eb-42fb-8106-281160c98d6b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-35beba3e-ca8a-4f30-a025-b602a9f9db67","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"19d44d4c-a7a3-4456-8481-05c7d1410a6d","root":false,"$title":"[MS.7.2.2][MSG] Horario das transações","$position":{"top":"1812px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b941efff-bd3d-45d1-a364-36e348a318ca":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"6c049c5b-1cf2-4c61-89e0-9fa0e1ca9e12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"78dfeca4-2819-4b41-a6ca-281834d77a89","typeOfStateId":"state","$connId":"con_473","$id":"e684a7ef-3a86-4514-89b2-906e9b3329b5","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"e7397ea5-e0cb-4a2c-b473-5e8a62d09d97","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado';\n  try {\n      if (!inputUsuario) {\n          return 'inatividade';\n      }\n\n      let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi;\n      let validInput = new RegExp(regex).test(inputUsuario);\n\n      if (validInput) {\n          return \"É um valor válido\";\n      }\n      return invalidInputMessage;\n  } catch (err) {\n      return invalidInputMessage;\n  }\n}\n","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"44562c08-7038-473c-9d49-d9d67c73098b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"valorTransacao\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n\ttry {\n\t\t// let salesValue = input.replace('.', '').replace(',', '.')\n\t\treturn input;\n\t}\n\tcatch(err){\n\t\treturn false\n\t}\n}","inputVariables":["input.content"],"outputVariable":"valorTransacao","LocalTimeZoneEnabled":false},"conditions":[{"values":["É um valor válido"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"62f9baff-9498-4587-a528-5a50167bca5a","$typeOfContent":"","type":"SetVariable","$title":"set \"exceptionType\" to \"valor\"","$invalid":false,"settings":{"variable":"exceptionType","value":"valor"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"6cf65f23-ab23-46c8-866b-9273ad91a7f0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"b2856156-08b5-413f-bb72-3110a3706c26","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d7e72c40-9194-4df2-b532-ef6b27daf69a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4761ecbe-3b12-46ce-8607-a7ba288293a3","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ec45f8f9-d930-4472-baa0-15ad2e654c6b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-728d371f-6c74-4625-965d-3c9bcc78b04b","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b941efff-bd3d-45d1-a364-36e348a318ca","root":false,"$title":"[MS.7.2.3][INPUT] Valor das transações","$position":{"top":"2632px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0b7b93d1-cace-4366-bd46-782e761cc2a0":{"$contentActions":[{"action":{"$id":"4a9a46df-1ba2-4ec0-8082-25541ccee5a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7ddfaa92-c632-463a-8f48-95469fcbd5e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5eb7aae8-22ed-44c5-86df-f59933232f30","$typeOfContent":"text","type":"SendMessage","settings":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Por último, informe qual o valor da transação.\n\nDigite exatamente como no exemplo abaixo. \n\n👉 300,00","metadata":{}},"$cardContent":{"document":{"id":"680e7aab-04b0-4be8-b8ac-420595ab2b37","type":"text/plain","content":"Por último, informe qual o valor da transação.\n\nDigite exatamente como no exemplo abaixo. \n\n👉 300,00"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"14e7e86d-d28d-4dcb-b463-a4227097faa5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b941efff-bd3d-45d1-a364-36e348a318ca","typeOfStateId":"state","$connId":"con_478","$id":"6dfd6a45-e81f-4de7-aca8-55837bb486a6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"85f7cb42-180c-41bb-8803-efd48076e288","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-60296d0f-93a3-4335-b66a-99b2b27cc47d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-26ad9e89-9429-4e47-bed3-5447d3b85a98","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0b7b93d1-cace-4366-bd46-782e761cc2a0","root":false,"$title":"[MS.7.2.3][MSG] Valor das transações","$position":{"top":"2356px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"78dfeca4-2819-4b41-a6ca-281834d77a89":{"$contentActions":[{"action":{"$id":"096f4f12-6977-4d4f-a9ff-93e56528cc78","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"836f86c2-8b8e-4e4b-add0-c577ac4d95f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"836f86c2-8b8e-4e4b-add0-c577ac4d95f1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"07398d6f-003a-44e6-a44f-c94dd3f9518c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1f1bee41-bc63-4a84-81d8-ca0393313f28","type":"text/plain","content":"{{msg}}","metadata":{}},"$cardContent":{"document":{"id":"1f1bee41-bc63-4a84-81d8-ca0393313f28","type":"text/plain","content":"{{msg}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"cb395e28-8a99-4765-967d-b3dbf6972e30","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"db9f721c-ae8f-4559-a3c8-83c5a0f1a146","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"db9f721c-ae8f-4559-a3c8-83c5a0f1a146","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2b2ed92c-0493-4472-a2f0-1b0fe0592186","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"61685ad9-bbba-4a79-b141-938779902b12","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b6fbea89-9880-45f1-bcb8-9431423e4dfc","typeOfStateId":"state","$connId":"con_483","$id":"99415175-09b4-4231-8ca0-c31c2e427096","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3d10a6d3-b1f9-485b-8188-c94ea74fabc1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msg\"","$invalid":false,"settings":{"function":"run","source":"function run(nrTransacao, dataTransacao, horarioTransacao, valorTransacao, quantidade) {\n\ttry {\n\t\tif (quantidade > 1) {\n\t\t\treturn `${nrTransacao}ª transação\n\nData: ${dataTransacao}\nHora: ${horarioTransacao}\nValor:R$${valorTransacao}`\n\t\t}\n\t\treturn `Data: ${dataTransacao}\nHora: ${horarioTransacao}\nValor: R$${valorTransacao}`\n\t} catch (e) {\n\t\treturn e.message;\n\t}\n\n}","inputVariables":["nrTransacao","dataTransacao","horarioTransacao","valorTransacao","quantidade"],"outputVariable":"msg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"58d65ccc-66dd-4ffb-ac44-e0dcdca2b8cc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Os dados da transação estão corretos?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"db1723b5-93a3-4233-b316-6e8850a0b127","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-12066371-045e-46c4-8501-1349ec2ea93d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3ad80430-0efc-4188-aa61-59610ef4ad7d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1df03f58-2277-4d95-90a1-89c5daae0c71","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"78dfeca4-2819-4b41-a6ca-281834d77a89","root":false,"$title":"[MS.7.2.4][MSG] Confirma transaçao","$position":{"top":"2891px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"faadc313-0a4d-4cd0-b4f1-95ff2c4027c8":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7b9a02bf-fcae-47e2-8560-0498b9504d1f","typeOfStateId":"state","$connId":"con_488","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6ad3712a-6572-49b8-ae69-3556be70638b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Wi-fi\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Venda Parcelada\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Device lock/security\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Terminal não configurado\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Ativar o som da senha\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"QR Code\"\n    },\n    {\n        \"id\": \"7\",\n        \"title\": \"Sem SIM Card\"\n    },\n    {\n        \"id\": \"8\",\n        \"title\": \"Venda por aproximação\"\n    },\n    {\n        \"id\": \"9\",\n        \"title\": \"Senha cancelamento\",\n        // \"description\": \"Cadastrar senha de cancelamento\"\n    },\n    {\n        \"id\": \"10\",\n        \"title\": \"Tamper Interruption\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `De que tipo de configuração?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1ae76a77-8d09-43a1-91bd-b85ecfb2d6ec","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"1499330e-d597-484e-8c60-b4dc5dac5794","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"4e36065f-30bb-4c43-92c3-6e088399e506","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-65ad49a3-1c3e-43a1-940d-f4fd1f1239b4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-96223d46-6cba-4a20-937a-3d95d4487b67","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-44ac26c7-fca9-45e8-ab6e-ba1a607cf24e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-1a4db9d8-0883-430e-a46d-bd7ebe19d296","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"faadc313-0a4d-4cd0-b4f1-95ff2c4027c8","root":false,"$title":"[MS.8.0.0][MSG] Menu Configurações","$position":{"top":"753px","left":"14555px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7b9a02bf-fcae-47e2-8560-0498b9504d1f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"06e838c6-506a-4218-ab86-691400ccd9f1","typeOfStateId":"state","$connId":"con_493","$id":"7b54cf8f-f025-4b1d-85fd-c2a83871caec","conditions":[{"source":"context","comparison":"equals","values":["Wi-fi"],"variable":"userInput"}],"$invalid":false},{"stateId":"e6ee92ea-dbc4-438e-bca7-7ed922c45ff6","typeOfStateId":"state","$connId":"con_498","$id":"447eafb9-eddc-4aec-83f9-840cbb58dae7","conditions":[{"source":"context","comparison":"equals","values":["Venda Parcelada"],"variable":"userInput"}],"$invalid":false},{"stateId":"0b29672c-d817-4b62-9949-ed97291bfc45","typeOfStateId":"state","$connId":"con_503","$id":"bc11eca8-1137-443e-aa48-ff65032ac040","conditions":[{"source":"context","comparison":"equals","values":["Device lock/security"],"variable":"userInput"}],"$invalid":false},{"stateId":"3ff3d066-d976-4502-bc8e-02f9751f4262","typeOfStateId":"state","$connId":"con_508","$id":"4702613c-b5e4-4674-9829-5d1bd6fcef2f","conditions":[{"source":"context","comparison":"equals","values":["Terminal não configurado"],"variable":"userInput"}],"$invalid":false},{"stateId":"b2242987-7cb8-43c3-aea0-bace4d12fed2","typeOfStateId":"state","$connId":"con_513","$id":"25bf24c6-676a-4e5e-8d5c-e4fb5d685d80","conditions":[{"source":"context","comparison":"equals","values":["Ativar o som da senha"],"variable":"userInput"}],"$invalid":false},{"stateId":"5f4cbb08-d885-49ac-98e1-be2385da8261","typeOfStateId":"state","$connId":"con_518","$id":"ca2228ae-6abe-4afb-8113-bbe653839536","conditions":[{"source":"context","comparison":"equals","values":["QR Code"],"variable":"userInput"}],"$invalid":false},{"stateId":"a7e4313e-7cbe-4041-8a76-6bdc16ea19de","typeOfStateId":"state","$connId":"con_523","$id":"3b9cb9c4-b92e-4475-b9c2-31a84465021f","conditions":[{"source":"context","comparison":"equals","values":["Sem SIM Card"],"variable":"userInput"}],"$invalid":false},{"stateId":"11f4bb15-03de-4faf-8559-823ff841ae4d","typeOfStateId":"state","$connId":"con_528","$id":"8ed6d8c3-160e-49ba-a57b-607b388375bd","conditions":[{"source":"context","comparison":"equals","values":["Venda por aproximação"],"variable":"userInput"}],"$invalid":false},{"stateId":"bfc3e239-79fc-47f9-b42e-edd37a453f99","typeOfStateId":"state","$connId":"con_533","$id":"22dd9c4b-0e70-4439-ba80-11b118d40b2b","conditions":[{"source":"context","comparison":"equals","values":["Senha cancelamento"],"variable":"userInput"}],"$invalid":false},{"stateId":"5eda88f3-1391-4839-bc30-77e98dcc1f00","typeOfStateId":"state","$connId":"con_538","$id":"af5f5f35-7133-4a57-a40b-b3d945df5304","conditions":[{"source":"context","comparison":"equals","values":["Tamper Interruption"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e450f31e-2e44-4f5c-ae00-a358f0fed5cc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c0a64fe4-94d6-40da-a813-4412f31e81a7","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8196164d-b193-4fc6-a80a-d3972075c7c2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9a947dcf-5653-494e-8e62-0de92134c20e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7b9a02bf-fcae-47e2-8560-0498b9504d1f","root":false,"$title":"[MS.8.0.0][INPUT] Menu Configurações","$position":{"top":"995px","left":"14555px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"06e838c6-506a-4218-ab86-691400ccd9f1":{"$contentActions":[{"action":{"$id":"c7edad80-a823-4cbe-abd7-bc2ef0651949","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ce6f34c8-0a1f-4878-ba7b-59857f70ae7b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"30c19dae-3ccc-47c4-ad87-9e0963682ef8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Configuração do Wi-Fi no POS:\n- Pressione o atalho 992.\n- Localize a rede Wi-Fi desejada.\n- Adicione a senha correta.\n\n2° Após a Configuração:\n- Verifique se a configuração foi realizada com êxito.\n- Realize uma venda teste para confirmar a conexão.","metadata":{}},"$cardContent":{"document":{"id":"e8d0e11a-281d-4ecc-a0e1-2b54d09c0b9b","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Configuração do Wi-Fi no POS:\n- Pressione o atalho 992.\n- Localize a rede Wi-Fi desejada.\n- Adicione a senha correta.\n\n2° Após a Configuração:\n- Verifique se a configuração foi realizada com êxito.\n- Realize uma venda teste para confirmar a conexão."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2441e21-f579-4d60-9ef6-a5d885b1b3de","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_543","$id":"0d6db342-ba40-4d06-8ee4-e9de0958593a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e96d8631-b830-4a2d-bea8-216b36747355","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-11686fcd-d088-4984-9894-d195710964fc","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bda74f28-3f6d-4f00-9306-ac00a9d62cab","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"06e838c6-506a-4218-ab86-691400ccd9f1","root":false,"$title":"[MS.8.1.0][MSG] Botao Configuração Wi-Fi","$position":{"top":"963.164px","left":"11432.9px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4ab87a03-9954-4336-a58a-9c4e8f66d4be":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"0b29672c-d817-4b62-9949-ed97291bfc45","typeOfStateId":"state","$connId":"con_548","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"c1842f3c-3273-4158-8b6d-9b1a5b7a86c7","typeOfStateId":"state","$connId":"con_553","$id":"7635d63c-55c1-4820-b71b-1815a3783cbd","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-32f116ec-ce1c-4cd3-9f5f-3dffd9e129ea","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-835e5162-745f-41bf-afe3-3f56bf623b58","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-a17466c4-d441-4e34-a96f-b28f1ee0b225","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1a01d2d3-8b2e-4fea-b426-3727d85eb7dc","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4ab87a03-9954-4336-a58a-9c4e8f66d4be","root":false,"$title":"[MS.8.2.0][INPUT] Seleciona modelo de maquina","$position":{"top":"1410px","left":"12090px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e6ee92ea-dbc4-438e-bca7-7ed922c45ff6":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4ab87a03-9954-4336-a58a-9c4e8f66d4be","typeOfStateId":"state","$connId":"con_558","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Link 2500\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"86bb7ce6-5451-40d9-90bc-57ce7432f9b2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1cbfe78d-2e25-4e12-a97a-bc3f7a845ad2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f0403832-bb95-44f9-bdf8-1f7e8a075b3d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8f521de7-ab56-4571-8dd0-609a2f946609","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e6ee92ea-dbc4-438e-bca7-7ed922c45ff6","root":false,"$title":"[MS.8.2.0][MSG] Seleciona modelo de maquina","$position":{"top":"1073.44px","left":"12090.8px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c1842f3c-3273-4158-8b6d-9b1a5b7a86c7":{"$contentActions":[{"action":{"$id":"c1047c8b-ccbc-4283-98c6-c12d7038044d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5fb68d4a-105d-44c4-9e4f-c6991094fdd3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5fb68d4a-105d-44c4-9e4f-c6991094fdd3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ad449fc9-9019-46c3-be50-8c8949b27d85","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bd568f5f-3abd-462f-8afc-22977929e905","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Informe o valor.\n\n3° Selecione a opção crédito.\n\n4° Escolha entre sem ou com juros.\n\n5° Utilize as teclas F2 e F3 para visualizar as demais parcelas.","metadata":{}},"$cardContent":{"document":{"id":"bd568f5f-3abd-462f-8afc-22977929e905","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Informe o valor.\n\n3° Selecione a opção crédito.\n\n4° Escolha entre sem ou com juros.\n\n5° Utilize as teclas F2 e F3 para visualizar as demais parcelas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"5bfd8fb0-0ec1-45dd-a4cf-6687a348a88f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_563","$id":"c4210371-58b1-4d31-94c6-c95838443d15","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6e1cccc7-f901-4890-b346-0051271776c8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-64aab92d-dd54-48aa-90e2-a4a8d29fcb48","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-383a6e50-c396-4886-a045-e04070b39b2c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c1842f3c-3273-4158-8b6d-9b1a5b7a86c7","root":false,"$title":"[MS.8.2.1][MSG] Venda parcelada","$position":{"top":"1635.25px","left":"12091.1px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0b29672c-d817-4b62-9949-ed97291bfc45":{"$contentActions":[{"action":{"$id":"361c2d4c-9f8d-4f00-96e0-1ed3cea0c0d0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a4592510-908e-4562-ae94-36eef0992e5d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a4592510-908e-4562-ae94-36eef0992e5d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e815d1f2-f468-4a95-bd66-47c7a0228450","$typeOfContent":"text","type":"SendMessage","settings":{"id":"585c9ff4-c092-4876-9316-77f50499a2c4","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"585c9ff4-c092-4876-9316-77f50499a2c4","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9fa6f88a-94f0-4283-9744-fd4c7db22cb5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0b29672c-d817-4b62-9949-ed97291bfc45","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1202px","left":"12437px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3ff3d066-d976-4502-bc8e-02f9751f4262":{"$contentActions":[{"action":{"$id":"7c2f36d6-241d-4cc1-9d11-198d38652dc5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"64f9ea7d-577a-4865-b46f-9dcbe4b55b27","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"64f9ea7d-577a-4865-b46f-9dcbe4b55b27","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"774fd5e4-11ad-4060-b018-e9516903da09","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b67ac3e4-23a2-4441-a1e0-7d045017f639","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n<b>Pressione o botão ativar.</b>\n\n<b>Ativou?</b>\n- Se sim, finalize.\n- Se não, conecte-se ao Wi-Fi.\n\n<b>Ativação concluída?</b>\n- Se sim, finalize.\n- Se não, pressione o atalho 2001 (Ativar).","metadata":{}},"$cardContent":{"document":{"id":"b67ac3e4-23a2-4441-a1e0-7d045017f639","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n<b>Pressione o botão ativar.</b>\n\n<b>Ativou?</b>\n- Se sim, finalize.\n- Se não, conecte-se ao Wi-Fi.\n\n<b>Ativação concluída?</b>\n- Se sim, finalize.\n- Se não, pressione o atalho 2001 (Ativar)."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fb06e4dd-e68b-494d-b52f-18f79f417768","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9bf09db0-b546-44ed-966d-e19e6062a4bb","typeOfStateId":"state","$connId":"con_568","$id":"08174c26-5abb-4d0f-8142-a433435aa7ce","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0e0d6f66-1c78-46d2-b2a0-add36767a2ec","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-121d8562-ec04-4f42-9ed6-06602b5da378","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a26f2331-9318-4a2c-b560-54385138ed05","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3ff3d066-d976-4502-bc8e-02f9751f4262","root":false,"$title":"[MS.8.4.0][MSG] Terminal não configurado","$position":{"top":"1285.5px","left":"13086px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b2242987-7cb8-43c3-aea0-bace4d12fed2":{"$contentActions":[{"action":{"$id":"a59614b4-1959-42a9-a265-5db8866420c1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c0b27a69-a797-4afc-9b39-8a71793e4200","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"098f0d1d-f6c3-4554-a9ff-353282a142cd","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57e10090-e9d8-464f-8d64-1c5ba3467798","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9b0b9616-6956-41d9-8986-a708750d932c","typeOfStateId":"state","$connId":"con_573","$id":"54e8b0b2-8b8b-4117-a6cb-ed35d3d497cb","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"77b20b89-9f2f-4c6f-b5bb-0ed7bfc92056","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"174200c2-0d56-49b2-9e20-b27c95e6404b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3764b072-e0ae-40b2-9692-45ff4c14767b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a6284dbd-e493-4776-bb96-2f573cd81199","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-416bdd3a-231f-4102-a28d-f03ec3d63205","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b2242987-7cb8-43c3-aea0-bace4d12fed2","root":false,"$title":"[MS.8.5.0][MSG] Seleciona modelo de maquina","$position":{"top":"1407px","left":"13443px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9b0b9616-6956-41d9-8986-a708750d932c":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"4edeb2bf-a95a-49d5-be21-0583b1cfb9df","typeOfStateId":"state","$connId":"con_578","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outra"],"variable":"userInput"}],"$invalid":false},{"stateId":"c06c20ea-f066-409e-aa82-dfaf6d1cc863","typeOfStateId":"state","$connId":"con_583","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"33a2e060-76b5-43c4-a266-837d0b111cd8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3e1cc359-daa2-4736-9464-461d4d88664c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fe0b9db-ccb4-473a-9fcc-3aceac41b17a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-09330933-71e9-46eb-a699-b7072d7480f1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a3be0152-3c2a-4582-8b81-1d9d7c39e258","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f9728746-a1ff-4691-aca2-009054e7fc00","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-02bc490d-9d75-47cf-87cc-dcd590803176","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9b0b9616-6956-41d9-8986-a708750d932c","root":false,"$title":"[MS.8.5.0][INPUT] Seleciona modelo de maquina","$position":{"top":"1630.62px","left":"13442.9px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4edeb2bf-a95a-49d5-be21-0583b1cfb9df":{"$contentActions":[{"action":{"$id":"41e27025-039d-4fd5-afe8-bbc94e560f4b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3e906932-c27c-404c-9a8f-83397b995cb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3e906932-c27c-404c-9a8f-83397b995cb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7f3740b9-7a8d-4ac1-90f4-9a4e31081e0f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ae38d347-29e2-43f0-b1c1-5b23ab84a454","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"ae38d347-29e2-43f0-b1c1-5b23ab84a454","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e447aee4-2719-48e9-9ebe-0b98c6bc929d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4edeb2bf-a95a-49d5-be21-0583b1cfb9df","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1641.69px","left":"13787.8px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c06c20ea-f066-409e-aa82-dfaf6d1cc863":{"$contentActions":[{"action":{"$id":"8e21f143-20b5-40f4-85b6-b707ae3732ef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b57687b0-386c-491f-abc2-d376f5e1155e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b57687b0-386c-491f-abc2-d376f5e1155e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"52b05e21-b561-4407-87c0-665470fd2066","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d052ca70-d1b6-48bf-873f-84db2400139d","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Coloque o valor.\n\n3° Quando aparecer a opção de colocar a senha, aumente ou diminua o volume usando os botões \"+\" e \"-\".","metadata":{}},"$cardContent":{"document":{"id":"d052ca70-d1b6-48bf-873f-84db2400139d","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Insira o cartão.\n\n2° Coloque o valor.\n\n3° Quando aparecer a opção de colocar a senha, aumente ou diminua o volume usando os botões \"+\" e \"-\"."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c0411a8a-b9d2-4ff1-9456-5c13e150f438","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_588","$id":"78700bd4-c3e7-4b8d-8fc9-af078265e460","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0e1057f1-1fa6-488a-99ce-b64fb930f053","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-be05625e-abad-4b9b-bd8a-8a592458ba16","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a4f622a3-f461-40d3-8a35-e030ed180f5c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c06c20ea-f066-409e-aa82-dfaf6d1cc863","root":false,"$title":"[MS.8.5.1] Ativar o som da senha","$position":{"top":"1954px","left":"13442.6px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5f4cbb08-d885-49ac-98e1-be2385da8261":{"$contentActions":[{"action":{"$id":"374fe35f-ec45-4cc1-a18e-db50a7a503d1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d2b46a92-a316-445d-b152-0f0081ec6edd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d2b46a92-a316-445d-b152-0f0081ec6edd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"61c104ab-84a8-4dfb-8417-14a8c88ba4d9","$typeOfContent":"text","type":"SendMessage","settings":{"id":"406907e4-509b-419c-9ca7-c71284fa6c62","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste.","metadata":{}},"$cardContent":{"document":{"id":"406907e4-509b-419c-9ca7-c71284fa6c62","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"04302724-1c6f-4d5c-a951-ccdb2090b010","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3dcf0ada-ed0f-4004-b236-93f4a91fb304","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3dcf0ada-ed0f-4004-b236-93f4a91fb304","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"eaf1037f-96eb-4317-8f24-f6fca38f771b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4c89fc77-396c-40d4-b006-6410a6f12e19","type":"text/plain","content":"<b>Importante</b>\nVendas por QR Code débito e crédito, somente com o cartão de bandeira ELO.","metadata":{}},"$cardContent":{"document":{"id":"4c89fc77-396c-40d4-b006-6410a6f12e19","type":"text/plain","content":"<b>Importante</b>\nVendas por QR Code débito e crédito, somente com o cartão de bandeira ELO."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4bb527e7-9943-4098-a917-2cc543de4d59","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_593","$id":"d6e934fe-7667-4650-9015-664aca19e125","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"2f4c7ecd-3cb6-45da-a6e2-27c6bbda8ac2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3314f48c-f687-4e24-bd34-5ca56955dc4c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0883fbca-78bc-4d54-a6ec-e6e63934c613","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5f4cbb08-d885-49ac-98e1-be2385da8261","root":false,"$title":"[MS.8.6.0][MSG] QR Code","$position":{"top":"2099px","left":"14157px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a7e4313e-7cbe-4041-8a76-6bdc16ea19de":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0a026452-b1e2-4eb7-839a-874f6dc07d26","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste.","metadata":{}},"$cardContent":{"document":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 995.\n\n2° Pressione o atalho 993.\n\n3° Realize uma venda teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8c80961f-3443-4e58-8f55-c676db2aae66","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"999e316e-696e-4702-a95e-ceeacd887099","typeOfStateId":"state","$connId":"con_598","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"62c146b6-a638-438e-bf6f-1f12fc4db044","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2d1dd0f1-a78f-42ba-86ce-ad0c753965ab","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-38542ae0-6613-4344-a9f1-fcabe6cf0610","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a95e8468-92b7-44ae-93e5-ea241eb4abf4","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a7e4313e-7cbe-4041-8a76-6bdc16ea19de","root":false,"$title":"[MS.8.7.0][MSG] Sem SIM Card","$position":{"top":"1770.38px","left":"14584.2px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"999e316e-696e-4702-a95e-ceeacd887099":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1","typeOfStateId":"state","$connId":"con_603","$id":"02182c79-f3c9-4b94-8878-5dcdbe74d809","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d5d2cccc-aa01-4b4e-b66d-a08672a6e228","typeOfStateId":"state","$connId":"con_608","$id":"9ce82690-4bdd-4f3b-81aa-c0e81acb579c","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ad01d54b-8ca0-466c-881d-35f730c5e0f1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"2ee040e0-fc8b-46f2-a882-df5a2ac7a5e3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-baa382a3-be4d-4c1b-822b-17c128423686","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-47a0b522-5d4c-4302-bde1-711f1b62fe3f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-40753a4f-9e75-4b91-b9d6-1ecef2a432dd","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"999e316e-696e-4702-a95e-ceeacd887099","root":false,"$title":"[MS.8.7.0][INPUT] Sem SIM Card","$position":{"top":"2195px","left":"14584px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5a5d6d96-c921-4e51-9d3b-5dbbb69acb28","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1","root":false,"$title":"[GO TO] Finalização","$position":{"top":"2206.31px","left":"15015.8px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d5d2cccc-aa01-4b4e-b66d-a08672a6e228":{"$contentActions":[{"action":{"$id":"05a50a75-a02c-4987-985e-7fa53d8f4800","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e256fc49-f950-43a0-8bba-4f61da9eed16","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e256fc49-f950-43a0-8bba-4f61da9eed16","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0853eead-d27a-41ef-a760-614c58f04ed8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"94e0ba72-b752-4469-b093-4262025b1170","type":"text/plain","content":"Neste caso, realize o teste de comunicação.\n\nPara isso, pressione o atalho 9973.","metadata":{}},"$cardContent":{"document":{"id":"94e0ba72-b752-4469-b093-4262025b1170","type":"text/plain","content":"Neste caso, realize o teste de comunicação.\n\nPara isso, pressione o atalho 9973."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"110a4ce0-b82a-4ea7-8f3f-81c5cd4bac8b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"48fe2065-65c7-4601-b47d-6222ad48b7dd","typeOfStateId":"state","$connId":"con_613","$id":"7e19bddf-a275-4ef8-8fb3-9f4910a9adce","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6503d109-a055-4475-8ea5-dd8f2ed240d5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-67099460-3186-4457-8003-32f8f09743be","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6cd2a1a2-c005-43ef-8e07-176f365da9f9","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d5d2cccc-aa01-4b4e-b66d-a08672a6e228","root":false,"$title":"[MS.8.7.1][MSG] Sem Sim Card (Não deu certo)","$position":{"top":"2563px","left":"14584px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ee74906b-a573-4319-bb46-b76351bc8cb3":{"$contentActions":[{"action":{"$id":"60e9c4fb-7e3a-43db-bb0b-182c5cf99c65","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"db6e0b73-b6d9-456b-915e-77d64977ebb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"db6e0b73-b6d9-456b-915e-77d64977ebb2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"faee21fa-1815-4fcf-bc64-7de2f7727a2e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"5032b63b-5ca0-4e06-9a37-6d1c86a9ad9c","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\n1° Pressione o atalho 990.\n\n2º Selecione “apagar todos os arquivos”.\n\n3º confirme com “sim”.","metadata":{}},"$cardContent":{"document":{"id":"5032b63b-5ca0-4e06-9a37-6d1c86a9ad9c","type":"text/plain","content":"Neste caso, realize o teste de aplicação com problemas.\n\n1° Pressione o atalho 990.\n\n2º Selecione “apagar todos os arquivos”.\n\n3º confirme com “sim”."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fd75952d-b225-480d-a3d9-3d9650e3a71b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","typeOfStateId":"state","$connId":"con_618","$id":"ca9ba732-eee9-4e7c-a39a-470df975b2b3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"60a75d97-a62b-42d2-8471-d0c4be436ae5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-be1d50c7-fefb-4660-966c-f22741fce3a4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1d5d504e-3285-4029-a232-932408c326aa","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ee74906b-a573-4319-bb46-b76351bc8cb3","root":false,"$title":"[MS.8.8.1] Venda por aproximação (não deu certo)","$position":{"top":"2470px","left":"15492px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"11f4bb15-03de-4faf-8559-823ff841ae4d":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0a026452-b1e2-4eb7-839a-874f6dc07d26","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Digite o valor.\n\n2° Selecione uma opção: débito ou crédito.\n\n3° Aproxime o cartão.","metadata":{}},"$cardContent":{"document":{"id":"3af3fc55-cdc9-4adb-816a-05ce39c762a3","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Digite o valor.\n\n2° Selecione uma opção: débito ou crédito.\n\n3° Aproxime o cartão."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8c80961f-3443-4e58-8f55-c676db2aae66","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"95696603-89eb-4c89-b92a-a416687ae802","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3e641b5e-d55e-4bc1-b0bd-bac9422b5c76","typeOfStateId":"state","$connId":"con_623","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O problema foi resolvido?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6ee57d62-6c6d-42a6-afc0-77af1a565bf6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f8e9655d-ac8d-4c84-ad20-f4183c41672e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-aa189ae5-d101-4462-b9ef-141ad3ed4852","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5e152526-a602-4bda-b68d-7bdef415f19c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"11f4bb15-03de-4faf-8559-823ff841ae4d","root":false,"$title":"[MS.8.8.0][MSG] Venda por aproximação","$position":{"top":"1475.56px","left":"15492px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3e641b5e-d55e-4bc1-b0bd-bac9422b5c76":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"992fa2b7-8c2d-45c8-923e-69eb2f9db3d1","typeOfStateId":"state","$connId":"con_628","$id":"02182c79-f3c9-4b94-8878-5dcdbe74d809","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"ee74906b-a573-4319-bb46-b76351bc8cb3","typeOfStateId":"state","$connId":"con_633","$id":"9ce82690-4bdd-4f3b-81aa-c0e81acb579c","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2b016e19-7978-469a-b8fd-edf8e73a149d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"2c7b9808-c8bf-4b33-82ce-4d5c14f1bbfd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-55af4636-31ef-4d68-9450-bb95903a143d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-52862c7f-08b4-4a82-8472-3ec411fe498f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2cdbd003-e79f-4eff-870b-094d194d4f3a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3e641b5e-d55e-4bc1-b0bd-bac9422b5c76","root":false,"$title":"[MS.8.8.0][INPUT] Venda por aproximação","$position":{"top":"2182.5px","left":"15492px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bfc3e239-79fc-47f9-b42e-edd37a453f99":{"$contentActions":[{"action":{"$id":"af56ecb3-99b0-4ada-835f-a1bd261a468a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5b3d42de-eace-4958-bd41-7e27de0d80ec","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5b3d42de-eace-4958-bd41-7e27de0d80ec","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d8e7df4c-2ad0-4912-ae4b-cc68ae9c04de","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a05fe95a-cf53-471f-b1e5-2e5ff3625d5c","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 921.\n\n2° Duas mensagens podem aparecer:\n- Senha não cadastrada\n- Digite sua senha\n\n3° Para cadastrar sua senha:\n- Digite os 4 primeiros dígitos do CNPJ/CPF e confirme na tecla verde.\n- Digite o CEP do estabelecimento.\n- Cadastre uma nova senha de 4 dígitos, evitando números sequenciais ou repetidos.\n- Finalize o processo.","metadata":{}},"$cardContent":{"document":{"id":"a05fe95a-cf53-471f-b1e5-2e5ff3625d5c","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione o atalho 921.\n\n2° Duas mensagens podem aparecer:\n- Senha não cadastrada\n- Digite sua senha\n\n3° Para cadastrar sua senha:\n- Digite os 4 primeiros dígitos do CNPJ/CPF e confirme na tecla verde.\n- Digite o CEP do estabelecimento.\n- Cadastre uma nova senha de 4 dígitos, evitando números sequenciais ou repetidos.\n- Finalize o processo."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b33dfddd-f1d4-43bd-8175-f7c7083ab3fc","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","typeOfStateId":"state","$connId":"con_638","$id":"e33170eb-ec65-4215-93fa-4175d5d81ac3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"a64d2b20-585a-4705-8d29-2c17808c6198","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-32f31c59-2e0a-49f0-9980-c5e0e096f326","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ededd8e4-f8ad-4e0c-971e-ee80c9294efe","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bfc3e239-79fc-47f9-b42e-edd37a453f99","root":false,"$title":"[MS.8.9.0] Senha Cancelamento","$position":{"top":"1380.45px","left":"15892.1px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5eda88f3-1391-4839-bc30-77e98dcc1f00":{"$contentActions":[{"action":{"$id":"03e61454-3a73-487f-bf63-b8d1aa7ccbf9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f5a75f26-561c-44bf-9cf4-b450659c6423","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f5a75f26-561c-44bf-9cf4-b450659c6423","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"82dab2e4-55d2-46a9-ba40-6bf8060805e0","$typeOfContent":"text","type":"SendMessage","settings":{"id":"81348e18-fbf2-4049-9ab3-66bf1c2959d4","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o equipamento.","metadata":{}},"$cardContent":{"document":{"id":"81348e18-fbf2-4049-9ab3-66bf1c2959d4","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Retire a bateria.\n\n2° Aguarde 30 segundos.\n\n3° Conecte a bateria novamente.\n\n4° Ligue o equipamento."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"71ca5443-b934-48a2-837c-397ce02c7028","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","typeOfStateId":"state","$connId":"con_643","$id":"45b520f1-5b21-49b6-8d94-e8d8378d0dde","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"afcd392e-6ff3-4ebf-a1cc-29245c471c7c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fd3c7550-5295-4a44-8bc9-412094efc9b3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0a4b54cc-b318-40e2-b253-e253db603a1b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5eda88f3-1391-4839-bc30-77e98dcc1f00","root":false,"$title":"[MS.8.10.0] Tamper Interruption","$position":{"top":"1202.81px","left":"16153.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a37832a1-3f3b-4ed4-8765-9bdffb110d80","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"59b97d0a-0d4a-4a78-ba6f-54f694d91a2f","root":false,"$title":"[GO TO][MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2479.5px","left":"16043px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3247102c-1355-4dde-b9b2-ad167274fd3c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"87ad707f-271a-4f0c-900d-f146266e9450","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"5fad1cb3-48f6-47ce-8ee8-4df8ad91c6e7","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"nrTransacao\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(quantidade, nrTransacao) {\n\ttry {\n\t\tlet parsedNumber = Number(nrTransacao)\n\t\treturn parsedNumber + 1\n\t} catch (err) {\n\t\treturn '1'\n\t}\n}","inputVariables":["quantidade","nrTransacao"],"outputVariable":"nrTransacao","LocalTimeZoneEnabled":false},"conditions":[{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"26b33e50-abbf-4cc6-ae1f-66301c4171e1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"quantidade\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(quantidade) {\n\tlet parsedQuantidade = Number(quantidade)\n\treturn parsedQuantidade - 1\n}","inputVariables":["quantidade"],"outputVariable":"quantidade","LocalTimeZoneEnabled":false},"conditions":[{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"3593c8c2-fa9c-4d1b-80c1-6cd30a9d2562","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-105956e1-aa2c-4272-b025-8a656870248a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"3247102c-1355-4dde-b9b2-ad167274fd3c","root":false,"$title":"[GO TO][MS.7.2.4] Data das transações","$position":{"top":"3150px","left":"3880px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b6fbea89-9880-45f1-bcb8-9431423e4dfc":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a400ddf2-fa79-4b2c-ab83-65eec2376bb4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3247102c-1355-4dde-b9b2-ad167274fd3c","typeOfStateId":"state","$connId":"con_648","$id":"0af7353f-9682-42d8-9a9a-e4fefc7c830f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"},{"values":["1"],"source":"context","comparison":"greaterThan","variable":"quantidade"}],"$invalid":false},{"stateId":"3247102c-1355-4dde-b9b2-ad167274fd3c","typeOfStateId":"state","$connId":"con_653","$id":"26a60b62-11a5-433a-bb32-823e9abf83f8","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false},{"stateId":"1f53a2ba-b515-46bf-a6cd-ab2a4a18420c","typeOfStateId":"state","$connId":"con_658","$id":"b3f7c3d1-fb79-43db-8dc3-9ba449913a51","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8725cef0-f51b-4331-9810-bf295f7e5fcb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"si[mn]?|confirm[ao]|continu[ae](r)?\": \"Sim\",\n      \"n[aã]o|encerra(r)?|finaliza|sai(r)?\": \"Não\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6cd6f1dc-eb02-48a9-a406-96b1ee327899","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"19d870e4-e36b-43af-a3be-f2ea5b19ce81","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"transacoesNaoAutorizadas\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(transacoesNaoAutorizadas, dataTransacao, horarioTransacao, valorTransacao, nrTransacao, debitoMotivo, motivo, quantidade, contaSelecionada, identity) {\n\ttry {\n\t\tconst { doc } = JSON.parse(contaSelecionada)\n\t\tconst phone = identity.split('@')[0]\n\t\tif (!transacoesNaoAutorizadas) {\n\t\t\treturn `Criação automática WhatsApp PJ: Telefone: ${phone} CPF/CNPJ: ${doc} Motivo: ${motivo} ${debitoMotivo || ''} | Transação: ${nrTransacao} Data: ${dataTransacao} Horario: ${horarioTransacao} Valor: ${valorTransacao}`\n\t\t}\n\t\treturn transacoesNaoAutorizadas += ` | Transação: ${nrTransacao} Data: ${dataTransacao} Horario: ${horarioTransacao} Valor: ${valorTransacao}`\n\t} catch (err) {\n\t\tif (transacoesNaoAutorizadas) {\n\t\t\treturn transacoesNaoAutorizadas\n\t\t}\n\t\treturn `Criação automática WhatsApp PJ: Telefone: ${phone} CPF/CNPJ: ${doc} Motivo: ${motivo} ${debitoMotivo || \"\"} | Transação: ${nrTransacao} Data: ${dataTransacao} Horario: ${horarioTransacao} Valor: ${valorTransacao}`\n\t}\n}","inputVariables":["transacoesNaoAutorizadas","dataTransacao","horarioTransacao","valorTransacao","nrTransacao","debitoMotivo","motivo","quantidade","contaSelecionada","contact.identity"],"outputVariable":"transacoesNaoAutorizadas","LocalTimeZoneEnabled":false},"conditions":[{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"2c57e396-68e4-4c55-9251-92dfb8052d10","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"e683abdf-b128-4b62-8b4d-84ac44e172b8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cd58ea46-8e22-4144-99c1-656ab228ec96","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2bf8fa2e-4ee2-4254-a32b-71565f5c7b4b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-7b7bdc15-ea9d-4d64-9d9d-b63e6c696f4f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5c9e785a-5e11-4ff7-b20c-29b56f52bf5b","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b6fbea89-9880-45f1-bcb8-9431423e4dfc","root":false,"$title":"[MS.7.2.4][INPUT] Confirma transação","$position":{"top":"3150px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7eaa4922-911f-469d-be60-ea0ebb25000d":{"$contentActions":[{"action":{"$id":"22dcc13b-98e5-4bbf-97fc-8b1a665106e7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"01831fd0-2581-4170-bd53-2725f868ec18","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"01831fd0-2581-4170-bd53-2725f868ec18","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8ababea9-4e47-41e5-a34a-1aac24533d6e","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"13e40b3d-fa46-4cec-90b7-cbe5b9456243","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e225d922-1307-429f-9d34-d00bee21cc4e","typeOfStateId":"state","$connId":"con_663","$id":"59b3caff-a159-49cc-8fd7-ae56d8818680","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"7bb7719f-81d3-41f1-85c3-f498def8e3ee","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"9d5c9138-62b8-472c-b488-e1842ee341cd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions =  [\n    {\n        \"id\": \"1\",\n        \"title\": \"Leitura do cartão\",\n        \"description\": \"Erro na leitura do cartão\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Acessar arquivo\",\n        \"description\": \"Erro ao acessar arquivo\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Ethernet\",\n        \"description\": \"Erro de comunicação Ethernet\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Discado\",\n        \"description\": \"Erro de comunicação discado\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Torre de celular com X\",\n        \"description\": \"Problemas com a torre de celular\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"Erro desfazimento\",\n        \"description\": \"Erro ao cancelar venda\"\n    },\n    {\n        \"id\": \"7\",\n        \"title\": \"Códigos de erro\",\n        \"description\": \"3-050, 3-051, 3-052,3-50,3-51 e 3-52\"\n    },\n    {\n        \"id\": \"8\",\n        \"title\": \"Atalhos\",\n        \"description\": \"Lista de atalhos da sua máquina\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (permissoes.includes(permissoesNecessarias)) {\n        return\n    }\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        // const { ec } = JSON.parse(contaSelecionada)\n\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Você pode escolher uma opção ou digitar o que precisa, exemplo: *erro de comunicação.*`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"991e81cb-67cc-4bb1-aa88-ef7fecdc9aa4","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"6758f485-4584-479c-984c-3bf87e0ed0e4","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"0c7c5b66-c9d3-45fa-a055-d7633f24ab4c","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ef690164-8388-465e-ae59-0066770457cb","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-faf9ebe8-0c66-466f-8c8a-ef8097a4eba2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d9436bfc-02e1-4770-8524-d215b4c4a0df","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2477a6a6-64a7-4172-8538-75cbc2527c7d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7eaa4922-911f-469d-be60-ea0ebb25000d","root":false,"$title":"[MS.9.0.0][MSG] Menu Erros gerais","$position":{"top":"466px","left":"18673px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e225d922-1307-429f-9d34-d00bee21cc4e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"119bc7af-626d-44b3-9d63-4b262d5bd1bf","typeOfStateId":"state","$connId":"con_668","$id":"c7e70c64-4804-423d-8638-6a50a32a14b7","conditions":[{"source":"context","comparison":"equals","values":["Leitura do cartão"],"variable":"userInput"}],"$invalid":false},{"stateId":"848cebf5-0310-456a-95b0-0b2d4e5ae559","typeOfStateId":"state","$connId":"con_673","$id":"973b38d2-8dc8-42f8-a4bb-fd36f0a72f0f","conditions":[{"source":"context","comparison":"equals","values":["Acessar arquivo"],"variable":"userInput"}],"$invalid":false},{"stateId":"a0f4b4ef-0b45-4ffb-926e-d0d174420f34","typeOfStateId":"state","$connId":"con_678","$id":"28cbacd6-1c5c-45ba-8d1b-ef681ae4350d","conditions":[{"source":"context","comparison":"equals","values":["Ethernet"],"variable":"userInput"}],"$invalid":false},{"stateId":"65abd5f9-1bec-4b5b-8688-1efa12a63cc6","typeOfStateId":"state","$connId":"con_683","$id":"14980075-0e86-459f-a025-8ab8d80c4ea1","conditions":[{"source":"context","comparison":"equals","values":["Discado"],"variable":"userInput"}],"$invalid":false},{"stateId":"9358d504-8ea3-4711-9e34-4ed1b5978d61","typeOfStateId":"state","$connId":"con_688","$id":"16d35930-06a0-43f7-abf4-30772e33c7c8","conditions":[{"source":"context","comparison":"equals","values":["Torre de celular com X"],"variable":"userInput"}],"$invalid":false},{"stateId":"25cca5a7-86d4-4fdc-8365-7a0c5fb621e6","typeOfStateId":"state","$connId":"con_693","$id":"0ac2d79b-20e6-400a-a33e-ca4a97632686","conditions":[{"source":"context","comparison":"equals","values":["Erro desfazimento"],"variable":"userInput"}],"$invalid":false},{"stateId":"47c6e908-5e18-4f58-b4f2-9d29613f7e6d","typeOfStateId":"state","$connId":"con_698","$id":"3558246f-54cd-4aba-9b93-5b0d46916191","conditions":[{"source":"context","comparison":"equals","values":["Códigos de erro"],"variable":"userInput"}],"$invalid":false},{"stateId":"0d4f7110-4dfd-429a-a88a-cedec3b42217","typeOfStateId":"state","$connId":"con_703","$id":"e2aa8979-ee55-434b-a31b-b52c0e92d903","conditions":[{"source":"context","comparison":"equals","values":["Atalhos"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n\nfunction run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"e0beb31e-054f-4dc2-b737-09060d5b862e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"cc06cae1-6788-4f87-b094-d23fe76c196f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-09f4eebf-b63e-49e0-b9e3-838b71149469","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8be49f74-bb86-490c-801c-62eb3e5cab33","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e459f8ac-4097-42d3-896f-23cf89d9fe31","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f58c312c-ebe5-4cc1-851e-d2e6c9c327dd","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e225d922-1307-429f-9d34-d00bee21cc4e","root":false,"$title":"[MS.9.0.0][INPUT] Menu Erros gerais","$position":{"top":"689px","left":"18673px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"119bc7af-626d-44b3-9d63-4b262d5bd1bf":{"$contentActions":[{"action":{"$id":"77336a48-d4a3-408b-b09d-2d5d3430d42d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"04b8c027-f98d-43d1-b716-eeba77f2076d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"04b8c027-f98d-43d1-b716-eeba77f2076d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d8a8df90-3a15-4873-bfcf-79a8e557cbb2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bfeab220-a218-4112-b319-52661e32ad3d","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (Selecione \"Sim\").\n\n5° Ative o terminal novamente.\n\n6° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"bfeab220-a218-4112-b319-52661e32ad3d","type":"text/plain","content":"Vou te pedir para fazer o seguinte: \n\n1° Pressione o atalho 995.\n\n2° Solicite a retirada do relatório de vendas.\n\n3° Pressione o atalho 990.\n\n4° Apague todos os arquivos de dados (Selecione \"Sim\").\n\n5° Ative o terminal novamente.\n\n6° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2516fc56-a65a-4d48-b4aa-b4bec0b3a665","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"bd347b5e-efc6-46d6-b70f-f2b20113bdd3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"91b981f6-b405-4401-b80f-1a0229bad7aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"91b981f6-b405-4401-b80f-1a0229bad7aa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"62351bb7-2a04-4870-8545-31112cece2c5","typeOfStateId":"state","$connId":"con_708","$id":"d56848db-49a1-4048-b7b0-01cae7262e73","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0cd9d5e4-36e5-4c90-b460-d098d8733087","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-08319472-829f-4707-8831-527d10eb0289","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d27ca6b9-aa10-42be-adbc-ec386b069f0b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"119bc7af-626d-44b3-9d63-4b262d5bd1bf","root":false,"$title":"[MS.9.6.0][MSG] Informativo Leitura do cartão","$position":{"top":"1310px","left":"17679px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"848cebf5-0310-456a-95b0-0b2d4e5ae559":{"$contentActions":[{"action":{"$id":"149fd961-9c13-47ad-89a5-946382d994ed","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f87670e8-185b-43b6-bc6a-1cc4d5196bc4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f87670e8-185b-43b6-bc6a-1cc4d5196bc4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d229ec85-c756-4813-b783-824a07145279","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6f59b944-2e96-42e6-8d02-663706c6220c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7f64f93d-914a-45fc-9c38-15eafc970ed6","typeOfStateId":"state","$connId":"con_713","$id":"774b09cb-2bc5-4270-966e-af6a40392c01","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"65e01ca8-da38-446c-93e8-ea45bc03efaf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3bec231f-13ca-467e-9c30-067b845652b0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a905fbad-d47a-462e-90ed-bf08ae076b75","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fb67156b-1976-4b93-9a25-ef7056ff3b53","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6d0f1374-f32e-4809-9ddb-c7754724e70c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"848cebf5-0310-456a-95b0-0b2d4e5ae559","root":false,"$title":"[MS.9.5.0][MSG] Menu Acessar arquivo","$position":{"top":"1321px","left":"18290px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a0f4b4ef-0b45-4ffb-926e-d0d174420f34":{"$contentActions":[{"action":{"$id":"96b65530-b74d-473c-adcc-c0c9572f83d7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0944dbce-bcb1-46af-b47d-b249459c328a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0944dbce-bcb1-46af-b47d-b249459c328a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"48647a94-48d5-4388-8dec-ae0ade8b38c6","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"34e7e277-e9d8-4d09-954a-5cecaef46b3a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3c3398a1-0b05-4599-9fbe-422d5796e9b4","typeOfStateId":"state","$connId":"con_718","$id":"1e201fa9-e53b-4d9b-86cd-e458492ec021","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bbc7cb49-de43-4ff7-a7fe-df7135256805","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"POS fixo\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4d56f672-2cca-4cb2-98d7-03ba50c2aac2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ab1b27e2-3c0a-481e-874e-13222a94478f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3f2701bf-13b8-46ad-8e94-1087015e566c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-af6f8a91-61cf-443e-8f97-442b99c50dbb","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a0f4b4ef-0b45-4ffb-926e-d0d174420f34","root":false,"$title":"[MS.9.4.0][MSG] Menu Ethernet","$position":{"top":"1331px","left":"18703px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"65abd5f9-1bec-4b5b-8688-1efa12a63cc6":{"$contentActions":[{"action":{"$id":"06834a9b-f14e-404c-a5ad-1a57294c0eac","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bdb10b36-e0c9-4ad8-b8c9-6be4dc7eec5a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bdb10b36-e0c9-4ad8-b8c9-6be4dc7eec5a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4b2295ae-6f1d-4392-bc0d-72dbb7dbc9e9","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2d0aac25-d49c-4932-9126-fc414fdaef75","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"71994ba1-b762-4b94-b3fd-aa615e4f5be6","typeOfStateId":"state","$connId":"con_723","$id":"1da66945-cc74-4e34-b7a1-b0a5ff66e396","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"08f16855-6814-4e17-94df-4f597c5e767d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"POS fixo\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ce01e544-397d-47f6-93b7-077a1afe9e13","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-814b35ba-41b2-41b6-88e8-c6e67ffb48b8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a3f710b2-0b1e-45b2-a8cb-38c066140c9c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9ea23240-c2e7-4ddc-ad6d-f6b2ec5402ac","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"65abd5f9-1bec-4b5b-8688-1efa12a63cc6","root":false,"$title":"[MS.9.3.0][MSG] Menu Discado","$position":{"top":"1374px","left":"19469px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9358d504-8ea3-4711-9e34-4ed1b5978d61":{"$contentActions":[{"action":{"$id":"f4bb5296-4030-4f47-b3d3-128ded0645b4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fa35c691-25b2-4f63-851d-6980deabd20a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fa35c691-25b2-4f63-851d-6980deabd20a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"cad60d92-9818-4708-88e9-b57433e28998","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e0c9a8af-9b75-40df-ba58-f44fbfebd980","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"fa590f70-d5a2-4829-ba75-1b1f379d2ef8","typeOfStateId":"state","$connId":"con_728","$id":"8d43a7f0-7fc9-45c7-b269-b64ccfdc08de","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"46147313-9d63-464a-83f6-aa33cbf2e163","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"d7e3cc3f-cb4b-43b3-8f17-7185ef65f15c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Smart\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Outro modelo\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Entendi, e qual é o modelo da sua máquina?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d4e98ecd-7952-4db7-a662-b340f89d47aa","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-79996ad7-ee23-44da-8efe-22ede9632748","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-36161b2d-1af6-455a-8879-d49504c51eb2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9358d504-8ea3-4711-9e34-4ed1b5978d61","root":false,"$title":"[MS.9.2.0][MSG] Menu Torre de celular com X","$position":{"top":"1364px","left":"19823px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"25cca5a7-86d4-4fdc-8365-7a0c5fb621e6":{"$contentActions":[{"action":{"$id":"09d5e6dc-254d-4dc8-bc2d-11eeb7180004","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d113787a-6ef9-4971-98f9-d84bff005672","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d113787a-6ef9-4971-98f9-d84bff005672","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a4acbd7d-6f10-40e0-a2b7-469f6ff3ba31","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b4bbf748-1e14-447d-a070-a5e14ff31bb9","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ace3440e-4fba-4fe7-ac92-302202b38274","typeOfStateId":"state","$connId":"con_733","$id":"518434b4-d90a-4f82-8c88-bb5506311e8b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"cf24c171-f3ab-4cf9-bad0-070e48bfc339","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"9f765c68-0f7b-49d8-9ec5-10608fd8458c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Você possui *OS de desinstalação* em aberto?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3d67f619-d59c-4f34-ba37-902d63e54e96","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-06922ff7-eb36-4eae-b3e3-195f681669b9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4d1805e3-f18c-4e9a-8800-52561eb100bf","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"25cca5a7-86d4-4fdc-8365-7a0c5fb621e6","root":false,"$title":"[MS.9.1.0][MSG] Menu Erro desfazimento","$position":{"top":"1363px","left":"20562px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"62351bb7-2a04-4870-8545-31112cece2c5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"62351bb7-2a04-4870-8545-31112cece2c5","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"1825.48px","left":"17388.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"7f64f93d-914a-45fc-9c38-15eafc970ed6":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c8b02012-8d08-4154-81fc-c2138fed71c5","typeOfStateId":"state","$connId":"con_738","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"8ea6dad9-5026-46da-b3c4-c351fe56ab19","typeOfStateId":"state","$connId":"con_743","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Smart"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"cce8ed82-b220-4dd9-b77b-709d41a78ff1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"776b8c60-4d47-4c2c-bc4a-2ee573fa793d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"16df5799-7765-4307-991a-ade4f52e7e22","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"08517b9b-09d3-46e4-9d28-54c4caf0ce18","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e3a119fa-d588-46a9-9d22-10e6e56114a6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6f2314c5-35a2-4547-8fa9-f30bfd63fb52","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ed7a90d0-d9fc-4bcc-ad09-f3efa06920df","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a29e8921-33a1-46eb-b1db-bf5f32b32583","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7f64f93d-914a-45fc-9c38-15eafc970ed6","root":false,"$title":"[MS.9.5.0][INPUT] Menu Acessar arquivo","$position":{"top":"1573px","left":"18290px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c8b02012-8d08-4154-81fc-c2138fed71c5":{"$contentActions":[{"action":{"$id":"ddc1ccb8-370b-4b96-b023-ef062a8c5954","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ec68cd12-6a93-4e5e-b6c8-4960d24c45e5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ec68cd12-6a93-4e5e-b6c8-4960d24c45e5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9bf944e9-7da4-4b8a-a3b2-5f11643d0d70","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4e75fc64-9e1b-4213-b723-adca8f4e03d0","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"4e75fc64-9e1b-4213-b723-adca8f4e03d0","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-573603b6-8d14-4276-9329-99db4b30063e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c8b02012-8d08-4154-81fc-c2138fed71c5","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1957px","left":"18473px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"8ea6dad9-5026-46da-b3c4-c351fe56ab19":{"$contentActions":[{"action":{"$id":"8de07203-cb7f-4e6f-ab9d-b789ccd0499c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6a32dea3-fc9b-44d7-8564-e0366d7776e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6a32dea3-fc9b-44d7-8564-e0366d7776e9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"93d880cc-d2a4-43f9-8b5d-f9430ed0f40d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"433ef16e-dc38-476e-9a29-39a882d068ee","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione menu.\n\n2° Clique no símbolo da engrenagem.\n\n3° Digite a senha 1: 2001.\n\n4° Digite a senha 2: 260089.\n\n5° Acesse o menu app.\n\n6° Selecione Safra.\n\n7° Clique em Clear Data.\n\n8° Confirme com ok.\n\n9° Agora, reinicie e tente novamente.","metadata":{}},"$cardContent":{"document":{"id":"433ef16e-dc38-476e-9a29-39a882d068ee","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione menu.\n\n2° Clique no símbolo da engrenagem.\n\n3° Digite a senha 1: 2001.\n\n4° Digite a senha 2: 260089.\n\n5° Acesse o menu app.\n\n6° Selecione Safra.\n\n7° Clique em Clear Data.\n\n8° Confirme com ok.\n\n9° Agora, reinicie e tente novamente."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"35e68089-a26b-41bc-ba31-cc8ecb4d6a1e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"bbce0379-c441-4a6b-ab3a-dc9e82ac261d","typeOfStateId":"state","$connId":"con_748","$id":"f292124e-0014-470b-a1a6-f512f4b2526f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ec5f61d4-a042-4dfa-84e3-76be54c0231b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-312b4a86-3028-4c77-8145-f284481953f8","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0107c1a3-7a43-47c4-9bf8-684a6dd8f5bc","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8ea6dad9-5026-46da-b3c4-c351fe56ab19","root":false,"$title":"[MS.9.5.1][MSG] Tutorial Acessar arquivo","$position":{"top":"1939px","left":"18116px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bbce0379-c441-4a6b-ab3a-dc9e82ac261d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"bbce0379-c441-4a6b-ab3a-dc9e82ac261d","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2172.67px","left":"18475px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"3c3398a1-0b05-4599-9fbe-422d5796e9b4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_753","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false,"stateId":"c8b02012-8d08-4154-81fc-c2138fed71c5"},{"stateId":"fc75e150-8d74-4b41-baf1-391aedc93056","typeOfStateId":"state","$connId":"con_758","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["POS fixo"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"5e85ca75-e129-4e38-8aef-5a2a0a281212","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a9cd518d-bb8f-4864-b24a-c79b105528a7","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"43e668f3-4c7a-46f8-8416-bff1820f0525","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"e25dc608-32bd-4d2e-92a1-9b370f509dcf","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0740bd75-bb99-4cc6-8df8-339762f2fc4d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cd439c5b-d85d-45bf-9b4b-f9d1f778f82b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f7407c56-125e-4881-8704-47c8f0552810","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-52641480-9d4c-4f87-8a9e-bcc357a0eb34","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3c3398a1-0b05-4599-9fbe-422d5796e9b4","root":false,"$title":"[MS.9.4.0][INPUT] Menu Ethernet","$position":{"top":"1595px","left":"18704px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"fc75e150-8d74-4b41-baf1-391aedc93056":{"$contentActions":[{"action":{"$id":"5c298983-3089-4666-b85b-2b503cfb5b9e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"083e6ba7-ee83-483c-a951-5a782b204ca5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"083e6ba7-ee83-483c-a951-5a782b204ca5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b77c258d-398e-40af-bb6f-f2db2de13c8a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"502adcb2-35f6-48a8-8c72-8fb8adbbf6ef","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Verifique se o cabo de internet está conectado corretamente.\n\n2° Verifique se o cabo de internet não está com mau contato.\n\n3° Aperte o botão do lado direito para acessar a opção atalho.\n\n4° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"502adcb2-35f6-48a8-8c72-8fb8adbbf6ef","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Verifique se o cabo de internet está conectado corretamente.\n\n2° Verifique se o cabo de internet não está com mau contato.\n\n3° Aperte o botão do lado direito para acessar a opção atalho.\n\n4° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"709fe4ca-f799-4b7d-9787-57c369566fda","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ad34ceea-a4a8-406b-b25e-e86e16870a9e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ad34ceea-a4a8-406b-b25e-e86e16870a9e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6792d24c-b97b-4308-bdad-cd6da317fc60","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a9436bed-3e52-4dc8-bead-529154df4c82","type":"text/plain","content":"Deu certo fazer isso?\n\nSe sim, o equipamento está pronto para transacionar. Finalizar.\n\nSe não, tente o seguinte:\n\n- Aperte o botão do lado direito para acessar a opção atalho.\n- Pressione o atalho 992.\n- Pressione a opção ETHERNET.\n- Selecione a opção \"tipo IP Dinâmico\" e pressione verde.\n- Pressione o atalho 933.","metadata":{}},"$cardContent":{"document":{"id":"a9436bed-3e52-4dc8-bead-529154df4c82","type":"text/plain","content":"Deu certo fazer isso?\n\nSe sim, o equipamento está pronto para transacionar. Finalizar.\n\nSe não, tente o seguinte:\n\n- Aperte o botão do lado direito para acessar a opção atalho.\n- Pressione o atalho 992.\n- Pressione a opção ETHERNET.\n- Selecione a opção \"tipo IP Dinâmico\" e pressione verde.\n- Pressione o atalho 933."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"93807f04-544b-45b5-9424-492ee4c5494e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"bbce0379-c441-4a6b-ab3a-dc9e82ac261d","typeOfStateId":"state","$connId":"con_763","$id":"e73f0c2e-f943-4789-9985-5afd962badd1","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ff8af79e-de34-403f-87bb-4d2a87fe5077","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2f499b60-6cc6-4d48-9dd8-6ffd942a622c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-39b18f43-4a74-437c-9293-8e77c544727d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fc75e150-8d74-4b41-baf1-391aedc93056","root":false,"$title":"[MS.9.4.0][MSG] Tutorial Ethernet","$position":{"top":"1955.67px","left":"18857px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"71994ba1-b762-4b94-b3fd-aa615e4f5be6":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"4ccf9b34-36af-4a74-aea4-44dc363f3353","typeOfStateId":"state","$connId":"con_768","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false},{"stateId":"f59a89a7-936c-4d02-a416-c052131b24eb","typeOfStateId":"state","$connId":"con_773","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["POS fixo"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f3d3f6ba-e9c1-4c7f-a424-10a4b213b0c6","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c93c9954-79f0-4239-b11d-d05520ac97b8","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"63c4809c-1365-40d7-b3e9-9e5f7433c1fa","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"bcb35483-3216-4adc-b8d6-9bcd39e2f186","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-576276cd-925b-4ed8-83e9-b8ee94714f71","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8f5cc1e3-3b5b-4d1f-8b0a-e94305368e39","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8bc84b6a-24ab-4464-bdd3-99ed844f1d7c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-da15d07f-16bd-49d3-960d-53c5e37bd1be","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"71994ba1-b762-4b94-b3fd-aa615e4f5be6","root":false,"$title":"[MS.9.3.0][INPUT] Menu Discado","$position":{"top":"1623.67px","left":"19469px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f59a89a7-936c-4d02-a416-c052131b24eb":{"$contentActions":[{"action":{"$id":"6867ef5c-0600-4cc7-a4d5-c56f36c3c079","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"934aa63d-70be-431f-918b-4884eab1965e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"934aa63d-70be-431f-918b-4884eab1965e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"815f1f80-2b0f-49f7-816e-085a17d933ca","$typeOfContent":"text","type":"SendMessage","settings":{"id":"56946943-cfd5-41ee-9b78-f666ccaadfd0","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Certifique-se de que a linha telefônica esteja funcionando corretamente.\n\n2° Conecte o cabo no aparelho telefônico para verificar se há sinal através de um tom de discagem.\n\n3° Mude o terminal para outra linha telefônica.\n\n4° Aperte o botão do lado direito para acessar a opção atalho.\n\n5° Pressione o atalho 992.\n\n6° Pressione a opção discado.\n\n7° Selecione o tipo de conexão: PULSE.\n\n8° Caso tenha PABX, a opção para obter linha geralmente é 0 ou 9.\n\n9° Digite o número de inicialização: 0800 722 7287.\n\n10° Configure a velocidade de comunicação para 2400.\n\n11° Pressione o atalho 993.","metadata":{}},"$cardContent":{"document":{"id":"56946943-cfd5-41ee-9b78-f666ccaadfd0","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Certifique-se de que a linha telefônica esteja funcionando corretamente.\n\n2° Conecte o cabo no aparelho telefônico para verificar se há sinal através de um tom de discagem.\n\n3° Mude o terminal para outra linha telefônica.\n\n4° Aperte o botão do lado direito para acessar a opção atalho.\n\n5° Pressione o atalho 992.\n\n6° Pressione a opção discado.\n\n7° Selecione o tipo de conexão: PULSE.\n\n8° Caso tenha PABX, a opção para obter linha geralmente é 0 ou 9.\n\n9° Digite o número de inicialização: 0800 722 7287.\n\n10° Configure a velocidade de comunicação para 2400.\n\n11° Pressione o atalho 993."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cf60fda3-a781-47c3-909a-ba146e2b2c9f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f5497511-a788-4a38-9dc1-e57f10826795","typeOfStateId":"state","$connId":"con_778","$id":"900825f6-8685-47b7-9bc9-194d463f1fea","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"4a15384d-bb4e-4c87-8446-6af4acff6ac8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a2e24b52-d3a1-412a-82b6-606338765def","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7794d8e4-a203-41fb-b755-8f0df71b99cd","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f59a89a7-936c-4d02-a416-c052131b24eb","root":false,"$title":"[MS.9.3.1][MSG] Tutorial Discado","$position":{"top":"1961.67px","left":"19319px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4ccf9b34-36af-4a74-aea4-44dc363f3353":{"$contentActions":[{"action":{"$id":"9706e80c-077c-4077-a1e2-0f5221a22e46","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a35a6509-7137-4c11-8a3b-7c76da277263","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a35a6509-7137-4c11-8a3b-7c76da277263","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"dbda2370-4aa4-4a0c-9098-0891088dce4e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7a0688c1-edb3-4dd4-be6a-e3fe5efe0e30","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"7a0688c1-edb3-4dd4-be6a-e3fe5efe0e30","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-087b6285-8b6b-4cce-a678-80147a7fa54e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4ccf9b34-36af-4a74-aea4-44dc363f3353","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1947px","left":"19646px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"f5497511-a788-4a38-9dc1-e57f10826795":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"f5497511-a788-4a38-9dc1-e57f10826795","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2191px","left":"19656px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"fa590f70-d5a2-4829-ba75-1b1f379d2ef8":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_783","$id":"c3c28bfb-17b5-449b-bdee-e1b7607cd3f2","conditions":[{"source":"context","comparison":"equals","values":["Outro modelo"],"variable":"userInput"}],"$invalid":false,"stateId":"4ccf9b34-36af-4a74-aea4-44dc363f3353"},{"stateId":"ae9b55fe-db28-47d9-9216-b529f2f848e3","typeOfStateId":"state","$connId":"con_788","$id":"a92c0eb9-c099-4b91-ad20-a00cf4d882a4","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Smart"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"7819e582-fd62-4bfb-a366-be34df9ad170","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f7a97479-bf44-4225-b63d-95c193a529ee","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"c9042d62-bad4-4ddb-960e-a582fbea0b46","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"2af45440-f9ff-4b10-8406-1c6315b0eb72","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bb7cd4ae-957f-43b7-9b0c-03c8153ad845","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ce35d766-f4e5-4de0-8eda-3ddc69fe5c64","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8e457c0f-e19a-4057-a52c-d7eed8d6a6f6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bf94a4ff-bc63-4270-ad86-ce695a6a4487","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"fa590f70-d5a2-4829-ba75-1b1f379d2ef8","root":false,"$title":"[MS.9.2.0][INPUT] Menu Torre de celular com X","$position":{"top":"1605px","left":"19823px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"ae9b55fe-db28-47d9-9216-b529f2f848e3":{"$contentActions":[{"action":{"$id":"1eee978a-ae2b-424f-866b-67eefe7e37f8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8e41ea2d-f05e-4bf3-a08e-b2e68f3bb3e7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8e41ea2d-f05e-4bf3-a08e-b2e68f3bb3e7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1c636214-495b-4a5d-b21f-838c13a909b8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"eda644a6-0762-49a5-8c63-88b6bf4eb9e9","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local dele com um pano seco.\n\n4° Coloque o chip novamente no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação.","metadata":{}},"$cardContent":{"document":{"id":"eda644a6-0762-49a5-8c63-88b6bf4eb9e9","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Desligue o equipamento.\n\n2° Retire a bateria e o chip.\n\n3° Limpe o chip e o local dele com um pano seco.\n\n4° Coloque o chip novamente no Slot SIM 1 e ligue o equipamento.\n\n5° Pressione o atalho 9973.\n\n6° Realize testes de comunicação."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"acce09ad-1976-418a-83d2-3e6d5c0cd85e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"435b39bc-fe24-4bb8-9a18-1dfface95021","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"435b39bc-fe24-4bb8-9a18-1dfface95021","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"664a77c1-37e1-4416-a94c-0897bfd4a601","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3c0c38d6-2c85-4d75-84a1-c98375184138","type":"text/plain","content":"Você conseguiu atualizar?\n\n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste.","metadata":{}},"$cardContent":{"document":{"id":"3c0c38d6-2c85-4d75-84a1-c98375184138","type":"text/plain","content":"Você conseguiu atualizar?\n\n- Se sim: O equipamento possui comunicação. Realize uma venda de teste.\n\n- Se não: Conecte o POS ao Wi-Fi e realize uma venda de teste."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8ef56b72-ba3c-4d1b-8688-cb58563800d1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f5497511-a788-4a38-9dc1-e57f10826795","typeOfStateId":"state","$connId":"con_793","$id":"60e1a190-5164-45c3-bec8-58035b28fb93","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"71465794-1985-4807-8087-892a53b9bb91","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ed4dc2e9-0114-42f0-a810-0df27fab9482","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d9ab8f2d-b419-4734-95f0-7911f0ee83af","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ae9b55fe-db28-47d9-9216-b529f2f848e3","root":false,"$title":"[MS.9.2.1][MSG] Tutorial Torre de celular com X","$position":{"top":"1976.67px","left":"20004px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"ace3440e-4fba-4fe7-ac92-302202b38274":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd08052c-7099-4459-a2f4-e2cf95e448b3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"826d67de-104b-43dd-b938-62696a7e494b","typeOfStateId":"state","$connId":"con_798","$id":"f33311be-7152-4ae3-8d40-1e1c7db088f5","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"8b75bf20-495b-4728-b6c9-61ca7451db67","typeOfStateId":"state","$connId":"con_803","$id":"5c30b03e-547e-4775-b07c-f602626ff1f8","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"75556b5e-8d16-4691-9bd0-7a7680bcee95","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"28d83ea2-5e70-48be-bd6e-10e8aa978ac5","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"34de07d9-c683-4939-8587-16544e835bea","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"8c1d5af2-2e19-44fa-bf9d-3f1eb9b9d2a1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ccc08c80-22bd-45d9-8f54-15bc46bea4f4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3a3e7c7d-6769-4024-a23d-11237ed5d9ef","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-acfbbec4-0db5-4841-9abc-76203f41b1fc","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5aa31549-e434-4cad-9b9e-361094f968ea","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"ace3440e-4fba-4fe7-ac92-302202b38274","root":false,"$title":"[MS.9.1.0][INPUT] Menu Erro desfazimento","$position":{"top":"1609.67px","left":"20559px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8b75bf20-495b-4728-b6c9-61ca7451db67":{"$contentActions":[{"action":{"$id":"09dd9cb1-1335-431d-ab6b-fdc67bb608f8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f8d71005-ef8c-40d3-88b2-33cfcbb8fc0a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f8d71005-ef8c-40d3-88b2-33cfcbb8fc0a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1f6623bc-6bb8-4866-acd4-0b0b8114928a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d90f6242-2971-4752-b622-c7fd3123568e","type":"text/plain","content":"Neste caso, realize o atalho 9990.","metadata":{}},"$cardContent":{"document":{"id":"d90f6242-2971-4752-b622-c7fd3123568e","type":"text/plain","content":"Neste caso, realize o atalho 9990."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"466ff8ab-ba31-44ff-9d68-9ee3206cb484","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a433dcaf-c60b-4227-b638-c6f9e6698090","typeOfStateId":"state","$connId":"con_808","$id":"c80da39a-59b5-4c1b-97f8-74311add3cd8","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"29d72261-ed27-4ca1-8a8e-8e6a31823ba5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b46e524d-f1cb-4b72-98ce-e0a6b26c804b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f57259bc-7443-4b28-9fa1-4ada1ca4f40f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8b75bf20-495b-4728-b6c9-61ca7451db67","root":false,"$title":"[MS.9.1.1][MSG] Dica Erro desfazimento","$position":{"top":"1936px","left":"20461px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"826d67de-104b-43dd-b938-62696a7e494b":{"$contentActions":[{"action":{"$id":"3b9c4343-0d7a-4fd5-b995-79ebfa49a845","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"18d0fcd7-c2bf-4727-b14b-1af2a8677936","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"18d0fcd7-c2bf-4727-b14b-1af2a8677936","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"719b16ca-f66f-4c01-bfaa-d4955d4dd93e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1e317512-cd28-49c9-8bd4-189125afbe5c","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"1e317512-cd28-49c9-8bd4-189125afbe5c","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e82b72b0-0e03-4261-925f-4f8d73d13943","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"db7da12e-ee1a-4614-9e43-e78c3c1432eb"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2cb76d0c-2df1-4257-a3b0-cd21f02e6785","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"826d67de-104b-43dd-b938-62696a7e494b","root":false,"$title":"[GO TO] Redirect to WhatsApp PJ (suporte)","$position":{"top":"1929px","left":"20694px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"a433dcaf-c60b-4227-b638-c6f9e6698090":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a0f35ea8-3ed3-4052-b8e8-fd51659ef47f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"b03d52e3-aeda-4505-8186-ca025fd17395"},"isAiGenerated":false,"$tags":[],"id":"a433dcaf-c60b-4227-b638-c6f9e6698090","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2182.67px","left":"20461px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"47c6e908-5e18-4f58-b4f2-9d29613f7e6d":{"$contentActions":[{"action":{"$id":"9ef1675f-c8f5-4de0-a505-868769c3951a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d68cb396-b326-47d9-899f-be888a1d632e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d68cb396-b326-47d9-899f-be888a1d632e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4d0cb188-17e8-444c-b889-5a7e9aa469b8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9ec156da-adf6-4823-9ece-def818154534","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione a função atalho via app do cliente.\n\n2° Selecione a função 990.\n\n3° Confirme a atualização.\n\n4° Pressione novamente o atalho via app do cliente.\n\n5° Selecione a função 993.\n\n6° Equipamento reconfigurado.","metadata":{}},"$cardContent":{"document":{"id":"9ec156da-adf6-4823-9ece-def818154534","type":"text/plain","content":"Vou te pedir para fazer o seguinte:\n\n1° Pressione a função atalho via app do cliente.\n\n2° Selecione a função 990.\n\n3° Confirme a atualização.\n\n4° Pressione novamente o atalho via app do cliente.\n\n5° Selecione a função 993.\n\n6° Equipamento reconfigurado."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"9c80bc94-68d7-4dfb-a1be-5425784db1b4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"8a5361a8-de29-4f47-ac5e-b2f203bcfc84","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a0e5db2a-e050-4e9c-94a4-ceaaa10975d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"a0e5db2a-e050-4e9c-94a4-ceaaa10975d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"62351bb7-2a04-4870-8545-31112cece2c5","typeOfStateId":"state","$connId":"con_813","$id":"98ceb742-0f1f-4328-a1b1-db30b912177e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"70f2b1bc-ea89-40e0-8610-59f53b28dcad","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-28b7808c-4f92-4e01-8517-d4b935d95e31","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-41820f86-6587-4c48-81fe-4e00ce377a51","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"47c6e908-5e18-4f58-b4f2-9d29613f7e6d","root":false,"$title":"[MS.9.7.0][MSG] Informativo Códigos","$position":{"top":"1308px","left":"17389px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"0d4f7110-4dfd-429a-a88a-cedec3b42217":{"$contentActions":[{"action":{"$id":"539754ca-f29c-447f-be33-1221fd52fad3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"055c90c5-956d-4a1c-82b8-9a9c9773447d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"055c90c5-956d-4a1c-82b8-9a9c9773447d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"82d65c05-684c-4b84-932f-b9318f88c0d8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"98a5273d-2c41-4f63-ae97-b395e6184bc0","type":"text/plain","content":"Preparei uma lista de atalhos da sua máquina que pode te ajudar no dia a dia.","metadata":{}},"$cardContent":{"document":{"id":"98a5273d-2c41-4f63-ae97-b395e6184bc0","type":"text/plain","content":"Preparei uma lista de atalhos da sua máquina que pode te ajudar no dia a dia."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6e6d4eee-dbbd-4ce7-9bd5-98b23156216d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0c3b5bec-c62f-474c-85a3-bc7ee26549b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"0c3b5bec-c62f-474c-85a3-bc7ee26549b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ff20e41d-dd5d-4961-8f69-ad39faf05fd9","$typeOfContent":"media","type":"SendMessage","settings":{"id":"f9618269-b40c-46b7-a95b-1a97235960da","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/png","uri":"https://i.imgur.com/DL0qkZU.png","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"f9618269-b40c-46b7-a95b-1a97235960da","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/png","uri":"https://i.imgur.com/DL0qkZU.png","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"69256712-f738-4b82-9087-ccec82eff53b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"936c7f20-2d18-48a2-ab8c-3b8dda223a52","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b36ea4c7-17b2-4503-86e5-75352f1e81da","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"b36ea4c7-17b2-4503-86e5-75352f1e81da","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"62351bb7-2a04-4870-8545-31112cece2c5","typeOfStateId":"state","$connId":"con_818","$id":"99b44c24-4924-4862-b6f2-c92b40b652e7","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ac966489-70d7-478e-bde5-47d1bf73063c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ac3cd899-72d9-47b6-8abe-58cdfc20f168","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-43892b9c-5739-4e0f-b994-39affacde991","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0d4f7110-4dfd-429a-a88a-cedec3b42217","root":false,"$title":"[MS.9.8.0][MSG] Informativo Atalhos","$position":{"top":"1309px","left":"17145px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"5f4a5491-d20a-47dd-b5f1-39f15cef7df1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"02bab647-2209-4b62-a370-2acb5ef95a73","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"5f4a5491-d20a-47dd-b5f1-39f15cef7df1","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"1243.5px","left":"9914.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"48fe2065-65c7-4601-b47d-6222ad48b7dd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2be08df4-eb13-4dfb-8f27-24992583fed5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"48fe2065-65c7-4601-b47d-6222ad48b7dd","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"2531.67px","left":"11463px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9bf09db0-b546-44ed-966d-e19e6062a4bb":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2be08df4-eb13-4dfb-8f27-24992583fed5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b03d52e3-aeda-4505-8186-ca025fd17395","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9bf09db0-b546-44ed-966d-e19e6062a4bb","root":false,"$title":"[GO TO] [MS.X.X.X][MSG] Problema resolvido?","$position":{"top":"1581px","left":"13085px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"80842650-23df-4c88-b522-b3939ada67f4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"42d151ec-d972-4147-af06-f29a49a201d0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"bfcc5b65-e53c-4d5c-8c1a-a673ffbdee8d","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"80842650-23df-4c88-b522-b3939ada67f4","root":false,"$title":"[GO TO] MS.6.2.0 Problemas / comunicação","$position":{"top":"1579px","left":"7511px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1f53a2ba-b515-46bf-a6cd-ab2a4a18420c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"37286ef7-791d-4af5-938f-fd2600482e21","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"147d7713-1860-43c0-a094-4e2bf59b000c","typeOfStateId":"state","$connId":"con_823","$id":"fe0b12d8-a6b7-4f11-8011-6bb8511ef053","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"18eb9e2c-4309-4ebc-81ee-6eecba46c7a3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"d46ba7ea-d135-4cb2-9695-f43fc214c06e","type":"ExecuteScript","$title":"Process \"payloadProtocolo\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(contaSelecionada) {\n    const { doc, codigoSegmento } = JSON.parse(contaSelecionada)\n    const payload = JSON.stringify({\n        origemDesc: \"CLIENTE\",\n        idSegmento: parseInt(codigoSegmento),\n        CpfCnpj: doc,\n        canalDesc: \"WHATSAPP\",\n        statusDesc: 'ABERTO',\n        usuarioInclusao: 'USR_SPD'\n    })\n    return payload;\n}\n\n","inputVariables":["contaSelecionada"],"outputVariable":"payloadProtocolo","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"70cd3530-a826-4b84-9381-0f299c51e143","type":"ProcessHttp","$title":"HTTP POST \"bodyProtocoloBpm\" (Cria Protocolo no Front)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Correlation-ID":"{{random.guid}}"},"method":"POST","body":"{{payloadProtocolo}}","uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos","responseStatusVariable":"statusProtocoloBpm","responseBodyVariable":"bodyProtocoloBpm"},"conditions":[]},{"$id":"df5da49c-4330-4f1e-902f-115da63bca8a","type":"ExecuteScript","$title":"Process \"idProtocoloBpm\" (Pega Id do protocolo BPM)","$invalid":false,"settings":{"function":"run","source":"function run(protocolo) {\n    try {\n        const protocoloId = JSON.parse(protocolo);\n        return protocoloId.data.id;\n    }\n    catch (err) {\n        return \"Falha ao abrir protocolo, tente novamente em alguns instantes.\"\n    }\n}\n","inputVariables":["bodyProtocoloBpm"],"outputVariable":"idProtocoloBpm","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dd7ad50b-8d3d-4de6-b79e-0589d7bbb546","type":"ExecuteScript","$title":"Process \"payloadOcorrencia\" (Gera payload ocorrencia)","$invalid":false,"settings":{"function":"run","source":"function run(body, routerId, motivo, description) {\n    try {\n        const { tipoId, motivoId, subMotivoId } = JSON.parse(body)[routerId][motivo];\n        const newBody = {\n            tipoId,\n            motivoId,\n            subMotivoId,\n            statusProcessamentoDesc: 'ABERTO',\n            usuarioInclusao: 'USR_SPD',\n            observacaoSolucaoAtendimento: description || '',\n            origem: 'CLIENTE',\n        }\n        return newBody\n    } catch (err) {\n        return false\n    }\n}","inputVariables":["resource.taxionomiaProtocolos","tunnel.owner","motivoProtocolo","transacoesNaoAutorizadas"],"outputVariable":"payloadOcorrencia","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"statusProtocoloBpm","values":["200"]}]},{"$id":"fa02da61-b215-4245-b6e4-9797d84c4640","type":"ProcessHttp","$title":"HTTP POST \"bodyOcorrencia\" (Cria nova ocorrencia)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"POST","body":"{{payloadOcorrencia}}","uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}/ocorrencias","responseStatusVariable":"statusOcorrencia","responseBodyVariable":"bodyOcorrencia"},"conditions":[{"source":"context","comparison":"equals","variable":"statusProtocoloBpm","values":["200"]}]},{"$id":"8ad0987d-bfc1-4ff4-97a3-294b9bce7973","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyConsultaProtocolo\" (Consultar Protocolo)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}"},"uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}","method":"GET","responseStatusVariable":"statusConsultaProtocolo","responseBodyVariable":"bodyConsultaProtocolo"},"conditions":[]},{"$id":"67331b9a-87c1-4820-9546-16ab427bc93c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusOcorrencia","statusProtocoloBpm"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"78169064-335c-4db0-9d00-f96f4e2e6de6","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"statusOcorrencia"}]},{"$id":"cae6835d-0a22-48ea-a108-f105ab492384","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api resumo\" (POST) (PROTOCOLO)","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos | {{payloadProtocolo}} | {{statusProtocoloBpm}} | {{bodyProtocoloBpm}}","category":"{{state.name}} api resumo"},"conditions":[]},{"$id":"f79819f1-e657-40ba-b15b-e54ced0626d6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api resumo\" (POST) (OCORRENCIA)","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}/ocorrencias | {{payloadOcorrencia}} | {{statusOcorrencia}} | {{bodyOcorrencia}}","category":"{{state.name}} api resumo 2"},"conditions":[]},{"$id":"367a37f1-1d85-49e9-81f9-c53bf79a01d4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{apiStatus}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"apiStatus"}]},{"$id":"ced798ec-9ac1-44ae-9f7b-af6db889d520","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\" statusProtocoloBpm","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"{{idSessao}}","identity":"{{contact.identity}}","body":"{{payloadProtocolo}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos | {{statusProtocoloBpm}}"},"conditions":[]},{"$id":"350aad19-3862-405c-81b8-f579aeb2cee8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\" statusOcorrencia","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"{{idSessao}}","identity":"{{contact.identity}}","idProtocoloBpm":"{{idProtocoloBpm}}","payloadOcorrencia":"{{payloadOcorrencia}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/idProtocoloBpm/ocorrencias | {{statusOcorrencia}}"},"conditions":[]},{"$id":"193b1c75-f9f7-4910-81de-983384584e5f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\" statusConsultaProtocolo","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"{{idSessao}}","identity":"{{contact.identity}}","idProtocoloBpm":"{{idProtocoloBpm}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/idProtocoloBpm | {{statusConsultaProtocolo}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-b6fd7abe-778e-4bcc-a889-045d6e0a8256","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-94d27e72-7d68-49f7-b324-8b2a02b8a0ee","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-081edb9f-5e2f-4ce1-b91d-ed407da009c6","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-32f7bd22-22e6-4fc3-b7be-34a97eb982b7","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"1f53a2ba-b515-46bf-a6cd-ab2a4a18420c","root":false,"$title":"[MS.7.3.0][HTTP] API Protocolo","$position":{"top":"3423px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"147d7713-1860-43c0-a094-4e2bf59b000c":{"$contentActions":[{"action":{"$id":"45f97abd-40f1-49d2-b32d-5d2bd8d47b76","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"16b7394e-69a5-44f6-b7e5-801df45598c4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"16b7394e-69a5-44f6-b7e5-801df45598c4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f57aa66e-5e2d-4c76-a16b-b0edea72f473","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2f380a9e-1cc7-44d4-8275-a1aaa2a51f0c","type":"text/plain","content":"{{dynamicContent}}","metadata":{}},"$cardContent":{"document":{"id":"2f380a9e-1cc7-44d4-8275-a1aaa2a51f0c","type":"text/plain","content":"{{dynamicContent}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"89972cb3-737e-4e2a-b4bd-58d53d901764","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e0da63ed-873f-4a03-8d51-babc22749386","typeOfStateId":"state","$connId":"con_828","$id":"a6e628de-f141-4cfc-b534-8b7b8338da8c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6bc02259-d8c7-4507-93bf-4a83be51155d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\" (DadosDoProtocolo)","$invalid":false,"settings":{"function":"run","source":"function run(obj) {\n    try {\n        obj = JSON.parse(obj).data;\n        let msgsProtocolo = [];\n        let msg = `Agradecemos pelas informações. 😊\n\nSeguem os dados do seu protocolo.👇`\n        msgsProtocolo.push(msg);\n\n        for (let i = 0; i < obj.length; i++) {\n            let msg = `• *${obj[i].id}*\n• *Aberto em*: ${getDataFormatada(obj[i].dataHoraInclusao)}\n• *Retorno previsto*: ${getAddDoisDiasUteis(obj[i].dataHoraInclusao, obj[i].maiorSLAOcorrencia)}`;\n            msgsProtocolo.push(msg);\n        };\n        msgsProtocolo = msgsProtocolo.join(\"\\n\\n\");\n        return msgsProtocolo;\n    }\n    catch (e) {\n        return e.message;\n    }\n}\nfunction getDataFormatada(data) {\n    let dataHoraInclusao = new Date(data);\n    let dia = (\"0\" + dataHoraInclusao.getDate()).slice(-2);\n    let mes = (\"0\" + (dataHoraInclusao.getMonth() + 1)).slice(-2);\n    let ano = dataHoraInclusao.getFullYear();\n    return `${dia}/${mes}/${ano}`;\n};\n\nfunction getAddDoisDiasUteis(data, maiorSLAOcorrencia) {\n    data = new Date(data);\n    maiorSLAOcorrencia = maiorSLAOcorrencia ? parseInt(maiorSLAOcorrencia) : 4;\n    for (let i = 0; i < maiorSLAOcorrencia;) {\n        data.setDate(data.getDate() + 1);\n        if (data.getDay() !== 0 && data.getDay() !== 6) {\n            i++;\n        }\n    }\n    return getDataFormatada(data);\n}\n","inputVariables":["bodyConsultaProtocolo"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"004fc65a-b3f0-4473-a400-139e877103a4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-048197c2-7c9a-4862-a50f-84b82b1ffe07","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8626724d-cc18-43e7-bf62-59a6d9f528b5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-20501d02-a8ab-468e-949a-85e503583d1e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"147d7713-1860-43c0-a094-4e2bf59b000c","root":false,"$title":"[MS.7.4.0][MSG] Status Protocolo Aberto","$position":{"top":"3661px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e0da63ed-873f-4a03-8d51-babc22749386":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d5a1d918-e12a-42a1-a7e2-278c000430f1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e0da63ed-873f-4a03-8d51-babc22749386","root":false,"$title":"[GO TO] Redirect to Finalizacao ","$position":{"top":"3880px","left":"4162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e335ceac-e744-405a-8be6-573e70ef7fc2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea7de052-de25-408e-a19f-dfa8bcd71cce","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e335ceac-e744-405a-8be6-573e70ef7fc2","root":false,"$title":"[GO TO] Redirect to Finalizacao","$position":{"top":"613px","left":"4507px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c5482705-133e-4f31-b01e-7930e16e12a3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '63897915-e896-4c66-ba27-f5cf84ea3f0a',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cbef1e34-7f2b-4d4a-82c4-8b080009f1b1","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"onboarding"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6594165c-892a-48c0-8bfa-3d29427ab797","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0ea9d811-f710-41df-9c57-7067d59c31f2","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"c5482705-133e-4f31-b01e-7930e16e12a3","root":false,"$title":"[Redirect] To \"Autenticacao\" (Simulador de vendas)","$position":{"top":"238.333px","left":"2763.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"63897915-e896-4c66-ba27-f5cf84ea3f0a":{"$contentActions":[{"action":{"$id":"9cf758d6-8e87-4998-85e6-1b2eaadd853e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f06f62a5-70c6-4221-8715-fdc4567381c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f06f62a5-70c6-4221-8715-fdc4567381c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6339baf9-b191-4c51-a549-917443160bd5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"27a005a8-7031-4512-b28e-093cdd4dc92a","type":"text/plain","content":"Você pode simular de duas formas:\n\n<b>Quero cobrar:</b>\n- Insira o valor que deseja cobrar do cliente para ver quanto receberá após a aplicação das taxas.\n\n<b>Quero receber:</b>\n- Insira o valor líquido que deseja receber da venda, e o sistema calculará o valor a ser cobrado, considerando os descontos e taxas.","metadata":{}},"$cardContent":{"document":{"id":"27a005a8-7031-4512-b28e-093cdd4dc92a","type":"text/plain","content":"Você pode simular de duas formas:\n\n<b>Quero cobrar:</b>\n- Insira o valor que deseja cobrar do cliente para ver quanto receberá após a aplicação das taxas.\n\n<b>Quero receber:</b>\n- Insira o valor líquido que deseja receber da venda, e o sistema calculará o valor a ser cobrado, considerando os descontos e taxas."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f61f2d1c-79cd-42d3-8a2f-925a381b2d2b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"136deec1-b274-4d22-b9a2-021b3c27c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"136deec1-b274-4d22-b9a2-021b3c27c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6851e987-b421-4d6c-8039-304ed8ddac92","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"63e9145d-3760-4ef3-ba6e-88f41a491e41","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8f1c55b1-7d84-4727-a19c-145275d573e4","typeOfStateId":"state","$connId":"con_833","$id":"3e12632c-4292-499f-ad43-d2b0e19815a4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6cf082c9-1a1a-40b3-ba97-43413903f57d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"3343998f-7c5e-4b6a-89f2-74839c8a1a4c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Quero cobrar\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Quero receber\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Qual simulação você quer fazer?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-684f5b05-cebe-4bb4-a01d-aa89084009d1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4d6f1be4-21fc-40bb-9d9c-1397400f2b2f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-109edf48-7c31-4e0a-9b01-0b95719698bd","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"63897915-e896-4c66-ba27-f5cf84ea3f0a","root":false,"$title":"[MS.2.0.1] [MSG] Simulador de Vendas - Máquina","$position":{"top":"455px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"47fe6812-1d71-4bbc-b0aa-0f28704aea00":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cd358a19-a561-4197-b16d-fb92953c8fa1","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"5724999e-4ebb-443e-8b1d-4c15ef40251e","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"47fe6812-1d71-4bbc-b0aa-0f28704aea00","root":false,"$title":"[GO TO] [Redirect] to WhatsApp PJ (atendente)","$position":{"top":"1364px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3363e5ff-e5bb-4373-a385-f4206fa54eba":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"42352582-3913-431e-976e-ad8494ad2445","typeOfStateId":"state","$connId":"con_838","$id":"ef04e652-526a-411f-9385-a603df4c7b38","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(data) {\n\ttry {\n\t\tif (!data) {\n\t\t\treturn 'inatividade'\n\t\t}\n\t\tconst regex = /^(\\d{2})[\\/\\-]?(\\d{2})[\\/\\-]?(\\d{4})$/;\n\t\tif (!regex.test(data)) return 'input inesperado';\n\n\t\tlet dia = parseInt(data.substring(0, 2));\n\t\tlet mes = parseInt(data.substring(3, 5));\n\t\tlet ano = parseInt(data.substring(6, 10));\n\n\t\tif (dia < 1 || dia > 31) return 'input inesperado';\n\t\tif (mes < 1 || mes > 12) return 'input inesperado';\n\t\tif ((mes == 4 || mes == 6 || mes == 9 || mes == 11) && dia == 31) return 'input inesperado';\n\t\tif (mes == 2) {\n\t\t\tconst bissexto = (ano % 4 == 0 && (ano % 100 != 0 || ano % 400 == 0));\n\t\t\tif (dia > 29 || (dia == 29 && !bissexto)) return 'input inesperado';\n\t\t}\n\t\treturn dia.toString().padStart(2, '0') + '/' + mes.toString().padStart(2, '0') + '/' + ano;\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ec82a1b2-65e4-4ae4-bc07-de805eef7dff","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.4.0.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.4.0.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"010c590c-aa18-4af4-beab-af976bce53ee","$typeOfContent":"","type":"MergeContact","$title":"Set \"DataVendaNaoRecebida\"","$invalid":false,"settings":{"extras":{"dataVendaNaoRecebida":"{{userInput}}"}},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"a6ab0e22-9b79-4ede-801c-f05e254fc2b9","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"a9df706b-0d80-4c56-9453-563ddde8a263","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d6ded3d5-7dbd-4fef-b819-f8cb214f4b96","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5befc8ae-f530-4b2d-bfff-c9ac9b0189b5","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-3dc47d6b-5c71-40d5-ad99-ec0d919e2267","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-7e9f9685-72fb-4990-901c-464ff4df5a27","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b0a2943e-c47b-439a-9bbe-dd752c6574bc","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3363e5ff-e5bb-4373-a385-f4206fa54eba","root":false,"$title":"[MS.4.0.0][INPUT] Não recebi minha venda","$position":{"top":"687px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3667b0cd-ad3b-4f05-a5de-144400562fd0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"47fe6812-1d71-4bbc-b0aa-0f28704aea00","typeOfStateId":"state","$connId":"con_843","$id":"ed4b98d3-d6f8-4e76-9b69-fbeb08e72afd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(valor, message) {\n    try {\n        if (!valor) {\n            return 'inatividade'\n        }\n        const messageType = JSON.parse(message).type\n        if (messageType !== \"text/plain\") {\n            return 'input inesperado'\n        }\n\n        if (!/^\\d{1,3}(\\.\\d{3})*,\\d{2}$/.test(valor)) {\n            return 'input inesperado';\n        }\n\n        const valorNumerico = valor.replace(/\\./g, '').replace(',', '.');\n        const valorFormatado = parseFloat(valorNumerico).toFixed(2).replace('.', ',');\n        return 'R$ ' + valorFormatado;\n    } catch (err) {\n        return err.message\n    }\n}","inputVariables":["input.content","input.message"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"785130e9-58c2-4e11-9bd8-75c1e56c45e0","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"MS.4.1.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"MS.4.1.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"010c590c-aa18-4af4-beab-af976bce53ee","$typeOfContent":"","type":"MergeContact","$title":"Set \"valorVendaNaoRecebida\"","$invalid":false,"settings":{"extras":{"valorVendaNaoRecebida":"{{userInput}}"}},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"fc8709a7-d7bb-44dd-be41-fea8b632692d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"9f2acfeb-fe5e-469f-a895-8397c9edc1ea","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-936d6b6e-a15d-46b8-932e-56fe0feb5b0c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cb887236-8a72-4303-b77e-7b306a4259a5","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c6fa675b-4feb-4334-8628-26564a7ea37b","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-2344ba08-47e6-4ccf-83a7-b669ef8d7c58","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4047a8af-5482-4872-bf52-3bd2174dd69c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3667b0cd-ad3b-4f05-a5de-144400562fd0","root":false,"$title":"[MS.4.1.0][INPUT] Solicita valor da venda","$position":{"top":"1146px","left":"3375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4051c1ad-de53-4ef3-bfa0-add7a989e960":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"63e9145d-3760-4ef3-ba6e-88f41a491e41","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"999f8756-0822-4b23-9887-f47836298b3a","typeOfStateId":"state","$connId":"con_848","$id":"3e12632c-4292-499f-ad43-d2b0e19815a4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6cf082c9-1a1a-40b3-ba97-43413903f57d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Maquina Safrapay {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"22d6b742-155e-4644-851e-fe36cfa633c5","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"999f8756-0822-4b23-9887-f47836298b3a","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-acb7e35b-79a3-4454-9fd9-ac2a92b7e47f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-97bd111f-8faa-450f-aef6-4686569e6943","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"4051c1ad-de53-4ef3-bfa0-add7a989e960","root":false,"$title":"[MS.4.0.0] [SET] Não recebi minha venda Inicio","$position":{"top":"27px","left":"3374px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"999f8756-0822-4b23-9887-f47836298b3a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '4b038e89-c130-4869-a541-4954e12ebf81',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cbef1e34-7f2b-4d4a-82c4-8b080009f1b1","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"onboarding"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8adbdf1e-c978-436f-86cf-eee741073b77","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a423a2b9-7875-4a88-a09e-331496294bf3","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"999f8756-0822-4b23-9887-f47836298b3a","root":false,"$title":"[Redirect] To \"Autenticacao\" (Não recebi minha VD)","$position":{"top":"262px","left":"3374px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"a5ddf643-13c0-4a81-a174-e1aa9dd86873":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"5b733936-1903-4654-b904-fc7b72d289cc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Bot Taxas e Condições ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'a5ddf643-13c0-4a81-a174-e1aa9dd86873',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"d02ef8e1-41a6-4df8-ae88-9f54609b5548","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-00700918-856f-4f4e-ad76-aac3c71d1c9d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7261f05e-be2e-490a-8498-f17e76ed18a7","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$title":"[Redirect] To Taxas e condições","$position":{"top":"242.5px","left":"1610px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"e0d2ce64-3265-46bd-b396-f53ad65b26e6":{"$contentActions":[{"action":{"$id":"45773e89-c639-48b0-a84f-5f29fdb265ef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2b68cfc6-71ac-43dd-ba99-972954c677b2","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"26faef34-7912-4e02-b8a6-069c18b0a656","typeOfStateId":"state","$connId":"con_853","$id":"6fcdc215-f3c2-4ac1-9f5d-929f74d63d9f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"83551b1f-5996-47df-b780-cc7da6540faf","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77a9996e-b081-4071-9ad4-416c7805cd87","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n\t{\n\t\tid: '1',\n\t\ttitle: 'Suporte e configurações',\n\t\tdescription: 'Veja as orientações'\n\t},\n\t{\n\t\tid: '2',\n\t\ttitle: 'Taxas e condições',\n\t\tdescription: 'Taxas de venda, antecipação, pix na Safrapay e questionar cobrança'\n\t},\n\t{\n\t\tid: '3',\n\t\ttitle: 'Devolução da máquina',\n\t\tdescription: 'Saiba como realizar a devolução'\n\t},\n\t{\n\t\tid: '4',\n\t\ttitle: 'Vendas',\n\t\tdescription: 'Simular venda, venda não recebida, link de pagamento e cancelar venda'\n\t},\n\t{\n\t\tid: '5',\n\t\ttitle: 'Antecipação',\n\t\tdescription: 'Contratar, consultar ARV, valores bloqueados, taxas e cancelamento'\n\t},\n\t{\n\t\tid: '6',\n\t\ttitle: 'Ordem de serviço',\n\t\tdescription: 'Consultar o andamento da solicitação'\n\t},\n\t{\n\t\tid: '7',\n\t\ttitle: 'Upgrade e downgrade',\n\t\tdescription: 'Veja como trocar sua máquina por um outro modelo.'\n\t}\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n\tif (posicao > menuOptions.length) {\n\t\tposicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n\t}\n\tif (menuOptions.find(option => option.id == posicao)) {\n\t\tquantidadeItens = menuOptions.length\n\t\tfor (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n\t\t\tmenuOptions[i].id = (i + 2).toString()\n\t\t}\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72) || ''\n\t\t})\n\t} else {\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72)\n\t\t})\n\t}\n\tmenuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n\t// Parametro de busca é o title ou description da opção que deseja atualizar\n\tconst opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tmenuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n\tmenuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: '[extratoDeContaCorrente]' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao);\n\n\tif (!opcao) {\n\t\treturn;\n\t}\n\n\tconst hasPermission = permissoesNecessarias.some(necessaria => permissoes.includes(necessaria));\n\n\tif (hasPermission) {\n\t\treturn;\n\t}\n\n\tconst index = menuOptions.indexOf(opcao);\n\tif (index > -1) {\n\t\tmenuOptions.splice(index, 1);\n\t}\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions.splice(index, 1)\n}\n\nfunction removeDescricaoDoBotao({ tituloDoBotao, parteASerRemovida, listaPermissoes, permissaoNecessaria }) {\n\tif (listaPermissoes.includes(permissaoNecessaria)) {\n\t\treturn\n\t}\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions[index].description = menuOptions[index].description.replace(parteASerRemovida, '')\n}\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada, ecList) {\n\ttry {\n\t\tconst { ec, permissoes } = JSON.parse(contaSelecionada);\n\t\tconst ecListParsed = JSON.parse(ecList);\n\t\t// Simulador de vendas, Não recebi minha venda, Vendas Online, Cancelar Venda\n\t\tif (ecListParsed.allecQuantity && ecListParsed.allecQuantity < 1) {//Se a quantidade de EC for menos 1 remove a opcao retirada de maquina, independente de ser EC ativo ou cancelado.\n\t\t\tremoveOpcaoDoMenu({ tituloDoBotao: 'Devolução da máquina' })\n\t\t}\n\t\tif (!ec) {\n\t\t\tatualizaOpcaoMenu({ parametroDeBusca: 'Vendas', title: 'Vendas', description: 'Não recebi minha venda, Vendas online, Cancelar venda' })\n\t\t}\n\t\tremoveDescricaoDoBotao({\n\t\t\ttituloDoBotao: 'Vendas',\n\t\t\tparteASerRemovida: 'Não recebi minha venda, ',\n\t\t\tlistaPermissoes: permissoes,\n\t\t\tpermissaoNecessaria: 'naoRecebiAVenda'\n\t\t})\n\t\tremoveDescricaoDoBotao({\n\t\t\ttituloDoBotao: 'Antecipação',\n\t\t\tparteASerRemovida: ' e cancelamento ',\n\t\t\tlistaPermissoes: permissoes,\n\t\t\tpermissaoNecessaria: 'cancelarAntecipAutomatica'\n\t\t})\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Ótimo, o que você precisa sobre máquina Safrapay?`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": menuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\terror: err.message,\n\t\t\texceptionType: 'reiniciarFluxo',\n\t\t\tdynamicContent: {\n\t\t\t\t\"type\": \"text/plain\",\n\t\t\t\t\"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n\t\t\t}\n\t\t}\n\t}\n}","inputVariables":["contaSelecionada","ecList"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b01ab217-20cc-4b44-8b8e-8ec8af27ceff","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"3c02d965-7713-4270-ba3a-219d42fd37a3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"58b41d22-b9c4-4c9d-aff5-5066e7a89cb4","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"22d8a273-d24b-4639-a5f6-11eb42bf08a8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"selecaoMenuAnterior\"","$invalid":false,"settings":{"function":"run","source":"function run(stateId, serviceName) {\n\ttry {\n\t\treturn {\n\t\t\tstateId,\n\t\t\tserviceName\n\t\t}\n\t} catch (er) {\n\t\treturn {\n\t\t\tstateId: 'welcome',\n\t\t\tserviceName: 'Bot Main'\n\t\t}\n\t}\n}","inputVariables":["state.id","config.serviceName"],"outputVariable":"selecaoMenuAnterior","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1c51aa68-bcdd-4dbd-8928-f2f6f655b425","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6445fdd8-94ef-403e-85fb-5e695c3e1748","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fe46a04a-c173-4ed8-922d-f2268a8d8873","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f592490e-ab65-43ca-b73f-dd37c394cfc7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e0d2ce64-3265-46bd-b396-f53ad65b26e6","root":false,"$title":"[M.5.1.0][MSG] Menu - Máquinas Safrapay","$position":{"top":"481px","left":"1368px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"26faef34-7912-4e02-b8a6-069c18b0a656":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_858","$id":"7a42f34d-890f-4245-bf02-2faf05746dbf","conditions":[{"source":"context","comparison":"equals","values":["Taxas e condições"],"variable":"userInput"}],"$invalid":false,"stateId":"b33933ce-96ec-4f09-bd6f-b502c15124db"},{"stateId":"c5ef80ee-bfa5-4929-8017-4c78d9f86bbe","typeOfStateId":"state","$connId":"con_863","$id":"1c39db59-adf4-4f52-91dd-0a3e0c895e69","conditions":[{"source":"context","comparison":"equals","values":["Vendas"],"variable":"userInput"}],"$invalid":false},{"stateId":"e1aff5a0-e120-4e0e-a1a2-67fae556c4b9","typeOfStateId":"state","$connId":"con_868","$id":"bc070b11-ee9e-4c09-8d36-278ba77ec131","conditions":[{"source":"context","comparison":"equals","values":["Ordem de serviço"],"variable":"userInput"}],"$invalid":false},{"stateId":"f817dcce-1003-42db-a940-95c267d9a2c8","typeOfStateId":"state","$connId":"con_873","$id":"60b5c245-9a4b-453b-a4da-24ece8f604a2","conditions":[{"source":"context","comparison":"equals","values":["Suporte e configurações"],"variable":"userInput"}],"$invalid":false},{"stateId":"c7d28097-fb6e-4341-a690-b43b82085fad","typeOfStateId":"state","$connId":"con_878","$id":"bdcc229c-47ed-4d1a-b6b7-83f97652946c","conditions":[{"source":"context","comparison":"equals","values":["Upgrade e downgrade"],"variable":"userInput"}],"$invalid":false},{"stateId":"a4599177-c976-4921-9be9-ca6fa0d0d574","typeOfStateId":"state","$connId":"con_883","$id":"9023d425-ef88-4a26-9dbd-511ab7a6afdf","conditions":[{"source":"context","comparison":"equals","values":["Antecipação"],"variable":"userInput"}],"$invalid":false},{"stateId":"227c3938-627f-4a0a-8136-ddb558c334ed","typeOfStateId":"state","$connId":"con_888","$id":"c4db3528-ae20-4f07-b6c1-542a655fe51f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Devolução da máquina"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"b8f910d1-f140-4584-b031-aa6bdab8c585","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2c853ac7-fde1-4b0d-92c7-f60b245a9072","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"00fb1c58-ac94-4872-ae2e-4329d1889e8d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"95b3ca8c-7d57-4516-b57d-f7d5579948df","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"d67b36fe-d7aa-4b9c-9a59-b49a481f9b5d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2c144bb0-4f85-49f1-9176-205dc11f69d3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bfe834e2-6873-4495-9844-102122540067","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-bf873ca5-5154-4f0f-b30c-3643504a622f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7b3fe103-47c8-4769-bc1e-1a4a2e0dbabd","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"26faef34-7912-4e02-b8a6-069c18b0a656","root":false,"$title":"[M.5.1.0][INPUT] Menu - Máquinas Safrapay","$position":{"top":"1073.5px","left":"1396.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"c5ef80ee-bfa5-4929-8017-4c78d9f86bbe":{"$contentActions":[{"action":{"$id":"45773e89-c639-48b0-a84f-5f29fdb265ef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4debe525-4c4e-4205-8593-f4cc500ba0b2","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2b68cfc6-71ac-43dd-ba99-972954c677b2","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"35a93cc9-44a0-4b9a-9214-c401f2bd5d9d","typeOfStateId":"state","$connId":"con_893","$id":"6fcdc215-f3c2-4ac1-9f5d-929f74d63d9f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f2b92728-adef-4dd3-ab47-b3c40cc6ac1e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"77a9996e-b081-4071-9ad4-416c7805cd87","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Não recebi minha venda\",\n        \"description\": \"\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Vendas Online\",\n        \"description\": \"API Safrapay e TEF\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Cancelar venda\",\n        \"description\": \"\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao);\n\n    if (!opcao) {\n        return;\n    }\n\n    const hasPermission = permissoesNecessarias.some(necessaria => permissoes.includes(necessaria));\n\n    if (hasPermission) {\n        return;\n    }\n\n    const index = menuOptions.indexOf(opcao);\n    if (index > -1) {\n        menuOptions.splice(index, 1);\n    }\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeDescricaoDoBotao({ tituloDoBotao, parteASerRemovida, listaPermissoes, permissaoNecessaria }) {\n    if (listaPermissoes.includes(permissaoNecessaria)) {\n        return\n    }\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions[index].description = menuOptions[index].description.replace(parteASerRemovida, '')\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        const { ec, permissoes } = JSON.parse(contaSelecionada)\n        if (ec) {\n            adicionaOpcaoNoMenu({ posicao: 1, title: 'Simulador de vendas', description: '' })\n        }\n        verificaPermissao({ tituloDoBotao: 'Não recebi minha venda', permissoesNecessarias: ['naoRecebiAVenda'], permissoes })\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Separei alguns tópicos sobre vendas. \n\nDe qual deles você quer mais informações?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}\n","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c3c26b3e-34c9-4ae0-8a12-8f757a6961fa","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"fe0a0d4d-142c-4b01-8d19-6a8ff56540b4","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"b9dc014f-a0ef-4190-93b9-96b44ab6c0b8","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c5c23600-f8b1-4647-a2a5-79230ce91267","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-50c35023-9cdf-4af7-8a36-be7d8fd1e6d5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f833e508-342d-4755-a526-bd3f4239ed96","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2da6dd36-8976-4d35-9296-bad72c38210a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c5ef80ee-bfa5-4929-8017-4c78d9f86bbe","root":false,"$title":"[M.5.1.2][MSG] Menu - Vendas","$position":{"top":"1354px","left":"903px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"35a93cc9-44a0-4b9a-9214-c401f2bd5d9d":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"62ddc83e-559e-4fce-83d5-8d7020dde684","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"4ad60f8f-8c23-44a7-8528-9dbd3c0c6536","typeOfStateId":"state","$connId":"con_898","$id":"ff07b176-98fd-4b3c-8d37-8fe147441bb3","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Vendas Online"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"6f1f1e0c-4552-4f1c-8756-7fe5e190db5a","typeOfStateId":"state","$connId":"con_903","$id":"0842f43f-db83-411f-b933-1298bfbb4bf1","conditions":[{"source":"context","comparison":"equals","values":["Simulador de vendas"],"variable":"userInput"}],"$invalid":false},{"stateId":"f043bcf4-0318-4aa7-91b7-4e76c9c3f701","typeOfStateId":"state","$connId":"con_908","$id":"f9dea011-8786-44c7-88bf-d033b2badc61","conditions":[{"source":"context","comparison":"equals","values":["Não recebi minha venda"],"variable":"userInput"}],"$invalid":false},{"stateId":"2f71ab30-8070-459a-8b4e-42e21a806b2c","typeOfStateId":"state","$connId":"con_913","$id":"2df10952-1179-4cc3-bcf0-2ef00ec5778c","conditions":[{"source":"context","comparison":"equals","values":["Cancelar venda"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f4dc1b2c-6916-4396-aecb-3d245a9e7e5e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2c853ac7-fde1-4b0d-92c7-f60b245a9072","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"00fb1c58-ac94-4872-ae2e-4329d1889e8d","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"95b3ca8c-7d57-4516-b57d-f7d5579948df","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"d67b36fe-d7aa-4b9c-9a59-b49a481f9b5d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e97d86d3-54e4-4895-8448-713c0b4867b8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-66bb687a-b45d-489c-bd45-0885fc28c79f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ac69938b-d477-4940-9d4d-a9ed267e6345","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a995300b-752e-4ce9-a862-772e9b4fe118","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"35a93cc9-44a0-4b9a-9214-c401f2bd5d9d","root":false,"$title":"[M.5.1.2][INPUT] Menu - Vendas","$position":{"top":"1543px","left":"904px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"4ad60f8f-8c23-44a7-8528-9dbd3c0c6536":{"$contentActions":[{"action":{"$id":"b90564c6-ab1b-46ff-b1fc-76389c0697b9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"79389fea-5a22-4077-8848-84ecd36b4516","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"79389fea-5a22-4077-8848-84ecd36b4516","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"25b9a46f-db18-4f56-b1f1-e9ded665d894","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"34eb1c20-4a5f-446c-a191-30ba4fa348a3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7ca8f3e0-f81a-48a1-9a81-f5abf8969423","typeOfStateId":"state","$connId":"con_918","$id":"50649ead-7c41-45f4-9f73-389eeceaba17","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"7f62fac6-7150-4366-831d-a52a89217132","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"3a278e7a-a753-4c10-99be-17488089ee7a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n\t{\n\t\t\"id\": \"1\",\n\t\t\"title\": \"Link de Pagamento\",\n\t\t\"description\": \"\"\n\t},\n\t{\n\t\t\"id\": \"2\",\n\t\t\"title\": \"Portal Link\",\n\t\t\"description\": \"\"\n\t},\n\t{\n\t\t\"id\": \"3\",\n\t\t\"title\": \"API Safrapay\",\n\t\t\"description\": \"\"\n\t},\n\t{\n\t\t\"id\": \"4\",\n\t\t\"title\": \"TEF\",\n\t\t\"description\": \"\"\n\t}\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n\tif (posicao > menuOptions.length) {\n\t\tposicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n\t}\n\tif (menuOptions.find(option => option.id == posicao)) {\n\t\tquantidadeItens = menuOptions.length\n\t\tfor (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n\t\t\tmenuOptions[i].id = (i + 2).toString()\n\t\t}\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72) || ''\n\t\t})\n\t} else {\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72)\n\t\t})\n\t}\n\tmenuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n\t// Parametro de busca é o title ou description da opção que deseja atualizar\n\tconst opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tmenuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n\tmenuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (permissoes.includes(permissoesNecessarias)) {\n\t\treturn\n\t}\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions.splice(index, 1)\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions.splice(index, 1)\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n\ttry {\n\t\t// const { ec } = JSON.parse(contaSelecionada)\n\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, vale lembrar que as vendas feitas na sua maquininha podem demorar até *1 dia útil* para aparecer no seu extrato.\n\nVeja como posso te ajudar.`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": menuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\terror: err.message,\n\t\t\texceptionType: 'reiniciarFluxo',\n\t\t\tdynamicContent: {\n\t\t\t\t\"type\": \"text/plain\",\n\t\t\t\t\"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n\t\t\t}\n\t\t}\n\t}\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5e668d0a-4f52-4950-b1c9-72efe3575aea","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"a91879b4-dea1-43c1-977d-57bf11967d03","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"cea7b103-af81-404d-9f97-22f35bb58d22","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b8fd297c-e2c1-4b4f-b9d4-4af73e6a1557","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-32ebcb60-da72-4c37-99db-416334a95b8e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b9509fa8-3110-4820-a3f4-f96a9d991b5e","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-9ea99a42-7273-4fa2-ac52-24c3e38f1390","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4ad60f8f-8c23-44a7-8528-9dbd3c0c6536","root":false,"$title":"[M.5.2.0][MSG] Venda Online","$position":{"top":"1807.67px","left":"544px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7ca8f3e0-f81a-48a1-9a81-f5abf8969423":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"c9016473-d211-44eb-97c7-e7bc60f461c1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"da2d874f-8dc3-430d-9e90-7cb00ac1bd57","typeOfStateId":"state","$connId":"con_923","$id":"2ba0ca5f-88e9-42bb-be58-4dc618a0628e","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["TEF"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"16c97c97-32b5-4249-a279-ba2c2ee817c9","typeOfStateId":"state","$connId":"con_928","$id":"705d3d41-9047-46a2-ac98-ae5722801cc1","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"1d9d8b89-4338-4fa7-9526-db7d677e1f11","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2eef2c40-51db-49e3-aea0-53a79ca131a5","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"ee723013-22a9-4e7f-b5aa-d05a1aa24fa3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1bcea604-b657-40a1-8968-1bebe56ece99","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b8dca639-0851-49d7-8729-1ffbc37ee138","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-229cd72a-e10d-4802-afff-43e234b1f7ed","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7ca8f3e0-f81a-48a1-9a81-f5abf8969423","root":false,"$title":"[M.5.2.0][INPUT] Venda Online","$position":{"top":"2006.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"16c97c97-32b5-4249-a279-ba2c2ee817c9":{"$contentActions":[{"action":{"$id":"4fdb0a5d-f536-4390-9bf1-bfcf87e81114","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4058f9ed-04ff-4401-b6e6-54bf1ce5bcb1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4058f9ed-04ff-4401-b6e6-54bf1ce5bcb1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28af84c1-1d5d-493c-8f82-979f92e86f4c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a8fcedce-c08e-468a-9aea-c7cb5c0f6659","type":"text/plain","content":"{{msgVendaOnline}}","metadata":{}},"$cardContent":{"document":{"id":"a8fcedce-c08e-468a-9aea-c7cb5c0f6659","type":"text/plain","content":"{{msgVendaOnline}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1456b57a-3dfc-4a28-81eb-519d6321e51f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9d2ac225-26f9-4cdf-b13c-1b86bef1d5c0","typeOfStateId":"state","$connId":"con_933","$id":"b4430d47-650b-43ca-b7ae-95c03d9dbf3b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"605603b4-ec2c-43e6-bcda-3bab5bb04f00","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgVendaOnline\"","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    const msg = input;\n \n    if (msg == \"Link de Pagamento\") {\n        return \"O *Link de pagamento* Safrapay é uma solução rápida e fácil que permite a você compartilhar um link pela internet para que seus clientes realizem pagamento à distância.\\n\\nAceite os principais meios de pagamento do mercado com maior segurança através do *Antifraude Safrapay.*\"\n    }\n \n    if (msg == \"Portal Link\") {\n        return \"Com *Portal Link* Safrapay, você tem acesso a uma ferramenta completa para aumentar sua gestão e acompanhamento. \\n\\nIsso possibilita criar usuários para acesso individualizado, detalhar as transações, exportar relatórios e gerar link de forma rápida. \\n\\nAlém disso, oferece um dashboard completo para acompanhamento da sua taxa de aprovação.\"\n    }    \n \n    if (msg == \"API Safrapay\") {\n        return \"Através da *API Safrapay*, tenha acesso a diversas funcionalidades para aumentar a conversão nas suas vendas online.\\n\\nAceite os principais meios de pagamento com maior segurança, ou, se preferir, faça sua integração conosco através dos gateways e plataformas parceiras.\"\n    }   \n}","inputVariables":["userInput"],"outputVariable":"msgVendaOnline","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6968d948-3b20-4624-a73a-45490d19fa09","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e25f0c05-deae-4763-917d-31e12be85299","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6e91b0fb-5942-45c9-9e9d-e19a11f8c527","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7e272e1e-9005-4f39-b586-b03fecd29044","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"16c97c97-32b5-4249-a279-ba2c2ee817c9","root":false,"$title":"[M.5.2.1][MSG] FAQ Venda Online","$position":{"top":"2211.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9d2ac225-26f9-4cdf-b13c-1b86bef1d5c0":{"$contentActions":[{"action":{"$id":"67e70cc9-6393-4d37-ba36-ab42735b0eed","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"2098d415-a968-45b8-b588-9b9cc6dcf4ef","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"2098d415-a968-45b8-b588-9b9cc6dcf4ef","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"39c28537-59ae-4084-b6af-709065d95861","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"230ef0f6-57ed-4fd0-9e7d-5b3ca97fa12d","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1062b696-f6b1-451a-b62a-58750c8bb9b4","typeOfStateId":"state","$connId":"con_938","$id":"9bd7e953-35f1-4655-ab3d-8151dbbc4797","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"03a443b4-a97a-48bb-9f3d-66c22dc4f02b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run() {\n\treturn {\n\n\t\t\"recipient_type\": \"individual\",\n\n\t\t\"type\": \"interactive\",\n\n\t\t\"interactive\": {\n\n\t\t\t\"type\": \"button\",\n\t\t\t\"body\": {\n\n\t\t\t\t\"text\": \"Consegui te ajudar?\"\n\n\t\t\t},\n\n\t\t\t\"action\": {\n\n\t\t\t\t\"buttons\": [\n\n\t\t\t\t\t{\n\n\t\t\t\t\t\t\"type\": \"reply\",\n\n\t\t\t\t\t\t\"reply\": {\n\n\t\t\t\t\t\t\t\"id\": \"unique-postback-id\",\n\n\t\t\t\t\t\t\t\"title\": \"Sim\"\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t},\n\n\t\t\t\t\t{\n\n\t\t\t\t\t\t\"type\": \"reply\",\n\n\t\t\t\t\t\t\"reply\": {\n\n\t\t\t\t\t\t\t\"id\": \"unique-id\",\n\n\t\t\t\t\t\t\t\"title\": \"Não\"\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t]\n\n\t\t\t}\n\n\t\t}\n\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e22386f9-dd5f-4f2d-8f57-a33d6822d920","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-27817b87-edb8-4d29-9c53-1a390ed3bbca","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d1bc1a41-62e1-4e71-bee9-33e1af2f05b9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7376dc7e-6306-4980-bbeb-b76430928061","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"9d2ac225-26f9-4cdf-b13c-1b86bef1d5c0","root":false,"$title":"[M.5.2.2][MSG] Resposta foi util","$position":{"top":"2464.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1062b696-f6b1-451a-b62a-58750c8bb9b4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"45bbe750-410e-4ed2-ae6b-af6797032ca6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b52fb46d-d8fc-42bd-b149-dc828615ec19","typeOfStateId":"state","$connId":"con_943","$id":"d68b370b-ee59-4445-88c0-64deb8ea831a","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Sim"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"da2d874f-8dc3-430d-9e90-7cb00ac1bd57","typeOfStateId":"state","$connId":"con_948","$id":"4424960d-a89b-4570-adf8-8e658840c2f2","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Não"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"b2abb1c4-68c3-43be-9708-1df16c8216cf","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b67506e9-1348-4bd2-9d1f-72288bb37b76","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"b29a2d6b-f100-4c40-8979-81e6a45a518b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"861c93fb-7fe9-4f4f-b689-f0d96126b41b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Main {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Main {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-01a2554d-38eb-4717-af23-623995050df1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1e8e9fc8-cb54-410d-b2ff-bcfb9a13a2d1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ab5560b4-b1c8-4af2-b3b4-46d75bb82dd9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b104e021-dbd4-4441-98f1-2d00f847fca5","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1062b696-f6b1-451a-b62a-58750c8bb9b4","root":false,"$title":"[M.5.2.2][INPUT] Resposta foi util","$position":{"top":"2690.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3bd1f502-d1bd-45b4-9021-a9a7c7f6d192":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"de0209ba-cc78-4ccc-a44d-8ebb5b84cd0a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"462596bd-3e1f-480a-85b5-4c2e948e4109","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tpreviousStateName: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: 'WhatsApp PJ',\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: 'Vendas Online',\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"088fa28a-94a8-4880-aa0f-da3b5b9fda81","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]}],"$leavingCustomActions":[{"$id":"d020a3f2-daee-4595-b129-c1d5f7d88fd6","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5a0a5bb3-d630-4f0a-b832-212bde4febd2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d95560e7-07a3-4daa-9c58-765194bb071d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-1153877e-ed8b-4372-b6b5-541a672f238d","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"3bd1f502-d1bd-45b4-9021-a9a7c7f6d192","root":false,"$title":"[Redirect] serviço WhatsApp PJ (Vendas Online)","$position":{"top":"236px","left":"1209px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b33933ce-96ec-4f09-bd6f-b502c15124db":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c111cfa0-c629-4daa-9680-3ce628c37eff","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"b33933ce-96ec-4f09-bd6f-b502c15124db","root":false,"$title":"[GO TO] Redirect to Taxas e Condicoes","$position":{"top":"972px","left":"1868.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e1aff5a0-e120-4e0e-a1a2-67fae556c4b9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"7d0c2e76-2030-441b-835d-09c8a72332bd","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"17c7dad6-772d-4ea0-820d-5f79af6b3d85","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e1aff5a0-e120-4e0e-a1a2-67fae556c4b9","root":false,"$title":"[GO TO] Redirect to Consultar OS","$position":{"top":"859.286px","left":"1868.86px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f817dcce-1003-42db-a940-95c267d9a2c8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e6338af4-643d-4aa8-955e-9e07b7d94922","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"4f6e7e6d-21b4-4b11-9913-6aa5149a7469","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f817dcce-1003-42db-a940-95c267d9a2c8","root":false,"$title":"[GO TO] MS.5.0.0 Suporte e Configurações","$position":{"top":"1109.67px","left":"1868px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"17c7dad6-772d-4ea0-820d-5f79af6b3d85":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"5b733936-1903-4654-b904-fc7b72d289cc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Bot OS ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'fb46f9fc-1dfe-45f8-a9c6-09bfd80f21db',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"d02ef8e1-41a6-4df8-ae88-9f54609b5548","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-a3336255-c986-4204-a6c9-d7d50e7d6c72","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-138cf66c-18f0-48b9-b095-1135f487a332","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"17c7dad6-772d-4ea0-820d-5f79af6b3d85","$title":"[Redirect] To Consultar OS","$position":{"top":"247.5px","left":"1804px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"da2d874f-8dc3-430d-9e90-7cb00ac1bd57":{"$contentActions":[{"action":{"$id":"55d5c695-4011-4360-b296-a96112e2a753","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"20b06f5d-10be-4937-b1a3-4e14807d5938","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"20b06f5d-10be-4937-b1a3-4e14807d5938","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6c82c0c4-03da-4b05-9d39-28d25eafb334","$typeOfContent":"text","type":"SendMessage","settings":{"id":"41c3b137-9b08-423d-8f8d-ede53b58ed66","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"41c3b137-9b08-423d-8f8d-ede53b58ed66","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc3c9349-2f7a-499b-b122-83ad67de8220","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"3bd1f502-d1bd-45b4-9021-a9a7c7f6d192","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-93ffad9c-762b-4161-a353-481f15350a0c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"da2d874f-8dc3-430d-9e90-7cb00ac1bd57","root":false,"$title":"[GO TO] Redirect To WhatsApp PJ (Vendas Online)","$position":{"top":"2313.67px","left":"146px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b52fb46d-d8fc-42bd-b149-dc828615ec19":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3dff3012-ad26-4244-93f5-c3d9a572fdc0","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"b52fb46d-d8fc-42bd-b149-dc828615ec19","root":false,"$title":"[GO TO] Redirect to Finalizacao","$position":{"top":"2925.67px","left":"545px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6f1f1e0c-4552-4f1c-8756-7fe5e190db5a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"38c7b810-b485-4fbf-bf2c-f6123f9d34d5","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c391e959-860e-4eaf-86b9-71fcd8888c86","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"6f1f1e0c-4552-4f1c-8756-7fe5e190db5a","root":false,"$title":"[GO TO] MS.2.0.0 Simulador de Vendas","$position":{"top":"1441.67px","left":"1374.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f043bcf4-0318-4aa7-91b7-4e76c9c3f701":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8b0c2584-0041-45c6-93a2-783de7a8a312","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"4051c1ad-de53-4ef3-bfa0-add7a989e960","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f043bcf4-0318-4aa7-91b7-4e76c9c3f701","root":false,"$title":"[GO TO] MS. 4.0.0 Não recebi minha venda","$position":{"top":"1632.67px","left":"1373px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"29bd66a7-4ad7-49bb-94cd-e130dbbb90fe":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8e566e96-9d61-4951-84fe-47f3cc1ff9e6","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"29bd66a7-4ad7-49bb-94cd-e130dbbb90fe","root":false,"$title":"[GO TO] Redirect to Taxas e Condicoes","$position":{"top":"3495.33px","left":"2623.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2f71ab30-8070-459a-8b4e-42e21a806b2c":{"$contentActions":[{"action":{"$id":"8e4fdbbf-4e88-4311-884d-736acff5a89e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"57690764-7fc0-4344-bc40-537e0f4e13a0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"57690764-7fc0-4344-bc40-537e0f4e13a0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c448e438-2477-433b-9126-5a7f08b2c6d4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4bbe4222-1e7a-4372-a068-f8e55d6f05b9","type":"text/plain","content":"Para cancelar qualquer venda, é necessário cadastrar uma senha na própria máquina.","metadata":{}},"$cardContent":{"document":{"id":"4bbe4222-1e7a-4372-a068-f8e55d6f05b9","type":"text/plain","content":"Para cancelar qualquer venda, é necessário cadastrar uma senha na própria máquina."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"65105f29-5fba-43a1-aaa4-e339c6d98c69","typeOfStateId":"state","$connId":"con_953","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Você já cadastrou essa senha?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2b537db4-44cf-4473-9532-d62cb5bcf702","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-04197dfa-289b-4290-8fdb-f3a878c9a57d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-79049666-1869-4448-98e2-15313a7fa5cf","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2f71ab30-8070-459a-8b4e-42e21a806b2c","root":false,"$title":"[M.5.3.0][MSG] Cancelar Venda","$position":{"top":"1991px","left":"1340.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"65105f29-5fba-43a1-aaa4-e339c6d98c69":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"179ca13e-2c68-4278-8949-4b2c081f3969","typeOfStateId":"state","$connId":"con_958","$id":"18a13bda-ca05-417e-bfee-5a9ffc6c570e","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"bd21149e-3257-4413-83d5-21fa41bbc4a6","typeOfStateId":"state","$connId":"con_963","$id":"2e19111b-9973-44c3-9ed9-38685b9b7c5c","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0c3d7594-0b42-4a16-b9b3-04036c054beb","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7b9e2018-0395-4450-8766-eb73bcdc94cb","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-56c76e2b-088b-4e45-83d7-493874b9a950","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d2ac771e-e9a3-41d1-8897-104c24543c79","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"65105f29-5fba-43a1-aaa4-e339c6d98c69","root":false,"$title":"[M.5.3.0][INPUT] Cancelar Venda","$position":{"top":"2197.67px","left":"1340.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bd21149e-3257-4413-83d5-21fa41bbc4a6":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"629d9776-b085-4867-83cd-dfc957f9fbce","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Neste caso, será necessário realizar o cadastro.\n\nPara isso:\n\n1° Pressione o atalho <b>921.</b>\n\n2° Podem aparecer duas mensagens: \"Senha não cadastrada\" ou \"Digite sua senha\".","metadata":{}},"$cardContent":{"document":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Neste caso, será necessário realizar o cadastro.\n\nPara isso:\n\n1° Pressione o atalho <b>921.</b>\n\n2° Podem aparecer duas mensagens: \"Senha não cadastrada\" ou \"Digite sua senha\"."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5bb2d9d9-d9ed-43fb-a090-640b60e9593e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ef6b9f7c-cf31-4ea6-9f93-9bfac09b0fc7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ef6b9f7c-cf31-4ea6-9f93-9bfac09b0fc7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5edffbbb-69fe-40d0-b888-0f7bec6a2a58","$typeOfContent":"text","type":"SendMessage","settings":{"id":"202e3971-3795-4c73-b96d-85d4331f10ea","type":"text/plain","content":"Caso seja solicitado, siga as instruções para cadastrar sua senha:\n\n1° Digite os <b>4 primeiros dígitos</b> do CNPJ/CPF e confirme pressionando a tecla <b>verde.</b>\n\n2° Insira o <b>CEP do estabelecimento.</b>\n\n3° Cadastre uma <b>nova senha de 4 dígitos,</b> evitando números sequenciais ou repetidos.\n\n4° Finalize o processo.","metadata":{}},"$cardContent":{"document":{"id":"202e3971-3795-4c73-b96d-85d4331f10ea","type":"text/plain","content":"Caso seja solicitado, siga as instruções para cadastrar sua senha:\n\n1° Digite os <b>4 primeiros dígitos</b> do CNPJ/CPF e confirme pressionando a tecla <b>verde.</b>\n\n2° Insira o <b>CEP do estabelecimento.</b>\n\n3° Cadastre uma <b>nova senha de 4 dígitos,</b> evitando números sequenciais ou repetidos.\n\n4° Finalize o processo."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"515e56f3-3b93-4b51-b51d-b5d36857e205","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"50a22384-776a-4f21-884f-fee87744d5c0","typeOfStateId":"state","$connId":"con_968","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Conseguiu cadastrar a sua senha?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-57426f6a-daa4-4894-81b8-a086c8490202","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-01807409-84e4-447f-aed5-004ea3030775","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6474c006-17b0-4799-8724-9e13b53ab26f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bd21149e-3257-4413-83d5-21fa41bbc4a6","root":false,"$title":"[M.5.4.0][MSG] Instrucoes sem senha","$position":{"top":"2981px","left":"1842px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"50a22384-776a-4f21-884f-fee87744d5c0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"02b50670-f4e0-4b6e-aaa2-71f4fb57d53c","typeOfStateId":"state","$connId":"con_973","$id":"1153408b-20fa-4d80-ab52-f76af3e48242","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d3d438c4-7e57-440c-ae16-b78a24489e68","typeOfStateId":"state","$connId":"con_978","$id":"8528734e-f667-4480-a059-948d87079461","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3b0bb0e4-6cc3-43fa-b1cc-782469583274","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b7483782-1486-4bf3-a134-e4f859bf551a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-fb139165-2ef7-4bf6-80f8-b594bf856b27","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-26dcfbe4-b0af-4b7a-b48b-0db2d604bd50","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"50a22384-776a-4f21-884f-fee87744d5c0","root":false,"$title":"[M.5.4.0][INPUT] Instrucoes sem senha","$position":{"top":"3282px","left":"1841.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"179ca13e-2c68-4278-8949-4b2c081f3969":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f795d57e-53c8-431f-bdfa-975adbd91cca","typeOfStateId":"state","$connId":"con_983","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Última Transação\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Transações do Dia\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Outros dias\",\n\t\t\t\t\"description\": \"\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Qual transação deseja cancelar?` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Ver opções\", // <---- Titulo do botão\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-100d9bf8-ac46-41bd-95c6-006ae4939f89","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1b66edc6-3353-4f43-9de3-cdff1e43b239","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ceeda338-f542-4a78-bac6-bcf26316dd4c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"179ca13e-2c68-4278-8949-4b2c081f3969","root":false,"$title":"[M.5.3.1][MSG] Qual transacao","$position":{"top":"2633px","left":"1035px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f795d57e-53c8-431f-bdfa-975adbd91cca":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ee78bbc8-745c-4eed-ab7d-c35f0db195b3","typeOfStateId":"state","$connId":"con_988","$id":"b30733c4-d20c-4cd4-9c6e-6ca608b2e66c","conditions":[{"source":"context","comparison":"equals","values":["Última transação"],"variable":"userInput"}],"$invalid":false},{"stateId":"42169305-95d7-4178-8f73-a195425cfd74","typeOfStateId":"state","$connId":"con_993","$id":"39e5ed54-4a5b-4613-a0f8-364299d84746","conditions":[{"source":"context","comparison":"equals","values":["Transações do dia"],"variable":"userInput"}],"$invalid":false},{"stateId":"3577487a-9741-48f9-ad8b-c61134c88f7d","typeOfStateId":"state","$connId":"con_998","$id":"371c95eb-1563-45a6-85cc-763298cd8a0e","conditions":[{"source":"context","comparison":"equals","values":["Outros dias"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"861fc9b8-aa42-46b5-a3a0-0ea398840781","$typeOfContent":"","type":"SetVariable","$title":"Set \"tipoDeTransacaoCancelada\" with userInput","$invalid":false,"settings":{"variable":"tipoDeTransacaoCancelada","value":"{{userInput}}"},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fedbaafd-a8d1-4ab1-9e45-d865b2e5eea3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7ab35ecf-4acd-4431-bc8b-7c7d1ed34cf7","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-686fa706-4ef8-47be-a119-141f29edb246","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b1043247-44de-4c37-9169-fd44e15ba995","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"f795d57e-53c8-431f-bdfa-975adbd91cca","root":false,"$title":"[M.5.3.1][INPUT] Qual trasacao","$position":{"top":"2853.33px","left":"1034px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ee78bbc8-745c-4eed-ab7d-c35f0db195b3":{"$contentActions":[{"action":{"$id":"8f26a358-ffa2-496e-862f-8d76ebdbe59a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3324f5a6-5bef-4c62-9f9c-b394a20d8539","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3324f5a6-5bef-4c62-9f9c-b394a20d8539","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ddc61de6-586e-47d4-b888-2f750eb8e3a0","$typeOfContent":"text","type":"SendMessage","settings":{"id":"5b02b199-d66c-4b2e-aa2a-f97ed5748b2d","type":"text/plain","content":"Para cancelar a última transação:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>última</b> ou digite o atalho <b>81</b>.\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Insira, passe ou aproxime o cartão na máquina.","metadata":{}},"$cardContent":{"document":{"id":"5b02b199-d66c-4b2e-aa2a-f97ed5748b2d","type":"text/plain","content":"Para cancelar a última transação:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>última</b> ou digite o atalho <b>81</b>.\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Insira, passe ou aproxime o cartão na máquina."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"93086432-8017-4201-b419-005550333ac7","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1003","$id":"f0f55347-a21b-40d8-8a88-694a892de25b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false},{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1008","$id":"8f303af9-50d2-4968-b11a-ff86988c899f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b96d9f0a-30ab-404b-a884-31fa282751dc","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9978f133-a2c7-49b0-b41c-86be041dc890","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ed5721bd-487a-43de-b923-4982e3414130","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ee78bbc8-745c-4eed-ab7d-c35f0db195b3","root":false,"$title":"[M.5.3.2][MSG] Última transação","$position":{"top":"3160px","left":"771px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"42169305-95d7-4178-8f73-a195425cfd74":{"$contentActions":[{"action":{"$id":"2db82daa-9294-4dbf-99b3-3542877a3b77","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"54c0d85b-d4dc-47ef-b586-ae0d591e1e78","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"54c0d85b-d4dc-47ef-b586-ae0d591e1e78","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"053e1c04-5d9d-4394-bd23-6b77b91a73ec","$typeOfContent":"text","type":"SendMessage","settings":{"id":"df1ab2da-25ad-4fb0-9da6-41808eec238e","type":"text/plain","content":"Para cancelar demais transações no mesmo dia:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>\"por código\"</b> ou digite o atalho <b>82.</b>\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Informe o número do <b>NSU</b> da transação a ser cancelada e pressione <b>entra</b>.\n\n6. Insira, passe ou aproxime o cartão na máquina.","metadata":{}},"$cardContent":{"document":{"id":"df1ab2da-25ad-4fb0-9da6-41808eec238e","type":"text/plain","content":"Para cancelar demais transações no mesmo dia:\n\n1. Acesse o <b>menu</b>.\n\n2. Selecione a opção <b>cancelar</b>.\n\n3. Em seguida, selecione a opção <b>\"por código\"</b> ou digite o atalho <b>82.</b>\n\n4. Digite a <b>senha cadastrada.</b>\n\n5. Informe o número do <b>NSU</b> da transação a ser cancelada e pressione <b>entra</b>.\n\n6. Insira, passe ou aproxime o cartão na máquina."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8e2f9e89-9cab-4ec4-ae36-9fbe655ebec8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1013","$id":"188a611a-483a-4a73-9bdb-789d9a15fd89","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false},{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1018","$id":"9ef309d1-c555-40aa-b764-f57e46543233","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"743dd78b-1294-4786-8338-45c01a72eeff","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5cc70add-e925-49a2-8e62-48cfbe591bb6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-13f4ab89-c2d2-4261-9776-04ce5033903f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"42169305-95d7-4178-8f73-a195425cfd74","root":false,"$title":"[M.5.3.3][MSG] Transações do dia","$position":{"top":"3158px","left":"1033px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3577487a-9741-48f9-ad8b-c61134c88f7d":{"$contentActions":[{"action":{"$id":"c917d87a-628f-441e-9896-6cfcd5cc0f7b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b861341d-3b69-4e23-ae68-2106feb44c4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b861341d-3b69-4e23-ae68-2106feb44c4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"88a1d591-faca-4a99-8617-dffeb5a7e4c6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"41c64726-32ae-40d6-be2d-07ff9aabf74b","type":"text/plain","content":"Para cancelar uma venda após o dia da transação:\n\n1° Acesse o site: www.safra.com.br/pessoa-juridica\n\n2° Clique em <b>“cancelamento de vendas”.</b>","metadata":{}},"$cardContent":{"document":{"id":"41c64726-32ae-40d6-be2d-07ff9aabf74b","type":"text/plain","content":"Para cancelar uma venda após o dia da transação:\n\n1° Acesse o site: www.safra.com.br/pessoa-juridica\n\n2° Clique em <b>“cancelamento de vendas”.</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"06041a8a-ef6c-481c-9e4b-f6653f7d9f6c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7a6f331a-100a-4030-b145-2116a835e888","typeOfStateId":"state","$connId":"con_1023","$id":"3b132e1e-23f2-4764-9be8-0fd147c08e1d","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"51577fd5-61fa-48d4-b11a-6e2769630340","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-339b36f9-419d-4643-bc84-6f5915ae029c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-51445b29-1357-4c5e-9479-e6e2f2869b95","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3577487a-9741-48f9-ad8b-c61134c88f7d","root":false,"$title":"[M.5.3.4][MSG] Transações Outros Dias","$position":{"top":"3162px","left":"1319.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"68f61a0e-414c-4d79-bc30-3ea7af7d4ee2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"25991251-b486-423e-8a43-49f1c17ecef6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"656962f1-1814-43ee-9f4d-872a42f2f951","typeOfStateId":"state","$connId":"con_1028","$id":"53fa7443-3506-4fc7-9037-9b8b918c538a","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"728749a4-366a-4c0d-a3e1-464490888b52","typeOfStateId":"state","$connId":"con_1033","$id":"d27cf49b-94ee-4aed-bf88-7d4bb31c1379","conditions":[{"source":"context","comparison":"notExists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"293128be-9c10-41a4-a756-aeaae2dcf228","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"44cf9df6-0a6c-4fd4-ad05-64001a33cf75","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-be2d419c-1982-4275-8770-00dca864a915","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"68f61a0e-414c-4d79-bc30-3ea7af7d4ee2","root":false,"$title":"[M.5.6.0][LOGIC] Cliente carterizado?","$position":{"top":"4055px","left":"1032px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cf24777b-0dc4-44b9-969f-a9c1c4e552fc":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7ec5eb0b-06f0-4ed0-9aa5-ede058ce49de","typeOfStateId":"state","$connId":"con_1038","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Menu Principal\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Menu Anterior\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Falar com gerente\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t// {\n\t\t\t// \t\"id\": \"4\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"5\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"6\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"7\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"8\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"9\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \t\"id\": \"10\",\n\t\t\t// \t\"title\": \"\",\n\t\t\t// \t\"description\": \"\"\n\t\t\t// }\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, como podemos te ajudar?` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Assuntos\", // <---- Titulo do botão\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5e4df7b5-7635-403f-8374-128bb8ff727f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-aaa2e3c3-b5e4-46b8-9aae-26f68b9556ba","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1eed2f15-31fc-46d2-bf8e-cf825f8981c6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"cf24777b-0dc4-44b9-969f-a9c1c4e552fc","root":false,"$title":"[M.5.7.0][MSG] Como podemos ajudar? (EMP1)","$position":{"top":"4593px","left":"1303px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7ec5eb0b-06f0-4ed0-9aa5-ede058ce49de":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_1043","$id":"9ce4999f-6b8b-4435-8cb9-fdf34c26823c","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Menu Principal"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false,"stateId":"779f3426-cb43-4e48-b325-afe9d7daed41"},{"stateId":"728749a4-366a-4c0d-a3e1-464490888b52","typeOfStateId":"state","$connId":"con_1048","$id":"4d9465dd-2dad-401f-8b69-540bf76f98f1","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Falar com gerente"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"d221250a-163d-488f-a84d-11538e4663b5","typeOfStateId":"state","$connId":"con_1053","$id":"97a6b7c5-e1e4-4148-9865-1aeabfb7b810","conditions":[{"source":"context","comparison":"equals","values":["Menu Anterior"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-436c1fe5-8896-479f-a001-47d864d02c14","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f3f355d0-363a-42b7-a68c-a4d03afc6748","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-aeb71679-556a-4dba-9fea-a32aada57975","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-328fbb63-addb-4357-a33a-9e819ce17b86","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7ec5eb0b-06f0-4ed0-9aa5-ede058ce49de","root":false,"$title":"[M.5.7.0][INPUT] Como podemos ajudar? (EMP1)","$position":{"top":"4859px","left":"1022px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"656962f1-1814-43ee-9f4d-872a42f2f951":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"307f84bd-662a-49b4-9bf1-3772df28581b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"cf24777b-0dc4-44b9-969f-a9c1c4e552fc","typeOfStateId":"state","$connId":"con_1058","$id":"563aed27-41a6-4834-aaab-88bb3328f8b4","conditions":[{"source":"context","comparison":"equals","values":["emp1"],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"728749a4-366a-4c0d-a3e1-464490888b52","typeOfStateId":"state","$connId":"con_1063","$id":"7d78fa3e-7ca8-4b32-b30d-5bc1cbf2b8f2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1ee54c11-c7ad-46b5-b29c-4d4060b3026a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"e959fa2c-a861-466b-a6ec-f5b876ec8fdd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bec640d2-c35a-4330-bcd4-54e2b0105df1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"656962f1-1814-43ee-9f4d-872a42f2f951","root":false,"$title":"[M.5.7.0][LOGIC] Seguimento EMP1?","$position":{"top":"4383px","left":"1304px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"7a6f331a-100a-4030-b145-2116a835e888":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"2dd22f9a-89f5-4511-a4a3-2d5d2da457bb","typeOfStateId":"state","$connId":"con_1068","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Consegui te ajudar?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a2af1f86-840b-497c-85be-9055c31f5fc6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-22017b7e-3d73-4250-b421-a83ebcaf6893","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d3f6b7eb-fc1f-4bfc-bb1d-00598947d02c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7a6f331a-100a-4030-b145-2116a835e888","root":false,"$title":"[M.5.5.0][MSG] Conseguimos te ajudar?","$position":{"top":"3660px","left":"1032px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2dd22f9a-89f5-4511-a4a3-2d5d2da457bb":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"048f0bdd-8010-4f32-915c-a307fbec1701","typeOfStateId":"state","$connId":"con_1073","$id":"1a2890f7-e81c-4492-b80f-e928704ffabd","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"d3d438c4-7e57-440c-ae16-b78a24489e68","typeOfStateId":"state","$connId":"con_1078","$id":"8c32a683-8ac5-4670-9773-826ed3726b8e","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-081f21fd-fb7b-4157-b29a-78596a778fa6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cfc0f6ba-e53f-48b4-aa44-7ddea994b5c6","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-40eac594-2d93-46e3-822c-0796649ba772","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-013997d3-7ffa-4b3e-adc5-13fc048f04a1","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"2dd22f9a-89f5-4511-a4a3-2d5d2da457bb","root":false,"$title":"[M.5.5.0][INPUT] Conseguimos te ajudar?","$position":{"top":"3833px","left":"1032px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"048f0bdd-8010-4f32-915c-a307fbec1701":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"4931fe2b-740e-47cb-a7e5-a1537fa8944e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"048f0bdd-8010-4f32-915c-a307fbec1701","root":false,"$title":"[GO TO] Redirect Finalizacao","$position":{"top":"3855px","left":"761px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"728749a4-366a-4c0d-a3e1-464490888b52":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"6d0f93ba-75a0-44ed-8ce1-d210bdd8d423","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"728749a4-366a-4c0d-a3e1-464490888b52","root":false,"$title":"[GO TO] Redirect to Atendimento Humano","$position":{"top":"4373px","left":"713px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f2c4d052-2f9b-4aa8-9925-48aa824fc35c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"704dbd33-00b3-43d1-bd89-9dc566b692e1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `atendimentohumano ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7c5fc08a-b380-4fd2-a8e8-22e7c51e3bfd","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a202c193-c7ff-4362-a2f7-951269808519","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-edeef7c8-e27c-4392-b87f-3ab3f836daa2","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","root":false,"$title":"[Redirect] to Atendimento Humano","$position":{"top":"254px","left":"2197px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"779f3426-cb43-4e48-b325-afe9d7daed41":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"275da9c5-b39f-4c0d-8f37-793134f1fcf3","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"779f3426-cb43-4e48-b325-afe9d7daed41","root":false,"$title":"[GO TO] Redirect to Main (Menu Principal)","$position":{"top":"5070px","left":"726px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d221250a-163d-488f-a84d-11538e4663b5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"7e8e700c-f00b-49a8-8bb7-777d767809eb","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"2f71ab30-8070-459a-8b4e-42e21a806b2c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"d221250a-163d-488f-a84d-11538e4663b5","root":false,"$title":"[GO TO] MS.5.3.0 Cancelar Venda","$position":{"top":"5074.33px","left":"1301.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"02b50670-f4e0-4b6e-aaa2-71f4fb57d53c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cef173a7-afe9-40eb-8ef7-42b786979ec6","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"179ca13e-2c68-4278-8949-4b2c081f3969","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"02b50670-f4e0-4b6e-aaa2-71f4fb57d53c","root":false,"$title":"[GO TO][M.5.3.1][MSG] Qual transacao","$position":{"top":"3293px","left":"2060px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c7d28097-fb6e-4341-a690-b43b82085fad":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"629d9776-b085-4867-83cd-dfc957f9fbce","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Para fazer <b>upgrade</b> (trocar por um modelo superior) ou <b>downgrade</b> (trocar por um modelo mais simples) da sua máquina:\n\n1° Acesse o <b>Safra empresas.</b>\n\n2° Clique na opção <b>ver mais.</b>\n\n3° Selecione <b>maquininhas Safrapay.</b>\n\n4° Selecione <b>solicitar manutenção.</b>\n\n5° Clique em <b>trocar modelo.</b>","metadata":{}},"$cardContent":{"document":{"id":"f8a9a158-07cd-40c7-b0ba-20b4c04d96fc","type":"text/plain","content":"Para fazer <b>upgrade</b> (trocar por um modelo superior) ou <b>downgrade</b> (trocar por um modelo mais simples) da sua máquina:\n\n1° Acesse o <b>Safra empresas.</b>\n\n2° Clique na opção <b>ver mais.</b>\n\n3° Selecione <b>maquininhas Safrapay.</b>\n\n4° Selecione <b>solicitar manutenção.</b>\n\n5° Clique em <b>trocar modelo.</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"515e56f3-3b93-4b51-b51d-b5d36857e205","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d1b2e4e6-4dec-4e67-9ca4-53af5b4f5347","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"14dba1a2-517a-47d8-ac26-9df544934baa","typeOfStateId":"state","$connId":"con_1083","$id":"079ac376-a4b5-4b87-a244-a12133dc2444","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Consegui te ajudar?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-95a1d035-3e80-4a7f-a7b6-65600e74cee9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0d3b30e4-72e7-4e86-b4fc-424e3a650e4c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3e85d474-4fbf-4ff0-b008-e64d8b673f33","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c7d28097-fb6e-4341-a690-b43b82085fad","root":false,"$title":"[MS.9.0.0][MSG] Como fazer Downgrade/Upgrade","$position":{"top":"1341.71px","left":"1867.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"14dba1a2-517a-47d8-ac26-9df544934baa":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9ef4fb9b-5db9-4b4e-8d3c-154e06f61eca","typeOfStateId":"state","$connId":"con_1088","$id":"1153408b-20fa-4d80-ab52-f76af3e48242","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"32a2ffb0-0b79-4710-bc8b-eb9ec0357bbe","typeOfStateId":"state","$connId":"con_1093","$id":"8528734e-f667-4480-a059-948d87079461","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ca70e992-ac5f-408b-a661-0a17b7486ce6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-dd7624dc-5404-4fdb-85ec-f0e830927fa2","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ca1719d5-ad89-4d80-bf9b-ac8fb25250a1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0fe9c40b-0433-4f33-87c8-8e3ce90566c5","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"14dba1a2-517a-47d8-ac26-9df544934baa","root":false,"$title":"[MS.9.0.0][INPUT] Como fazer Downgrade/Upgrade","$position":{"top":"1655.5px","left":"1867.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9ef4fb9b-5db9-4b4e-8d3c-154e06f61eca":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"792ab32f-cf42-4700-9585-20269c690fe2","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9ef4fb9b-5db9-4b4e-8d3c-154e06f61eca","root":false,"$title":"[GO TO] Redirect to Finalizacao  ","$position":{"top":"1900px","left":"1713.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"32a2ffb0-0b79-4710-bc8b-eb9ec0357bbe":{"$contentActions":[{"action":{"$id":"58e477d2-bc8d-49e6-894b-72e719609fd4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8bba8b96-4db0-4001-b2d5-80ad5b4019e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8bba8b96-4db0-4001-b2d5-80ad5b4019e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b3b475c7-8140-4f3a-9207-f8ae73986a22","$typeOfContent":"text","type":"SendMessage","settings":{"id":"def06af8-8e75-4157-8688-24007683cbed","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"def06af8-8e75-4157-8688-24007683cbed","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"951d823c-2e88-4b94-8aa7-456ce3babe9e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a38197c5-c084-42c8-a599-79563bfd1698","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"32a2ffb0-0b79-4710-bc8b-eb9ec0357bbe","root":false,"$title":"[GO TO] Redirect to Atendimento Humano ","$position":{"top":"1871px","left":"2056px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e36dcaa0-0665-4b22-ae98-3e8605d7e557":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"de7d8593-8bd0-4fb0-9c8b-bce0561fcf51","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"b039b1aa-719e-462d-aefc-de01bc0ddd7b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: '30e39880-1d2a-439a-a0ed-1e7210966286',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (error) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: error.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"b329fc66-8d30-44ed-8449-df875c5a9eb2","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6b45fb91-93df-4d83-a386-ae2d506b362d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8d131c93-38e7-4019-9cb4-4b9a91edca04","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","root":false,"$title":"[Redirect] To Main (Menu inicial)","$position":{"top":"268.333px","left":"2387.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a5a5102b-730f-4d5a-92f4-190d1ada87ca":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4c237b9b-20cc-48a6-bee7-baefd00e0d43","typeOfStateId":"state","$connId":"con_1098","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n    {\n        \"id\": \"1\",\n        \"title\": \"Antecipação automática\",\n        \"description\": \"Contratar antecipação automática\"\n    },\n    {\n        \"id\": \"2\",\n        \"title\": \"Antecipação eventual\",\n        \"description\": \"Contratar antecipação eventual\"\n    },\n    {\n        \"id\": \"3\",\n        \"title\": \"Outras credenciadoras\",\n        \"description\": \"\"\n    },\n    {\n        \"id\": \"4\",\n        \"title\": \"Consulta status ARV\",\n        \"description\": \"Antecipação de recebíveis de vendas\"\n    },\n    {\n        \"id\": \"5\",\n        \"title\": \"Valores bloqueados\",\n        \"description\": \"Meus valores estão bloqueados\"\n    },\n    {\n        \"id\": \"6\",\n        \"title\": \"Cancelamento\",\n        \"description\": \"Cancelar antecipação\"\n    }\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n    if (posicao > menuOptions.length) {\n        posicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n    }\n    if (menuOptions.find(option => option.id == posicao)) {\n        quantidadeItens = menuOptions.length\n        for (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n            menuOptions[i].id = (i + 2).toString()\n        }\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72) || ''\n        })\n    } else {\n        menuOptions.push({\n            id: posicao.toString(),\n            title: title.slice(0, 24),\n            description: description.slice(0, 72)\n        })\n    }\n    menuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n    // Parametro de busca é o title ou description da opção que deseja atualizar\n    const opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n    if (!opcao) {\n        return\n    }\n    menuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n    menuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao);\n\n    if (!opcao) {\n        return;\n    }\n\n    const hasPermission = permissoesNecessarias.some(necessaria => permissoes.includes(necessaria));\n\n    if (hasPermission) {\n        return;\n    }\n\n    const index = menuOptions.indexOf(opcao);\n    if (index > -1) {\n        menuOptions.splice(index, 1);\n    }\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions.splice(index, 1)\n}\n\nfunction removeDescricaoDoBotao({ tituloDoBotao, parteASerRemovida, listaPermissoes, permissaoNecessaria }) {\n    if (listaPermissoes.includes(permissaoNecessaria)) {\n        return\n    }\n    const opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n    if (!opcao) {\n        return\n    }\n    const index = menuOptions.indexOf(opcao)\n    menuOptions[index].description = menuOptions[index].description.replace(parteASerRemovida, '')\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n    try {\n        const { segmentoGerente, permissoes } = JSON.parse(contaSelecionada)\n\n        if (!segmentoGerente) {\n            removeOpcaoDoMenu({ tituloDoBotao: 'Outras credenciadoras' })\n        }\n\n        verificaPermissao({ tituloDoBotao: 'Cancelamento', permissoesNecessarias: ['cancelarAntecipAutomatica'], permissoes })\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"list\",\n                \"header\": {\n                    \"type\": \"text\",\n                    \"text\": \"\"\n                },\n                \"body\": {\n                    \"text\": `Ótimo, o que você precisa sobre antecipação?`\n                },\n                \"action\": {\n                    \"button\": \"Ver opções\",\n                    \"sections\": [\n                        {\n                            \"title\": \"\",\n                            \"rows\": menuOptions\n                        }\n                    ]\n                }\n            }\n        }\n    } catch (err) {\n        return {\n            error: err.message,\n            exceptionType: 'reiniciarFluxo',\n            dynamicContent: {\n                \"type\": \"text/plain\",\n                \"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n            }\n        }\n    }\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dcc9ffa9-70b9-4696-83c5-a2461736f608","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"4a8d8aa0-5345-46d7-8cd2-f51fb2274c53","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"26432abb-ada2-47d2-97c7-7213b7d91800","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ca3cebdc-0649-4322-be00-73bc7bcfeafc","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ee34cccf-94fe-4401-9070-66e75c7be9be","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c0f9b77b-7b87-4761-95a2-203ebdd00c1d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-911da8d6-280c-4f10-a7a8-a0a2ac85f501","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a5a5102b-730f-4d5a-92f4-190d1ada87ca","root":false,"$title":"[MS.10.0.0][MSG] Menu Antecipação","$position":{"top":"3863px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4c237b9b-20cc-48a6-bee7-baefd00e0d43":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8f3f6d82-eb95-42af-82c6-86e9a4438a9c","typeOfStateId":"state","$connId":"con_1103","$id":"efe44cd9-a5f9-48db-99f5-d6b6640cf97b","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Antecipação Automática"],"source":"context","comparison":"contains","variable":"userInput"}],"$invalid":false},{"stateId":"76280067-42cb-426f-8675-bf5e7bfe226a","typeOfStateId":"state","$connId":"con_1108","$id":"e4466e11-becb-4426-b060-4d21b7dedfb8","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Antecipação eventual"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"2ffe873a-3607-4860-b954-25c34139551a","typeOfStateId":"state","$connId":"con_1113","$id":"08a73cfe-70d5-4bfe-abae-9a84c8ec82c7","conditions":[{"source":"context","comparison":"equals","values":["Outras credenciadoras"],"variable":"userInput"}],"$invalid":false},{"stateId":"87114d80-0d65-4e2b-af38-cf5ba2c2ae03","typeOfStateId":"state","$connId":"con_1118","$id":"e5061ae7-3361-4c13-be9f-df6ec4b9388f","conditions":[{"source":"context","comparison":"notEquals","values":["Input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-99e431a0-1f3d-4f8d-924b-6d32ebb6cdae","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-99c77fd9-8062-4629-bf13-99f064f928b1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e9a27ea5-9b82-48c2-a676-7ba68c2ef4b3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-dbb301bd-a7f5-4483-b6ed-4a3d32e79da7","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4c237b9b-20cc-48a6-bee7-baefd00e0d43","root":false,"$title":"[MS.10.0.0][INPUT] Menu Antecipação","$position":{"top":"4165px","left":"2758px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8f3f6d82-eb95-42af-82c6-86e9a4438a9c":{"$contentActions":[{"action":{"$id":"99a96b1a-b09c-4202-8862-d7b4602d7ac0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87d75b86-a144-4aa2-86ea-2431e4b6fe9a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação automática:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>habilitar</b>.\n\n3° Escolha a modalidade desejada: diária, semanal ou programada.\n\n4° Por fim, valide a contratação com sua senha.","metadata":{}},"$cardContent":{"document":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação automática:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>habilitar</b>.\n\n3° Escolha a modalidade desejada: diária, semanal ou programada.\n\n4° Por fim, valide a contratação com sua senha."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"200e12c3-550a-49e8-9d8e-2ee65440c421","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a860f92e-db91-4469-9f66-c60e4847cbe1","typeOfStateId":"state","$connId":"con_1123","$id":"b318c3d6-22ab-4fbf-817c-f50e7be3fec8","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"47f0eaf6-355b-4a3a-a3d1-4fa167d1ae6c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9975f9df-af72-4866-b33a-a18bc4a9e078","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-42f6ee19-f98c-4add-80d6-ba64dcb5f18b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8f3f6d82-eb95-42af-82c6-86e9a4438a9c","root":false,"$title":"[MS.10.1.0][MSG] Contratar Antecipação Automatica","$position":{"top":"4451px","left":"2495px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"76280067-42cb-426f-8675-bf5e7bfe226a":{"$contentActions":[{"action":{"$id":"99a96b1a-b09c-4202-8862-d7b4602d7ac0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fedff260-fea7-4497-9b06-508ca58acd4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87d75b86-a144-4aa2-86ea-2431e4b6fe9a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação eventual:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>solicitar antecipação eventual</b>.\n\n3° Selecione a <b>bandeira</b> e o <b>valor</b> que deseja antecipar.\n\n4° Finalize a contratação com seus <b>dados</b> e <b>senha</b>.","metadata":{}},"$cardContent":{"document":{"id":"091696a5-696e-42b9-9a9d-02dda35227a5","type":"text/plain","content":"Para contrar a antecipação eventual:\n\n1° No app <b>Safra empresas</b>, acesse o <b>menu Safrapay</b>.\n\n2° Selecione <b>antecipação Safrapay</b> e clique em <b>solicitar antecipação eventual</b>.\n\n3° Selecione a <b>bandeira</b> e o <b>valor</b> que deseja antecipar.\n\n4° Finalize a contratação com seus <b>dados</b> e <b>senha</b>."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"200e12c3-550a-49e8-9d8e-2ee65440c421","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a860f92e-db91-4469-9f66-c60e4847cbe1","typeOfStateId":"state","$connId":"con_1128","$id":"f862d498-9b71-4765-b797-a6e5aa24e632","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"d90ce903-0495-4fc4-a438-060097e94d3e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d95e4e67-a496-44a3-86fe-b61c2b5d7b9a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-714c0ca7-288e-47b9-b60e-20cbc7f38a97","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"76280067-42cb-426f-8675-bf5e7bfe226a","root":false,"$title":"[MS.10.2.0][MSG]Contratar Antecipação Eventual","$position":{"top":"4455px","left":"2956px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2ffe873a-3607-4860-b954-25c34139551a":{"$contentActions":[{"action":{"$id":"dc25a00b-3f8e-40e7-b1e7-4d8f0ebfcf0b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"54ada81d-b8f3-4600-84be-8f1684ea54a3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"54ada81d-b8f3-4600-84be-8f1684ea54a3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ddb4cf9a-b01a-4977-844c-2263e4408fac","$typeOfContent":"text","type":"SendMessage","settings":{"id":"13ffceac-1fc0-4acb-a2f2-e54606a6c581","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"13ffceac-1fc0-4acb-a2f2-e54606a6c581","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"185f44cf-e607-4877-927c-8a125625cbd9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f2c4d052-2f9b-4aa8-9925-48aa824fc35c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"2ffe873a-3607-4860-b954-25c34139551a","root":false,"$title":"[GO TO] Redirect to Atendimento Humano","$position":{"top":"5531px","left":"2543px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a860f92e-db91-4469-9f66-c60e4847cbe1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"25991251-b486-423e-8a43-49f1c17ecef6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6dea6981-7b58-4bcb-8d42-ae88222752c3","typeOfStateId":"state","$connId":"con_1133","$id":"53fa7443-3506-4fc7-9037-9b8b918c538a","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"5b7baa1b-0a6b-46ec-ba01-89fe4abc0f96","typeOfStateId":"state","$connId":"con_1138","$id":"d27cf49b-94ee-4aed-bf88-7d4bb31c1379","conditions":[{"source":"context","comparison":"notExists","values":[],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"293128be-9c10-41a4-a756-aeaae2dcf228","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"44cf9df6-0a6c-4fd4-ad05-64001a33cf75","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-12b24346-b258-48d7-b7ff-0a57fed18072","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"a860f92e-db91-4469-9f66-c60e4847cbe1","root":false,"$title":"[M.10.3.0][LOGIC] Cliente carterizado?","$position":{"top":"4733.25px","left":"2757.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"72e19ac3-74de-4bab-9c2e-f61ec8323b7e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"307f84bd-662a-49b4-9bf1-3772df28581b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0e1b1b41-8bd0-4455-b681-89cb62d82eb3","typeOfStateId":"state","$connId":"con_1143","$id":"563aed27-41a6-4834-aaab-88bb3328f8b4","conditions":[{"source":"context","comparison":"equals","values":["emp1"],"variable":"contaSelecionada@segmentoGerente"}],"$invalid":false},{"stateId":"2ffe873a-3607-4860-b954-25c34139551a","typeOfStateId":"state","$connId":"con_1148","$id":"7d78fa3e-7ca8-4b32-b30d-5bc1cbf2b8f2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1ee54c11-c7ad-46b5-b29c-4d4060b3026a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"e959fa2c-a861-466b-a6ec-f5b876ec8fdd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"Gerente | {{contaSelecionada@segmentoGerente}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-af45e790-3214-49bf-9c91-1e16e012218b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"72e19ac3-74de-4bab-9c2e-f61ec8323b7e","root":false,"$title":"[M.10.4.0][LOGIC] Seguimento EMP1?","$position":{"top":"5336px","left":"2960px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"0e1b1b41-8bd0-4455-b681-89cb62d82eb3":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0247a648-855d-4503-b0da-0881b9f5a533","typeOfStateId":"state","$connId":"con_1153","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Ver o menu incial\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Ver o menu anterior\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Falar com gerente\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Será que consigo te ajudar de outra forma?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a6428eeb-fba8-4ac7-810c-a5ec4044b90a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-829e170c-fb7f-493a-9e3c-efdc07ac7c06","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-eb3ba4e1-7494-4238-9691-ab7995fa6854","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0e1b1b41-8bd0-4455-b681-89cb62d82eb3","root":false,"$title":"[M.10.5.0][MSG] Como podemos ajudar? (EMP1)","$position":{"top":"5546.67px","left":"2960px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0247a648-855d-4503-b0da-0881b9f5a533":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_1158","$id":"9ce4999f-6b8b-4435-8cb9-fdf34c26823c","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Ver o menu incial"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false,"stateId":"7248b15d-01f6-44e7-ab77-ac9917d9b140"},{"stateId":"2ffe873a-3607-4860-b954-25c34139551a","typeOfStateId":"state","$connId":"con_1163","$id":"4d9465dd-2dad-401f-8b69-540bf76f98f1","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Falar com gerente"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"efb4fbac-3d65-441d-994d-1fe19448b82d","typeOfStateId":"state","$connId":"con_1168","$id":"4da266cf-7880-405d-9101-56dbbb1ea5b2","conditions":[{"source":"context","comparison":"equals","values":["Ver o menu anterior"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction botao(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction lista(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}\n\nfunction run(inputUsuario, dynamicContent) {\n  try {\n    if(!inputUsuario) {\n      return 'inatividade'\n    }\n    if (JSON.parse(dynamicContent).interactive.type === 'button') {\n        return botao(inputUsuario, dynamicContent)\n    } else {\n        return lista(inputUsuario, dynamicContent)\n    }\n  } catch (err) {\n    return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-926ac38c-033c-4060-92e1-8652ee437780","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5870ba39-4608-4191-9ab8-6267e82c801a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c9a83ddc-b757-42e8-8333-42e54c1c5ade","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-93b0eec3-6325-46ca-8757-91f5058c4122","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"0247a648-855d-4503-b0da-0881b9f5a533","root":false,"$title":"[M.10.5.0][INPUT] Como podemos ajudar? (EMP1)","$position":{"top":"5817.33px","left":"2959.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"7248b15d-01f6-44e7-ab77-ac9917d9b140":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"275da9c5-b39f-4c0d-8f37-793134f1fcf3","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"7248b15d-01f6-44e7-ab77-ac9917d9b140","root":false,"$title":"[GO TO] Redirect to Main (Menu Principal)","$position":{"top":"5886.67px","left":"2407.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"efb4fbac-3d65-441d-994d-1fe19448b82d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea868f10-624c-4979-9a24-543bfe08cd94","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5a5102b-730f-4d5a-92f4-190d1ada87ca","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"efb4fbac-3d65-441d-994d-1fe19448b82d","root":false,"$title":"[GO TO] MS.10.0.0 Antecipação","$position":{"top":"5756.33px","left":"2407.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a4599177-c976-4921-9be9-ca6fa0d0d574":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"be41d916-189b-4c8e-b51d-7476b570afd3","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5a5102b-730f-4d5a-92f4-190d1ada87ca","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"a4599177-c976-4921-9be9-ca6fa0d0d574","root":false,"$title":"[GO TO] MS.10.0.0  Antecipacao","$position":{"top":"746.286px","left":"1871px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5b7baa1b-0a6b-46ec-ba01-89fe4abc0f96":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e0255a9a-6ef8-41b9-8702-3efb0baafc5e","typeOfStateId":"state","$connId":"con_1173","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Ver o menu incial\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Ver o menu anterior\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"O que você gostaria de fazer agora?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fff31e89-6b5f-4706-b7e0-36b1f138b9b2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8d36c70b-bdd7-49b8-acf2-4d8803140bfd","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-59793950-2382-43da-87ff-2514162f5508","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5b7baa1b-0a6b-46ec-ba01-89fe4abc0f96","root":false,"$title":"[M.10.3.1][MSG] Menu Sem Carteira","$position":{"top":"4929px","left":"2005px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e0255a9a-6ef8-41b9-8702-3efb0baafc5e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_1178","$id":"9ce4999f-6b8b-4435-8cb9-fdf34c26823c","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["Ver o menu incial"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false,"stateId":"7248b15d-01f6-44e7-ab77-ac9917d9b140"},{"stateId":"efb4fbac-3d65-441d-994d-1fe19448b82d","typeOfStateId":"state","$connId":"con_1183","$id":"4da266cf-7880-405d-9101-56dbbb1ea5b2","conditions":[{"source":"context","comparison":"equals","values":["Ver o menu anterior"],"variable":"userInput"}],"$invalid":false},{"stateId":"0a14602f-f7b5-46eb-bbdd-c824fea248c9","typeOfStateId":"state","$connId":"con_1188","$id":"487d282c-05c5-4b52-a566-f51ac94b303d","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"e92b1099-6dfa-4974-bdde-8b7286ba3462","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"83c99b99-48c9-4ca8-9ff6-4b57fc8b8c6e","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-66f52407-14b7-4c4d-8276-cba426aa1a72","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ba3be873-6bf1-467d-9120-adb966c03f71","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-cbc1277c-b08f-41f9-8de3-d3b15f6e1d2b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f3f62486-ac0b-4e86-8a23-71077fd2f004","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e0255a9a-6ef8-41b9-8702-3efb0baafc5e","root":false,"$title":"[M.10.3.1][INPUT] Menu Sem Carteira","$position":{"top":"5804px","left":"2004px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"6dea6981-7b58-4bcb-8d42-ae88222752c3":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9b0b8b25-dfa1-437d-a2a2-1ee1d3c5ebe1","typeOfStateId":"state","$connId":"con_1193","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Consegui te ajudar?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0fb72ad1-661f-4ea6-b9da-1ca73f98be5d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-90513bc1-606f-464a-aeca-791d746e7f65","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4de38b8e-ba86-4a75-9186-b68a170b7ad9","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6dea6981-7b58-4bcb-8d42-ae88222752c3","root":false,"$title":"[M.10.3.1][MSG] Conseguimos te ajudar?","$position":{"top":"4921px","left":"2962px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9b0b8b25-dfa1-437d-a2a2-1ee1d3c5ebe1":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ee424cb6-5b7f-473c-9eaa-f22d58c1c686","typeOfStateId":"state","$connId":"con_1198","$id":"39187c73-d381-469f-a695-262719c7a4f1","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"72e19ac3-74de-4bab-9c2e-f61ec8323b7e","typeOfStateId":"state","$connId":"con_1203","$id":"b3983758-ac0e-4c89-aea6-c495831a7eab","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-03d61cc2-634d-4261-8ac9-c9a63a0d246c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8f1338e5-504e-45ee-83be-a37b28d66fcd","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e60d45cf-6073-46e9-b207-ea3ef0e5e007","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9e3741a0-d589-461b-b0bb-0ff19e0daf1c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9b0b8b25-dfa1-437d-a2a2-1ee1d3c5ebe1","root":false,"$title":"[M.10.3][INPUT] Conseguimos te ajudar?","$position":{"top":"5140.5px","left":"2960.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ee424cb6-5b7f-473c-9eaa-f22d58c1c686":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d24f1072-0226-4389-8fa4-1ef80bde80de","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"ee424cb6-5b7f-473c-9eaa-f22d58c1c686","root":false,"$title":"[GO TO] Finalizacao","$position":{"top":"5270px","left":"2684px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d3d438c4-7e57-440c-ae16-b78a24489e68":{"$contentActions":[{"action":{"$id":"c89a345c-0fb4-41e6-bd78-a3fb6eb746df","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bc151dc5-557e-406c-9f57-cd0434f1fa1b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bc151dc5-557e-406c-9f57-cd0434f1fa1b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fe9ca734-6683-4e14-989b-a6a9affc2c22","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1426b76c-fa01-43b2-81e1-baebcc331ecb","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"1426b76c-fa01-43b2-81e1-baebcc331ecb","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '5724999e-4ebb-443e-8b1d-4c15ef40251e',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Máquina Safrapay ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"71e66d5e-ddc0-48d4-930d-8630f59d2205","type":"Redirect","$title":"Redirect to {state} sending {userInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@userInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d7f0764c-950a-4c06-9de9-e42b6d6bf896","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2579ed84-d800-46ff-a0bb-aec323b4ec3c","label":"Redirect","background":"#1EA1FF","canChangeBackground":false},{"id":"blip-tag-f8fd7f60-5440-44e6-b178-5cd126a11d09","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d3d438c4-7e57-440c-ae16-b78a24489e68","root":false,"$title":"[Redirect] to Autenticacao (Falar sobre conta)","$position":{"top":"3833px","left":"1842px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fef763ef-e7cb-454e-9e26-e696b9b5a126":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9a883544-be29-422a-90f1-64d574057c1c","type":"text/plain","textContent":"User input","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c6aaf603-0246-480b-927c-6e5c926e41f2","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"fef763ef-e7cb-454e-9e26-e696b9b5a126","root":false,"$title":"[GO TO] Finalizacao ","$position":{"top":"3575px","left":"1257px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c08c2e55-852c-49e8-a1e6-aa81bc5188fe":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '5724999e-4ebb-443e-8b1d-4c15ef40251e',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Máquina Safrapay ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"71e66d5e-ddc0-48d4-930d-8630f59d2205","type":"Redirect","$title":"Redirect to {state} sending {userInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@userInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-16c589e4-42b6-4f64-aa01-d049dd884e1f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5c15cf93-b839-4aae-8f1b-13df720dfaa0","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"c08c2e55-852c-49e8-a1e6-aa81bc5188fe","root":false,"$title":"[Redirect] to Autenticacao (Whatsapp PJ Atendente)","$position":{"top":"4279px","left":"3441px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"227c3938-627f-4a0a-8136-ddb558c334ed":{"$contentActions":[{"action":{"$id":"dd75ec0c-0870-4f21-8e88-5b31268d8428","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"01a2b024-d22c-4132-8397-3573f32c0df1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"01a2b024-d22c-4132-8397-3573f32c0df1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28a40774-307d-444d-9191-b858ee050870","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3d3335a3-4747-4eb9-9469-0fd0bf163710","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"3d3335a3-4747-4eb9-9469-0fd0bf163710","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"53ecccb3-e087-49da-8667-d20438985d9a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"8d3a9912-951d-4bfc-ac47-2a281fc57f02","$typeOfContent":"","type":"SetVariable","$title":"Set \"atendimento\" to \"Caca_POS\"","$invalid":false,"settings":{"variable":"atendimento","value":"Caca_POS"},"conditions":[]},{"$id":"b0e87449-cedc-4403-99b9-f0a312c926bd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Whatsapp PJ ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"Caca_POS\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a70cb04f-0d4c-47b7-8093-5e2df5401351","$typeOfContent":"","type":"SetVariable","$title":"Set \"msg\" to \"\"","$invalid":false,"settings":{"variable":"msg"},"conditions":[]},{"$id":"c9b1067a-9377-4513-b20a-b8916212b51c","$typeOfContent":"","type":"ProcessHttp","$title":"Process \"possuiMovimentacaoResponse\" using \"GET\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Aplicacao":"CHT","Safra-Correlation-ID":"{{random.guid}}","Safra-Bot-ID":"{{application.identifier}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/movimentacoes/verificar?codigoEC={{contaSelecionada@ec}}&qtdDiasApuracao=40","responseStatusVariable":"possuiMovimentacaoStatus","responseBodyVariable":"possuiMovimentacaoResponse"},"conditions":[]},{"$id":"5027774e-ab70-4033-8755-d02bdad8edcd","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/movimentacoes/verificar?codigoEC={{contaSelecionada@ec}}&qtdDiasApuracao=40 | GET | {{possuiMovimentacaoStatus}} | {{possuiMovimentacaoResponse}}"},"conditions":[]},{"$id":"0f7ba8ea-1b21-431f-92a7-ced3d7a0d706","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{possuiMovimentacaoStatus}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"possuiMovimentacaoStatus"}]},{"$id":"99c24419-0295-4d86-a26a-58a2ae6eca97","$typeOfContent":"","type":"SetVariable","$title":"Set \"possuiMovimentacao\"","$invalid":false,"settings":{"variable":"possuiMovimentacao","value":"{{possuiMovimentacaoResponse@data.possuiMovimentacao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"possuiMovimentacaoResponse@data.possuiMovimentacao"}]}],"$leavingCustomActions":[{"$id":"271f6538-acf2-4082-bbbc-5a1cbe0b5201","$typeOfContent":"","type":"TrackEvent","$title":"Track \"consolidado api request\"","$invalid":false,"settings":{"extras":{"contaSelecionada":"{{contaSelecionada}}","idSessao":"idSessao","identity":"{{contact.identity}}"},"category":"consolidado api request","action":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/movimentacoes/verificar?codigoEC=contaSelecionada@ec&qtdDiasApuracao=40 | {{possuiMovimentacaoStatus}}"},"conditions":[]},{"$id":"899b0fcf-a95a-42db-ab36-2b708dd3f4c9","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"caca_pos"},"address":"WhatsApp PJ"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e762a921-1461-457c-b83b-19ec56a4d4fd","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f8da36d2-7173-41c1-adca-f6ec784266f5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-41a54815-e1fe-4097-851a-099c2edffa22","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-99758e99-5a2d-4026-a271-0e1d75add681","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-853de610-3d32-4eb2-8d06-6b58a2c0b57c","label":"Redirect","background":"#1EA1FF","canChangeBackground":false},{"id":"blip-tag-ba8067d3-35cb-4624-a1ff-bb60bc445a16","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"227c3938-627f-4a0a-8136-ddb558c334ed","root":false,"$title":"[Redirect] to WhatsApp PJ (Caca_POS)","$position":{"top":"575px","left":"1873px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d5dc7576-7a47-4388-b7ee-115298ab5310":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"26d2e917-0ce9-4b27-8a63-a8ac0ae41366","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"d5dc7576-7a47-4388-b7ee-115298ab5310","root":false,"$title":"[GO TO] Finalização","$position":{"top":"3193px","left":"2515px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"40aae674-ff83-4bc9-b589-08d3a89635a7":{"$contentActions":[{"action":{"$id":"0fcf96e0-9c36-4a02-a1f5-12c06318eaf1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fab11b19-866c-4da6-b5d3-3956c53392c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fab11b19-866c-4da6-b5d3-3956c53392c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ce0f816f-9d53-40fb-9f4b-0a4aecf5858e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f7743179-741d-495e-95b8-67a4d52ee18c","type":"text/plain","content":"Adicionar a ação\n\nProcess \"dataAtual\"","metadata":{}},"$cardContent":{"document":{"id":"f7743179-741d-495e-95b8-67a4d52ee18c","type":"text/plain","content":"Adicionar a ação\n\nProcess \"dataAtual\""},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b46843cb-db2a-4def-9063-b1600e845f90","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"1b355c16-05ba-468c-b659-0e52f008e774","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dataAtual\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\tconst date = new Date();\n\tconst pad = (num) => num.toString().padStart(2, '0');\n\n\tconst hora = `${pad(date.getHours())}:${pad(date.getMinutes())}`;\n\tconst data = `${pad(date.getDate())}/${pad(date.getMonth() + 1)}/${date.getFullYear()}`;\n\tconst dataHora = `${data} ${hora}`;\n\n\treturn {\n\t\tdata,\n\t\thora,\n\t\tdataHora\n\t};\n}","inputVariables":[],"outputVariable":"dataAtual","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-60d74c28-df6a-47e3-9ee5-21aadd0d2023","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-15eca9fd-3c55-44e3-a9f2-b136f0f7db89","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"40aae674-ff83-4bc9-b589-08d3a89635a7","root":false,"$title":"ADICIONAR NAS AÇÕES GLOBAL","$position":{"top":"83px","left":"437px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0a14602f-f7b5-46eb-bbdd-c824fea248c9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d24f1072-0226-4389-8fa4-1ef80bde80de","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"0a14602f-f7b5-46eb-bbdd-c824fea248c9","root":false,"$title":"[GO TO] Finalizacao","$position":{"top":"5815px","left":"1756px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"87114d80-0d65-4e2b-af38-cf5ba2c2ae03":{"$contentActions":[{"action":{"$id":"3adeb1af-1cd3-45d4-acaf-8477bedd859a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3679a080-0806-4d60-9a37-516786491813","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3679a080-0806-4d60-9a37-516786491813","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3297a39e-96f2-4f6b-8389-d1713b172c49","$typeOfContent":"text","type":"SendMessage","settings":{"id":"23414342-d71e-45df-af16-624dee575ba3","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso.","metadata":{}},"$cardContent":{"document":{"id":"23414342-d71e-45df-af16-624dee575ba3","type":"text/plain","content":"Vou te direcionar para quem pode te ajudar com isso."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6fddc5f-8d04-424e-8503-88afe09e7373","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c08c2e55-852c-49e8-a1e6-aa81bc5188fe","typeOfStateId":"state","$connId":"con_1208","$id":"85b9c96e-b57a-4a95-a949-bc07de1a9d82","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fe96734d-6895-4da4-8edb-1f9baa4168b7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"87114d80-0d65-4e2b-af38-cf5ba2c2ae03","root":false,"$title":"[MS.10.0.2][MSG] Direcionamento humano","$position":{"top":"4302px","left":"3217px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.65","builder:stateTrack":"true","builder:#localTimeZone":"E. South America Standard Time","builder:useTunnelOwnerContext":"true","clientId":"BLIP","grantType":"client_credentials","urlToken":"https://sts-api.safra.com.br","urlCHT":"https://api.safra.com.br","clientSecret":"5312b6d5-acb8-4165-9458-ef445876473e","builder:stateExpiration":"0.00:15:00","serviceName":"Bot Máquina Safrapay","TraceTargetType":"Http","TraceMode":"All","TraceTarget":"https://take-api-beholder.cs.blip.ai/api/traces/prodspdmaquinasafrapay","TraceCacheMode":0},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"4c21d0dd-95f7-488d-bed5-7796a333ef49","$typeOfContent":"","type":"ExecuteScript","$title":"PROCESS \"currentDate\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n    return getFormatDate();\n}\n\nfunction getFormatDate() {\n    const dataAtual = new Date();\n\n    const getDay = String(dataAtual.getDate()).padStart(2, '0');\n    const getMonth = String(dataAtual.getMonth() + 1).padStart(2, '0');\n    const getYear = dataAtual.getFullYear();\n    const getHour = String(dataAtual.getHours()).padStart(2, '0');\n    const getMinutes = String(dataAtual.getMinutes()).padStart(2, '0');\n    const getSeconds = String(dataAtual.getSeconds()).padStart(2, '0');\n\n    return `${getDay}/${getMonth}/${getYear}`;\n}","inputVariables":[],"outputVariable":"currentDate","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"29bb007d-9a14-4539-b834-5527c98867aa","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"voltarState\"","$invalid":false,"settings":{"function":"run","source":"function ignoreBlock(stateName) {\n    try {\n        const match = stateName.match(/\\[(.*?)\\]/);\n        const stateNameOrigin = match ? match[1] : stateName;\n        const regex = /Redirect|Redirecionar/i;\n        const ignore = regex.test(stateNameOrigin);\n        return ignore;\n    } catch (err) {\n        return false\n    }\n}\n\n\nfunction run(voltarState, blockId, botOrigin, lastVoltarState, previousStateName) {\n    if (!voltarState) {\n        const state = {}\n        state[botOrigin] = [blockId]\n        return state\n    }\n    const state = JSON.parse(voltarState)\n    try {\n        const isIgnoredBlock = ignoreBlock(previousStateName)\n        if (state[botOrigin][state[botOrigin].length - 1] !== blockId && blockId !== 'onboarding' && !isIgnoredBlock && blockId !== lastVoltarState) {\n            state[botOrigin].push(blockId)\n        }\n        return state\n    } catch (err) {\n        state[botOrigin] = [blockId]\n        return state\n    }\n}","inputVariables":["voltarState","state.previous.id","config.serviceName","lastVoltarState","state.previous.name"],"outputVariable":"voltarState","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}