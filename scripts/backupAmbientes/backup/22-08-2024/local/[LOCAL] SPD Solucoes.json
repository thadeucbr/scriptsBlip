{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"7fc31a03-b1f7-4b65-b90f-67efc0704942","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{blockDestinationId}}","typeOfStateId":"variable","$id":"5e4fe04d-f76b-443a-ad26-1eded9a0d854","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"blockDestinationId"}],"$invalid":false},{"stateId":"2c5ecc04-daf8-4fee-ac52-1e4c15182f30","typeOfStateId":"state","$connId":"con_3","$id":"0ca63212-b834-4981-999f-aafae3f64b46","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"eb66a3a1-3bed-4680-9c95-6f5c8926bdb7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"inicio\"","$invalid":false,"settings":{"extras":{"identity":"{{contact.identity}}","idSessao":"{{idSessao}}"},"category":"inicio","action":"{{config.serviceName}} | {{state@botOrigin}} | {{state@stateNameOrigin}} | {{input.content}} | {{input.intent.name}}"},"conditions":[]},{"$id":"bdbba0c6-f7b9-4d0b-bdc6-1c20fd265ff2","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"blockDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(state, serviceName) {\n\ttry {\n\t\tconst { botDestination, stateDestination } = JSON.parse(state)\n\n\t\tif (stateDestination.match(/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/) && botDestination === serviceName) {\n\t\t\treturn stateDestination\n\t\t}\n\t\treturn false\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["state","config.serviceName"],"outputVariable":"blockDestinationId","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-a5d8f483-9ba3-4b8a-9e9c-54cf9e103819","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3f3c898d-6418-4c18-b721-7668068284c5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-20eae14f-d916-4b69-b733-05d670732000","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Início","$position":{"top":"87.2857px","left":"2500.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d6cc6e16-4518-4ff0-9677-470b3397a857","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f13e7fbd-372e-45ce-a30f-de575a5cb830","typeOfStateId":"state","$connId":"con_8","$id":"dc9d8396-889f-40d8-942a-caaeddc460fe","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"78bd990e-116e-4242-9cc2-6571f52fe228","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(previousBlockId, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `cascata ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ce70daf4-def5-4390-9017-0282e40ed480","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\" if input.content not exist","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n\tif (!inputUsuario) {\n\t\treturn 'inatividade'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"input.content"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f13e7fbd-372e-45ce-a30f-de575a5cb830","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-9e6d9432-8ab4-4eea-aa81-c09eefdfb1ce","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceções","$position":{"top":"86px","left":"1099px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"99095867-01bc-4fb1-a47d-3168e590e328":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3207213c-5c1f-4009-bb71-9efd9faacd7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:34517"}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"e5c42afc-00c5-4267-b012-69a5a2cb1a30","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c7b0ddd7-9237-4036-93e3-41ef25b6be22","$typeOfContent":"","type":"Redirect","$title":"Redirect to {service} sending {state@lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-67d8c878-b974-4138-8bf1-8c2a5ae5f616","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d025ee96-8c41-430a-8b57-d5157feab18e","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"99095867-01bc-4fb1-a47d-3168e590e328","root":false,"$title":"[Redirect] To Finalizacao (Welcome)","$position":{"top":"57px","left":"1977px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4e281c5d-1774-4f0e-b0b1-bbcacf5a88ca":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f90fc6e5-33b9-4780-8cca-c89b313f8942","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"9a85f97b-7df8-4446-882e-fd92b64f14fc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tpreviousStateName: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: 'WhatsApp PJ',\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: 'atendente',\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6a0e2cc4-fb2b-40d6-a043-916e2efe7521","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a31f9e18-032e-438a-87ce-8f629d477bfa","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-65d22d28-4058-49a9-99a6-51be4e1c437b","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"4e281c5d-1774-4f0e-b0b1-bbcacf5a88ca","root":false,"$title":"[Redirect] To WhatsApp PJ (atendente)","$position":{"top":"47.5px","left":"1777px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"dbea5aca-16ff-48d8-94e5-1cc1c37d3356":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"eceade33-1f3d-4151-b69a-a681756f42a2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c192ff0b-f855-4c5e-b70f-991686d31f91","typeOfStateId":"state","$connId":"con_13","$id":"0a040f0f-5f66-49c1-b362-6358629b6012","conditions":[{"source":"context","comparison":"equals","values":["Protocolo válido"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bb19dbdf-7604-4688-b763-c9df69486991","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado'\n    try {\n      if (!inputUsuario) {\n        return 'inatividade'\n      }\n      const regexDictionary = {\n        \"^\\\\d{14}$\": \"Protocolo válido\"\n      }\n      for (let regex in regexDictionary) {\n        if (new RegExp(regex, 'i').test(inputUsuario)) {\n          return regexDictionary[regex]\n        }\n      }\n      return invalidInputMessage\n    } catch (err) {\n      return invalidInputMessage\n    }\n  }","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c421f31e-2abe-4412-8d83-19f0e9dbd390","$typeOfContent":"","type":"SetVariable","$title":"Set \"numeroProtocolo\"","$invalid":false,"settings":{"variable":"numeroProtocolo","value":"{{input.content}}"},"conditions":[{"values":["Input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"883c546a-b6a2-4f9f-add4-89f4fa77ecb6","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"protocolo\"","$invalid":false,"settings":{"variable":"exceptionType","value":"protocolo"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"260d0439-fb81-4f7b-b4d1-8aa37001a49d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"927a5019-bbc0-4041-b673-edb402f19ebe","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-a8c44583-187d-489b-b345-80197365bde9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-db3b9e28-8963-4799-9138-b6e0b7d4bc3f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0cc61a27-0b19-42d8-983a-a49d4b14ab3c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-46410f58-3f14-40ef-91ca-e007dbc0a602","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"dbea5aca-16ff-48d8-94e5-1cc1c37d3356","root":false,"$title":"[S.2.6.0][INPUT] Consulta Protocolo Númerica","$position":{"top":"435px","left":"4331px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"e4d6612a-10e4-46cb-bb7a-fee228cb3415":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"eceade33-1f3d-4151-b69a-a681756f42a2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6816ed87-a80a-4743-b76f-0bfbafb3f80d","typeOfStateId":"state","$connId":"con_18","$id":"0a040f0f-5f66-49c1-b362-6358629b6012","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"},{"values":["Sim"],"source":"context","comparison":"equals","variable":"protocoloEncontrado"}],"$invalid":false},{"stateId":"635bebe1-1780-40bc-9069-2292fe9d29c4","typeOfStateId":"state","$connId":"con_23","$id":"47a53f65-d8fe-4cb8-ae35-49a8500934b6","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"},{"values":["Não"],"source":"context","comparison":"equals","variable":"protocoloEncontrado"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0bf92cb2-15aa-4e8c-a249-cdc82580e382","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} exibicao","action":"Exibicao"},"conditions":[]},{"$id":"0da4cca7-1b3b-4ce8-ac79-c76ca8883b30","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyConsultaProtocolo\" (Consultar Protocolo)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}","Safra-Correlation-ID":"{{idSessao}}","Safra-Aplicacao":"CHT"},"uri":"{{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/protocolos/{{numeroProtocolo}}","method":"GET","responseStatusVariable":"statusConsultaProtocolo","responseBodyVariable":"bodyConsultaProtocolo"},"conditions":[]},{"$id":"c4206f93-98bd-4eef-a06c-194ca98545ee","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyConsultaOcorrenciaLista\" (Consultar Ocorrencias Unico)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}","Safra-Correlation-ID":"{{idSessao}}","Safra-Aplicacao":"CHT"},"uri":"{{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/ocorrencias?idProtocolo={{numeroProtocolo}}","method":"GET","responseStatusVariable":"statusConsultaOcorrenciaLista","responseBodyVariable":"bodyConsultaOcorrenciaLista"},"conditions":[]},{"$id":"f230bb72-fbb7-4bf5-90e7-ce2f41746bd3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200 && status != 404 )) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusConsultaProtocolo","statusConsultaOcorrenciaLista"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"aab17666-7d32-45ca-8400-bfa1c9ade33c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"protocoloEncontrado\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaProtocolo, numeroProtocolo, bodyConsultaOcorrenciaLista) {\n    try {\n        bodyConsultaProtocolo = JSON.parse(bodyConsultaProtocolo).data;\n        bodyConsultaOcorrenciaLista = JSON.parse(bodyConsultaOcorrenciaLista).data;\n        var protocoloInProtocolo = bodyConsultaProtocolo.id == numeroProtocolo;\n        var protocoloInProtocoloLista = bodyConsultaOcorrenciaLista.some(item => item.idProtocolo == numeroProtocolo);\n        if (protocoloInProtocoloLista == true && protocoloInProtocolo == true) {\n            return \"Sim\"\n        }\n        return \"Não\"\n    }\n    catch (e) {\n        return \"Não\"\n    }\n}","inputVariables":["bodyConsultaProtocolo","numeroProtocolo","bodyConsultaOcorrenciaLista"],"outputVariable":"protocoloEncontrado","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"82a4304c-747b-4d88-80d2-865a3937e91e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroDeOcorrencias\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(bodyConsultaOcorrenciaLista) {\n\ttry {\n\t\tlet ocorrencias = JSON.parse(bodyConsultaOcorrenciaLista).data;\n\t\tlet numInt = ocorrencias.length;\n\t\tif (numInt == 0) {\n\t\t\treturn \"ZERO\"\n\t\t}\n\t\tif (numInt == 1) {\n\t\t\treturn \"UM\"\n\t\t}\n\t\telse {\n\t\t\treturn numInt;\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"numeroDeProtocolos","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cd459105-5ad7-401e-ae0c-a6ef33f2531c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} protocolo encontrado dados\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} protocolo encontrado dados","action":"{{contact.extras.CPF}} | {{contaSelecionada@doc}} | {{numeroProtocolo}} | {{protocoloEncontrado}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"protocoloEncontrado"}]},{"$id":"be67abfe-ef91-466e-ab03-a9f7bc67b60e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} protocolo encontrado validacao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} protocolo encontrado validacao","action":"{{protocoloEncontrado}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"protocoloEncontrado"}]},{"$id":"7a3ac1cd-c4fa-4572-a9e6-e93d5272cbc9","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/protocolos/{{numeroProtocolo}} | GET | {{statusConsultaProtocolo}} | {{bodyConsultaProtocolo}}"},"conditions":[]},{"$id":"d5dfafd8-6883-4d77-bd0a-bf60787616a0","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo 2\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Maquina Safrapay {{state.name}} api resumo 2","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/ocorrencias?idProtocolo={{numeroProtocolo}} | GET | {{statusConsultaProtocoloLista}} | {{bodyConsultaProtocoloLista}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-19b806e0-160b-4395-82ba-dfbc38d96597","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9f66dc71-721c-4d10-ab25-9edbd53761e1","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-d9a5dc21-0dd4-4d48-9597-0637acf6a70b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"e4d6612a-10e4-46cb-bb7a-fee228cb3415","root":false,"$title":"[S.2.0.1] [HTTP] Api Consulta Status Protocolo","$position":{"top":"837px","left":"4331px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"f13e7fbd-372e-45ce-a30f-de575a5cb830":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5c1c7b30-f3c5-44d7-99a1-c0e259cae078","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c8764fbc-31a8-4587-a403-f626f06e3151","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"id":"blip-tag-900b28a4-dbea-4d31-8105-4f754997d45f","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"f13e7fbd-372e-45ce-a30f-de575a5cb830","root":false,"$title":"[Redirect] To cascata","$position":{"top":"74px","left":"1359px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"2c5ecc04-daf8-4fee-ac52-1e4c15182f30":{"$contentActions":[{"action":{"$id":"f22a896f-c283-4523-b138-0e63563d32e7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f598e52a-28ad-47cd-ac48-e3c884efab96","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f598e52a-28ad-47cd-ac48-e3c884efab96","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"487e6504-a1df-4e9a-8ea5-673a81b7cfd8","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"5be71b90-45a1-44ac-84ea-508f5e72dd9e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6348fd86-a751-473e-b206-6863add9be82","typeOfStateId":"state","$connId":"con_28","$id":"df85b892-95a1-45c0-b6c3-941cf70cef81","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["dynamicContent"],"source":"context","comparison":"notEquals","variable":"exceptionType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"d6d7686f-d6b3-43a1-955c-7899598dfa09","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} exibicao","action":"Exibicao"},"conditions":[]},{"$id":"be48ee40-a75b-47dc-9fc0-5151f5bd230d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"/**\n * @typedef {Object} MenuOption\n * @property {string} id - ID da opção do menu\n * @property {string} title - Título da opção do menu\n * @property {string} description - Descrição da opção do menu\n */\n\n/**\n * Adicione as opções que devem ser exibidas por padrão para todos os usuários. \n * O id deve ser igual a posição do menu que será exibido o botão. Ex: { id: 1 } para o primeiro item da lista.\n * @type {MenuOption[]}\n */\nconst menuOptions = [\n\t{\n\t\t\"id\": \"1\",\n\t\t\"title\": \"Consultar protocolo\",\n\t\t\"description\": \"\"\n\t},\n\t{\n\t\t\"id\": \"2\",\n\t\t\"title\": \"Títulos\",\n\t\t\"description\": \"Boletos de cobrança gerados para receber pagamentos\"\n\t},\n\t{\n\t\t\"id\": \"3\",\n\t\t\"title\": \"Descredenciamento\",\n\t\t\"description\": \"Encerramento de conta/máquina\"\n\t},\n\t{\n\t\t\"id\": \"4\",\n\t\t\"title\": \"Transação não autorizada\",\n\t\t\"description\": \"Meu pagamento não foi autorizado\"\n\t}\n]\n\n/**\n * @typedef {Object} MenuOption\n * @property {number} posicao - Posição que o botão deve ser inserido no menu\n * @property {string} title - Título do botão\n * @property {string} description - Descrição do botão\n */\n/**\n * @summary Essa função adiciona uma opção (botão) no menu de acordo com a posição informada e reordena todos os botões.\n * @param {MenuOption} option - Objeto contendo a posição, título e descrição do botão\n * @example adicionaOpcaoNoMenu({ posicao: 2, title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction adicionaOpcaoNoMenu({ posicao, title, description }) {\n\tif (posicao > menuOptions.length) {\n\t\tposicao = Number(menuOptions[menuOptions.length - 1].id) + 1\n\t}\n\tif (menuOptions.find(option => option.id == posicao)) {\n\t\tquantidadeItens = menuOptions.length\n\t\tfor (let i = Number(posicao - 1); i < quantidadeItens; i++) {\n\t\t\tmenuOptions[i].id = (i + 2).toString()\n\t\t}\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72) || ''\n\t\t})\n\t} else {\n\t\tmenuOptions.push({\n\t\t\tid: posicao.toString(),\n\t\t\ttitle: title.slice(0, 24),\n\t\t\tdescription: description.slice(0, 72)\n\t\t})\n\t}\n\tmenuOptions.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @typedef {Object} MenuOptionUpdate\n * @property {string} parametroDeBusca - Título ou descrição da opção que deseja atualizar\n * @property {string} title - Novo título do botão\n * @property {string} description - Nova descrição do botão\n */\n\n/**\n * @summary Essa função atualiza o título e descrição de uma opção (botão) do menu.\n * @param {MenuOptionUpdate} option - Objeto contendo o título ou descrição da opção que deseja atualizar, novo título e nova descrição do botão\n * @example atualizaOpcaoMenu({ parametroDeBusca: 'Conta Corrente', title: 'Conta Corrente', description: 'Extratos, Fazer pix, Antecipar saldo, Falar sobre conta, entre outros.' })\n */\nfunction atualizaOpcaoMenu({ parametroDeBusca, title, description }) {\n\t// Parametro de busca é o title ou description da opção que deseja atualizar\n\tconst opcao = menuOptions.find(option => option.title === parametroDeBusca || option.description === parametroDeBusca)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tmenuOptions.find(option => option.id === opcao.id).title = title.slice(0, 24)\n\tmenuOptions.find(option => option.id === opcao.id).description = description.slice(0, 72) || ''\n}\n/**\n * @typedef {Object} PermissionCheck\n * @property {string} tituloDoBotao - Título ou descrição da opção que deseja verificar\n * @property {Array.<string>} permissoes - Permissões do usuário (usar o array de permissões da conta selecionada)\n * @property {string} permissoesNecessarias - Permissão necessária para exibir a opção\n */\n\n/**\n * @summary Essa função verifica se o usuário possui a permissão necessária para exibir a opção no menu.\n * @param {PermissionCheck} permission - Objeto contendo o título ou descrição da opção que deseja verificar, permissões do usuário e permissão necessária para exibir a opção\n * @example verificaPermissao({ tituloDoBotao: 'Conta Corrente', permissoes: ['extratoDeContaCorrente'], permissoesNecessarias: 'extratoDeContaCorrente' })\n */\nfunction verificaPermissao({ tituloDoBotao, permissoes, permissoesNecessarias }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao);\n\n\tif (!opcao) {\n\t\treturn;\n\t}\n\n\tconst hasPermission = permissoesNecessarias.some(necessaria => permissoes.includes(necessaria));\n\n\tif (hasPermission) {\n\t\treturn;\n\t}\n\n\tconst index = menuOptions.indexOf(opcao);\n\tif (index > -1) {\n\t\tmenuOptions.splice(index, 1);\n\t}\n}\n\nfunction removeOpcaoDoMenu({ tituloDoBotao }) {\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions.splice(index, 1)\n}\n\nfunction removeDescricaoDoBotao({ tituloDoBotao, parteASerRemovida, listaPermissoes, permissaoNecessaria }) {\n\tif (listaPermissoes.includes(permissaoNecessaria)) {\n\t\treturn\n\t}\n\tconst opcao = menuOptions.find(option => option.title === tituloDoBotao || option.description === tituloDoBotao)\n\tif (!opcao) {\n\t\treturn\n\t}\n\tconst index = menuOptions.indexOf(opcao)\n\tmenuOptions[index].description = menuOptions[index].description.replace(parteASerRemovida, '')\n}\n\n/**\n * @typedef {Object} ContaSelecionada\n * @property {number} codigoCliente\n * @property {string} baseDocumento\n * @property {string} agencia\n * @property {string} agenciaCadastroBacen\n * @property {string} conta\n * @property {(boolean|string)} contaCorrenteSPD\n * @property {string} canal\n * @property {string} shortname\n * @property {string} usuario\n * @property {number} codigoSegmento\n * @property {string} nivel\n * @property {string} nomeEmpresa\n * @property {string} tipoPessoa\n * @property {string} doc\n * @property {string} nomeCompleto\n * @property {string} primeiroNome\n * @property {string} filaGerente\n * @property {Array.<string>} permissoes\n * @property {string} cpfAppKey\n * @property {(boolean|string)} ec\n * @property {string} segmentoGerente\n */\n\n/**\n * @param {ContaSelecionada} contaSelecionada - Objeto contendo as informações da conta selecionada\n * @description Dentro do try, defina todas as regras de exibição, utilizando as funções disponiveis: \"verificaPermissao\", \"atualizaOpcaoMenu\", \"adicionaOpcaoNoMenu\"\n */\nfunction run(contaSelecionada) {\n\ttry {\n\t\tconst { permissoes } = JSON.parse(contaSelecionada)\n\t\tverificaPermissao({ tituloDoBotao: 'Consultar protocolo', permissoesNecessarias: ['consultaDeProtocolo'], permissoes })\n\t\tverificaPermissao({ tituloDoBotao: 'Descredenciamento', permissoesNecessarias: ['desinstalacao'], permissoes })\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo, do que você precisa? `\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Opções\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": menuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\terror: err.message,\n\t\t\texceptionType: 'reiniciarFluxo',\n\t\t\tdynamicContent: {\n\t\t\t\t\"type\": \"text/plain\",\n\t\t\t\t\"content\": `Estamos fazendo alguns ajustes no sistema e alguns recursos podem estar temporariamente indisponíveis. Em breve, estaremos de volta ao normal.`\n\t\t\t}\n\t\t}\n\t}\n}","inputVariables":["contaSelecionada"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d1c2bf22-7947-49a7-9dd9-8aaf1a8756fa","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"dynamicContent erro\"","$invalid":false,"settings":{"extras":{},"category":"dynamicContent erro","action":"{{config.serviceName}} | {{state.name}} | {{dynamicContent@error}} | {{contact.identity}} | {{idSessao}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"876c4d17-9652-4c47-90ab-9ea145cb6e5b","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"dynamicContent\"","$invalid":false,"settings":{"variable":"exceptionType","value":"dynamicContent"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]},{"$id":"338ed64a-a95c-476b-ac29-f5712161777b","$typeOfContent":"","type":"SetVariable","$title":"Set \"dynamicContent\" to \"dynamicContent@dynamicContent\"","$invalid":false,"settings":{"variable":"dynamicContent","value":"{{dynamicContent@dynamicContent}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"dynamicContent@error"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"fallback"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2dd87be7-0864-49cd-8ffd-f5300a7fc4b9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-accf4cc8-6dd4-497a-acbc-ffa7de86824f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fec4a8fc-dc67-4e2e-820c-8ff1f33d3ce1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-550a43a4-5c9c-4c0f-9271-1093e5e72f02","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2c5ecc04-daf8-4fee-ac52-1e4c15182f30","root":false,"$title":"[S.1.0.0][MSG] Menu Soluções","$position":{"top":"280px","left":"2501.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6348fd86-a751-473e-b206-6863add9be82":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"5be71b90-45a1-44ac-84ea-508f5e72dd9e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c5482705-133e-4f31-b01e-7930e16e12a3","typeOfStateId":"state","$connId":"con_33","$id":"a2eb0fee-78ff-49ef-973f-62ad9ffef106","conditions":[{"values":["Descredenciamento"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"typeOfStateId":"state","$connId":"con_38","$id":"47f48cb3-bd96-49f9-bbaf-07dfafa8bd4d","conditions":[{"source":"context","comparison":"equals","values":["Consultar Protocolo"],"variable":"userInput"}],"$invalid":false,"stateId":"6476d17f-4f5c-4ea1-959e-0fad57cd8bc8"},{"stateId":"733915ec-b86d-4df4-b6cd-0844b9f4c969","typeOfStateId":"state","$connId":"con_43","$id":"35bb9401-d821-46f7-aa05-5f54ad2f9424","conditions":[{"source":"context","comparison":"equals","values":["Títulos"],"variable":"userInput"}],"$invalid":false},{"stateId":"ebd69b85-ac8c-4129-afde-1f91a09c6ed0","typeOfStateId":"state","$connId":"con_48","$id":"957b0e33-9a16-4387-ac37-4b27d04926b3","conditions":[{"source":"context","comparison":"equals","values":["Transação não autorizada"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"aa0f8882-b76d-488c-8ad0-51020e4534a9","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e8013f0a-13ef-4988-b7b4-4bd01ac710cf","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"19c29e7a-f96f-47f6-a261-5dc53ef5d2f1","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"e81bb9f0-f5fd-450d-96b2-5bd77a53226a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"6f307cc3-d7b9-4fb4-9199-5ad42a1babae","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"fallback"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-334a916e-2068-48b6-a9fd-d7e7d1a5d8ce","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-98482183-1376-46a8-8ba0-f7dd861df6e8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e4077573-7a49-46cc-ad89-e2f60a5db9ca","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c078b76f-f6cb-4cb3-bc99-56c7168bfd00","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"6348fd86-a751-473e-b206-6863add9be82","root":false,"$title":"[S.1.0.0][INPUT] Menu Soluções","$position":{"top":"464.5px","left":"2501.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"c5482705-133e-4f31-b01e-7930e16e12a3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: 'e2658701-703d-4150-944c-3daba99cfbd3',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cbef1e34-7f2b-4d4a-82c4-8b080009f1b1","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"onboarding"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c3eb0230-116e-4b57-8677-bc0a314ed0d0","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7f111941-c6da-4db0-bc70-29ceb07921f5","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"c5482705-133e-4f31-b01e-7930e16e12a3","root":false,"$title":"[Redirect] To \"Autenticacao\" (Descredenciamento)","$position":{"top":"198px","left":"2964.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"6476d17f-4f5c-4ea1-959e-0fad57cd8bc8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"076741d6-13b2-45ff-919a-dff3bda1dc37","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"44c346c4-2d0e-41e0-aa1e-63da89563f8c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"6476d17f-4f5c-4ea1-959e-0fad57cd8bc8","root":false,"$title":"[GO TO] S.2.0.0 Consultar Protocolo","$position":{"top":"695px","left":"2965.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e2658701-703d-4150-944c-3daba99cfbd3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f90fc6e5-33b9-4780-8cca-c89b313f8942","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"9a85f97b-7df8-4446-882e-fd92b64f14fc","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tpreviousStateName: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: 'WhatsApp PJ',\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: 'Descredenciamento',\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6a0e2cc4-fb2b-40d6-a043-916e2efe7521","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e6e959f4-6a1f-4c44-8d52-8a05507d660e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4d2d6399-203f-491b-9912-b9806865dad7","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"e2658701-703d-4150-944c-3daba99cfbd3","root":false,"$title":"[Redirect] To WhatsApp PJ (Descredenciamento)","$position":{"top":"47.5px","left":"1567px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"635bebe1-1780-40bc-9069-2292fe9d29c4":{"$contentActions":[{"action":{"$id":"50e9f345-f01c-4419-a5fd-c9813eccfedc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3818d653-57a6-44fa-816d-bf2b8e43d968","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3818d653-57a6-44fa-816d-bf2b8e43d968","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6493ac36-7a3d-4e90-a3bf-b152d1e8ea6c","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1b46fdb-e03a-4cdc-9f02-8b9fa489f6f4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"011aeeaf-900e-4f4b-95af-56c6a4169e6b","typeOfStateId":"state","$connId":"con_53","$id":"e9a15541-6359-4325-beae-5c811c715913","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1cad4baf-0b83-45eb-ac00-f3dacd10122a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Fazer nova consulta\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Ver menu inicial\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = `Dei uma olhada aqui e não encontrei este protocolo. Verifica se o CPF que você informou é o mesmo de quem abriu o protocolo.\n\nO que você gostaria de fazer?`;\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["salesType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f6ffe4c-9cef-400a-a402-f3fb8b5e76db","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-8c97e740-aa7f-4a92-b751-70ab515e1eac","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7c03f562-2295-4fc3-b454-ef99ac498b1e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3f07a738-9fb9-411f-907f-4ef6182cc589","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"635bebe1-1780-40bc-9069-2292fe9d29c4","root":false,"$title":"[S.2.0.7][MSG] Como deseja prosseguir?","$position":{"top":"1009px","left":"4913px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"011aeeaf-900e-4f4b-95af-56c6a4169e6b":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"d1b46fdb-e03a-4cdc-9f02-8b9fa489f6f4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"921cb208-a3d7-4e7a-a484-7064959af433","typeOfStateId":"state","$connId":"con_58","$id":"d99aa798-0d98-498b-8b87-c9aeda7f3cc0","conditions":[{"source":"context","comparison":"equals","values":["Fazer nova consulta"],"variable":"userInput"}],"$invalid":false},{"stateId":"25cae0d3-7eca-4137-95df-b76ef613d04b","typeOfStateId":"state","$connId":"con_63","$id":"95f6a5b4-a27f-4ca3-b23a-b48dda40edf4","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false},{"stateId":"eb076e1b-c303-4df2-88eb-d9083b2c22bb","typeOfStateId":"state","$connId":"con_68","$id":"348d7ab5-97da-4fa7-87b0-ef95216963db","conditions":[{"source":"context","comparison":"equals","values":["Ver menu inicial"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"a244eb0d-dd86-42a9-b40b-039ebf20ad50","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"13b147fe-0ec1-440b-b844-0715b6388e4e","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"6494f030-bee4-449c-8b9c-7350ff498c97","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"cff66c25-fe11-4ba7-95ee-7c840e943aa4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-1c836634-5513-4074-b0f3-21f023899817","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-04722892-ddf5-410f-b651-e1c1cef3981d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-44567479-2706-46a0-b1e1-703b01ab31f4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8572e0a2-e5d8-4d96-ba7a-2ce0a5ee2968","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"011aeeaf-900e-4f4b-95af-56c6a4169e6b","root":false,"$title":"[S.2.0.7] [INPUT] Como deseja prosseguir?","$position":{"top":"1628px","left":"4913.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"25cae0d3-7eca-4137-95df-b76ef613d04b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6db7aa2-0222-4b55-a0c5-5498d09dc5a7","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"25cae0d3-7eca-4137-95df-b76ef613d04b","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"1852.14px","left":"5207.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"921cb208-a3d7-4e7a-a484-7064959af433":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e38fd42f-e93d-4a4e-aaca-a4bd80a4eec8","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"921cb208-a3d7-4e7a-a484-7064959af433","root":false,"$title":"[GO TO] S.2.0.0 Tentar Novamente","$position":{"top":"1885.71px","left":"4610px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e747d2e2-106e-449e-8b25-7840ceabf084":{"$contentActions":[{"action":{"$id":"b0f53b7f-d115-49d1-b8ab-03542936ca58","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7aff57fb-5682-48b3-b5cf-74888b089efb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b6af780-e7f1-4fbe-8f4a-3481e581e6bb","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"accd9a7e-b06d-4c3c-b0ee-7d8810f639a0","typeOfStateId":"state","$connId":"con_73","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3b88274c-e1e3-4b7c-b62c-cb355e1a84e4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(cpfAppKey, ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Consulta de títulos\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Emissão de boleto\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Espécie 33\",\n\t\t\t\t\"description\": \"Boleto e aporte\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Consulta de boleto\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"5\",\n\t\t\t\t\"title\": \"Boleto com QR Code Pix\",\n\t\t\t\t\"description\": \"\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Sobre boletos, posso te ajudar com os seguintes assuntos. 👇` // <---- Body\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Assuntos\", // <---- Titulo do botão\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["cpfAppKey","selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5f51d111-5dfe-4c05-b21b-610f9213816e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"5b0fa85e-11ee-443f-8e77-770e863958bf","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-13e10c47-8169-4053-9cf5-1baec7f6d553","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-68ecf408-c1ce-4e9f-9b7e-2383e4980127","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ae0ad733-eb74-4ae7-84cf-61c0ee9a9450","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-a9716080-30d1-4eb3-8832-ea853dde6a37","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e747d2e2-106e-449e-8b25-7840ceabf084","root":false,"$title":"[S.3.0.0][MSG] Menu Boletos","$position":{"top":"267.333px","left":"11205.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"accd9a7e-b06d-4c3c-b0ee-7d8810f639a0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"67bbe7a8-5b19-49ee-bd20-f8223724e0c5","typeOfStateId":"state","$connId":"con_78","$id":"0d3e5feb-4be9-4421-8aa7-3e80c7eabab7","conditions":[{"source":"context","comparison":"equals","values":["Consulta de Títulos"],"variable":"userInput"}],"$invalid":false},{"stateId":"4d225fba-a0c7-4644-9b01-56b59dd5e3fa","typeOfStateId":"state","$connId":"con_83","$id":"318b9779-991d-4c48-a4a1-f9250510672d","conditions":[{"source":"context","comparison":"equals","values":["Emissão de Boleto"],"variable":"userInput"}],"$invalid":false},{"stateId":"416cada3-8419-49e7-bc77-fd4aa8d65ca9","typeOfStateId":"state","$connId":"con_88","$id":"b64923ca-e825-4833-a916-f41d6da8a9d8","conditions":[{"source":"context","comparison":"equals","values":["Consulta de boleto"],"variable":"userInput"}],"$invalid":false},{"stateId":"39bdebc7-a35c-4d00-ac75-49f6ca6cc215","typeOfStateId":"state","$connId":"con_93","$id":"d450c689-df87-48b4-b844-f1ec89bb525d","conditions":[{"source":"context","comparison":"equals","values":["Espécie 33"],"variable":"userInput"}],"$invalid":false},{"stateId":"5428084d-2bbc-41d3-b1c2-6e0587378c6b","typeOfStateId":"state","$connId":"con_98","$id":"21088e60-023b-4048-9d0d-a43b25dd6c01","conditions":[{"source":"context","comparison":"equals","values":["Boleto com QR Code PIX"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  }\n\nfunction run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\",\n      \"4\": \"quart[ao]|[qc]uat(r)?o\",\n      \"5\": \"quint[ao]|[sc]inc[ou]\",\n      \"6\": \"sext[ao]|[sc]inc[uo]\",\n      \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n      \"8\": \"oitav[ao]|oit[ou]\",\n      \"9\": \"non[ao]|nov[ei]\",\n      \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n      rows.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n          regexDictionary[key] = button.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f89a3ce6-4c38-4bf6-b85e-e1623182ebcc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3324ffce-8b39-4b36-b262-94dd7c56fd7a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-b65b1523-489a-4f16-9809-1f6205f0b6a2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ae8f50a7-3c00-4fb7-bcb3-ed1da85c4832","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"accd9a7e-b06d-4c3c-b0ee-7d8810f639a0","root":false,"$title":"[S.3.0.0][INPUT] Menu Boletos","$position":{"top":"467px","left":"11206.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"67bbe7a8-5b19-49ee-bd20-f8223724e0c5":{"$contentActions":[{"action":{"$id":"1511573b-a0b0-42ee-9543-d5cfb4dd921f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"62cbd3eb-e926-4813-85f0-95aed76f1d32","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"62cbd3eb-e926-4813-85f0-95aed76f1d32","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"406df223-7068-404f-bed6-7fbb2b85b66e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"98aecbcb-996e-4d40-bc0c-ff3bd64c6d81","type":"text/plain","content":"Para consultar os títulos, primeiro é necessário fazer login no <b>Internet Banking</b>. Após o login, selecione o menu de <b>Cobrança e Recebimentos</b>. Em seguida, acesse o submenu <b>Consulta / 2ª via de Boletos</b>, conforme mostrado na imagem abaixo.👇","metadata":{}},"$cardContent":{"document":{"id":"98aecbcb-996e-4d40-bc0c-ff3bd64c6d81","type":"text/plain","content":"Para consultar os títulos, primeiro é necessário fazer login no <b>Internet Banking</b>. Após o login, selecione o menu de <b>Cobrança e Recebimentos</b>. Em seguida, acesse o submenu <b>Consulta / 2ª via de Boletos</b>, conforme mostrado na imagem abaixo.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b848af1a-88ca-4013-84fd-53537c3532bd","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"2ffdb662-8509-49e7-8da8-0489364dc6f4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"2ffdb662-8509-49e7-8da8-0489364dc6f4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2a5cbc93-9a05-40df-8761-04a76ae05e68","$typeOfContent":"media","type":"SendMessage","settings":{"id":"21e3c55a-ceef-496d-a48e-513283dd5265","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_412e7c49-a02a-4f4a-a242-61bb56eb8d9a","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"21e3c55a-ceef-496d-a48e-513283dd5265","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_412e7c49-a02a-4f4a-a242-61bb56eb8d9a","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0640973f-8dae-464d-a3dd-05ddc1d40d61","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"d65dda4d-0eaa-4fcc-846b-bc25060d2df4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c9888164-0e28-4ed0-ae3c-edc55836417f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"c9888164-0e28-4ed0-ae3c-edc55836417f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"5f177234-9c09-4314-8714-76002e603673","typeOfStateId":"state","$connId":"con_103","$id":"5bc6e928-d311-44b1-b7a7-6025ead43479","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5b2f81ca-814b-448d-a09b-bef020f1b6d5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1edb6707-3d18-40e8-8661-54e30eb2d99c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9fb27f89-de14-4891-86bc-cd6a5970a44d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"67bbe7a8-5b19-49ee-bd20-f8223724e0c5","root":false,"$title":"[S.3.1.1][MSG] Consulta de Títulos","$position":{"top":"1209px","left":"10463px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5f177234-9c09-4314-8714-76002e603673":{"$contentActions":[{"action":{"$id":"8f38abf8-f5ae-4b30-8f51-53a8194a4038","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e68f136c-cb27-4b3e-953b-ed7112b62af3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e68f136c-cb27-4b3e-953b-ed7112b62af3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"735256e1-5496-4f5d-bf83-25b7dea9a23f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2f42e3e5-bca2-46ab-877b-42cb45678f4b","type":"text/plain","content":"Na tela de <b>Gestão de cobrança</b>, ao lado direito de cada título, selecionando a linha pontilhada, você encontrará diversas opções.","metadata":{}},"$cardContent":{"document":{"id":"2f42e3e5-bca2-46ab-877b-42cb45678f4b","type":"text/plain","content":"Na tela de <b>Gestão de cobrança</b>, ao lado direito de cada título, selecionando a linha pontilhada, você encontrará diversas opções."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7d6b8795-1108-44f6-a86b-d99ecb64b25b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"afe5eb76-7817-4fac-b2db-1f6edaca5fbc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"afe5eb76-7817-4fac-b2db-1f6edaca5fbc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ff19b67f-51f9-4d22-8190-86e9c5c8c6ea","$typeOfContent":"text","type":"SendMessage","settings":{"id":"becd9410-27b2-418f-93d7-f4dd42d485f1","type":"text/plain","content":"Selecione a opção desejada, em seguida clique no botão <b>Próximo Passo</b>, no canto inferior direito da tela.\n\nConfira na imagem abaixo.👇","metadata":{}},"$cardContent":{"document":{"id":"becd9410-27b2-418f-93d7-f4dd42d485f1","type":"text/plain","content":"Selecione a opção desejada, em seguida clique no botão <b>Próximo Passo</b>, no canto inferior direito da tela.\n\nConfira na imagem abaixo.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b0a27549-b685-484d-983d-f0d91208d6ea","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f7c1f611-8d52-40cd-a52d-081aa3a94bff","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"f7c1f611-8d52-40cd-a52d-081aa3a94bff","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8c203687-9f44-4257-87af-49aa7a4d7689","$typeOfContent":"media","type":"SendMessage","settings":{"id":"7035960a-fc95-4c64-a30e-20dc1f38ac5e","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_2015b660-a4d4-44f2-ab02-999909a19283","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"7035960a-fc95-4c64-a30e-20dc1f38ac5e","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_2015b660-a4d4-44f2-ab02-999909a19283","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3e53e0ce-7af1-4d68-9bbe-0333429a1b5b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f5697092-294d-4b35-96ad-bd3c326fb418","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"f5697092-294d-4b35-96ad-bd3c326fb418","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"72ab5ce1-014d-4c47-bbed-a1a0e348dd78","$typeOfContent":"media","type":"SendMessage","settings":{"id":"75911e07-9f0c-4359-b4da-3260176924ed","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_e5342a43-b7cf-494e-9e20-d5655a187966","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"75911e07-9f0c-4359-b4da-3260176924ed","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_e5342a43-b7cf-494e-9e20-d5655a187966","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6980606d-1301-4fd2-a0c6-86f3a26babc0","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"d27a0a5b-fa32-4596-9afb-4aae77302a6f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1fc49344-9c95-419f-8952-77a048138ef1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"1fc49344-9c95-419f-8952-77a048138ef1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"25ea1518-5746-4b94-a1bb-f7e20e5d08a3","typeOfStateId":"state","$connId":"con_108","$id":"e4625ff6-da16-42d9-a12c-140f846de2ef","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fcfd167c-beec-4e35-b7fb-e46934d0dbb0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-76885aa2-5e5c-4d1e-95ad-54bf2f7826ce","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-16394ed7-5cde-4784-8b49-aefb7deda538","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5f177234-9c09-4314-8714-76002e603673","root":false,"$title":"[S.3.1.2][MSG] Consulta de Títulos 2","$position":{"top":"1447px","left":"10463px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"25ea1518-5746-4b94-a1bb-f7e20e5d08a3":{"$contentActions":[{"action":{"$id":"c757cd8e-2487-4cb2-880d-31163efcf042","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"41354cbb-ef36-4101-9005-e3e33db75cb8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"41354cbb-ef36-4101-9005-e3e33db75cb8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7b903a46-c908-4f76-a9de-715775d69917","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4f5066e1-c7f2-4877-9020-dd5d0b1712d7","type":"text/plain","content":"Por fim, você chegará ao resultado da sua busca. Como mostrado na imagem abaixo.👇","metadata":{}},"$cardContent":{"document":{"id":"4f5066e1-c7f2-4877-9020-dd5d0b1712d7","type":"text/plain","content":"Por fim, você chegará ao resultado da sua busca. Como mostrado na imagem abaixo.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"71879b02-e3c7-45de-86c9-f43f1a2cbc99","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5d8a90ff-c1ab-4ff9-b6b4-33308b38636c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"5d8a90ff-c1ab-4ff9-b6b4-33308b38636c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"47ad186c-710f-4701-93f7-db1bca9ad4f0","$typeOfContent":"media","type":"SendMessage","settings":{"id":"6847023d-f42d-49d8-9543-a5eac6b5b66a","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_bafbea71-001f-495a-95a4-1d34a68a7c73","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"6847023d-f42d-49d8-9543-a5eac6b5b66a","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_bafbea71-001f-495a-95a4-1d34a68a7c73","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"5041af44-d549-46c7-b45b-ef1886f4a9e8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"798d7aa8-cdb1-4edb-ab53-88ce13799c48","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"73c53c53-c043-4d85-a08b-f530b10df33a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"73c53c53-c043-4d85-a08b-f530b10df33a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"01e6479a-0432-4102-8e00-d6b8b1f0af3d","typeOfStateId":"state","$connId":"con_113","$id":"14abd727-d3c5-450c-b084-d69554de3511","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"8c4cd09f-6e96-4bfe-82fe-8f0fa9c5cec6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fee5a554-f70c-4655-91e5-383ddbaa5b82","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e7716638-26d2-441f-a855-52fc8661400c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"25ea1518-5746-4b94-a1bb-f7e20e5d08a3","root":false,"$title":"[S.3.1.3][MSG] Consulta de Títulos 3","$position":{"top":"1676px","left":"10463px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"01e6479a-0432-4102-8e00-d6b8b1f0af3d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f83de06c-d68a-43f8-b06f-bf13876791da","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"01e6479a-0432-4102-8e00-d6b8b1f0af3d","root":false,"$title":"[GO TO] Redirect to Finalização","$position":{"top":"2138.33px","left":"10904.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4d225fba-a0c7-4644-9b01-56b59dd5e3fa":{"$contentActions":[{"action":{"$id":"05816c1f-b6a4-4cf8-b957-65b63fdd72a3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"dd5e0847-c035-428b-878a-bf5fb49ada54","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"dd5e0847-c035-428b-878a-bf5fb49ada54","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0f84592d-f764-48ea-bbb0-43d9ee26470c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b40956a9-9fcd-40f5-9dbb-218ab06edbfd","type":"text/plain","content":"Para emitir um boleto, primeiro você precisa estar logado no <b>Internet Banking</b>.\n\nDepois de logado, procure, na parte superior da tela, pela opção <b>Cobrança e Recebimentos</b>.\n\nLogo após, no canto esquerdo da tela, selecione a opção <b>Emitir Boletos</b>.\n\nConfira na imagem 👇\n\n","metadata":{}},"$cardContent":{"document":{"id":"b40956a9-9fcd-40f5-9dbb-218ab06edbfd","type":"text/plain","content":"Para emitir um boleto, primeiro você precisa estar logado no <b>Internet Banking</b>.\n\nDepois de logado, procure, na parte superior da tela, pela opção <b>Cobrança e Recebimentos</b>.\n\nLogo após, no canto esquerdo da tela, selecione a opção <b>Emitir Boletos</b>.\n\nConfira na imagem 👇\n\n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9d9fec83-b522-41f2-9bfb-48ccbef862a0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"02955954-a0c3-42d7-b5bc-29d81a42f9c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"02955954-a0c3-42d7-b5bc-29d81a42f9c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8e70495d-94e5-4967-94eb-1c5d2a8d3995","$typeOfContent":"media","type":"SendMessage","settings":{"id":"fc351522-e19f-418f-a49d-7170c06e80d5","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_e4359e21-c557-404b-ab86-0734944b5184","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"fc351522-e19f-418f-a49d-7170c06e80d5","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_e4359e21-c557-404b-ab86-0734944b5184","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"faaa64fe-baf7-48b4-a6c1-c86cc7ffdd55","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"6ce883fb-676b-44ea-9154-2fbe90ef693c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3c4442b3-63da-489f-81cf-f3e379e8a404","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"3c4442b3-63da-489f-81cf-f3e379e8a404","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"6349d8fd-3079-4ab6-ac69-716f59cccac4","typeOfStateId":"state","$connId":"con_118","$id":"db78d483-f452-43c1-89a1-d1c984f3fb89","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0c025436-64ba-483e-9902-27a867d01169","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-69a7d379-87b2-472c-89af-84f08d21b2c5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f7af8f65-3aac-4960-a179-8ebbeea97907","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4d225fba-a0c7-4644-9b01-56b59dd5e3fa","root":false,"$title":"[S.3.2.1][MSG] Emissão de Boleto","$position":{"top":"1179px","left":"10949.3px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6349d8fd-3079-4ab6-ac69-716f59cccac4":{"$contentActions":[{"action":{"$id":"0225c205-d0e3-4faf-9895-24fb93bc0798","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7d49f234-6ade-4474-b661-d912de390d47","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7d49f234-6ade-4474-b661-d912de390d47","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"312d7b83-9f90-4b0f-9033-f218b6a01381","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2f8c4d5e-6cb2-4f49-9df6-fd74f913ed67","type":"text/plain","content":"Para gerar o boleto, é necessário preencher algumas informações.\n\nInforme o número da conta de quem irá receber.\n\nDepois, informe os dados de quem irá pagar o boleto. Pode ser o CPF ou o CNPJ. Lembrando que, caso seja um novo pagador(a) você precisará cadastrá-lo(a) na opção <b>Cadastrar</b> logo na linha baixo.\n\nFeito isso, você irá escolher o <b>Modo de Envio</b>. As opções disponíveis são: SMS, e-mail ou Físico.\n\nEm seguida, selecione a espécie: exemplo: <b>Duplicata Mercantil</b>.\n\nAgora, chegou a hora de preecher a <b>Forma de Emissão</b>. Nela, você irá informar o valor total do boleto, data de vencimento, quantidade e valores de parcelas, se houver.\n\nConfira na imagem abaixo 👇\n","metadata":{}},"$cardContent":{"document":{"id":"2f8c4d5e-6cb2-4f49-9df6-fd74f913ed67","type":"text/plain","content":"Para gerar o boleto, é necessário preencher algumas informações.\n\nInforme o número da conta de quem irá receber.\n\nDepois, informe os dados de quem irá pagar o boleto. Pode ser o CPF ou o CNPJ. Lembrando que, caso seja um novo pagador(a) você precisará cadastrá-lo(a) na opção <b>Cadastrar</b> logo na linha baixo.\n\nFeito isso, você irá escolher o <b>Modo de Envio</b>. As opções disponíveis são: SMS, e-mail ou Físico.\n\nEm seguida, selecione a espécie: exemplo: <b>Duplicata Mercantil</b>.\n\nAgora, chegou a hora de preecher a <b>Forma de Emissão</b>. Nela, você irá informar o valor total do boleto, data de vencimento, quantidade e valores de parcelas, se houver.\n\nConfira na imagem abaixo 👇\n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f34fec94-82d0-44e0-95b3-1ae471eb1df4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"475b841f-a29c-430a-ad2b-53830eb053d4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"475b841f-a29c-430a-ad2b-53830eb053d4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f659cab3-fd7a-4c6e-8fc2-99b9f2fc30bb","$typeOfContent":"media","type":"SendMessage","settings":{"id":"55550092-f16d-4f2d-818f-ad1932e22f02","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_5ea42598-92d0-45a1-b5e8-37d3bbff2a6c","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"55550092-f16d-4f2d-818f-ad1932e22f02","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_5ea42598-92d0-45a1-b5e8-37d3bbff2a6c","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4e48cd40-bb8d-41c2-bbbb-a2d3e4a2c0d8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"478da152-3d83-4ed7-97d2-c8ee7b42a0a1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e92f80ce-f76f-47a9-95fe-3f3ad34d40c3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"e92f80ce-f76f-47a9-95fe-3f3ad34d40c3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"ed4276f4-8bb4-4130-bd93-038e5a80580b","typeOfStateId":"state","$connId":"con_123","$id":"4b7c8954-6449-4e3d-88d5-9b4103919f66","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"92e7186a-f7d9-4411-85da-429b7767207e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3c2e678a-4463-48e2-9151-f12688ffeefa","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-eb276a2d-efd3-4940-9389-b1cdd53d1dd5","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6349d8fd-3079-4ab6-ac69-716f59cccac4","root":false,"$title":"[S.3.2.2][MSG] Emissão de Boleto 2","$position":{"top":"1359.33px","left":"10950.3px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ed4276f4-8bb4-4130-bd93-038e5a80580b":{"$contentActions":[{"action":{"$id":"0dc3adb8-3383-43a7-b28f-8600243c90f5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"00f59ca4-f0ac-4ce7-9720-8920f7185c0f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"00f59ca4-f0ac-4ce7-9720-8920f7185c0f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4def3a53-1cb2-4322-ae9e-005a99a63168","$typeOfContent":"text","type":"SendMessage","settings":{"id":"50d41c4d-e9e7-41d3-957c-2988f2283543","type":"text/plain","content":"Existe a possibilidade de preencher <b>Dados complementares</b>. Fica a cargo de quem está gerando o boleto decidir se incluirá: abatimento, desconto, juros, multa e até protesto. Por fim, insira o número do <b>Beneficiário Final</b>.\n\nApós o preenchimento desses dados, clique em <b>Prosseguir</b>,\nvocê será direcionado para os termos finais. \n\n Confira na imagem.👇","metadata":{}},"$cardContent":{"document":{"id":"50d41c4d-e9e7-41d3-957c-2988f2283543","type":"text/plain","content":"Existe a possibilidade de preencher <b>Dados complementares</b>. Fica a cargo de quem está gerando o boleto decidir se incluirá: abatimento, desconto, juros, multa e até protesto. Por fim, insira o número do <b>Beneficiário Final</b>.\n\nApós o preenchimento desses dados, clique em <b>Prosseguir</b>,\nvocê será direcionado para os termos finais. \n\n Confira na imagem.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9a1a1e53-005c-4745-af7f-c937cbf07802","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"efd10853-0f44-4a09-93b2-5b2141fd9ac1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"efd10853-0f44-4a09-93b2-5b2141fd9ac1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"29bc3612-9218-41f8-b7cc-fecab11be8fe","$typeOfContent":"media","type":"SendMessage","settings":{"id":"e43b0ccd-8af3-402a-8af5-9afbaf15514b","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_4a0d1eae-78ee-47d2-b808-eea933032b9d","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"e43b0ccd-8af3-402a-8af5-9afbaf15514b","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_4a0d1eae-78ee-47d2-b808-eea933032b9d","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6df0bfac-8270-43c9-a451-b25b8b229d82","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"77a72922-0624-4c5d-9c1b-17cef97318ec","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7b3b008e-2e63-4096-a662-cb9e489e1357","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"7b3b008e-2e63-4096-a662-cb9e489e1357","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"a07bbfe5-cfa8-483f-99fe-debeb4313e97","typeOfStateId":"state","$connId":"con_128","$id":"08b99801-d857-494f-bab0-aff8144bef63","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"18154c74-ae55-44a0-8162-c79b2b496961","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-693d6399-852b-439e-b542-19db58c2b11d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-655efdc6-ea41-463e-acc2-a454c8526d63","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ed4276f4-8bb4-4130-bd93-038e5a80580b","root":false,"$title":"[S.3.2.3][MSG] Emissão de Boleto 3","$position":{"top":"1554.33px","left":"10951.3px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a07bbfe5-cfa8-483f-99fe-debeb4313e97":{"$contentActions":[{"action":{"$id":"62956be7-7f15-430e-b7c4-07a556572698","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"750835e5-c948-48b5-8272-39a2a6777607","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"750835e5-c948-48b5-8272-39a2a6777607","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"becb6ea3-0be8-4ead-a0f4-34d909e766ad","$typeOfContent":"text","type":"SendMessage","settings":{"id":"be5e1e71-ba47-4025-ac10-43e83c3d760b","type":"text/plain","content":"Por fim, você deverá optar pelo tipo de emissão e envios de boleto. Se você mesmo emite e envia, ou se o Safra faz isso por você.\n\nLeia e aceite os termos e condições, clique em <b>Habilitar e pronto</b>. 😉\n\nConfira na imagem.👇","metadata":{}},"$cardContent":{"document":{"id":"be5e1e71-ba47-4025-ac10-43e83c3d760b","type":"text/plain","content":"Por fim, você deverá optar pelo tipo de emissão e envios de boleto. Se você mesmo emite e envia, ou se o Safra faz isso por você.\n\nLeia e aceite os termos e condições, clique em <b>Habilitar e pronto</b>. 😉\n\nConfira na imagem.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"95840b98-932d-40cb-83bd-7c38ca8cb38d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8b438b0d-11a7-4be1-ab63-769a5be36817","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"8b438b0d-11a7-4be1-ab63-769a5be36817","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b519415-7d76-4269-a77e-d49e757543d5","$typeOfContent":"media","type":"SendMessage","settings":{"id":"287f9bfb-2ef4-4810-bc7a-ebf2e73ecddd","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_a66f5961-e0fe-4b87-afc1-543811b2c9ec","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"287f9bfb-2ef4-4810-bc7a-ebf2e73ecddd","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_a66f5961-e0fe-4b87-afc1-543811b2c9ec","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"705ca4c7-ab20-41b1-a748-de4af3f5953d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"1ea5b866-3798-40a0-8a04-a8a732839c43","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c8daaba7-8800-4908-9c8d-534f725dc59b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"c8daaba7-8800-4908-9c8d-534f725dc59b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"01e6479a-0432-4102-8e00-d6b8b1f0af3d","typeOfStateId":"state","$connId":"con_133","$id":"f178b1a7-f61c-4137-9802-e7ce057a33ea","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"86ca98cf-7989-4258-adc2-f098c2883e65","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-936d475b-3660-4f2e-8dc2-5cb31daea4c1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-51f9e6e4-6832-4791-81c5-e36711a753f8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a07bbfe5-cfa8-483f-99fe-debeb4313e97","root":false,"$title":"[S.3.2.4][MSG] Emissão de Boleto 4","$position":{"top":"1751.33px","left":"10951.3px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"416cada3-8419-49e7-bc77-fd4aa8d65ca9":{"$contentActions":[{"action":{"$id":"a86c9c7d-797b-4a7c-938d-7ca5d9a1cabf","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4d4a8bcb-6d83-4995-a11c-06f6e14bdd92","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4d4a8bcb-6d83-4995-a11c-06f6e14bdd92","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1469a65e-2bee-4c93-b1c3-bb053333bf64","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f4232971-7ae5-4705-983e-baa406cc8c5e","type":"text/plain","content":"Para consultar <b>Boletos</b>, primeiro você precisa estar logado no Internet Banking. Depois de logado, vá em <b>Gestão de Cobrança</b> e selecione a opção <b>Detalhes</b>, na parte inferior da tela, como na imagem abaixo.👇\n\n","metadata":{}},"$cardContent":{"document":{"id":"f4232971-7ae5-4705-983e-baa406cc8c5e","type":"text/plain","content":"Para consultar <b>Boletos</b>, primeiro você precisa estar logado no Internet Banking. Depois de logado, vá em <b>Gestão de Cobrança</b> e selecione a opção <b>Detalhes</b>, na parte inferior da tela, como na imagem abaixo.👇\n\n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d647fdff-9597-46a8-924d-4dbd770ba9ef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4a970c49-846a-4fc8-b499-72755843c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"4a970c49-846a-4fc8-b499-72755843c12d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6aff7af8-de48-40f2-a0f4-acab5191fc32","$typeOfContent":"media","type":"SendMessage","settings":{"id":"cdde7c95-ddc4-4c59-8661-31482d6df85f","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_a69066a7-54c0-4f6f-a9cb-8f7188e6ca2f","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"cdde7c95-ddc4-4c59-8661-31482d6df85f","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_a69066a7-54c0-4f6f-a9cb-8f7188e6ca2f","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7d2bf429-8bbb-45ab-a157-ea92f700b803","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"6723a18e-286d-49b3-b54d-6b71ce13bf7a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"83a4927f-0404-45de-ac6b-d0f9c13252bf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"83a4927f-0404-45de-ac6b-d0f9c13252bf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"01e6479a-0432-4102-8e00-d6b8b1f0af3d","typeOfStateId":"state","$connId":"con_138","$id":"32a2230c-491d-4a97-b3f2-4e1f66e2a484","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3caeb0ad-2438-4e3b-acd7-43cd05c3f747","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-397d5377-7d13-4dd9-b860-e04ca2998282","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-38228d8c-80aa-405e-886c-1dfd6e7b1a88","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"416cada3-8419-49e7-bc77-fd4aa8d65ca9","root":false,"$title":"[S.3.3.1][MSG] Consulta de boleto","$position":{"top":"1212px","left":"11443px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"39bdebc7-a35c-4d00-ac75-49f6ca6cc215":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"674e7373-85e8-4ea2-8a45-b62b32fc00d8","typeOfStateId":"state","$connId":"con_143","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"O que é?\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Como funciona\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Restrições\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Para saber mais sobre Espécie 33 - Boleto Deposito e Aporte, escolha uma das opções abaixo que a gente te mostra.👇\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1417bf60-027d-490a-9dcf-6f9b9aa8fad9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-da5cf23f-bfbf-4503-a3eb-1a3ac5226817","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0b3155d5-bf0f-484e-a864-b6b981023a33","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"39bdebc7-a35c-4d00-ac75-49f6ca6cc215","root":false,"$title":"[S.3.4.1][MSG] Botão Espécie 33","$position":{"top":"640.333px","left":"9832.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"674e7373-85e8-4ea2-8a45-b62b32fc00d8":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"75c8a72d-f928-4d09-9d6d-29fa6b024230","typeOfStateId":"state","$connId":"con_148","$id":"640f3fb4-4769-4a38-8f55-30e2a495d15c","conditions":[{"source":"context","comparison":"equals","values":["Restrições"],"variable":"userInput"}],"$invalid":false},{"stateId":"c5675f8e-1de6-4e04-84e2-f6fc670a93b3","typeOfStateId":"state","$connId":"con_153","$id":"ca78e923-bd95-4b8c-b7be-8e0ef14f35ad","conditions":[{"source":"context","comparison":"equals","values":["Como funciona"],"variable":"userInput"}],"$invalid":false},{"stateId":"eaa02b0b-8c8a-4085-b570-9421efe0a57b","typeOfStateId":"state","$connId":"con_158","$id":"77563549-e4b3-45e9-be07-0e36f35d0334","conditions":[{"source":"context","comparison":"equals","values":["O que é?"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // Entender botões com caracteres especiais.\n}\n\nfunction run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { buttons } = JSON.parse(dynamicContent).interactive.action\n        buttons.forEach((button, index) => {\n            const key = `^(${index + 1}|${posicoes[index + 1]}|${escapeRegExp(button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase())})$`\n            regexDictionary[key] = button.reply.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e19443a1-57ae-4e11-9948-939320d59261","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9ad99129-0f52-4790-8f0a-ddb62b36e111","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-df0ba378-2d2c-40ec-8f6c-7bc3d5f81ee1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-445f5ef4-1c2e-4d4a-9917-ae7facd6eb23","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"674e7373-85e8-4ea2-8a45-b62b32fc00d8","root":false,"$title":"[S.3.4.1][INPUT] Botão Espécie 33","$position":{"top":"635.5px","left":"12864.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"75c8a72d-f928-4d09-9d6d-29fa6b024230":{"$contentActions":[{"action":{"$id":"1ba80fdb-a32e-4774-a173-4df16cbc89a8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fc24cbed-f92e-4432-9b88-13e5b4d5af03","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fc24cbed-f92e-4432-9b88-13e5b4d5af03","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"02b5de1c-e812-47c8-921d-86dda0e52840","$typeOfContent":"text","type":"SendMessage","settings":{"id":"669427ae-c91b-445c-912b-fa87b48a2a16","type":"text/plain","content":"Existem algumas restrições para registro da espécie 33 junto a CIP / DDA - que serão aceitas no COB, porém serão recusadas na CIP. Como mostra a lista abaixo.\n \n<b>Importante</b>: Nessa situação, o pagador não conseguirá liquidar o boleto, pois não estará registrado na CIP. Em caso de atendimento a esta situação, as recusas / motivos poderão ser consultados pelo DDA / CIP / Relatórios.\n\n<b>Confira Lista</b> 👇","metadata":{}},"$cardContent":{"document":{"id":"669427ae-c91b-445c-912b-fa87b48a2a16","type":"text/plain","content":"Existem algumas restrições para registro da espécie 33 junto a CIP / DDA - que serão aceitas no COB, porém serão recusadas na CIP. Como mostra a lista abaixo.\n \n<b>Importante</b>: Nessa situação, o pagador não conseguirá liquidar o boleto, pois não estará registrado na CIP. Em caso de atendimento a esta situação, as recusas / motivos poderão ser consultados pelo DDA / CIP / Relatórios.\n\n<b>Confira Lista</b> 👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"288477ae-5bec-40e6-b2bb-3fa95cdf4eaf","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"101f96eb-0d70-4602-a415-46088a843bb0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"101f96eb-0d70-4602-a415-46088a843bb0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9292b8ff-9503-4ea1-afad-185902e40cdd","$typeOfContent":"media","type":"SendMessage","settings":{"id":"d94c5156-6977-40e9-a901-ef549d272f95","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_c6f5c29b-0eb4-4a31-9f89-405899664432","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"d94c5156-6977-40e9-a901-ef549d272f95","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_c6f5c29b-0eb4-4a31-9f89-405899664432","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b4a1b1bb-0759-419c-b3d8-d00a737dba69","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"953e0d78-1413-417d-ba02-842d3ac13827","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"},"metadata":{}},"$cardContent":{"document":{"id":"953e0d78-1413-417d-ba02-842d3ac13827","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2500"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a81a47a7-3a95-4002-a97d-3039d019ced4","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4dfd61ed-8780-47e6-bd57-d0143eafb799","typeOfStateId":"state","$connId":"con_163","$id":"441c4188-c4ae-4a20-b6bf-ccbbc2c00cf7","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"023e6db9-b79d-4121-b902-eeaccf36d729","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"O que é?\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Como funciona\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Saber mais.👇\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ecddfde1-b161-4efa-aefc-c98782811107","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-da7fcea5-f10c-48d3-8a9d-22d702340557","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a96d39f1-35e1-4be7-b910-0d811b82610a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"75c8a72d-f928-4d09-9d6d-29fa6b024230","root":false,"$title":"[S.3.4.2][MSG] Botão Restrições","$position":{"top":"1073.5px","left":"13264.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c5675f8e-1de6-4e04-84e2-f6fc670a93b3":{"$contentActions":[{"action":{"$id":"27877d66-9f2f-4c58-a0fc-ef4eba1f93eb","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"90a540e4-c68e-464b-abef-ef2a717c7e56","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"90a540e4-c68e-464b-abef-ef2a717c7e56","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2d75508a-59a6-4531-a3dc-c435dd4a098e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a163b612-ffcc-4014-8fd3-56d8949fdca2","type":"text/plain","content":"<b>Como funciona aqui no SAFRA</b>:\n• Os registros de cobrança efetivados, onde o PAGADOR seja o BENEFICIÁRIO, a espécie informada pelo beneficiário será convertida para <b>33 - Boleto de depósito e aporte</b> para envio e registro na CIP / DDA.\n\n• No sistema, a espécie permanecerá a original informada pelo cliente beneficiário, não havendo mudanças no fluxo de emissão de boletos.","metadata":{}},"$cardContent":{"document":{"id":"a163b612-ffcc-4014-8fd3-56d8949fdca2","type":"text/plain","content":"<b>Como funciona aqui no SAFRA</b>:\n• Os registros de cobrança efetivados, onde o PAGADOR seja o BENEFICIÁRIO, a espécie informada pelo beneficiário será convertida para <b>33 - Boleto de depósito e aporte</b> para envio e registro na CIP / DDA.\n\n• No sistema, a espécie permanecerá a original informada pelo cliente beneficiário, não havendo mudanças no fluxo de emissão de boletos."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7bcfeee8-3f37-4b9d-875d-41edf2c9f1c5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bb521fdf-13e6-4cc2-bbc1-bbfaa2567133","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bb521fdf-13e6-4cc2-bbc1-bbfaa2567133","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4b2431de-6116-449e-86ba-08e613fde316","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4dfd61ed-8780-47e6-bd57-d0143eafb799","typeOfStateId":"state","$connId":"con_168","$id":"be02b8e3-a564-4f4c-860a-c88730919d4e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"233d1757-2447-4911-a9a3-b202379f2728","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"O que é?\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Restrições\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Saber mais.👇\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-eba3306b-fcb8-44ab-b7ca-9896438232e5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f01a834e-4634-4116-973b-524ce7a79254","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-df88b6a1-14e7-4739-9f4d-3e731ecef014","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c5675f8e-1de6-4e04-84e2-f6fc670a93b3","root":false,"$title":"[S.3.4.3][MSG] Botão Como funciona","$position":{"top":"1063.5px","left":"12864.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4dfd61ed-8780-47e6-bd57-d0143eafb799":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"eaa02b0b-8c8a-4085-b570-9421efe0a57b","typeOfStateId":"state","$connId":"con_173","$id":"d23b54aa-e2f6-4e0e-9ab8-e95b64d0b2c5","conditions":[{"source":"context","comparison":"equals","values":["O que é?"],"variable":"userInput"}],"$invalid":false},{"stateId":"c5675f8e-1de6-4e04-84e2-f6fc670a93b3","typeOfStateId":"state","$connId":"con_178","$id":"6dd8b4cf-ea06-4827-b69c-d77361c915f6","conditions":[{"source":"context","comparison":"equals","values":["Como funciona"],"variable":"userInput"}],"$invalid":false},{"stateId":"75c8a72d-f928-4d09-9d6d-29fa6b024230","typeOfStateId":"state","$connId":"con_183","$id":"0beb0599-1470-434d-9ab9-b2458b11ee70","conditions":[{"source":"context","comparison":"equals","values":["Restrições"],"variable":"userInput"}],"$invalid":false},{"stateId":"efbdca07-598a-425a-af19-a5ec1d8c95de","typeOfStateId":"state","$connId":"con_188","$id":"0f1e7c70-0618-449d-b00c-fef537ced6c0","conditions":[{"source":"context","comparison":"equals","values":["Encerrar"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e98e1999-367d-4a38-a145-dbe99c774949","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9bc2e27d-82af-43a8-a0d0-47a8c24a939b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-797cee01-2310-4769-afc2-2d46576bf136","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fb64b86e-21bb-4e47-979a-236249be5517","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4dfd61ed-8780-47e6-bd57-d0143eafb799","root":false,"$title":"[S.3.5.0][INPUT] Botão Saber Mais?","$position":{"top":"1393.5px","left":"12864.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"eaa02b0b-8c8a-4085-b570-9421efe0a57b":{"$contentActions":[{"action":{"$id":"6e2d83bc-d4ef-499e-ade3-862c0ae6d74e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"de5edb21-661c-4ab2-a23a-5bd47f1af72b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"de5edb21-661c-4ab2-a23a-5bd47f1af72b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"dd575238-dfa7-4977-885a-16392f4db5cb","$typeOfContent":"text","type":"SendMessage","settings":{"id":"49d5f8e9-e7ea-4f14-81d4-7883fe371ce0","type":"text/plain","content":"<b>Espécie 33 - Boleto Deposito e Aporte</b> é o novo processo para tratamento de registros de boletos de cobrança.\n\nA normativa Bacen Circular n° 3.956/19 determina que todos os boletos, onde o PAGADOR seja o próprio BENEFICIÁRIO, os sistemas de cobrança dos bancos façam tratamentos específicos dos registros antes do envio para a CIP / DDA.","metadata":{}},"$cardContent":{"document":{"id":"49d5f8e9-e7ea-4f14-81d4-7883fe371ce0","type":"text/plain","content":"<b>Espécie 33 - Boleto Deposito e Aporte</b> é o novo processo para tratamento de registros de boletos de cobrança.\n\nA normativa Bacen Circular n° 3.956/19 determina que todos os boletos, onde o PAGADOR seja o próprio BENEFICIÁRIO, os sistemas de cobrança dos bancos façam tratamentos específicos dos registros antes do envio para a CIP / DDA."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"27aba12b-5ef1-43b6-8da3-1a1e816fac1f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c1307812-cb74-4f56-b203-cc1ad9964c9b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c1307812-cb74-4f56-b203-cc1ad9964c9b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"64a9e912-e195-4cdf-8e4f-1371d7657364","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4dfd61ed-8780-47e6-bd57-d0143eafb799","typeOfStateId":"state","$connId":"con_193","$id":"cff30c8b-4c76-4705-9a2a-1ae205307113","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"96079643-45ae-405e-82c2-71c1a01338b3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Como funciona\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Restrições\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Saber mais.👇\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9b56845e-4a50-4326-bab6-2e500d49f1a9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-98d756f0-6109-4768-8a9c-aa8c0cab4f46","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e226cfaf-b092-4ea4-ad72-27694db5c9bf","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"eaa02b0b-8c8a-4085-b570-9421efe0a57b","root":false,"$title":"[3.4.2][MSG] Botão O que é?","$position":{"top":"1062.5px","left":"12470.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"efbdca07-598a-425a-af19-a5ec1d8c95de":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2d966634-4194-42a0-9b4f-c0b523bbb7a4","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"efbdca07-598a-425a-af19-a5ec1d8c95de","root":false,"$title":"[GO TO] Redirect to Finalizacao","$position":{"top":"1643.5px","left":"12864.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5428084d-2bbc-41d3-b1c2-6e0587378c6b":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7bd0f7b0-08af-4c2d-a1a1-0cf569c8b37d","typeOfStateId":"state","$connId":"con_198","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Você já ativou o boleto com QR Code PIX na sua máquina Safrapay? 🤔\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-09877519-e2a5-44eb-bdb6-4828729f4524","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-12085f19-7198-492c-9777-df6dd9d23f4a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-82e17b9b-0fd5-4c5e-9278-34184e4f28c6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5428084d-2bbc-41d3-b1c2-6e0587378c6b","root":false,"$title":"[S.3.6.1][MSG] Botão Boleto com QR Code PIX","$position":{"top":"747px","left":"12124.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7bd0f7b0-08af-4c2d-a1a1-0cf569c8b37d":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"d596e8b5-d7cf-4f15-a919-e64877e9e353","typeOfStateId":"state","$connId":"con_203","$id":"69a13383-9480-4bc4-b6a4-596e49cf6cf9","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false},{"stateId":"b0db7207-723a-40f0-8636-c05a5116ed2b","typeOfStateId":"state","$connId":"con_208","$id":"da14f44c-79de-464c-a26a-c6cbe7ca88ea","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3cd45f76-5e79-46e0-a6ee-fd8fc13ecf6a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ab7e7de4-fd6b-4479-9088-f6ac14eb8f05","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0048bbaf-4cd5-458d-855f-a1c67c0a1a96","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a077b2b4-31be-4067-9e59-38eca2eb74df","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7bd0f7b0-08af-4c2d-a1a1-0cf569c8b37d","root":false,"$title":"[S.3.6.1][INPUT] Botão Boleto com QR Code PIX","$position":{"top":"1032.67px","left":"12124.7px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d596e8b5-d7cf-4f15-a919-e64877e9e353":{"$contentActions":[{"action":{"$id":"82f43a47-6693-4968-9ee0-7c6fb52e3746","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"536e7368-0fba-4b7e-a69f-48f9962c43a3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"536e7368-0fba-4b7e-a69f-48f9962c43a3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6f5baa66-d7a1-42f1-891a-10a1bf823f1a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"30961f93-770e-4bf3-8b1f-fd0701259211","type":"text/plain","content":"Nesse caso, primeiro faça o login no <b>Internet Banking</b>.","metadata":{}},"$cardContent":{"document":{"id":"30961f93-770e-4bf3-8b1f-fd0701259211","type":"text/plain","content":"Nesse caso, primeiro faça o login no <b>Internet Banking</b>."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"47a7a6eb-d944-4740-b959-dbb798a337f1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0c19ae6a-71f8-4f07-b2e1-e97732bbdb9c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0c19ae6a-71f8-4f07-b2e1-e97732bbdb9c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6153984b-2e84-43fc-8c7d-320eea3fbeb7","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4a3fa2f9-89e6-4d76-8d47-23f20bfda8d1","type":"text/plain","content":"Na página principal, selecione a opção <b>Contratos de cobrança</b>, como mostra a imagem abaixo.👇","metadata":{}},"$cardContent":{"document":{"id":"4a3fa2f9-89e6-4d76-8d47-23f20bfda8d1","type":"text/plain","content":"Na página principal, selecione a opção <b>Contratos de cobrança</b>, como mostra a imagem abaixo.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"74011b8a-b538-4146-b70e-723096d3ad54","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ad99cd1c-2166-47f5-a3db-1fa12275928b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"ad99cd1c-2166-47f5-a3db-1fa12275928b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5ba5281d-1f29-4bc6-adf3-d5072593875a","$typeOfContent":"media","type":"SendMessage","settings":{"id":"01726b09-68bc-4146-94ec-f92561697cba","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_3fde14fa-c10f-4168-b9f3-75402c05226a","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"01726b09-68bc-4146-94ec-f92561697cba","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_3fde14fa-c10f-4168-b9f3-75402c05226a","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4a33aa2d-ca66-4ffe-b9cc-796ddc0ea04c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"31443b9b-e057-4815-9f57-9b512d762dac","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5fde9956-8e40-4711-939e-3019ff46f499","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"5fde9956-8e40-4711-939e-3019ff46f499","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"de817b05-32d7-464d-84f1-1b9a8a509f60","typeOfStateId":"state","$connId":"con_213","$id":"00ad80d4-125a-457d-b9c6-9cfdc585b1cb","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f6a28bcf-7a92-4bfa-8dd1-806b30a12a1f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6ad931a3-8526-4573-9b16-652b6b20287b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-27b53bcd-fa74-4df3-b6f4-575fdd84b200","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d596e8b5-d7cf-4f15-a919-e64877e9e353","root":false,"$title":"[S.3.8.1][MSG] Boleto com QR Code PIX","$position":{"top":"1326px","left":"12246px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"de817b05-32d7-464d-84f1-1b9a8a509f60":{"$contentActions":[{"action":{"$id":"224e5df0-5e57-4a88-a25f-a95ace02d5be","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8ae90da8-790b-402c-bbf2-5d996033df26","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8ae90da8-790b-402c-bbf2-5d996033df26","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3165d6fc-60cf-4d4b-9907-920c5c6c0e75","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7215bfd5-d489-4a27-aa6c-cad7807a5ebe","type":"text/plain","content":"Na tela seguinte, selecione a opção Boleto com QR Code PIX, como na imagem.👇","metadata":{}},"$cardContent":{"document":{"id":"7215bfd5-d489-4a27-aa6c-cad7807a5ebe","type":"text/plain","content":"Na tela seguinte, selecione a opção Boleto com QR Code PIX, como na imagem.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a8bf62c0-df4c-4f17-be2a-b9806f5dc812","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f9bdce6b-c451-44d7-a4c8-6064fdfad4dc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"f9bdce6b-c451-44d7-a4c8-6064fdfad4dc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4c3e9a5a-6fb4-42d4-bfbc-0f9f2ec3f750","$typeOfContent":"media","type":"SendMessage","settings":{"id":"7f67cdd0-47c1-49a3-9f33-7f0ac06f1fc9","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_c1613e98-b84c-4c27-8cd4-16464b3cb4ee","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"7f67cdd0-47c1-49a3-9f33-7f0ac06f1fc9","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_c1613e98-b84c-4c27-8cd4-16464b3cb4ee","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e6d98283-ef05-4073-ac11-78c11e94962f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"0ae4dfd1-bc03-4667-acc4-ce022773d602","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"85cc3fc0-920c-4dd8-b63b-f74013162bcf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"85cc3fc0-920c-4dd8-b63b-f74013162bcf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"2c1e4568-ce6c-4f9b-aed6-0ea1a7dff2dc","typeOfStateId":"state","$connId":"con_218","$id":"d0c4c114-3445-4d99-afe9-6c54ec66bdf6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"04187f49-4536-4132-8c73-e47250f3c1c8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4b76fe78-91ee-44c2-840e-a492ee68a674","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4c23cb51-5675-49c2-ad7f-1b3552b4a2de","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"de817b05-32d7-464d-84f1-1b9a8a509f60","root":false,"$title":"[S.3.8.2][MSG] Boleto com QR Code PIX 2","$position":{"top":"1521px","left":"12410px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2c1e4568-ce6c-4f9b-aed6-0ea1a7dff2dc":{"$contentActions":[{"action":{"$id":"3a1aba59-dbcf-4732-9020-7c2d0ce6ed61","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8b4a2596-59fe-48c3-aaa4-b55fb2ae4b89","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8b4a2596-59fe-48c3-aaa4-b55fb2ae4b89","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8b7cc33c-9a2c-42fd-a50f-96e042dadc0d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9163f00b-312d-49cc-a3fe-bcbb67193cdd","type":"text/plain","content":"Depois preencha as informações de segurança e aceite do termo.👇","metadata":{}},"$cardContent":{"document":{"id":"9163f00b-312d-49cc-a3fe-bcbb67193cdd","type":"text/plain","content":"Depois preencha as informações de segurança e aceite do termo.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fd9c11a1-5c8b-4c1d-b11f-d0378e712be3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"30ebe03e-331f-43e3-b6c8-e65380ae6b87","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"30ebe03e-331f-43e3-b6c8-e65380ae6b87","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fcc4196b-6284-469d-80fb-3b5a23549a84","$typeOfContent":"media","type":"SendMessage","settings":{"id":"d35da3bf-b543-44e2-8448-36c87b54a032","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_1546d782-1b2b-4c88-9333-89bef364c373","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"d35da3bf-b543-44e2-8448-36c87b54a032","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_1546d782-1b2b-4c88-9333-89bef364c373","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7de64149-09d8-4e07-9eba-86b07f4a1873","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"2964c6f7-249d-4589-994a-0ef27137865e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4df05da5-39c4-4726-8ffd-d0db1d5fa153","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"4df05da5-39c4-4726-8ffd-d0db1d5fa153","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"07876c93-03e3-472a-81ae-9b1e7cefe706","typeOfStateId":"state","$connId":"con_223","$id":"60197909-4110-4ffe-94cc-f156e6b3d85a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3f1525c9-23ba-4c10-9d3b-e0162f7be1c7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e3861a49-511d-40f5-9136-0d057464772a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-090094a0-9e1c-43e8-8c4e-ec32ddb7c902","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2c1e4568-ce6c-4f9b-aed6-0ea1a7dff2dc","root":false,"$title":"[S.3.8.3][MSG] Boleto com QR Code PIX 3","$position":{"top":"1784px","left":"12410px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"07876c93-03e3-472a-81ae-9b1e7cefe706":{"$contentActions":[{"action":{"$id":"afa86540-1905-49b7-bae7-1ccea54eb51e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"04189404-40fc-4ac7-b061-ae94799c86cc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"04189404-40fc-4ac7-b061-ae94799c86cc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"42db8f1d-4ee8-4d3e-b29a-0d156fac52d4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d72b564e-5e42-4fe0-a67c-b63b7c8d6946","type":"text/plain","content":"Pronto, a mensagem de operação realizada com sucesso aparecerá na sua tela.👇","metadata":{}},"$cardContent":{"document":{"id":"d72b564e-5e42-4fe0-a67c-b63b7c8d6946","type":"text/plain","content":"Pronto, a mensagem de operação realizada com sucesso aparecerá na sua tela.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1e4e53c9-8ece-4473-b719-ddfc483f4c27","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8ce510e7-c981-4126-b8ea-a87474ad80e3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"8ce510e7-c981-4126-b8ea-a87474ad80e3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"540f4f43-ec66-456b-a229-4bdb01c8e1db","$typeOfContent":"media","type":"SendMessage","settings":{"id":"ecd7d43a-6074-44ed-bdc7-7d45f57a936c","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_02a00bf0-e4c0-40ab-bd96-5a2537a36062","aspectRatio":"2:1"},"metadata":{}},"$cardContent":{"document":{"id":"ecd7d43a-6074-44ed-bdc7-7d45f57a936c","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://blipmediastore.blob.core.windows.net/public-medias/Media_02a00bf0-e4c0-40ab-bd96-5a2537a36062","aspectRatio":"2:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"10e6ab5b-6ef8-44aa-ae1f-ce2f540643a0","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"6de21f59-9690-4f89-bb5c-c3d97f473223","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"32a493d9-f54e-4ca8-bbf3-e9ad5cd81fe3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"32a493d9-f54e-4ca8-bbf3-e9ad5cd81fe3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"29dbe946-9809-4feb-93d0-8327cd06d1a2","typeOfStateId":"state","$connId":"con_228","$id":"43e3ece5-756d-41cf-a7a6-c72f84c0a9b7","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e758e722-7b78-4567-af5d-636f3ab37489","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ae11acf6-8011-4887-a1e9-d1492a6133ae","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-70e7509b-244a-4b92-8c94-37e1b6f548a4","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"07876c93-03e3-472a-81ae-9b1e7cefe706","root":false,"$title":"[S.3.8.4][MSG] Boleto com QR Code PIX 4","$position":{"top":"1987px","left":"12410px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"29dbe946-9809-4feb-93d0-8327cd06d1a2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"41310cdb-3d00-4a65-9422-85f6b3487fbc","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"29dbe946-9809-4feb-93d0-8327cd06d1a2","root":false,"$title":"[GO TO] Redirect to Finalizacao ","$position":{"top":"2181px","left":"12172px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b0db7207-723a-40f0-8636-c05a5116ed2b":{"$contentActions":[{"action":{"$id":"01c6745d-74de-47e5-8004-e77645d540ff","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f068ed53-62f7-4440-bea2-b83beb5d618d","type":"text/plain","content":"Nesse caso, após cadastrar uma chave pix com a Safrapay, através do <b>Internet banking</b>, ou no momento do credenciamento, você tem acesso a opção <b>Pagar com QR Code</b> na sua maquininha.\n\nCom ela, você dá aos seus clientes a possibilidade de realizar pagamentos via PIX, sem precisar usar cartão de crédito ou débito.\n\nBasta digitar o valor da venda e pedir para o cliente apontar a câmera do celular para sua Safrapay! ","metadata":{}},"$cardContent":{"document":{"id":"f068ed53-62f7-4440-bea2-b83beb5d618d","type":"text/plain","content":"Nesse caso, após cadastrar uma chave pix com a Safrapay, através do <b>Internet banking</b>, ou no momento do credenciamento, você tem acesso a opção <b>Pagar com QR Code</b> na sua maquininha.\n\nCom ela, você dá aos seus clientes a possibilidade de realizar pagamentos via PIX, sem precisar usar cartão de crédito ou débito.\n\nBasta digitar o valor da venda e pedir para o cliente apontar a câmera do celular para sua Safrapay! "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"action":{"$id":"ade4c0b2-ecc9-4e29-9ac1-37d2026a8e84","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c9c32ff5-7288-413d-92a6-d933e6c211fa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c9c32ff5-7288-413d-92a6-d933e6c211fa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"326ece7f-4e90-4b11-b900-04a7432e9d00","typeOfStateId":"state","$connId":"con_233","$id":"0c4f7eff-02ba-48f6-a20c-bb347857aa1d","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Gostaria de ver um vídeo explicativo de como vender com PIX usando QR Code?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-15c54273-697f-4c34-bde2-40f14350af40","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ac0e89c6-fcd7-46b4-ba2e-77d7550e86f9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fd2b6815-95f9-4d9e-8eee-7b5325a5740c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b0db7207-723a-40f0-8636-c05a5116ed2b","root":false,"$title":"[S.3.7.1][MSG] Boleto Ativado Botão","$position":{"top":"1281px","left":"11804px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"326ece7f-4e90-4b11-b900-04a7432e9d00":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"29dbe946-9809-4feb-93d0-8327cd06d1a2","typeOfStateId":"state","$connId":"con_238","$id":"69a13383-9480-4bc4-b6a4-596e49cf6cf9","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false},{"stateId":"87c5fde0-d1ec-48a0-b195-bbe414ebd307","typeOfStateId":"state","$connId":"con_243","$id":"da14f44c-79de-464c-a26a-c6cbe7ca88ea","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c65d2f25-d91a-48d3-b2f6-095a67169c1d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-70475d79-7add-4bc0-abe7-47cb48b8cba1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-881abe35-3ebc-45bb-994f-c4f08b1795f2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-25f26770-4412-4ede-9968-75c72101e47c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"326ece7f-4e90-4b11-b900-04a7432e9d00","root":false,"$title":"[S.3.7.1][INPUT] Boleto Ativado Botão","$position":{"top":"1543px","left":"11804px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"87c5fde0-d1ec-48a0-b195-bbe414ebd307":{"$contentActions":[{"action":{"$id":"ec755843-1310-4785-b8a0-27901f0954a7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d071cfa2-f408-4ca5-9cab-4cbc158851fe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d071cfa2-f408-4ca5-9cab-4cbc158851fe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0a6e9acb-4c28-41e4-a012-336187064991","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bb304d53-5947-46b4-a7a5-baf1948e393b","type":"text/plain","content":"Veja no  link abaixo o vídeo explicativo! 😊\n\nLink 👉  https://www.youtube.com/watch?v=6RLXeRYdChk","metadata":{}},"$cardContent":{"document":{"id":"bb304d53-5947-46b4-a7a5-baf1948e393b","type":"text/plain","content":"Veja no  link abaixo o vídeo explicativo! 😊\n\nLink 👉  https://www.youtube.com/watch?v=6RLXeRYdChk"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c27e8ec2-50a5-4f77-b0ed-6e7342aa4cae","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"29dbe946-9809-4feb-93d0-8327cd06d1a2","typeOfStateId":"state","$connId":"con_248","$id":"f881db99-71af-4687-bee5-03f7eb0675f8","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3eefea5e-9c82-44b5-8db2-029009ce9cfb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3c2ece91-89ef-4c85-b587-e4192008908e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-628f73c3-50ab-4386-b38b-200fe3bf9e89","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"87c5fde0-d1ec-48a0-b195-bbe414ebd307","root":false,"$title":"[S.3.7.2][MSG] Video Venda por Boleto","$position":{"top":"1805px","left":"12172px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"733915ec-b86d-4df4-b6cd-0844b9f4c969":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"6f08df86-e471-4487-bed9-3ce655bc2d81","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e747d2e2-106e-449e-8b25-7840ceabf084","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"733915ec-b86d-4df4-b6cd-0844b9f4c969","root":false,"$title":"[GO TO] [S.3.0.0][MSG] Menu Boletos","$position":{"top":"550.5px","left":"2964.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"eb076e1b-c303-4df2-88eb-d9083b2c22bb":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a5cee436-1b27-415b-8f38-ae04973b6b99","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"eb076e1b-c303-4df2-88eb-d9083b2c22bb","root":false,"$title":"[GO TO] Redirect to Main (Menu Principal)","$position":{"top":"1877px","left":"4913.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e36dcaa0-0665-4b22-ae98-3e8605d7e557":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"de7d8593-8bd0-4fb0-9c8b-bce0561fcf51","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"b039b1aa-719e-462d-aefc-de01bc0ddd7b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: '30e39880-1d2a-439a-a0ed-1e7210966286',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (error) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: error.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"b329fc66-8d30-44ed-8449-df875c5a9eb2","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-776e46e0-c584-4d3c-a480-0a0985e88362","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0cbae6ed-3398-4eb2-82c0-870de6b0fa95","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"e36dcaa0-0665-4b22-ae98-3e8605d7e557","root":false,"$title":"[Redirect] To Main (Menu inicial)","$position":{"top":"67px","left":"2186.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6816ed87-a80a-4743-b76f-0bfbafb3f80d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a960a336-a740-4c68-8bab-0967f271b0eb","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"951b3eb5-7c14-4eb9-8b46-0b909846398b","typeOfStateId":"state","$connId":"con_253","$id":"4f22a19a-f779-4390-b05f-e7eac4404a8e","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"cnpjLiberado"}],"$invalid":false},{"stateId":"635bebe1-1780-40bc-9069-2292fe9d29c4","typeOfStateId":"state","$connId":"con_258","$id":"9ddc9b6b-eef8-49e4-b143-606d694a7296","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"cnpjLiberado"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"43e05fc3-4a2c-4d66-a98c-a1f667b4bb5d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"cnpjLiberado\"","$invalid":false,"settings":{"function":"run","source":"function run(contaSelecionada, bodyConsultaProtocolo) {\n\ttry {\n\t\tcontaSelecionada = JSON.parse(contaSelecionada);\n\t\tbodyConsultaProtocolo = JSON.parse(bodyConsultaProtocolo).data;\n\t\tif (contaSelecionada.doc == bodyConsultaProtocolo.documento) {\n\t\t\treturn \"Sim\"\n\t\t}\n\t\treturn \"Não\"\n\t}\n\tcatch (e) {\n\t\treturn \"Não\"\n\t}\n}","inputVariables":["contaSelecionada","bodyConsultaProtocolo"],"outputVariable":"cnpjLiberado","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2b771b12-a7a1-4bb9-935f-827d957b460f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"9c658471-98ce-4f5f-9b1a-60dba972a942","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validacao dados\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} validacao dados","action":"{{numeroProtocolo}} | {{contaSelecionada@doc}} | {{cnpjLiberado}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-de34f2f1-d984-438b-ae80-817718a1d0be","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d34aa61c-d086-452a-a7d5-4b08f86bfe0f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"6816ed87-a80a-4743-b76f-0bfbafb3f80d","root":false,"$title":"[S.2.0.1][SET] cnpjLiberado","$position":{"top":"1020px","left":"4331px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"443ab8bd-9468-402d-b5d6-4c1afa3a7212":{"$contentActions":[{"action":{"$id":"03aad8d9-5b10-4bfb-b6e6-a15e05b51ce0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9b3c8634-e171-4440-80a6-fc89e34cf5ae","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9b3c8634-e171-4440-80a6-fc89e34cf5ae","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a1ad81ac-b0f3-47d5-810a-5d266d27196a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4b0cde3d-c788-42f7-8623-f3df6958a7d9","type":"text/plain","content":"Por favor, digite o seu número de protocolo.\n\nComo neste exemplo:\n<b>12345678910112</b>","metadata":{}},"$cardContent":{"document":{"id":"4b0cde3d-c788-42f7-8623-f3df6958a7d9","type":"text/plain","content":"Por favor, digite o seu número de protocolo.\n\nComo neste exemplo:\n<b>12345678910112</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"eceade33-1f3d-4151-b69a-a681756f42a2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"dbea5aca-16ff-48d8-94e5-1cc1c37d3356","typeOfStateId":"state","$connId":"con_263","$id":"a9dcb232-2792-47af-ac0a-494f6e5b658e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"93dcf09c-18c5-4f87-8f2d-1cb0f2041d7c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-7353cd92-248c-48b9-a431-b6318bc38106","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c02bc9b0-94dd-4d1d-be2d-f9ecef2af45a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","root":false,"$title":"[S.2.6.0][MSG] Consulta Protocolo Númerica","$position":{"top":"218px","left":"4330.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"44c346c4-2d0e-41e0-aa1e-63da89563f8c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:35031"}],"$conditionOutputs":[{"stateId":"c20e1e53-f902-4a8c-821d-747708a4294b","typeOfStateId":"state","$connId":"con_268","$id":"94b0d318-57a3-4934-9b98-409233834812","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:35047"}],"$invalid":false,"$$hashKey":"object:35033"}],"$enteringCustomActions":[{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]},{"$id":"e85e5032-c468-466c-accb-a81684067458","$typeOfContent":"","type":"SetVariable","$title":"Set \"assunto\"","$invalid":false,"settings":{"variable":"assunto","value":"Consulta de Protocolo"},"conditions":[]}],"$leavingCustomActions":[{"$id":"8907a632-f4f9-42e1-bda5-1af99a00b67c","$typeOfContent":"","type":"SetVariable","$title":"Set msgOcorrencia CLEAR","$invalid":false,"settings":{"variable":"msgOcorrencia"},"conditions":[]},{"$id":"c9ec40e4-767f-44ba-9a7b-22e0f9fb84f6","$typeOfContent":"","type":"SetVariable","$title":"Set msgOcorrencias CLEAR","$invalid":false,"settings":{"variable":"msgOcorrencias"},"conditions":[]},{"$id":"c9171d5a-9e83-4f7a-b1e9-473bbf6d6050","$typeOfContent":"","type":"SetVariable","$title":"Set statusConsultaOcorrenciaLista CLEAR","$invalid":false,"settings":{"variable":"statusConsultaOcorrenciaLista"},"conditions":[]},{"$id":"a935f9e7-f165-41a0-b0a1-340658fa074e","$typeOfContent":"","type":"SetVariable","$title":"Set bodyConsultaOcorrenciaLista CLEAR","$invalid":false,"settings":{"variable":"bodyConsultaOcorrenciaLista"},"conditions":[]},{"$id":"715782f1-109c-412f-9e89-fbd70e40faeb","$typeOfContent":"","type":"SetVariable","$title":"Set numeroDeOcorrencias CLEAR","$invalid":false,"settings":{"variable":"numeroDeOcorrencias"},"conditions":[]},{"$id":"f931c343-4968-48d1-9cb6-a5f7010b26a0","$typeOfContent":"","type":"SetVariable","$title":"Set ocorrenciaEncontrada CLEAR","$invalid":false,"settings":{"variable":"ocorrenciaEncontrada"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-851ea37b-c76e-48ed-8204-315fd64fedd3","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fb3adf95-6745-40e7-a078-27aae5efb0aa","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"44c346c4-2d0e-41e0-aa1e-63da89563f8c","root":false,"$title":"[S.2.0.0][MSG] Inicio Protocolo","$position":{"top":"0px","left":"6528.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c20e1e53-f902-4a8c-821d-747708a4294b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9773dbdb-c4a4-422a-a0a9-bd1f47189bcd","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"50271819-701d-4321-9f69-1d3524b3dc4a","typeOfStateId":"state","$connId":"con_273","$id":"583db181-8751-48e3-ae06-352f76efa6b5","conditions":[{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"4d2b0312-2061-44d3-af22-25d4a301fd5d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"intervaloDeDatas\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n    const hoje = new Date();\n    const DiasAtras = new Date();\n    DiasAtras.setDate(hoje.getDate() - 7);//Ultimos 7 dias\n    const formatarData = (data) => {\n        const ano = data.getFullYear();\n        const mes = String(data.getMonth() + 1).padStart(2, '0');\n        const dia = String(data.getDate()).padStart(2, '0');\n        return `${ano}-${mes}-${dia}`;\n    };\n    const periodo = `periodo.gte=${formatarData(DiasAtras)}&periodo.lte=${formatarData(hoje)}`;\n    return periodo;\n}","inputVariables":[],"outputVariable":"intervaloDeDatas","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3ad17416-61f6-48ac-8c59-a73b7e211917","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyConsultaProtocoloLista\" (Consultar Protocolo Lista)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}","Safra-Correlation-ID":"{{idSessao}}","Safra-Aplicacao":"CHT"},"uri":"{{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/ocorrencias?documentoCliente={{contaSelecionada@doc}}&{{intervaloDeDatas}}","method":"GET","responseStatusVariable":"statusConsultaOcorrenciaLista","responseBodyVariable":"bodyConsultaOcorrenciaLista"},"conditions":[]},{"$id":"74af7a6f-7d3b-4346-8fda-c2e04239aec6","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusConsultaOcorrenciaLista"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"68608304-18ff-40c1-b1a6-c9e306e2a544","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/ocorrencias?documentoCliente={{contaSelecionada@doc}}&{{intervaloDeDatas}} | GET | {{statusConsultaProtocoloLista}} | {{bodyConsultaProtocoloLista}}"},"conditions":[]},{"$id":"daae12b4-a4ef-4b02-ac88-5551d7406d4b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{apiStatus}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"apiStatus"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f666c598-d0e9-4391-9f0f-554dfccc2755","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fcdff289-6cd8-4703-bd8e-fd0e900b2850","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-4af3e037-526a-4217-861b-8cbbad9b6393","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"c20e1e53-f902-4a8c-821d-747708a4294b","root":false,"$title":"[S.2.1.0] [HTTP] Consulta Ocorrencias","$position":{"top":"170.857px","left":"6528px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ed2a5fb2-da6f-4961-b14d-e302fa57b991":{"$contentActions":[{"action":{"$id":"278eb460-650c-4071-ba4d-52fa49ea806c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fa378076-abf8-4f07-ba26-e248bab7588a","type":"text/plain","content":"Nos últimos 7 dias encontrei <b>{{numeroDeOcorrencias}}</b> protocolos.","metadata":{}},"$cardContent":{"document":{"id":"fa378076-abf8-4f07-ba26-e248bab7588a","type":"text/plain","content":"Nos últimos 7 dias encontrei <b>{{numeroDeOcorrencias}}</b> protocolos."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:36009"},{"action":{"$id":"08c61e2c-d15f-42e3-8102-ebb442760d36","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:36010"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:36011"}],"$conditionOutputs":[{"stateId":"2f9e7f20-742c-48d2-901d-373375d47540","typeOfStateId":"state","$connId":"con_278","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:36031"}],"$invalid":false,"$$hashKey":"object:36017"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-52d662a3-71ff-43f9-8a5c-e8e9d622676a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ed2a5fb2-da6f-4961-b14d-e302fa57b991","root":false,"$title":"[S.2.4.0][MSG] Ocorrencias Encontradas","$position":{"top":"562.667px","left":"7069.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2277261f-1fd3-4041-ad2a-494985ee2067":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7b60ebcd-d719-48fc-b7de-d4d3e0774e1c","typeOfStateId":"state","$connId":"con_283","$id":"b1c9e975-9a1d-4abe-9282-9870c1633436","conditions":[{"source":"context","comparison":"equals","values":["Não encontrei o protocolo"],"variable":"userInput"}],"$invalid":false},{"stateId":"b370502b-e1bf-4c50-a4f1-39f401c3ba9a","typeOfStateId":"state","$connId":"con_288","$id":"b61d8545-ad87-4395-9ce8-ab94124b2db3","conditions":[{"source":"context","comparison":"notEquals","values":["Input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, ocorrenciasEncontradas) {\n    try {\n        ocorrenciasEncontradas = JSON.parse(ocorrenciasEncontradas);\n        if (!inputUsuario) return 'inatividade'\n        if (inputUsuario == \"0\") return \"Não encontrei o protocolo\"\n        if (isNumber(inputUsuario)) {\n            let index = parseInt(inputUsuario) - 1;\n            if (index >= 0 && index < ocorrenciasEncontradas.length) {\n                return ocorrenciasEncontradas[index];\n            } else {\n                return 'input inesperado';\n            }\n        };\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}\nfunction isNumber(input) {\n    const regex = /^\\d+$/;\n    return regex.test(input);\n}","inputVariables":["input.content","ocorrenciasEncontradas"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d25ef70a-7b3c-498c-b27e-e63b3dcbb1ab","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciaEncontrada\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada);\n\t\treturn ocorrenciaEncontrada;\n\t}\n\tcatch (e) {\n\t\treturn \"Não Encontrada\"\n\t}\n}","inputVariables":["userInput"],"outputVariable":"ocorrenciaEncontrada","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"S.2.4.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"S.2.4.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1cffb7a5-a562-450e-b1cc-3737399d1107","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b1e49ab2-6b22-433b-be45-da1af993ac8a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6c49f2f7-6722-47e8-8bc9-78fb71329592","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b5ea37de-06ca-4d16-b3cf-e265c32df672","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"2277261f-1fd3-4041-ad2a-494985ee2067","root":false,"$title":"[S.2.4.0.1][INPUT] Menu Lista de Ocorrencias","$position":{"top":"939.143px","left":"7065.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b20fb076-c6ef-4428-aa0d-84347f64c134":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:36428"},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false,"$$hashKey":"object:36429"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:36430"}],"$conditionOutputs":[{"stateId":"4c41d929-318a-4a12-9354-3bdf63dcf68f","typeOfStateId":"state","$connId":"con_293","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:36451"}],"$invalid":false,"$$hashKey":"object:36437"}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Consultar 60 dias\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Informar número\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Fiz uma busca e nos últimos 7 dias não encontrei nenhum protocolo. Se preferir, posso te mostrar dos últimos 60 dias ou consultar um número específico.\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7feb6ddf-9dd6-4546-8ffa-c402a23ec26c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bf3ae247-7b56-41de-877d-d6f492231a33","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a9cab2e9-c9d9-4766-b9c1-89b881e7e110","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b20fb076-c6ef-4428-aa0d-84347f64c134","root":false,"$title":"[S.2.3.1][MSG] Nenhum Protocolo","$position":{"top":"337.857px","left":"7519.29px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4c41d929-318a-4a12-9354-3bdf63dcf68f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:36607"}],"$conditionOutputs":[{"stateId":"4e9827e9-12c0-4947-814a-5c4657ca92e1","typeOfStateId":"state","$connId":"con_298","$id":"63d3e659-896e-4898-9d47-22d250699d08","conditions":[{"source":"context","comparison":"equals","values":["Informar número"],"variable":"userInput","$$hashKey":"object:36630"}],"$invalid":false,"$$hashKey":"object:36610"},{"stateId":"73c400ff-6fac-4a40-9496-b33797582398","typeOfStateId":"state","$connId":"con_303","$id":"f2b14f53-bee6-4f03-9701-76da4fa528d8","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput","$$hashKey":"object:36648"}],"$invalid":false,"$$hashKey":"object:36611"},{"stateId":"1e1a9840-12e2-48e2-9d7a-a957dcfed181","typeOfStateId":"state","$connId":"con_308","$id":"c8e7b62b-51cd-46d5-b90d-6737d58d4dcf","conditions":[{"source":"context","comparison":"equals","values":["Consultar 60 dias"],"variable":"userInput","$$hashKey":"object:36664"}],"$invalid":false,"$$hashKey":"object:36612"}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5e98a51d-a50f-4bcf-9914-14c2c9cf7c7b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cbb4ec86-581b-413c-baf7-0580c0831058","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-b8533cca-1609-41e9-aaf8-6ec573159b1e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-891c5564-bf3b-467b-a25f-7e87060e20cc","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4c41d929-318a-4a12-9354-3bdf63dcf68f","root":false,"$title":"[S.2.3.1][INPUT] Nenhum Protocolo","$position":{"top":"338.429px","left":"7788px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4e9827e9-12c0-4947-814a-5c4657ca92e1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8dae2f8d-827d-42f5-8b0a-4d8b022a0629","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"4e9827e9-12c0-4947-814a-5c4657ca92e1","root":false,"$title":"[GO TO] S.2.6.0 Digitar Número","$position":{"top":"617px","left":"7927px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"73c400ff-6fac-4a40-9496-b33797582398":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6db7aa2-0222-4b55-a0c5-5498d09dc5a7","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"73c400ff-6fac-4a40-9496-b33797582398","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"612.429px","left":"7622px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"953ef71d-0751-4132-8abf-d93e9796d017":{"$contentActions":[{"action":{"$id":"41e88d1d-5eb3-4d58-afc3-790f0774283c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"51676aef-8b24-4bde-97ab-de677f016eeb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"51676aef-8b24-4bde-97ab-de677f016eeb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6204a6c1-eb31-4c64-b33c-31f8525d5f4b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9f2a4b4c-d38f-4459-8366-f0c96d6ff1a3","type":"text/plain","content":"Nos últimos 7 dias encontrei este protocolo.\n\nVou te mostrar o status dele.","metadata":{}},"$cardContent":{"document":{"id":"9f2a4b4c-d38f-4459-8366-f0c96d6ff1a3","type":"text/plain","content":"Nos últimos 7 dias encontrei este protocolo.\n\nVou te mostrar o status dele."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"9d6ba1ae-d71a-41d3-9a57-fc9cc38d90bf","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"24f3ed8d-b58f-4387-9361-b21679366958","typeOfStateId":"state","$connId":"con_313","$id":"bda41ca7-cb5a-43b4-ae7c-f695a007a870","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"02d33333-0135-41b9-b32e-2b117a6e07c5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciaEncontrada\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaOcorrenciaLista) {\n    try {\n        let data = JSON.parse(bodyConsultaOcorrenciaLista).data;\n        return data[0];\n    }\n    catch (e) {\n        return e.message;\n    }\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"ocorrenciaEncontrada","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3fad94bc-93b2-4f50-a46b-f99922749a65","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1c238c79-7632-42a9-ab5d-5cdd3e41e0fb","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"953ef71d-0751-4132-8abf-d93e9796d017","root":false,"$title":"[S.2.2.1][MSG]Um Protocolo Encontrado","$position":{"top":"401px","left":"6117.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ebd69b85-ac8c-4129-afde-1f91a09c6ed0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5e54ad2b-00dc-4f1a-a67f-15a151bef4ff","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"239841c6-cdd6-4f52-8527-76249dcf0731","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: 'e2658701-703d-4150-944c-3daba99cfbd3',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Máquina Safrapay ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'f0a8601f-5de1-4885-9b44-4f4a6e062c01',//MS.7.0.1\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5fa8b658-0682-4ef3-977f-7c2702d1ce6e","type":"Redirect","$title":"Redirect to {service} sending {lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cb95b0e0-482a-437b-82fd-977a8e226c9b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-67717ea0-f642-4921-8c9c-cea85c66691e","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"ebd69b85-ac8c-4129-afde-1f91a09c6ed0","root":false,"$title":"[Redirect] To Transacao Não Autorizada","$position":{"top":"385px","left":"2965px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b8f75e1a-844f-4de1-bacc-0756666f4f99":{"$contentActions":[{"action":{"$id":"9dfe15ed-4061-4979-b19d-eacddba5cb83","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f758c4c6-28c6-4ac1-9c0a-a6a4901da60a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f758c4c6-28c6-4ac1-9c0a-a6a4901da60a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:35259"},{"action":{"$id":"d08e2644-43c0-4299-9ef8-bc7978dc2d07","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f30789cb-d21b-4e3c-9d1c-839730d2f8c5","type":"text/plain","content":"{{msgOcorrencia}}","metadata":{}},"$cardContent":{"document":{"id":"f30789cb-d21b-4e3c-9d1c-839730d2f8c5","type":"text/plain","content":"{{msgOcorrencia}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:35260"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2477b43e-f239-42c8-bbed-232d5d532e72","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:35261"}],"$conditionOutputs":[{"stateId":"cf7b3798-16dc-4735-9c5f-d6a6fb24d52c","typeOfStateId":"state","$connId":"con_318","$id":"07f3d340-804d-4c61-b873-e2a22db26c2e","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:35281"}],"$invalid":false,"$$hashKey":"object:35267"}],"$enteringCustomActions":[{"$id":"fb4dfe2f-bd40-4121-8e66-48e542086c4c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada)\n\t\treturn `*Status*: ✔Encerrado\n\n${ocorrenciaEncontrada.descricaoMotivo} - ${ocorrenciaEncontrada.descricaoSubmotivo}\n*Protocolo*: ${ocorrenciaEncontrada.idProtocolo}.${ocorrenciaEncontrada.id}\n*Aberto em*: ${getDataFormatada(ocorrenciaEncontrada.dataHoraAbertura)}\n*Fechado em*: ${getDataFormatada(ocorrenciaEncontrada.dataHoraEncerramento)}\n\n${obsExiste(ocorrenciaEncontrada.motivoResolucao)}`\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\nfunction obsExiste(obs) {\n\tif (obs) {\n\t\treturn `*Observação*: ${obs}`\n\t}\n\telse\n\t\treturn '';\n}\n\nfunction getDataFormatada(data) {\n    let partes = data.split(/[-\\/]/); \n    let ano = parseInt(partes[0], 10);\n    let mes = parseInt(partes[1], 10) - 1; \n    let dia = parseInt(partes[2], 10);\n    let dataHora = new Date(ano, mes, dia);\n\n    let diaFormatado = (\"0\" + dataHora.getDate()).slice(-2);\n    let mesFormatado = (\"0\" + (dataHora.getMonth() + 1)).slice(-2);\n    let anoFormatado = dataHora.getFullYear();\n\n    return `${diaFormatado}/${mesFormatado}/${anoFormatado}`;\n}","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"msgOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ffc71c60-bce0-4443-add7-99c0d78624a9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-24245b98-136f-4209-bc04-698868011f45","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b8f75e1a-844f-4de1-bacc-0756666f4f99","root":false,"$title":"[S.2.2.2][MSG] Ocorrencia Encerrada","$position":{"top":"782px","left":"5895px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cea0a717-1eae-408f-948f-fc413d0c33bd":{"$contentActions":[{"action":{"$id":"6ee0a734-b070-430b-9324-15e4b5d2e119","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"124eae8e-7d62-498e-901f-f0043ddad5c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"124eae8e-7d62-498e-901f-f0043ddad5c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:34695"},{"action":{"$id":"63032d32-43ce-46d2-89d3-df18b8b56c5a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a7a6b601-71fd-4940-bfba-d8c2fa24bc2e","type":"text/plain","content":"{{msgOcorrencia}}","metadata":{}},"$cardContent":{"document":{"id":"a7a6b601-71fd-4940-bfba-d8c2fa24bc2e","type":"text/plain","content":"{{msgOcorrencia}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:34696"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ed1403fc-49a9-44a0-97d8-16cba5d08569","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:34697"}],"$conditionOutputs":[{"stateId":"5da6c41a-97cb-4e11-ac95-12981b4c8e97","typeOfStateId":"state","$connId":"con_323","$id":"4422ed4a-7f41-405c-8c62-f6aa12d13467","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:34717"}],"$invalid":false,"$$hashKey":"object:34703"}],"$enteringCustomActions":[{"$id":"ebf4d6ef-8f15-455c-a696-c72148ad6fcb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada)\n\n\t\treturn `*Status*: ${getStatus(ocorrenciaEncontrada.descricaoStatus)}\n\n${ocorrenciaEncontrada.descricaoMotivo} - ${ocorrenciaEncontrada.descricaoSubmotivo}\n*Protocolo*: ${ocorrenciaEncontrada.idProtocolo}.${ocorrenciaEncontrada.id}\n*Aberto em*: ${getDataFormatada(ocorrenciaEncontrada.dataHoraAbertura)}\n*Retorno previsto*: ${getDataFormatada(ocorrenciaEncontrada.dataPrevistaEncerramento)}`\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\nfunction getStatus(status) {\n    if (status == 'ABERTO') {\n        return \"⚠Em aberto\"\n    }\n    if (status == 'ENCERRADO') {\n        return \"✔Encerrado\"\n    } else {\n        return \"🔍Em análise\"\n    }\n}\nfunction getDataFormatada(data) {\n    let partes = data.split(/[-\\/]/); \n    let ano = parseInt(partes[0], 10);\n    let mes = parseInt(partes[1], 10) - 1; \n    let dia = parseInt(partes[2], 10);\n    let dataHora = new Date(ano, mes, dia);\n\n    let diaFormatado = (\"0\" + dataHora.getDate()).slice(-2);\n    let mesFormatado = (\"0\" + (dataHora.getMonth() + 1)).slice(-2);\n    let anoFormatado = dataHora.getFullYear();\n\n    return `${diaFormatado}/${mesFormatado}/${anoFormatado}`;\n}","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"msgOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dd897e6a-75f9-47b7-92d7-2092867747d6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-65b5d9ae-108c-47c5-b26e-00fca0f8591e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"cea0a717-1eae-408f-948f-fc413d0c33bd","root":false,"$title":"[S.2.2.3][MSG] Ocorrencia Em Andamento","$position":{"top":"731px","left":"6546.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3fa87362-bf43-45cc-a49f-ed7a51b8e58f":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"77ec3a55-1bb8-4edf-8135-e59b9b6ba2c2","typeOfStateId":"state","$connId":"con_328","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Consultar 60 dias\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Informar número\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = `Era este o protocolo que você precisava?\n\nPosso consultar também os protocolos dos últimos 60 dias ou então se tiver um número específico, é só informar aqui.\n\nSelecione uma das opções:`; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-84a6e4c4-fa49-46eb-9d74-c51cacb47d42","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-902411bc-2094-4b78-8def-c7e6c4afe781","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-677c3130-3c6d-47e5-ac63-5741b3fb6e78","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3fa87362-bf43-45cc-a49f-ed7a51b8e58f","root":false,"$title":"[S.2.2.4][MSG] Consultar Mais? (1 Ocorrencias)","$position":{"top":"1138px","left":"5639px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"77ec3a55-1bb8-4edf-8135-e59b9b6ba2c2":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b13f4a09-dcce-4272-9a48-16f69c8b3db7","typeOfStateId":"state","$connId":"con_333","$id":"8109f2f0-4c9e-494a-80c8-843b8855dd81","conditions":[{"source":"context","comparison":"equals","values":["Consultar 60 dias"],"variable":"userInput"}],"$invalid":false},{"stateId":"b813cfdd-674b-4f6b-82d9-4c036c04f45d","typeOfStateId":"state","$connId":"con_338","$id":"ce62b26c-c12f-468e-9375-1244a9dd2c57","conditions":[{"source":"context","comparison":"equals","values":["Informar número"],"variable":"userInput"}],"$invalid":false},{"stateId":"208abc39-52a5-4c49-bca6-0ff41be09e1b","typeOfStateId":"state","$connId":"con_343","$id":"40311f2f-2ad9-423b-97cf-a35e0db3af18","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e0f0692d-39c8-4026-aa53-abe8bd0d7a6a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-57ecf3f4-45bd-4238-8878-3012cec3b402","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-cba0328a-1bd6-4165-84bf-41d1994da144","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b6f35256-9c20-4b71-b997-c68863e86e32","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"77ec3a55-1bb8-4edf-8135-e59b9b6ba2c2","root":false,"$title":"[S.2.2.4][INPUT] Consultar Mais? (1 Ocorrencias)","$position":{"top":"1375.25px","left":"5638.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5da6c41a-97cb-4e11-ac95-12981b4c8e97":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"80a2253d-1530-4d86-a4bd-bcc0090ae7c6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"51a41959-7fdc-4fcc-ae99-8fc67f677ec6","typeOfStateId":"state","$connId":"con_348","$id":"ac480b65-9aa3-475a-bc8b-0c24c380fd73","conditions":[{"source":"context","comparison":"equals","values":["Fora do prazo"],"variable":"dentroDoPrazo"}],"$invalid":false},{"stateId":"bed597ba-629b-4bff-8ae4-9135b1c21da3","typeOfStateId":"state","$connId":"con_353","$id":"4289372f-41cc-4ad8-9335-ef3138e2dd59","conditions":[{"source":"context","comparison":"equals","values":["Dentro do prazo"],"variable":"dentroDoPrazo"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"dc0b9966-8bce-4205-965b-ae8e4773d486","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} validação","action":"{{numeroProtocolo}} | {{dentroDoPrazo}}"},"conditions":[]},{"$id":"49ddb0d3-31b5-4646-b3c0-a8a31ba36400","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dentroDoPrazo\"","$invalid":false,"settings":{"function":"run","source":"function run(ocorrenciaEncontrada) {\n    try {\n        ocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada);  \n        let dataAtual = new Date();\n        let itemAberto = ocorrenciaEncontrada;\n\n        if (itemAberto) {\n            let dataLimite = getDataFormatada(itemAberto.dataPrevistaEncerramento);\n            if (dataLimite < dataAtual) {\n                return `Fora do prazo`;\n            }\n        }\n        return `Dentro do prazo`;\n    }\n    catch (e) {\n        return e.message;\n    }\n}\nfunction getDataFormatada(data) {\n    let dataHoraInclusao = new Date(data);\n    return dataHoraInclusao;\n};","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"dentroDoPrazo","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a2d4de6d-016e-41d3-9dc2-9b63f738b661","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-13ff4696-504e-4c7b-a5f8-95549cccedfe","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"5da6c41a-97cb-4e11-ac95-12981b4c8e97","root":false,"$title":"[S.2.2.5][SET] Valida SLA","$position":{"top":"984px","left":"6546px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"51a41959-7fdc-4fcc-ae99-8fc67f677ec6":{"$contentActions":[{"action":{"$id":"fae01ff2-78d7-4a1c-803e-9705d922c71a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7b88248e-8508-4d17-8ec6-24313231a67e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7b88248e-8508-4d17-8ec6-24313231a67e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e216291e-531e-4195-946c-441699fc3a34","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2aa81b5c-808a-4ae9-bba2-78d8338b6439","type":"text/plain","content":"Vi aqui que o prazo para dar um retorno já passou. Já acionei nosso time e estamos fazendo o possível para resolver o quanto antes.","metadata":{}},"$cardContent":{"document":{"id":"2aa81b5c-808a-4ae9-bba2-78d8338b6439","type":"text/plain","content":"Vi aqui que o prazo para dar um retorno já passou. Já acionei nosso time e estamos fazendo o possível para resolver o quanto antes."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1b46fdb-e03a-4cdc-9f02-8b9fa489f6f4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d84bfa10-7d79-4375-af80-86eac63229a8","typeOfStateId":"state","$connId":"con_358","$id":"70ecf102-12cc-495c-8ab1-4c0a196b5766","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6548ab5a-027b-49cc-857a-3b4bbac94441","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibicao"},"conditions":[]},{"$id":"a87e3fb6-8488-49cf-a62a-56a32613436f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"requestComentarioOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(contaSelecionada) {\n\ttry {\n\t\tlet obj = JSON.parse(contaSelecionada);\n\t\treturn {\n\t\t\t\"idUsuario\": obj.usuario,\n\t\t\t\"nomeUsuario\": obj.nomeCompleto,\n\t\t\t\"origemAberturaOcorrencia\": \"SUSTENTACAO PJ\",\n\t\t\t\"comentario\": `Registro via chatbot WhatsApp PJ - O usuário ${obj.nomeCompleto}, portador do CNPJ: ${obj.doc}, solicita urgência no atendimento de sua demanda. O prazo máximo para a resolução já foi atingido, e sua situação requer atenção imediata.`\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\n","inputVariables":["contaSelecionada"],"outputVariable":"requestComentarioOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b0e7d724-774a-40a1-ac05-bf3da939c9b8","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP POST \"bodyComentarioOcorrencia\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}","Safra-Aplicacao":"CHT","Safra-Correlation-ID":"{{idSessao}}"},"uri":"{{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/protocolos/{{ocorrenciaEncontrada@idProtocolo}}/ocorrencias/{{ocorrenciaEncontrada@id}}/historicos","method":"POST","responseStatusVariable":"statusComentarioOcorrencia","responseBodyVariable":"bodyComentarioOcorrencia","body":"{{requestComentarioOcorrencia}}"},"conditions":[]},{"$id":"2e659540-d7a4-443c-b0cb-09ff9682176a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusComentarioOcorrencia"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"87c8fa21-90d7-4ea3-bfa9-487092daefd3","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/protocolos/{{numeroProtocolo}}/ocorrencias/{{idUltimaOcorrencia}}/historicos | POST | {{statusComentarioOcorrencia}} | {{bodyComentarioOcorrencia}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-d1198500-50e5-41a0-8445-a5f87f53429f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-41976ca2-ccc2-41d7-b4ad-8989609eb6e4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f79ff6b5-bfff-446a-8786-c1462db5d1a8","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-5e54df95-d7f1-4859-8484-7317f915715a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"51a41959-7fdc-4fcc-ae99-8fc67f677ec6","root":false,"$title":"[S.2.2.6][MSG][HTTP]Protocolo fora do Prazo","$position":{"top":"1181.43px","left":"6426.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"bed597ba-629b-4bff-8ae4-9135b1c21da3":{"$contentActions":[{"action":{"$id":"13d18022-762f-4806-ba88-f201a115da0b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fd821cfb-121e-42e6-9ae7-e92f92ad123e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fd821cfb-121e-42e6-9ae7-e92f92ad123e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b85ed1ed-64c1-4100-a727-efe77413443a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"6ca88c3d-9a7f-435c-b01c-e86be2bd31b1","type":"text/plain","content":"Por aqui, estou trabalhando para te dar um retorno o quanto antes, e isso pode ocorrer até às 23:59 da data prevista.","metadata":{}},"$cardContent":{"document":{"id":"6ca88c3d-9a7f-435c-b01c-e86be2bd31b1","type":"text/plain","content":"Por aqui, estou trabalhando para te dar um retorno o quanto antes, e isso pode ocorrer até às 23:59 da data prevista."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"97c334c5-7414-4c06-885d-ad54444c8a0b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d84bfa10-7d79-4375-af80-86eac63229a8","typeOfStateId":"state","$connId":"con_363","$id":"a319b6a0-0957-40d4-ba1c-8c49ad71e255","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f8b950a0-c49f-4707-a9ee-c55033b39474","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bed597ba-629b-4bff-8ae4-9135b1c21da3","root":false,"$title":"[S.2.2.7][MSG] Dentro do Prazo","$position":{"top":"1187.43px","left":"6678.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d84bfa10-7d79-4375-af80-86eac63229a8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6db7aa2-0222-4b55-a0c5-5498d09dc5a7","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"d84bfa10-7d79-4375-af80-86eac63229a8","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"1434.43px","left":"6536.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"24f3ed8d-b58f-4387-9361-b21679366958":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9d6ba1ae-d71a-41d3-9a57-fc9cc38d90bf","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:35434"}],"$conditionOutputs":[{"stateId":"b8f75e1a-844f-4de1-bacc-0756666f4f99","typeOfStateId":"state","$connId":"con_368","$id":"eecef03a-cfc5-4f3f-a5c8-5971e35f482f","conditions":[{"source":"context","comparison":"equals","values":["ENCERRADO"],"variable":"ocorrenciaEncontrada@descricaoStatus","$$hashKey":"object:35454"}],"$invalid":false,"$$hashKey":"object:35436"},{"stateId":"cea0a717-1eae-408f-948f-fc413d0c33bd","typeOfStateId":"state","$connId":"con_373","$id":"033b187e-cecd-40ef-a5b4-ce63a156cd38","conditions":[{"source":"context","comparison":"notEquals","values":["ENCERRADO"],"variable":"ocorrenciaEncontrada@descricaoStatus","$$hashKey":"object:35470"}],"$invalid":false,"$$hashKey":"object:35437"}],"$enteringCustomActions":[{"$id":"02d33333-0135-41b9-b32e-2b117a6e07c5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciaEncontrada\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaOcorrenciaLista) {\n    try {\n        let data = JSON.parse(bodyConsultaOcorrenciaLista).data;\n        return data[0];\n    }\n    catch (e) {\n        return e.message;\n    }\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"ocorrenciaEncontrada","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-85e0fb58-3f17-467b-a904-ce1a9bc100ae","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"24f3ed8d-b58f-4387-9361-b21679366958","root":false,"$title":"[S.2.2.1.1][SET] Status da Ocorrencia","$position":{"top":"592px","left":"6118.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b370502b-e1bf-4c50-a4f1-39f401c3ba9a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8f19c9d7-dfe4-440f-b045-9ccf70498687","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"24f3ed8d-b58f-4387-9361-b21679366958","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"b370502b-e1bf-4c50-a4f1-39f401c3ba9a","root":false,"$title":"[GO TO] [S.2.2.1.1][SET] Status da Ocorrencia","$position":{"top":"1100.33px","left":"7310.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cf7b3798-16dc-4735-9c5f-d6a6fb24d52c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2477b43e-f239-42c8-bbed-232d5d532e72","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3fa87362-bf43-45cc-a49f-ed7a51b8e58f","typeOfStateId":"state","$connId":"con_378","$id":"07f3d340-804d-4c61-b873-e2a22db26c2e","conditions":[{"source":"context","comparison":"equals","values":["UM"],"variable":"numeroDeOcorrencias"}],"$invalid":false},{"stateId":"bdd88035-84e9-4158-bf83-76ae9a17b5c3","typeOfStateId":"state","$connId":"con_383","$id":"855b41fc-402c-48a8-8257-e4fd0b855374","conditions":[{"source":"context","comparison":"notEquals","values":["UM"],"variable":"numeroDeOcorrencias"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fb4dfe2f-bd40-4121-8e66-48e542086c4c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada)\n\t\treturn `*Status*: ✔${ocorrenciaEncontrada.descricaoStatus}}\n\n${ocorrenciaEncontrada.descricaoMotivo} - ${ocorrenciaEncontrada.descricaoSubmotivo}\n*Protocolo*: ${ocorrenciaEncontrada.idProtocolo}.${ocorrenciaEncontrada.id}\n*Aberto em*: ${ocorrenciaEncontrada.dataHoraAbertura}\n*Fechado em*: ${ocorrenciaEncontrada.dataHoraEncerramento}\n\n${obsExiste(ocorrenciaEncontrada.motivoResolucao)}`\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\nfunction obsExiste(obs) {\n\tif (obs) {\n\t\treturn `*Observação*: ${obs}`\n\t}\n\telse\n\t\treturn '';\n}","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"msgOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e3d3c5db-f58c-44e6-b05a-1667b0995cb7","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"cf7b3798-16dc-4735-9c5f-d6a6fb24d52c","root":false,"$title":"[S.2.2.2.2][SET] Quantidade de ocorrencia","$position":{"top":"968.857px","left":"5894px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bdd88035-84e9-4158-bf83-76ae9a17b5c3":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c154973d-aa74-4d66-be83-26620674ac23","typeOfStateId":"state","$connId":"con_388","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Consultar 60 dias\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Informar número\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = `Era este o protocolo que você precisava?\n\nPosso consultar também os protocolos dos últimos 60 dias ou então se tiver um número específico, é só informar aqui.\n\nSelecione uma das opções:`; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-881e8117-2261-4aa1-a379-f1635545a25d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-311cddc2-9445-4b2f-9652-467f59328158","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e299d51a-0b66-45a2-b516-7e5cfeac9585","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bdd88035-84e9-4158-bf83-76ae9a17b5c3","root":false,"$title":"[S.2.2.7][MSG] Consultar Mais? (+ Ocorrencias)","$position":{"top":"1167.5px","left":"6085.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c154973d-aa74-4d66-be83-26620674ac23":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6782f8e2-b0f2-47ab-8d2e-9c72eb6940a5","typeOfStateId":"state","$connId":"con_393","$id":"b7b46bbd-a7fa-4c42-879d-5f3288b4edef","conditions":[{"source":"context","comparison":"equals","values":["Ver opções novamente"],"variable":"userInput"}],"$invalid":false},{"stateId":"b13f4a09-dcce-4272-9a48-16f69c8b3db7","typeOfStateId":"state","$connId":"con_398","$id":"e72ab1ae-f6a0-4131-834d-21eaf1bf46cc","conditions":[{"source":"context","comparison":"equals","values":["Consultar 60 dias"],"variable":"userInput"}],"$invalid":false},{"stateId":"b813cfdd-674b-4f6b-82d9-4c036c04f45d","typeOfStateId":"state","$connId":"con_403","$id":"4450d719-e5cb-4d3f-9bb9-8979f48aee70","conditions":[{"source":"context","comparison":"equals","values":["Informar número"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a96de0f1-52ce-41be-933c-171f0de93bea","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-400a4d2c-1d21-42aa-83e9-5747a4b7470b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-d6eb9694-eff7-407f-ab0d-16fc398776d6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b690c197-b937-4abe-83ca-c4ddfb5b5d22","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"c154973d-aa74-4d66-be83-26620674ac23","root":false,"$title":"[S.2.2.7][INPUT] Consultar Mais?  (+ Ocorrencias)","$position":{"top":"1370px","left":"6084.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7b60ebcd-d719-48fc-b7de-d4d3e0774e1c":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c7786c74-a114-4419-9c16-ddf9441827d4","typeOfStateId":"state","$connId":"con_408","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Consultar 60 dias\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Informar número\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = `Entendi que você não encontrou o protocolo.\n\nPosso consultar também os protocolos dos últimos 60 dias ou então se você tiver o número específico, é só informar aqui,`; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fb483f11-0cbe-42c1-9c66-785287131a18","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0d975789-db9f-428a-b3c5-6ef08b10b277","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-814852e7-89ab-4532-b9b3-6d22f4a72e7c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7b60ebcd-d719-48fc-b7de-d4d3e0774e1c","root":false,"$title":"[S.2.4.1][MSG] Não encontrei o protocolo","$position":{"top":"1195.29px","left":"7066.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c7786c74-a114-4419-9c16-ddf9441827d4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"20f8349e-19b6-4b1b-a83b-b16925671a32","typeOfStateId":"state","$connId":"con_413","$id":"cb511aa0-66b0-4987-b333-6301c6428ede","conditions":[{"source":"context","comparison":"equals","values":["Consultar 60 dias"],"variable":"userInput"}],"$invalid":false},{"stateId":"6d78d9f9-c648-4768-a4da-254606bad9e9","typeOfStateId":"state","$connId":"con_418","$id":"180780cc-9cda-40f0-ae70-68a51a3075db","conditions":[{"source":"context","comparison":"equals","values":["Informar número"],"variable":"userInput"}],"$invalid":false},{"stateId":"35f56c8b-ee11-4cec-8af7-19d8a2923524","typeOfStateId":"state","$connId":"con_423","$id":"af7ebdb5-5d19-4f54-9414-7d9244b1a301","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c11afc71-2796-477b-896e-2b32ae3a18e2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4f22d88a-db28-4038-ad1b-4815034dc436","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-bbbc7742-79c8-4718-a381-d89c0caf8cc1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a7b890d8-c6b1-47fb-b2ab-991e42752471","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"c7786c74-a114-4419-9c16-ddf9441827d4","root":false,"$title":"[S.2.4.1][INPUT] Não encontrei o protocolo","$position":{"top":"1527.29px","left":"7066.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"20f8349e-19b6-4b1b-a83b-b16925671a32":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2dcb179d-c0df-419f-9d6f-cd3bf916613f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1e1a9840-12e2-48e2-9d7a-a957dcfed181","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"20f8349e-19b6-4b1b-a83b-b16925671a32","root":false,"$title":"[GO TO] [S.2.7.0] [HTTP] Consulta Ocorrencias (60)","$position":{"top":"1790.29px","left":"7392.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6d78d9f9-c648-4768-a4da-254606bad9e9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"1347e9b7-7b4c-4cdb-bee2-72392190d012","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"6d78d9f9-c648-4768-a4da-254606bad9e9","root":false,"$title":"[GO TO][S.2.6.0][MSG] Consulta Protocolo Númerica","$position":{"top":"1780px","left":"7066px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"35f56c8b-ee11-4cec-8af7-19d8a2923524":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c4631998-71ca-45cd-90bc-95149e7f8af0","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"35f56c8b-ee11-4cec-8af7-19d8a2923524","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"1785.29px","left":"6740.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b13f4a09-dcce-4272-9a48-16f69c8b3db7":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d84314f2-d464-4acd-83a8-d0189286de1f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1e1a9840-12e2-48e2-9d7a-a957dcfed181","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"b13f4a09-dcce-4272-9a48-16f69c8b3db7","root":false,"$title":"[GO TO] [S.2.7.0] [HTTP] Consulta Ocorrencias (60)","$position":{"top":"2062.33px","left":"5868.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b813cfdd-674b-4f6b-82d9-4c036c04f45d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ae15ca15-5edf-4c65-8a8d-ecf5ecb96fd2","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"b813cfdd-674b-4f6b-82d9-4c036c04f45d","root":false,"$title":"[GO TO][S.2.6.0][MSG] Consulta Protocolo Númerica","$position":{"top":"1620.86px","left":"5880.71px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"208abc39-52a5-4c49-bca6-0ff41be09e1b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"91fd6d8a-6980-4e0c-863c-7e814800fb5f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"208abc39-52a5-4c49-bca6-0ff41be09e1b","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"1633px","left":"5507.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6782f8e2-b0f2-47ab-8d2e-9c72eb6940a5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9431fae3-5cad-41ed-9d56-b6e3cf809122","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ed2a5fb2-da6f-4961-b14d-e302fa57b991","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"6782f8e2-b0f2-47ab-8d2e-9c72eb6940a5","root":false,"$title":"[GO TO] [S.2.4.0][MSG] Menu Lista de Ocorrencias","$position":{"top":"1650.67px","left":"6217.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c192ff0b-f855-4c5e-b70f-991686d31f91":{"$contentActions":[{"action":{"$id":"ffd278b3-bcdb-4346-9e08-abfb5a0b0457","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5563f456-d911-4ae9-93b7-a52ea9327a76","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5563f456-d911-4ae9-93b7-a52ea9327a76","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"72a4f543-a6a1-4f9a-a65e-d385220bb628","$typeOfContent":"text","type":"SendMessage","settings":{"id":"22c557b4-dbe5-4741-ba35-8fed2a46c0af","type":"text/plain","content":"Aguarde só um momento, estou consultando as informações dele.","metadata":{}},"$cardContent":{"document":{"id":"22c557b4-dbe5-4741-ba35-8fed2a46c0af","type":"text/plain","content":"Aguarde só um momento, estou consultando as informações dele."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"09491573-193d-4807-87e5-4c02db01b07c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e4d6612a-10e4-46cb-bb7a-fee228cb3415","typeOfStateId":"state","$connId":"con_428","$id":"816ea16f-488e-4219-9b42-c96c99388294","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-64bffa73-3bc7-4ac8-b6d0-ac8362f80118","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c192ff0b-f855-4c5e-b70f-991686d31f91","root":false,"$title":"[S.2.6.0][MSG] Aguarde um momento","$position":{"top":"631px","left":"4331.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"50271819-701d-4321-9f69-1d3524b3dc4a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9773dbdb-c4a4-422a-a0a9-bd1f47189bcd","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:36180"}],"$conditionOutputs":[{"stateId":"b20fb076-c6ef-4428-aa0d-84347f64c134","typeOfStateId":"state","$connId":"con_433","$id":"583db181-8751-48e3-ae06-352f76efa6b5","conditions":[{"source":"context","comparison":"equals","values":["ZERO"],"variable":"numeroDeOcorrencias","$$hashKey":"object:36202"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus","$$hashKey":"object:36203"}],"$invalid":false,"$$hashKey":"object:36182"},{"stateId":"953ef71d-0751-4132-8abf-d93e9796d017","typeOfStateId":"state","$connId":"con_438","$id":"2980b334-72d8-4d37-8212-ef2d5c6bea5a","conditions":[{"source":"context","comparison":"equals","values":["UM"],"variable":"numeroDeOcorrencias","$$hashKey":"object:36231"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus","$$hashKey":"object:36232"}],"$invalid":false,"$$hashKey":"object:36183"},{"stateId":"ed2a5fb2-da6f-4961-b14d-e302fa57b991","typeOfStateId":"state","$connId":"con_443","$id":"9204d041-1b22-4a0f-965f-b23dd7c74c65","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus","$$hashKey":"object:36258"},{"values":["2"],"source":"context","comparison":"greaterThanOrEquals","variable":"numeroDeOcorrencias","$$hashKey":"object:36259"}],"$invalid":false,"$$hashKey":"object:36184"}],"$enteringCustomActions":[{"$id":"47813d4f-dcea-4290-9394-935e11346710","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroDeOcorrencias\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(bodyConsultaOcorrenciaLista) {\n\ttry {\n\t\tlet ocorrencias = JSON.parse(bodyConsultaOcorrenciaLista).data;\n\t\tlet numInt = ocorrencias.length;\n\t\tif (numInt == 0) {\n\t\t\treturn \"ZERO\"\n\t\t}\n\t\tif (numInt == 1) {\n\t\t\treturn \"UM\"\n\t\t}\n\t\telse {\n\t\t\treturn numInt;\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"numeroDeOcorrencias","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d942601f-c87a-4c4b-9805-8ff27dc32082","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"50271819-701d-4321-9f69-1d3524b3dc4a","root":false,"$title":"[S.2.1.1][SET] Quantidade de Ocorrencias?","$position":{"top":"350.714px","left":"6528.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"951b3eb5-7c14-4eb9-8b46-0b909846398b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9773dbdb-c4a4-422a-a0a9-bd1f47189bcd","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"635bebe1-1780-40bc-9069-2292fe9d29c4","typeOfStateId":"state","$connId":"con_448","$id":"583db181-8751-48e3-ae06-352f76efa6b5","conditions":[{"source":"context","comparison":"equals","values":["ZERO"],"variable":"numeroDeOcorrencias"}],"$invalid":false},{"stateId":"0c32b967-ca59-4e42-8cd3-f9681597ca8f","typeOfStateId":"state","$connId":"con_453","$id":"2980b334-72d8-4d37-8212-ef2d5c6bea5a","conditions":[{"source":"context","comparison":"equals","values":["UM"],"variable":"numeroDeOcorrencias"}],"$invalid":false},{"stateId":"17076c47-4726-49c5-b63f-eec49c4be9d9","typeOfStateId":"state","$connId":"con_458","$id":"9204d041-1b22-4a0f-965f-b23dd7c74c65","conditions":[{"values":["2"],"source":"context","comparison":"greaterThanOrEquals","variable":"numeroDeOcorrencias"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"47813d4f-dcea-4290-9394-935e11346710","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroDeOcorrencias\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(bodyConsultaOcorrenciaLista) {\n\ttry {\n\t\tlet ocorrencias = JSON.parse(bodyConsultaOcorrenciaLista).data;\n\t\tlet numInt = ocorrencias.length;\n\t\tif (numInt == 0) {\n\t\t\treturn \"ZERO\"\n\t\t}\n\t\tif (numInt == 1) {\n\t\t\treturn \"UM\"\n\t\t}\n\t\telse {\n\t\t\treturn numInt;\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"numeroDeProtocolos","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4b4ee900-1b79-49e3-ac1b-15a98d40543e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"951b3eb5-7c14-4eb9-8b46-0b909846398b","root":false,"$title":"[S.2.0.2][SET] Quantidade de Ocorrencias?","$position":{"top":"1217.57px","left":"4331.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0c32b967-ca59-4e42-8cd3-f9681597ca8f":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"dc1b2d41-452b-46ab-9331-4edc7ae553aa","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"24f3ed8d-b58f-4387-9361-b21679366958","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"0c32b967-ca59-4e42-8cd3-f9681597ca8f","root":false,"$title":"[GO TO] [S.2.2.1.1][SET] Status da Ocorrencia","$position":{"top":"1553.57px","left":"4226.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"17076c47-4726-49c5-b63f-eec49c4be9d9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2d19da6a-a4e4-406a-bc91-774b1ececa09","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"2f9e7f20-742c-48d2-901d-373375d47540","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"17076c47-4726-49c5-b63f-eec49c4be9d9","root":false,"$title":"[GO TO] [S.2.4.0.1][MSG] Menu Lista de Ocorrencias","$position":{"top":"1551.33px","left":"4454.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1e1a9840-12e2-48e2-9d7a-a957dcfed181":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9773dbdb-c4a4-422a-a0a9-bd1f47189bcd","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:36832"}],"$conditionOutputs":[{"stateId":"db3e0233-6506-41f8-84fa-9fdf9a88e799","typeOfStateId":"state","$connId":"con_463","$id":"583db181-8751-48e3-ae06-352f76efa6b5","conditions":[{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus","$$hashKey":"object:36848"}],"$invalid":false,"$$hashKey":"object:36834"}],"$enteringCustomActions":[{"$id":"4d2b0312-2061-44d3-af22-25d4a301fd5d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"intervaloDeDatas\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n    const hoje = new Date();\n    const DiasAtras = new Date();\n    DiasAtras.setDate(hoje.getDate() - 60);//Ultimos 60 dias\n    const formatarData = (data) => {\n        const ano = data.getFullYear();\n        const mes = String(data.getMonth() + 1).padStart(2, '0');\n        const dia = String(data.getDate()).padStart(2, '0');\n        return `${ano}-${mes}-${dia}`;\n    };\n    const periodo = `periodo.gte=${formatarData(DiasAtras)}&periodo.lte=${formatarData(hoje)}`;\n    return periodo;\n}","inputVariables":[],"outputVariable":"intervaloDeDatas","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3ad17416-61f6-48ac-8c59-a73b7e211917","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyConsultaProtocoloLista\" (Consultar Protocolo Lista)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}","Safra-Correlation-ID":"{{idSessao}}","Safra-Aplicacao":"CHT"},"uri":"{{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/ocorrencias?documentoCliente={{contaSelecionada@doc}}&{{intervaloDeDatas}}","method":"GET","responseStatusVariable":"statusConsultaOcorrenciaLista","responseBodyVariable":"bodyConsultaOcorrenciaLista"},"conditions":[]},{"$id":"74af7a6f-7d3b-4346-8fda-c2e04239aec6","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusConsultaOcorrenciaLista"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"68608304-18ff-40c1-b1a6-c9e306e2a544","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/ocorrencias?documentoCliente={{contaSelecionada@doc}}&{{intervaloDeDatas}} | GET | {{statusConsultaProtocoloLista}} | {{bodyConsultaProtocoloLista}}"},"conditions":[]},{"$id":"daae12b4-a4ef-4b02-ac88-5551d7406d4b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{apiStatus}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"apiStatus"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-43e6b6d0-008b-48d1-a6b2-258a6dce23d9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bd828df0-b417-4c49-bdcd-f1af9c9b6359","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-beacfa8c-3803-485f-80aa-483563266e15","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"1e1a9840-12e2-48e2-9d7a-a957dcfed181","root":false,"$title":"[S.2.7.0] [HTTP] Consulta Ocorrencias (60 Dias)","$position":{"top":"434.333px","left":"9281.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"db3e0233-6506-41f8-84fa-9fdf9a88e799":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9773dbdb-c4a4-422a-a0a9-bd1f47189bcd","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a7e3a216-305d-44a8-9b77-12a033d47ca1","typeOfStateId":"state","$connId":"con_468","$id":"583db181-8751-48e3-ae06-352f76efa6b5","conditions":[{"source":"context","comparison":"equals","values":["ZERO"],"variable":"numeroDeOcorrencias"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"75347694-6b2e-4ad9-8154-4db70e6385be","typeOfStateId":"state","$connId":"con_473","$id":"2980b334-72d8-4d37-8212-ef2d5c6bea5a","conditions":[{"source":"context","comparison":"equals","values":["UM"],"variable":"numeroDeOcorrencias"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"afaddf71-ba7c-4292-bd62-84f094c25c3f","typeOfStateId":"state","$connId":"con_478","$id":"9204d041-1b22-4a0f-965f-b23dd7c74c65","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"},{"values":["2"],"source":"context","comparison":"greaterThanOrEquals","variable":"numeroDeOcorrencias"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"47813d4f-dcea-4290-9394-935e11346710","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroDeOcorrencias\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(bodyConsultaOcorrenciaLista) {\n\ttry {\n\t\tlet ocorrencias = JSON.parse(bodyConsultaOcorrenciaLista).data;\n\t\tlet numInt = ocorrencias.length;\n\t\tif (numInt == 0) {\n\t\t\treturn \"ZERO\"\n\t\t}\n\t\tif (numInt == 1) {\n\t\t\treturn \"UM\"\n\t\t}\n\t\telse {\n\t\t\treturn numInt;\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"numeroDeOcorrencias","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"44c346c4-2d0e-41e0-aa1e-63da89563f8c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-598cadac-f809-4dd8-b18d-8d8c3ac24cd2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"db3e0233-6506-41f8-84fa-9fdf9a88e799","root":false,"$title":"[S.2.7.1][SET] Quantidade de Ocorrencias?","$position":{"top":"719.333px","left":"9281.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a7e3a216-305d-44a8-9b77-12a033d47ca1":{"$contentActions":[{"action":{"$id":"be8d165c-339f-41aa-9862-323eac1b4bee","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e4e14dc8-273d-472e-aab5-a01595489bc6","type":"text/plain","content":"Não encontrei nenhum protocolo nos últimos 60 dias. Se precisar consultar acima deste período, é só falar com a central de atendimento:\n\nCapital e Grande São paulo:\n(11) 3175-8248\n\nDemais localidades:\n0300 015 7575","metadata":{}},"$cardContent":{"document":{"id":"e4e14dc8-273d-472e-aab5-a01595489bc6","type":"text/plain","content":"Não encontrei nenhum protocolo nos últimos 60 dias. Se precisar consultar acima deste período, é só falar com a central de atendimento:\n\nCapital e Grande São paulo:\n(11) 3175-8248\n\nDemais localidades:\n0300 015 7575"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"action":{"$id":"a5d08b2a-b09d-4c6c-a933-d4799f4f5a4a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d7b48284-de14-44b3-b897-d44ea8da822a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d7b48284-de14-44b3-b897-d44ea8da822a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"bdb96c32-f606-4787-8286-8b2bf8e82366","typeOfStateId":"state","$connId":"con_483","$id":"7656f80c-1054-4653-bf8d-4f83cad382b5","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Informar número\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = \"Você gostaria de consultar outro protocolo?\"; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dcbc6c9d-ccd2-436f-8a1f-fd744c4100cc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cc5ff6aa-5238-4c8b-b0ca-c20056d17345","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1e63b4af-45ec-421a-92f8-5c22c3c4e978","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a7e3a216-305d-44a8-9b77-12a033d47ca1","root":false,"$title":"[S.2.7.2][MSG] Nenhum Protocolo","$position":{"top":"830.333px","left":"9740.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"75347694-6b2e-4ad9-8154-4db70e6385be":{"$contentActions":[{"action":{"$id":"41e88d1d-5eb3-4d58-afc3-790f0774283c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"51676aef-8b24-4bde-97ab-de677f016eeb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"51676aef-8b24-4bde-97ab-de677f016eeb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6204a6c1-eb31-4c64-b33c-31f8525d5f4b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9f2a4b4c-d38f-4459-8366-f0c96d6ff1a3","type":"text/plain","content":"Nos últimos 60 dias encontrei este protocolo.\n\nVou te mostrar o status dele.","metadata":{}},"$cardContent":{"document":{"id":"9f2a4b4c-d38f-4459-8366-f0c96d6ff1a3","type":"text/plain","content":"Nos últimos 60 dias encontrei este protocolo.\n\nVou te mostrar o status dele."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"9d6ba1ae-d71a-41d3-9a57-fc9cc38d90bf","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"425a0975-5ebc-4885-bc03-71fb3126b93e","typeOfStateId":"state","$connId":"con_488","$id":"b563a935-fe00-4b9b-9943-e56f7d15cf2b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"02d33333-0135-41b9-b32e-2b117a6e07c5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciaEncontrada\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaOcorrenciaLista) {\n    try {\n        let data = JSON.parse(bodyConsultaOcorrenciaLista).data;\n        return data[0];\n    }\n    catch (e) {\n        return e.message;\n    }\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"ocorrenciaEncontrada","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e4b2401c-29e7-4b59-afc6-09e7b377dc66","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-853a4332-782c-46c5-8139-67b038a8c013","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"75347694-6b2e-4ad9-8154-4db70e6385be","root":false,"$title":"[S.2.7.3][MSG]Um Protocolo Encontrado","$position":{"top":"882px","left":"8218px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2f9e7f20-742c-48d2-901d-373375d47540":{"$contentActions":[{"action":{"$id":"ec36bddf-845f-4420-b691-66f0faaca720","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1656ae3d-ba81-48cd-bf9b-48c2d0c017e4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1656ae3d-ba81-48cd-bf9b-48c2d0c017e4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:35825"},{"action":{"$id":"5018e172-a94f-4630-8fbb-89ba1c22bbed","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9fbb2f01-c5d1-44f5-9ffe-791a452ef0b5","type":"text/plain","content":"{{msgOcorrencias}}","metadata":{}},"$cardContent":{"document":{"id":"9fbb2f01-c5d1-44f5-9ffe-791a452ef0b5","type":"text/plain","content":"{{msgOcorrencias}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:35826"},{"action":{"$id":"08c61e2c-d15f-42e3-8102-ebb442760d36","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:35827"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:35828"}],"$conditionOutputs":[{"stateId":"2277261f-1fd3-4041-ad2a-494985ee2067","typeOfStateId":"state","$connId":"con_493","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:35850"}],"$invalid":false,"$$hashKey":"object:35836"}],"$enteringCustomActions":[{"$id":"332c9be0-4499-4ada-a446-f2b148243d00","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciasEncontradas\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaOcorrenciaLista) {\n    try {\n        let data = JSON.parse(bodyConsultaOcorrenciaLista).data;\n        return data;\n    }\n    catch (e) {\n        return e.message;\n    }\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"ocorrenciasEncontradas","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"79114b61-ccff-4813-b7a9-f9f04043211c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencias\"","$invalid":false,"settings":{"function":"run","source":"function run(ocorrenciasEncontradas) {\n    try {\n        ocorrenciasEncontradas = JSON.parse(ocorrenciasEncontradas);\n        let msg = \"De qual protocolo você quer ver mais detalhes? É só informar o número da opção, exemplo: *4*.\\n\";\n        for (let index = 0; index < ocorrenciasEncontradas.length; index++) {\n            msg += `\\n*${index + 1}*- ${ocorrenciasEncontradas[index].descricaoMotivo} - ${ocorrenciasEncontradas[index].descricaoSubmotivo}\nStatus: ${getStatus(ocorrenciasEncontradas[index].descricaoStatus)}\\n`;\n        }\n        msg += \"\\n*0*- Não encontrei o protocolo\"\n        return msg;\n    }\n    catch (e) {\n        return e.message;\n    }\n}\nfunction getStatus(status) {\n    if (status == 'ABERTO') {\n        return \"⚠ Em aberto\"\n    }\n    if (status == 'ENCERRADO') {\n        return \"✔ Encerrado\"\n    } else {\n        return \"🔍 Em análise\"\n    }\n}\nfunction getDataFormatada(data) {\n    let dataHoraInclusao = new Date(data);\n    let dia = (\"0\" + dataHoraInclusao.getDate()).slice(-2);\n    let mes = (\"0\" + (dataHoraInclusao.getMonth() + 1)).slice(-2);\n    let ano = dataHoraInclusao.getFullYear();\n    return `${dia}/${mes}/${ano}`;\n};","inputVariables":["ocorrenciasEncontradas"],"outputVariable":"msgOcorrencias","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-01143bf1-ac24-40cb-a411-c358a16e08e3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c35a4244-be1e-4f9f-ac8f-5476c963bba7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2f9e7f20-742c-48d2-901d-373375d47540","root":false,"$title":"[S.2.4.0.1][MSG] Menu Lista de Ocorrencias","$position":{"top":"762.333px","left":"7069px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bdb96c32-f606-4787-8286-8b2bf8e82366":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e24c7f95-43c3-4696-88c5-59a276026c33","typeOfStateId":"state","$connId":"con_498","$id":"98d1c851-3cf7-4df3-a47c-2d9423783007","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false},{"stateId":"e0f75aea-a61d-40d9-8667-71f6d13835a1","typeOfStateId":"state","$connId":"con_503","$id":"178169cc-d0f1-45d3-a43c-3db31af2a3b3","conditions":[{"source":"context","comparison":"equals","values":["Informar número"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ad9ecf77-7f4b-4f98-b092-85f3f1feb86b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6191f2cc-21f3-4892-8e55-a57fe49e5918","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ccea548e-655d-47fd-9c2f-dbbfe1e1025f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ee7cc88e-d51d-46d0-a9f2-107ca46d7ee2","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"bdb96c32-f606-4787-8286-8b2bf8e82366","root":false,"$title":"[S.2.7.2][INPUT] Nenhum Protocolo","$position":{"top":"1098.33px","left":"9738.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e24c7f95-43c3-4696-88c5-59a276026c33":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ae188bc8-2f91-48d4-aca2-47e42e3a1abe","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e24c7f95-43c3-4696-88c5-59a276026c33","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"1335.33px","left":"9590.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e0f75aea-a61d-40d9-8667-71f6d13835a1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8509510f-8aee-4e76-8977-dd641a745b2c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e0f75aea-a61d-40d9-8667-71f6d13835a1","root":false,"$title":"[GO TO][S.2.6.0][MSG] Consulta Protocolo Númerica","$position":{"top":"1353.33px","left":"9938.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"afaddf71-ba7c-4292-bd62-84f094c25c3f":{"$contentActions":[{"action":{"$id":"278eb460-650c-4071-ba4d-52fa49ea806c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fa378076-abf8-4f07-ba26-e248bab7588a","type":"text/plain","content":"Nos últimos 60 dias encontrei <b>{{numeroDeOcorrencias}}</b> protocolos.","metadata":{}},"$cardContent":{"document":{"id":"fa378076-abf8-4f07-ba26-e248bab7588a","type":"text/plain","content":"Nos últimos 60 dias encontrei <b>{{numeroDeOcorrencias}}</b> protocolos."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"08c61e2c-d15f-42e3-8102-ebb442760d36","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3bf351da-2cbf-4efd-82b1-7c9ab791a63a","typeOfStateId":"state","$connId":"con_508","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c5869cdc-0e19-4daa-9816-4bea7d3b41dc","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"afaddf71-ba7c-4292-bd62-84f094c25c3f","root":false,"$title":"[S.2.7.3][MSG] Ocorrencias Encontradas","$position":{"top":"988.333px","left":"9281.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3bf351da-2cbf-4efd-82b1-7c9ab791a63a":{"$contentActions":[{"action":{"$id":"ec36bddf-845f-4420-b691-66f0faaca720","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1656ae3d-ba81-48cd-bf9b-48c2d0c017e4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1656ae3d-ba81-48cd-bf9b-48c2d0c017e4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5018e172-a94f-4630-8fbb-89ba1c22bbed","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9fbb2f01-c5d1-44f5-9ffe-791a452ef0b5","type":"text/plain","content":"{{msgOcorrencias}}","metadata":{}},"$cardContent":{"document":{"id":"9fbb2f01-c5d1-44f5-9ffe-791a452ef0b5","type":"text/plain","content":"{{msgOcorrencias}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"08c61e2c-d15f-42e3-8102-ebb442760d36","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c239d8bb-8cc5-42a6-9db2-127459f9595a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1475eaee-7b62-434c-a6a2-9ec49debf18c","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9be3021a-bd89-4920-8921-aeae75d4004e","typeOfStateId":"state","$connId":"con_513","$id":"b9ff35a7-e3f0-430a-9736-dbe6df9fda37","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"332c9be0-4499-4ada-a446-f2b148243d00","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciasEncontradas\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaOcorrenciaLista) {\n    try {\n        let data = JSON.parse(bodyConsultaOcorrenciaLista).data;\n        return data;\n    }\n    catch (e) {\n        return e.message;\n    }\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"ocorrenciasEncontradas","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"79114b61-ccff-4813-b7a9-f9f04043211c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencias\"","$invalid":false,"settings":{"function":"run","source":"function run(ocorrenciasEncontradas) {\n    try {\n        ocorrenciasEncontradas = JSON.parse(ocorrenciasEncontradas);\n        let msg = \"De qual protocolo você quer ver mais detalhes? É só informar o número da opção, exemplo: *4*.\\n\";\n        for (let index = 0; index < ocorrenciasEncontradas.length; index++) {\n            msg += `\\n*${index + 1}*- ${ocorrenciasEncontradas[index].descricaoMotivo} - ${ocorrenciasEncontradas[index].descricaoSubmotivo}\nStatus: ${getStatus(ocorrenciasEncontradas[index].descricaoStatus)}\\n`;\n        }\n        msg += \"\\n*0*- Não encontrei o protocolo\"\n        return msg;\n    }\n    catch (e) {\n        return e.message;\n    }\n}\nfunction getStatus(status) {\n    if (status == 'ABERTO') {\n        return \"⚠ Em aberto\"\n    }\n    if (status == 'ENCERRADO') {\n        return \"✔ Encerrado\"\n    } else {\n        return \"🔍 Em análise\"\n    }\n}\nfunction getDataFormatada(data) {\n    let dataHoraInclusao = new Date(data);\n    let dia = (\"0\" + dataHoraInclusao.getDate()).slice(-2);\n    let mes = (\"0\" + (dataHoraInclusao.getMonth() + 1)).slice(-2);\n    let ano = dataHoraInclusao.getFullYear();\n    return `${dia}/${mes}/${ano}`;\n};","inputVariables":["ocorrenciasEncontradas"],"outputVariable":"msgOcorrencias","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9c589e3c-e24a-4e90-8605-34fe43f96592","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fadd02b7-5bfd-4b22-926e-00f30ea6a3cc","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3bf351da-2cbf-4efd-82b1-7c9ab791a63a","root":false,"$title":"[S.2.7.4][MSG] Menu Lista de Ocorrencias","$position":{"top":"1246.33px","left":"9282.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9be3021a-bd89-4920-8921-aeae75d4004e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"9704c4d2-d981-4c16-bdb7-ab2f6e57e0a0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"621cc419-4554-41ec-a2f1-5de2c36b3342","typeOfStateId":"state","$connId":"con_518","$id":"b1c9e975-9a1d-4abe-9282-9870c1633436","conditions":[{"source":"context","comparison":"equals","values":["Não encontrei o protocolo"],"variable":"userInput"}],"$invalid":false},{"stateId":"4f600f97-b24d-422e-9787-bb42f25ef97b","typeOfStateId":"state","$connId":"con_523","$id":"e12f84a8-2b54-4dfb-8a3a-4669c3cfa432","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"98d8f680-0f33-40ef-ae64-e0eb576da038","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, ocorrenciasEncontradas) {\n    try {\n        ocorrenciasEncontradas = JSON.parse(ocorrenciasEncontradas);\n        if (!inputUsuario) return 'inatividade'\n        if (inputUsuario == \"0\") return \"Não encontrei o protocolo\"\n        if (isNumber(inputUsuario)) {\n            let index = parseInt(inputUsuario) - 1;\n            if (index >= 0 && index < ocorrenciasEncontradas.length) {\n                return ocorrenciasEncontradas[index];\n            } else {\n                return 'input inesperado';\n            }\n        };\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}\nfunction isNumber(input) {\n    const regex = /^\\d+$/;\n    return regex.test(input);\n}","inputVariables":["input.content","ocorrenciasEncontradas"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d25ef70a-7b3c-498c-b27e-e63b3dcbb1ab","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciaEncontrada\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada);\n\t\treturn ocorrenciaEncontrada;\n\t}\n\tcatch (e) {\n\t\treturn \"Não Encontrada\"\n\t}\n}","inputVariables":["userInput"],"outputVariable":"ocorrenciaEncontrada","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"27541523-9db3-45bb-925a-f96e659c35d3","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"S.2.4.0\"","$invalid":false,"settings":{"variable":"exceptionType","value":"S.2.4.0"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"a88a9c41-3781-40c5-87d8-85cc4984829c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"5f38ca73-16b6-465d-904a-fb43a3c9c385","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bba85681-781c-4a97-b03c-53b51e099a6d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ac8134d0-86c9-488f-92b9-e4f3fc5d87da","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6aeb5f8b-0048-4c53-8adf-1f1b5b9cadc9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-52682ddf-1e78-4ba7-b50e-23b35c169e44","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9be3021a-bd89-4920-8921-aeae75d4004e","root":false,"$title":"[S.2.7.4][INPUT] Menu Lista de Ocorrencias","$position":{"top":"1493.33px","left":"9281.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"621cc419-4554-41ec-a2f1-5de2c36b3342":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e903ef19-0695-4781-b9b4-1e50cdb603a7","typeOfStateId":"state","$connId":"con_528","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Informar número\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = `Entendi que você não encontrou o protocolo.\n\nSe você tiver o número do protocolo é só informar aqui,`; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f0eee0c7-62d5-4806-9d5a-ab985fe387ad","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7f102816-3752-465e-8231-cfe041999147","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-cc2c840c-bb4c-419f-ae91-fd16d23a1894","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"621cc419-4554-41ec-a2f1-5de2c36b3342","root":false,"$title":"[S.2.7.5][MSG] Não encontrei o protocolo","$position":{"top":"1758px","left":"9282px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e903ef19-0695-4781-b9b4-1e50cdb603a7":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"5d5de109-ede8-4b09-b292-23864239e93d","typeOfStateId":"state","$connId":"con_533","$id":"180780cc-9cda-40f0-ae70-68a51a3075db","conditions":[{"source":"context","comparison":"equals","values":["Informar número"],"variable":"userInput"}],"$invalid":false},{"stateId":"c844130a-a5fe-4177-bc34-99bdac7a6eea","typeOfStateId":"state","$connId":"con_538","$id":"af7ebdb5-5d19-4f54-9414-7d9244b1a301","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-972f00fe-d37f-45f4-aac7-4e87f1e010e1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b914f191-f718-427c-ad95-1011bb37163a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0b2189fc-959a-4773-b687-053a5b055619","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-dc4afcda-4d55-4ede-a5a7-a63c21d467c3","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e903ef19-0695-4781-b9b4-1e50cdb603a7","root":false,"$title":"[S.2.7.5][INPUT] Não encontrei o protocolo","$position":{"top":"2008.33px","left":"9282.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5d5de109-ede8-4b09-b292-23864239e93d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea0a9ca8-00fe-4231-8cdd-9480955d83d8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"5d5de109-ede8-4b09-b292-23864239e93d","root":false,"$title":"[GO TO][S.2.6.0][MSG] Consulta Protocolo Númerica ","$position":{"top":"2297.33px","left":"9173.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c844130a-a5fe-4177-bc34-99bdac7a6eea":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a7d1acf0-8b47-4386-b0bb-26d8ce124f92","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"c844130a-a5fe-4177-bc34-99bdac7a6eea","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome) ","$position":{"top":"2347.33px","left":"9371.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"425a0975-5ebc-4885-bc03-71fb3126b93e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9d6ba1ae-d71a-41d3-9a57-fc9cc38d90bf","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e8a7d398-d571-46b8-af62-2c12b59d1f2d","typeOfStateId":"state","$connId":"con_543","$id":"eecef03a-cfc5-4f3f-a5c8-5971e35f482f","conditions":[{"source":"context","comparison":"equals","values":["ENCERRADO"],"variable":"ocorrenciaEncontrada@descricaoStatus"}],"$invalid":false},{"stateId":"463b7c23-5575-468b-b49b-6806857b0e0a","typeOfStateId":"state","$connId":"con_548","$id":"033b187e-cecd-40ef-a5b4-ce63a156cd38","conditions":[{"source":"context","comparison":"notEquals","values":["ENCERRADO"],"variable":"ocorrenciaEncontrada@descricaoStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"02d33333-0135-41b9-b32e-2b117a6e07c5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"ocorrenciaEncontrada\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyConsultaOcorrenciaLista) {\n    try {\n        let data = JSON.parse(bodyConsultaOcorrenciaLista).data;\n        return data[0];\n    }\n    catch (e) {\n        return e.message;\n    }\n}","inputVariables":["bodyConsultaOcorrenciaLista"],"outputVariable":"ocorrenciaEncontrada","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a51a9817-6868-4e84-9bf1-671dbb6c0f56","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"425a0975-5ebc-4885-bc03-71fb3126b93e","root":false,"$title":"[S.2.8.0][SET] Status da Ocorrencia","$position":{"top":"1190.5px","left":"8220.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e8a7d398-d571-46b8-af62-2c12b59d1f2d":{"$contentActions":[{"action":{"$id":"9dfe15ed-4061-4979-b19d-eacddba5cb83","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f758c4c6-28c6-4ac1-9c0a-a6a4901da60a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f758c4c6-28c6-4ac1-9c0a-a6a4901da60a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d08e2644-43c0-4299-9ef8-bc7978dc2d07","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f30789cb-d21b-4e3c-9d1c-839730d2f8c5","type":"text/plain","content":"{{msgOcorrencia}}","metadata":{}},"$cardContent":{"document":{"id":"f30789cb-d21b-4e3c-9d1c-839730d2f8c5","type":"text/plain","content":"{{msgOcorrencia}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2477b43e-f239-42c8-bbed-232d5d532e72","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"60d067ae-effa-48fb-84fa-b8c83fa9168d","typeOfStateId":"state","$connId":"con_553","$id":"07f3d340-804d-4c61-b873-e2a22db26c2e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fb4dfe2f-bd40-4121-8e66-48e542086c4c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada)\n\t\treturn `*Status*: ✔Encerrado\n\n${ocorrenciaEncontrada.descricaoMotivo} - ${ocorrenciaEncontrada.descricaoSubmotivo}\n*Protocolo*: ${ocorrenciaEncontrada.idProtocolo}.${ocorrenciaEncontrada.id}\n*Aberto em*: ${getDataFormatada(ocorrenciaEncontrada.dataHoraAbertura)}\n*Fechado em*: ${getDataFormatada(ocorrenciaEncontrada.dataHoraEncerramento)}\n\n${obsExiste(ocorrenciaEncontrada.motivoResolucao)}`\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\nfunction obsExiste(obs) {\n\tif (obs) {\n\t\treturn `*Observação*: ${obs}`\n\t}\n\telse\n\t\treturn '';\n}\n\nfunction getDataFormatada(data) {\n    let partes = data.split(/[-\\/]/); \n    let ano = parseInt(partes[0], 10);\n    let mes = parseInt(partes[1], 10) - 1; \n    let dia = parseInt(partes[2], 10);\n    let dataHora = new Date(ano, mes, dia);\n\n    let diaFormatado = (\"0\" + dataHora.getDate()).slice(-2);\n    let mesFormatado = (\"0\" + (dataHora.getMonth() + 1)).slice(-2);\n    let anoFormatado = dataHora.getFullYear();\n\n    return `${diaFormatado}/${mesFormatado}/${anoFormatado}`;\n}","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"msgOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6ff1515b-deb3-424f-8ece-5ca7a61d9af9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-47e6b2f0-9f64-4060-adf6-731cb5afba0f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e8a7d398-d571-46b8-af62-2c12b59d1f2d","root":false,"$title":"[S.2.8.1][MSG] Ocorrencia Encerrada","$position":{"top":"1365.5px","left":"7992.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"463b7c23-5575-468b-b49b-6806857b0e0a":{"$contentActions":[{"action":{"$id":"6ee0a734-b070-430b-9324-15e4b5d2e119","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"124eae8e-7d62-498e-901f-f0043ddad5c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"124eae8e-7d62-498e-901f-f0043ddad5c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"63032d32-43ce-46d2-89d3-df18b8b56c5a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a7a6b601-71fd-4940-bfba-d8c2fa24bc2e","type":"text/plain","content":"{{msgOcorrencia}}","metadata":{}},"$cardContent":{"document":{"id":"a7a6b601-71fd-4940-bfba-d8c2fa24bc2e","type":"text/plain","content":"{{msgOcorrencia}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ed1403fc-49a9-44a0-97d8-16cba5d08569","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8bf1cf79-af4b-4618-ae0a-a895dcbaf99d","typeOfStateId":"state","$connId":"con_558","$id":"4422ed4a-7f41-405c-8c62-f6aa12d13467","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ebf4d6ef-8f15-455c-a696-c72148ad6fcb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada)\n\n\t\treturn `*Status*: ${getStatus(ocorrenciaEncontrada.descricaoStatus)}\n\n${ocorrenciaEncontrada.descricaoMotivo} - ${ocorrenciaEncontrada.descricaoSubmotivo}\n*Protocolo*: ${ocorrenciaEncontrada.idProtocolo}.${ocorrenciaEncontrada.id}\n*Aberto em*: ${getDataFormatada(ocorrenciaEncontrada.dataHoraAbertura)}\n*Retorno previsto*: ${getDataFormatada(ocorrenciaEncontrada.dataPrevistaEncerramento)}`\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\nfunction getStatus(status) {\n    if (status == 'ABERTO') {\n        return \"⚠Em aberto\"\n    }\n    if (status == 'ENCERRADO') {\n        return \"✔Encerrado\"\n    } else {\n        return \"🔍Em análise\"\n    }\n}\nfunction getDataFormatada(data) {\n    let partes = data.split(/[-\\/]/); \n    let ano = parseInt(partes[0], 10);\n    let mes = parseInt(partes[1], 10) - 1; \n    let dia = parseInt(partes[2], 10);\n    let dataHora = new Date(ano, mes, dia);\n\n    let diaFormatado = (\"0\" + dataHora.getDate()).slice(-2);\n    let mesFormatado = (\"0\" + (dataHora.getMonth() + 1)).slice(-2);\n    let anoFormatado = dataHora.getFullYear();\n\n    return `${diaFormatado}/${mesFormatado}/${anoFormatado}`;\n}","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"msgOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-89ea7ed1-5e0a-48ba-89a0-ca6f6cb6f6ac","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bdf88d85-0ee6-4d3c-b525-d064abcf33e0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"463b7c23-5575-468b-b49b-6806857b0e0a","root":false,"$title":"[S.2.8.2][MSG] Ocorrencia Em Andamento","$position":{"top":"1337.5px","left":"8635.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"60d067ae-effa-48fb-84fa-b8c83fa9168d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2477b43e-f239-42c8-bbed-232d5d532e72","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f8479797-dcdf-4c3e-a401-da8bdcb7d2d4","typeOfStateId":"state","$connId":"con_563","$id":"07f3d340-804d-4c61-b873-e2a22db26c2e","conditions":[{"source":"context","comparison":"equals","values":["UM"],"variable":"numeroDeOcorrencias"}],"$invalid":false},{"stateId":"3320463f-d231-4089-889d-fe003372aadc","typeOfStateId":"state","$connId":"con_568","$id":"855b41fc-402c-48a8-8257-e4fd0b855374","conditions":[{"source":"context","comparison":"notEquals","values":["UM"],"variable":"numeroDeOcorrencias"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fb4dfe2f-bd40-4121-8e66-48e542086c4c","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"msgOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(ocorrenciaEncontrada) {\n\ttry {\n\t\tocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada)\n\t\treturn `*Status*: ✔${ocorrenciaEncontrada.descricaoStatus}}\n\n${ocorrenciaEncontrada.descricaoMotivo} - ${ocorrenciaEncontrada.descricaoSubmotivo}\n*Protocolo*: ${ocorrenciaEncontrada.idProtocolo}.${ocorrenciaEncontrada.id}\n*Aberto em*: ${ocorrenciaEncontrada.dataHoraAbertura}\n*Fechado em*: ${ocorrenciaEncontrada.dataHoraEncerramento}\n\n${obsExiste(ocorrenciaEncontrada.motivoResolucao)}`\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\nfunction obsExiste(obs) {\n\tif (obs) {\n\t\treturn `*Observação*: ${obs}`\n\t}\n\telse\n\t\treturn '';\n}","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"msgOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-af0c8bbe-b8ad-42cf-853c-d8dda5efd136","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"60d067ae-effa-48fb-84fa-b8c83fa9168d","root":false,"$title":"[S.2.8.1.1][SET] Quantidade de ocorrencia","$position":{"top":"1595.5px","left":"7992.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8bf1cf79-af4b-4618-ae0a-a895dcbaf99d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"80a2253d-1530-4d86-a4bd-bcc0090ae7c6","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"355c68db-7472-40df-91a1-341ef7e927f0","typeOfStateId":"state","$connId":"con_573","$id":"ac480b65-9aa3-475a-bc8b-0c24c380fd73","conditions":[{"source":"context","comparison":"equals","values":["Fora do prazo"],"variable":"dentroDoPrazo"}],"$invalid":false},{"stateId":"2cf161a2-1636-4a04-ae85-603e2d825c5f","typeOfStateId":"state","$connId":"con_578","$id":"4289372f-41cc-4ad8-9335-ef3138e2dd59","conditions":[{"source":"context","comparison":"equals","values":["Dentro do prazo"],"variable":"dentroDoPrazo"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"dc0b9966-8bce-4205-965b-ae8e4773d486","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Solucoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Solucoes {{state.name}} validação","action":"{{numeroProtocolo}} | {{dentroDoPrazo}}"},"conditions":[]},{"$id":"49ddb0d3-31b5-4646-b3c0-a8a31ba36400","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dentroDoPrazo\"","$invalid":false,"settings":{"function":"run","source":"function run(ocorrenciaEncontrada) {\n    try {\n        ocorrenciaEncontrada = JSON.parse(ocorrenciaEncontrada);  \n        let dataAtual = new Date();\n        let itemAberto = ocorrenciaEncontrada;\n\n        if (itemAberto) {\n            let dataLimite = getDataFormatada(itemAberto.dataPrevistaEncerramento);\n            if (dataLimite < dataAtual) {\n                return `Fora do prazo`;\n            }\n        }\n        return `Dentro do prazo`;\n    }\n    catch (e) {\n        return e.message;\n    }\n}\nfunction getDataFormatada(data) {\n    let dataHoraInclusao = new Date(data);\n    return dataHoraInclusao;\n};","inputVariables":["ocorrenciaEncontrada"],"outputVariable":"dentroDoPrazo","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-47967ccd-1c2a-44c5-af93-55c49d23dffa","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-050c1705-a171-4734-9427-4c42702e7e15","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"8bf1cf79-af4b-4618-ae0a-a895dcbaf99d","root":false,"$title":"[S.2.8.8][SET] Valida SLA","$position":{"top":"1585px","left":"8632.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3320463f-d231-4089-889d-fe003372aadc":{"$contentActions":[{"action":{"$id":"28bfb96c-79c5-4ac8-8778-25de14ba63a5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5f48b832-32a4-499f-a070-903c9fe311d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4e5c1b0e-b89e-4dfc-a2fa-6c5782b88fbe","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1e925f2-97db-4bfb-8cc0-1af8068b39c4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"04fdebc0-7150-4666-a97d-e05210cf910f","typeOfStateId":"state","$connId":"con_583","$id":"89e71d43-8dd4-4b6c-bc09-b59a2eef1d05","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc8763c-9079-49b1-9277-2d26f7b42da5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Ver opções novamente\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Informar número\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst bodyText = `Era este o protocolo que você precisava?\n\nPosso consultar também os protocolos dos últimos 60 dias ou então se tiver um número específico, é só informar aqui.\n\nSelecione uma das opções:`; // <---- Body\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": bodyText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"75a90e52-db9b-4311-9a75-10d05621c2cb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} exibicao","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c78ee146-9ccb-4813-ad07-4826f7f8502e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d7153a3a-d37c-4352-b199-5ec3b2164918","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8ec73c43-4d55-4c80-8aed-283c5dcc8cb2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3320463f-d231-4089-889d-fe003372aadc","root":false,"$title":"[S.2.8.4][MSG] Consultar Mais? (+ Ocorrencias)","$position":{"top":"1790.5px","left":"8143.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e4b128f9-85e7-4b61-a314-679b26acb2b5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c6e59ac8-9b50-46e7-8343-2803589d7436","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"443ab8bd-9468-402d-b5d6-4c1afa3a7212","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e4b128f9-85e7-4b61-a314-679b26acb2b5","root":false,"$title":"[GO TO][S.2.6.0][MSG] Consulta Protocolo Númerica  ","$position":{"top":"2280px","left":"7830px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f8479797-dcdf-4c3e-a401-da8bdcb7d2d4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3cc656d6-a590-443c-9edf-9a391913731c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f8479797-dcdf-4c3e-a401-da8bdcb7d2d4","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)   ","$position":{"top":"1801.5px","left":"7717.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"355c68db-7472-40df-91a1-341ef7e927f0":{"$contentActions":[{"action":{"$id":"fae01ff2-78d7-4a1c-803e-9705d922c71a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7b88248e-8508-4d17-8ec6-24313231a67e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7b88248e-8508-4d17-8ec6-24313231a67e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e216291e-531e-4195-946c-441699fc3a34","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2aa81b5c-808a-4ae9-bba2-78d8338b6439","type":"text/plain","content":"Vi aqui que o prazo para dar um retorno já passou. Já acionei nosso time e estamos fazendo o possível para resolver o quanto antes.","metadata":{}},"$cardContent":{"document":{"id":"2aa81b5c-808a-4ae9-bba2-78d8338b6439","type":"text/plain","content":"Vi aqui que o prazo para dar um retorno já passou. Já acionei nosso time e estamos fazendo o possível para resolver o quanto antes."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d1b46fdb-e03a-4cdc-9f02-8b9fa489f6f4","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"22db9c00-b001-4a6c-8983-795b50860595","typeOfStateId":"state","$connId":"con_588","$id":"c38be8eb-f37d-42f6-acd5-d5285c63689a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6548ab5a-027b-49cc-857a-3b4bbac94441","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibicao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibicao","action":"Exibicao"},"conditions":[]},{"$id":"a87e3fb6-8488-49cf-a62a-56a32613436f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"requestComentarioOcorrencia\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(contaSelecionada) {\n\ttry {\n\t\tlet obj = JSON.parse(contaSelecionada);\n\t\treturn {\n\t\t\t\"idUsuario\": obj.usuario,\n\t\t\t\"nomeUsuario\": obj.nomeCompleto,\n\t\t\t\"origemAberturaOcorrencia\": \"SUSTENTACAO PJ\",\n\t\t\t\"comentario\": `Registro via chatbot WhatsApp PJ - O usuário ${obj.nomeCompleto}, portador do CNPJ: ${obj.doc}, solicita urgência no atendimento de sua demanda. O prazo máximo para a resolução já foi atingido, e sua situação requer atenção imediata.`\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\n","inputVariables":["contaSelecionada"],"outputVariable":"requestComentarioOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b0e7d724-774a-40a1-ac05-bf3da939c9b8","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP POST \"bodyComentarioOcorrencia\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Bot-ID":"{{application.identifier}}","Safra-Aplicacao":"CHT","Safra-Correlation-ID":"{{idSessao}}"},"uri":"{{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/protocolos/{{ocorrenciaEncontrada@idProtocolo}}/ocorrencias/{{ocorrenciaEncontrada@id}}/historicos","method":"POST","responseStatusVariable":"statusComentarioOcorrencia","responseBodyVariable":"bodyComentarioOcorrencia","body":"{{requestComentarioOcorrencia}}"},"conditions":[]},{"$id":"2e659540-d7a4-443c-b0cb-09ff9682176a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusComentarioOcorrencia"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"87c8fa21-90d7-4ea3-bfa9-487092daefd3","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{config.urlCHT}}/operacoes-execucoes/servicos-operacionais/protocolos/assistente-virtual/v1/protocolos/{{numeroProtocolo}}/ocorrencias/{{idUltimaOcorrencia}}/historicos | POST | {{statusComentarioOcorrencia}} | {{bodyComentarioOcorrencia}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-5cdc7758-045c-4a6f-8f2c-b8b9fcf0b757","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-855ce081-70f7-47b6-98da-fb81cde61711","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6bb4f86b-3cf7-4a7b-ba3b-9f9a12abff70","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-4abc1ca1-d1f7-4935-9cc0-cb77b190ef60","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"355c68db-7472-40df-91a1-341ef7e927f0","root":false,"$title":"[S.2.8.8.1][MSG][HTTP]Protocolo fora do Prazo","$position":{"top":"1753px","left":"8423.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"2cf161a2-1636-4a04-ae85-603e2d825c5f":{"$contentActions":[{"action":{"$id":"13d18022-762f-4806-ba88-f201a115da0b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fd821cfb-121e-42e6-9ae7-e92f92ad123e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fd821cfb-121e-42e6-9ae7-e92f92ad123e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b85ed1ed-64c1-4100-a727-efe77413443a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"6ca88c3d-9a7f-435c-b01c-e86be2bd31b1","type":"text/plain","content":"Por aqui, estou trabalhando para te dar um retorno o quanto antes, e isso pode ocorrer até às 23:59 da data prevista.","metadata":{}},"$cardContent":{"document":{"id":"6ca88c3d-9a7f-435c-b01c-e86be2bd31b1","type":"text/plain","content":"Por aqui, estou trabalhando para te dar um retorno o quanto antes, e isso pode ocorrer até às 23:59 da data prevista."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"97c334c5-7414-4c06-885d-ad54444c8a0b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"22db9c00-b001-4a6c-8983-795b50860595","typeOfStateId":"state","$connId":"con_593","$id":"066f515d-b75a-4aa2-ada4-796f565768e7","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-075a4851-78bc-43bb-bd6e-8da0559b1c94","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2cf161a2-1636-4a04-ae85-603e2d825c5f","root":false,"$title":"[S.2.8.8.2][MSG] Dentro do Prazo","$position":{"top":"1772.67px","left":"8864.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"04fdebc0-7150-4666-a97d-e05210cf910f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a5d357-4677-4157-8c8d-788ce02a2023","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e4b128f9-85e7-4b61-a314-679b26acb2b5","typeOfStateId":"state","$connId":"con_598","$id":"4450d719-e5cb-4d3f-9bb9-8979f48aee70","conditions":[{"source":"context","comparison":"equals","values":["Informar número"],"variable":"userInput"}],"$invalid":false},{"stateId":"abbdb87d-1552-4dae-93d5-c3481cfea0c0","typeOfStateId":"state","$connId":"con_603","$id":"a37496e4-955c-413e-871f-b17d12f4c02f","conditions":[{"source":"context","comparison":"equals","values":["Ver opções novamente"],"variable":"userInput"}],"$invalid":false},{"stateId":"c126284e-2396-4eb5-9824-4417e5af86f4","typeOfStateId":"state","$connId":"con_608","$id":"4c7ef026-e016-47a2-8d39-a4ce9d9693cd","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"694cf924-2ae1-4c02-b720-442cff7b2677","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n  const posicoes = {\n      \"1\": \"primeir[oa]|u[mn]\",\n      \"2\": \"segund[ao]|do[ie]s\",\n      \"3\": \"terceir[ao]|tr[eê]s\"\n  }\n  try {\n      if (!inputUsuario) return 'inatividade'\n      const regexDictionary = {}\n      const { buttons } = JSON.parse(dynamicContent).interactive.action\n      buttons.forEach((button, index) => {\n          const key = `^(${index + 1}|${posicoes[index + 1]}|${button.reply.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()})$`\n          regexDictionary[key] = button.reply.title\n      })\n      for (let regex in regexDictionary) {\n          if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n              return regexDictionary[regex]\n          }\n      }\n      return 'input inesperado'\n  } catch (err) {\n      return 'input inesperado'\n  }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a52535a0-fcb9-4753-8d42-2c341f99e952","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d47e9f4a-5fa9-4684-bdff-e2d6d1cd4c2f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} validação\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"0e756d2f-a657-43f2-b54f-af799513e0e7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} input inesperado\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-74bc4f41-c25b-43bb-9e86-45da71aa694a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-252a8a56-2da8-450a-a755-11e830ad9d38","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ae3bcfe6-19b0-4373-9299-f1ae5ff1c5ea","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f6e1f2f8-2e02-4c45-a902-bc4423650072","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"04fdebc0-7150-4666-a97d-e05210cf910f","root":false,"$title":"[S.2.8.4][INPUT] Consultar Mais? (+ Ocorrencias)","$position":{"top":"2047.67px","left":"8143px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"abbdb87d-1552-4dae-93d5-c3481cfea0c0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"151faaed-b713-4ce7-84fb-ae0544cbb686","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"3bf351da-2cbf-4efd-82b1-7c9ab791a63a","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"abbdb87d-1552-4dae-93d5-c3481cfea0c0","root":false,"$title":"[GO TO][S.2.7.4][MSG] Menu Lista de Ocorrencias","$position":{"top":"2353px","left":"8142.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c126284e-2396-4eb5-9824-4417e5af86f4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"30b18653-45cf-498b-9218-e259071f95bc","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"c126284e-2396-4eb5-9824-4417e5af86f4","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"2290px","left":"8498px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"22db9c00-b001-4a6c-8983-795b50860595":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3cc656d6-a590-443c-9edf-9a391913731c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"99095867-01bc-4fb1-a47d-3168e590e328","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"22db9c00-b001-4a6c-8983-795b50860595","root":false,"$title":"[GO TO] [Redirect] To Finalizacao (Welcome)","$position":{"top":"1897.33px","left":"8647.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4f600f97-b24d-422e-9787-bb42f25ef97b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8f19c9d7-dfe4-440f-b045-9ccf70498687","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"425a0975-5ebc-4885-bc03-71fb3126b93e","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"4f600f97-b24d-422e-9787-bb42f25ef97b","root":false,"$title":"[GO TO] [S.2.8.0][SET] Status da Ocorrencia","$position":{"top":"1615px","left":"9538.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"true","builder:#localTimeZone":"E. South America Standard Time","builder:useTunnelOwnerContext":"true","TraceTargetType":"Http","TraceMode":"All","TraceTarget":"https://take-api-beholder.cs.blip.ai/api/traces/devspdsolucoes2","serviceName":"Bot Soluções"},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}