{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"f9dd120e-024a-4544-9c88-aad781313623","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{blockDestinationId}}","typeOfStateId":"variable","$id":"d7411888-b223-44ea-8adc-853b2be5fb0c","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"blockDestinationId"}],"$invalid":false},{"stateId":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","typeOfStateId":"state","$connId":"con_3","$id":"11a69cb0-0fe0-411d-b7e4-51b72e5b8773","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"9ed83b55-8fac-4c5d-9645-3ce28ed48497","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"blockDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(state, serviceName) {\n\ttry {\n\t\tconst { botDestination, stateDestination } = JSON.parse(state)\n\n\t\tif (stateDestination.match(/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/) && botDestination === serviceName) {\n\t\t\treturn stateDestination\n\t\t}\n\t\treturn false\n\t} catch (err) {\n\t\treturn false\n\t}\n}","inputVariables":["state","config.serviceName"],"outputVariable":"blockDestinationId","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-7177fb0b-fc6a-4872-949d-7d9a24de7f5a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-971c711c-f01d-47f2-9a42-ca608a50d1ca","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Início","$position":{"top":"36.3333px","left":"2065.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"127c233a-774d-4815-8878-b660a8e1b3d8","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","conditions":[{"source":"input","comparison":"exists","values":[]}],"$id":"b4906de6-3af7-45cd-bd5e-54da2289f776","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[{"$id":"78cd6a7a-98af-4316-bfcb-e704f170a66a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(previousBlockId, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `cascata ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-4a28e71b-f967-4f1d-9d2e-b7a41040ee90","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceções","$position":{"top":"33.6667px","left":"170.333px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cac63fde-6671-4aa1-9a67-efc2f5336711":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c9ba908c-18ee-43c9-8df0-e67e932e5074","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"5645aa88-959e-46a7-af25-0e32ed445e49","typeOfStateId":"state","$connId":"con_13","$id":"57625472-6942-43b7-acc1-422abf536dd2","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"55ffe85b-9014-42b0-bc52-2118de1c6299","$typeOfContent":"","type":"TrackEvent","$title":"Track \"Chamada de API\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"Chamada de API","action":"consulta taxas de atencipação do plano"},"conditions":[]},{"$id":"e448899d-10fa-4137-81e9-3cf6f9cd8551","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"taxaBody\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/operacoes-execucoes/servicos-consumidores/antecipacoes-recebiveis/assistente-virtual/v1/estabelecimentos/{{selectedEc@codigoEc}}?view=taxas-antecipacao","responseStatusVariable":"taxaStatus","responseBodyVariable":"taxaBody"},"conditions":[]},{"$id":"695557b3-8de1-433c-9df5-df9491e5b200","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxaAntecipacao\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(taxaBody) {\n\ttry {\n\t\tlet taxaBody = JSON.parse(taxaBody);\n\t\ttaxaBody = taxaBody.data\n\t\treturn JSON.stringify(taxaBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaBody"],"outputVariable":"taxaAntecipacao","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"8a14a865-fe46-4720-a100-febd2918a05f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxaModalidade\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(taxaBody) {\n\ttry {\n\t\tlet taxaBody = JSON.parse(taxaBody);\n\t\ttaxaBody = taxaBody.modalidade\n\t\treturn JSON.stringify(taxaBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaAntecipacao"],"outputVariable":"taxaModalidade","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"33134da2-5316-46f3-b06b-23738c3b2e35","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"taxaVendasBody\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json"},"method":"GET","uri":"{{config.urlCHT}}/chat-assistente/safra-pay/v1/taxas?idEstabelecimento={{selectedEc@codigoEc}}","responseStatusVariable":"taxaVendasStatus","responseBodyVariable":"taxaVendasBody"},"conditions":[]},{"$id":"e124f1ba-0f80-43e3-b22f-dccd563df622","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"a30aca83-daca-4da9-88f4-19ae7374b1db","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{assunto}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"assunto"}]},{"$id":"7bbfbe91-5ba8-4379-a8cf-6c66b30c3428","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["taxaStatus","taxaVendasStatus"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0ea090d9-c6dc-44f9-aa94-2aa424b7d682","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/operacoes-execucoes/servicos-consumidores/antecipacoes-recebiveis/assistente-virtual/v1/estabelecimentos/{{selectedEc@codigoEc}}?view=taxas-antecipacao | GET| {{taxaStatus}} | {{taxaBody}}"},"conditions":[]},{"$id":"56ee3b0c-33c8-4053-aad5-2984812f2309","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo 2\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api resumo 2","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/safra-pay/v1/taxas?idEstabelecimento={{selectedEc@codigoEc}} | GET| {{taxaVendasStatus}} | {{taxaVendasBody}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"039d734d-1018-497c-83da-7a9e5f1e8b1c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {{state.name}} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status","action":"{{taxaVendasStatus}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxaVendasStatus"}]},{"$id":"4839e6b5-2855-4473-af1a-2e8b91aff380","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {{state.name}} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status","action":"{{taxaStatus}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxaStatus"}]},{"$id":"b539c9a2-fc50-41f5-b2c3-6c5561710345","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"taxaStatus"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-8905f22c-4833-4f57-beeb-0a3aa5ad9978","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e1c78b93-cc70-4156-b6a3-cbeabe40fec9","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-88aa2d93-00d5-4a87-90a8-9be76bcf0ac0","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-6b32967a-f134-4cc7-82dd-28873c581b98","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"cac63fde-6671-4aa1-9a67-efc2f5336711","root":false,"$title":"[TC.3.0.0][HTTP] API Taxas de Antecipação","$position":{"top":"425.667px","left":"670.667px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"24ee326c-2f65-4cf1-944e-2b178eaf2a82":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c9ba908c-18ee-43c9-8df0-e67e932e5074","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"45ec8433-22a9-4498-8005-c3c52f7ce6bc","typeOfStateId":"state","$connId":"con_18","$id":"c3cccbbb-a3c1-4124-945b-420030956119","conditions":[{"source":"context","comparison":"equals","values":["0"],"variable":"sizeMaquinas"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"e66b1d69-3e83-4e4d-9f57-5c2d84cd1ce5","typeOfStateId":"state","$connId":"con_23","$id":"53da15ed-8049-4435-a181-80e69abf758e","conditions":[{"source":"context","comparison":"equals","values":["1"],"variable":"sizeMaquinas"},{"values":["A"],"source":"context","comparison":"equals","variable":"tipoMaquina"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"0e6bc8ca-977f-40d6-9ccf-23d15a44268b","typeOfStateId":"state","$connId":"con_28","$id":"2a189d77-5c94-47b5-bfbf-febebd903c24","conditions":[{"source":"context","comparison":"equals","values":["1"],"variable":"sizeMaquinas"},{"values":["C"],"source":"context","comparison":"equals","variable":"tipoMaquina"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"46f819c5-9a97-4c4c-9a09-e363d6736ae1","typeOfStateId":"state","$connId":"con_33","$id":"48a23afc-2c9c-4282-8bc9-376125d176ed","conditions":[{"source":"context","comparison":"greaterThanOrEquals","values":["11"],"variable":"sizeMaquinas"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"bb74c3c9-73bc-4030-ae90-62acb134db5e","typeOfStateId":"state","$connId":"con_38","$id":"6a138384-8997-4175-9063-cb4f19baae61","conditions":[{"source":"context","comparison":"equals","values":["A"],"variable":"tipoMaquina"},{"values":["10"],"source":"context","comparison":"lessThanOrEquals","variable":"sizeMaquinas"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"bb74c3c9-73bc-4030-ae90-62acb134db5e","typeOfStateId":"state","$connId":"con_43","$id":"aec68847-2054-483c-8ae2-b5a28152d65e","conditions":[{"source":"context","comparison":"equals","values":["C"],"variable":"tipoMaquina"},{"values":["10"],"source":"context","variable":"sizeMaquinas","comparison":"lessThan"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"83910691-760e-4cc7-b210-e3aa8c707efa","typeOfStateId":"state","$connId":"con_48","$id":"1a8bd161-d3e3-4bcf-a358-1419b759434e","conditions":[{"source":"context","comparison":"lessThanOrEquals","values":["10"],"variable":"sizeMaquinas"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"46f819c5-9a97-4c4c-9a09-e363d6736ae1","typeOfStateId":"state","$connId":"con_53","$id":"5b1b40ec-7586-4185-bd08-b6ebc8a72f32","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"eeb8160f-35db-40c7-9e1c-6f35beaea83b","$typeOfContent":"","type":"TrackEvent","$title":"Chamada de API","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"Chamada de API","action":"Consulta máquinas disponíveis para EC."},"conditions":[]},{"$id":"a13ebe5a-7f0a-4cda-9ee7-5cec03846cd2","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"consultMaquina\" (Terminais)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/terminais?codigoEstabelecimentoComercial={{selectedEc@codigoEc}}","responseStatusVariable":"consultMaquinaStatus","responseBodyVariable":"consultMaquina"},"conditions":[]},{"$id":"67249656-098d-40c5-bb65-ca13fcdc48a2","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"tipoMaquina\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(consultMaquina) {\n\tlet consultMaquina = JSON.parse(consultMaquina);\n\nfunction retronarModalidadeA (value){\n  if(value.modalidade == 'A')\n  return value;\n}\nfunction retronarModalidadeC (value){\n  if(value.modalidade == 'C')\n  return value;\n}\nfunction retronarModalidadeV (value){\n  if(value.modalidade == 'V')\n  return value;\n}\n\nlet var1 = consultMaquina.data.filter(retronarModalidadeA);\nlet var2 = consultMaquina.data.filter(retronarModalidadeC);\nlet var3 = consultMaquina.data.filter(retronarModalidadeV);\nlet retorno = \"\"\nif (var1.length >0 && var3.length >0  || var2.length >0 && var3.length >0  ){\n    retorno = \"A e C\"\n}else if(var1.length >0  || var2.length >0  ){\n    retorno = \"A\"\n}else{\n  retorno = \"C\"\n}\n\treturn retorno;\n}","inputVariables":["consultMaquina"],"outputVariable":"tipoMaquina","LocalTimeZoneEnabled":false},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"consultMaquinaStatus"}]},{"$id":"54d01726-4eac-4f8a-ae09-305086f7178b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"sizeMaquinas\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina) {\n\tlet consultMaquina = JSON.parse(consultMaquina);\n\tlet sizeMaquina = consultMaquina.data.length\n\treturn sizeMaquina;\n}","inputVariables":["consultMaquina"],"outputVariable":"sizeMaquinas","LocalTimeZoneEnabled":false},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"consultMaquinaStatus"}]},{"$id":"6b251080-10aa-4802-b35c-6155039fd27f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"modalidadeMaquina\"","$invalid":false,"settings":{"function":"run","source":"function run(tipoMaquina) {\n\ttry {\n\t\tif (tipoMaquina == \"A\") {\n\t\t\treturn \"Alugada\"\n\t\t}\n\t\telse {\n\t\t\treturn \"Comprada\"\n\t\t}\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["tipoMaquina"],"outputVariable":"modalidadeMaquina","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"16d4e121-6af2-46fe-afaf-4f31b54688fa","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"ces\"","$invalid":false,"settings":{"variable":"pesquisa","value":"ces"},"conditions":[]},{"$id":"af2ef353-47c2-4a32-8408-672c7f3282f2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"08d7d24b-5e16-45e7-a4ee-70be9883bb6c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{assunto}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"assunto"}]},{"$id":"e6862cf0-cf57-41e7-b2b1-07e5e6e90370","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["consultMaquinaStatus"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"00575c53-9dc5-4af6-9d28-bd664c98d4d7","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"{state.name} api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/terminais?codigoEstabelecimentoComercial={{selectedEc@codigoEc}} | GET| {{consultMaquinaStatus}} | {{consultMaquina}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"73b7890c-1d3b-4f50-a276-4eb5eb14699b","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[]},{"$id":"541ea020-0b25-478a-8e9d-6a0c97812fa6","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"nomeTipoEquipamento\"","$invalid":false,"settings":{"variable":"nomeTipoEquipamento"},"conditions":[]},{"$id":"acfd5218-7228-4815-9bde-46c364008291","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"numeroserie\"","$invalid":false,"settings":{"variable":"numeroserie"},"conditions":[]},{"$id":"9bc602fe-e7b0-4d49-8d78-ce76d9ff7e4f","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"valorTabela\"","$invalid":false,"settings":{"variable":"valorTabela"},"conditions":[]},{"$id":"6657d45e-9e92-40a2-b997-6cdb13bfde25","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"valorPago\"","$invalid":false,"settings":{"variable":"valorPago"},"conditions":[]},{"$id":"b7ca2944-7897-4bd5-95f9-9c991e1cae8c","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"faturamentoMensal\"","$invalid":false,"settings":{"variable":"faturamentoMensal"},"conditions":[]},{"$id":"9097bcd6-1bfb-4820-82c9-c6429263d9ed","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"faturamentoAnual\"","$invalid":false,"settings":{"variable":"faturamentoAnual"},"conditions":[]},{"$id":"e1befccd-127f-4747-bf79-3f4187753222","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"valorTabela\"","$invalid":false,"settings":{"variable":"valorTabela","value":""},"conditions":[]},{"$id":"44a9ebad-5310-449d-a68e-434c2188b576","$typeOfContent":"","type":"SetVariable","$title":"Set CLEAR \"faturamentoAnual\"","$invalid":false,"settings":{"variable":"faturamentoAnual","value":"0"},"conditions":[]},{"$id":"87389c53-a6da-472f-861b-d96b28a27607","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroSerie\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina) {\n\tconsultMaquina = JSON.parse(consultMaquina);\n\tlet numeroSerie = consultMaquina.data[0].numeroSerie\n\treturn numeroSerie;\n}\n\n","inputVariables":["consultMaquina"],"outputVariable":"numeroSerie","LocalTimeZoneEnabled":false},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"consultMaquinaStatus"}]},{"$id":"122234b9-5481-42a8-aa78-4808635e2a07","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroLogico\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina) {\n\tconsultMaquina = JSON.parse(consultMaquina);\n\tlet numeroLogico = consultMaquina.data[0].numeroLogico\n\treturn numeroLogico;\n}\n\n","inputVariables":["consultMaquina"],"outputVariable":"numeroLogico","LocalTimeZoneEnabled":false},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"consultMaquinaStatus"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-90df3465-4532-4ed6-a6b8-f35bf74444d7","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c630b6d1-027f-4069-ad22-d347498c1a10","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-41cea90f-0e67-479d-9b9e-04486f72f9ec","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-734f31a1-fcf4-4682-afd6-5a172fc74ccb","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"24ee326c-2f65-4cf1-944e-2b178eaf2a82","root":false,"$title":"[TC.4.0.0][HTTP] API Consultar Máquinas","$position":{"top":"378.889px","left":"1155.78px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4a101355-7808-4bb7-a96d-7053a966074a":{"$contentActions":[{"action":{"$id":"926c7202-1e44-49de-962a-349238c2cba8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4e2a9b99-e0af-42b7-baed-11cbbaa7369c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4e2a9b99-e0af-42b7-baed-11cbbaa7369c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"55a10321-ecb4-4ab7-a368-b65761bea3b8","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c9ba908c-18ee-43c9-8df0-e67e932e5074","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"722bd745-fd0f-4ade-9937-852d7db9e165","typeOfStateId":"state","$connId":"con_58","$id":"69ef53aa-1708-4fbb-91cb-a8d04011ba17","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6288fd61-64e2-4e1d-9dcb-569b499aea7a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Valor divergente\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Cobrança duplicada\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Outros motivos\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Para podermos entender melhor, escolha uma das opções abaixo. 👇 \";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"be3510e5-7f5f-49aa-bcd5-35df5694c9e6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"4d426545-1d43-4f3a-984a-f0f255b4ea5d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{assunto}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"assunto"}]}],"$leavingCustomActions":[{"$id":"dc186f16-cee1-48e0-afb4-90d8615f9955","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-9af4e678-400d-4eb8-96a3-272020740e7b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f961d560-1a08-4444-ae86-54e6952c9af4","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3abbee48-7dcd-4af4-9835-d1a450d36ba8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e3737134-2f76-4043-9492-0358aef36bb0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"4a101355-7808-4bb7-a96d-7053a966074a","root":false,"$title":"[TC.7.0.0][MSG] Questionar uma cobrança","$position":{"top":"399px","left":"3266.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e912e94c-247f-4ad6-abec-f42562d981a0":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"fbfbbf55-3fd8-42df-9c52-1fa32ab0d86e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"82358327-d2c4-40da-a143-48cc6a090bad","typeOfStateId":"state","$connId":"con_63","$contentId":"8702cb7b-c61e-4284-b4e1-f75632e772f3","$id":"1c793d1b-4d9c-4025-90cd-698b39ed0f37","conditions":[{"source":"context","comparison":"equals","values":["Vendas Online","Vendas Físicas"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"11d3e430-a83a-412f-9a45-b815c8d231c8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {{state.name}} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"8d005c35-9919-4762-a56a-1808f568758b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, salesPaymentType) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"venda f[ií]sica\": \"Venda Física\",\n      \"venda online|venda digital\": \"Venda Online\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e8b4d028-59bf-48d1-be68-5eb55bfbb0f9","$typeOfContent":"","type":"SetVariable","$title":"Set \"taxModality\" with \"userInput\"","$invalid":false,"settings":{"value":"{{userInput}}","variable":"taxModality"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"639ae723-4c8f-4537-8c9c-15eafc103843","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"cc45bca6-a1e5-4bfb-80eb-37f50fb5bb08","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"63331023-2b40-48de-bf0a-7d63973d6574","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Vendas Online","Vendas Físicas"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-d9705c11-ed17-4f80-b169-63f5dff851d5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-741dbdc5-a7d9-4303-97ce-f4161fa78554","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d1da046a-b18d-4b34-a25f-7e5a2563ae70","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-9d54f818-744a-4430-ad18-bcb6ea693547","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"e912e94c-247f-4ad6-abec-f42562d981a0","root":false,"$title":"[TC.2.0.2][INPUT] Modalidade de venda","$position":{"top":"1330.21px","left":"294px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4dfbe4df-5b62-4c68-9130-ab7ccec1756b":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"06094d8f-981b-4ac3-a526-af631e3f4600","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"313d8fd3-b86e-48a6-91d5-803adf2aa7d6","typeOfStateId":"state","$connId":"con_68","$contentId":"0e9a72e1-c51b-497a-8f60-ae80a6000813","$id":"65252d08-2925-4a46-9e47-b8a888193b6b","conditions":[{"source":"context","comparison":"equals","values":["Visa","Elo","Amex","Master","Hiper"],"variable":"userInput"},{"values":[],"source":"context","comparison":"exists","variable":"taxasExibir@taxaDebitoAvistaEcommerce"}],"$invalid":false},{"stateId":"82358327-d2c4-40da-a143-48cc6a090bad","typeOfStateId":"state","$connId":"con_73","$id":"a42a1689-c4ea-4e9f-a5b8-6355014714a9","conditions":[{"source":"context","comparison":"equals","values":["Elo","Amex","Hiper","Master","Visa"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"05482743-ecc7-4eae-96d3-ee4227e6527a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {{state.name}} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"a2f27600-bc34-4e24-acca-19c4613242ea","$typeOfContent":"","type":"SetVariable","$title":"Set \"taxModality\" to \"Vendas Físicas\" if taxaDebitoAvistaEcommerce NOT EXIST","$invalid":false,"settings":{"variable":"taxModality","value":"Vendas Físicas"},"conditions":[]}],"$leavingCustomActions":[{"$id":"22544a01-53d2-4dcb-aced-ddb4bb463c2e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Master\": \"Master\",\n      \"Visa\": \"Visa\",\n      \"Elo\": \"Elo\",\n      \"Amex\": \"Amex\",\n      \"Hiper\": \"Hiper\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c054b662-39ca-4707-92a1-404817bd887a","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"55c74ed8-2695-46aa-ac96-1cf27d4caa33","$typeOfContent":"","type":"SetVariable","$title":"Set \"taxCardFlag\" with \"userInput\"","$invalid":false,"settings":{"value":"{{userInput}}","variable":"taxCardFlag"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"ba43bc26-d89c-4d11-bda1-82dc51e510b9","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxasExibir\"","$invalid":false,"settings":{"function":"run","source":"function run(taxaVendasBody, bandeira) {\n\ttry {\n\t\tbandeira.toLowerCase();\n\t\tbandeira = bandeira.replace('master', 'MSTC').replace('visa', 'VISA').replace('hiper', 'HIPC').replace('elo', 'ELOC').replace('amex', 'AMXC');\n\t\ttaxaVendasBody = JSON.parse(taxaVendasBody);\n\t\ttaxaVendasBody = taxaVendasBody.data\n\t\ttaxaVendasBody = taxaVendasBody.filter(taxaVendasBody => (taxaVendasBody.codigoBandeira == bandeira))\n\t\ttaxaVendasBody = taxaVendasBody[0]\n\t\treturn JSON.stringify(taxaVendasBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaVendasBody","taxCardFlag"],"outputVariable":"taxasExibir","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"867b8492-1a86-4037-8bbd-4460a5c70194","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"89766afe-5cc2-4c7b-8525-7611f9729cf9","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Master","Visa","Elo","Amex","Hiper"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-6459c5fc-fe3a-40e0-aea4-456e7e0fbc13","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-76bf5dda-263d-4bfc-b25f-a9e8d68c9aeb","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-f7359a88-cc5d-43f5-aebc-b203893a48c0","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9c3a3124-bcad-476e-8c23-b272cd763b8a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"4dfbe4df-5b62-4c68-9130-ab7ccec1756b","root":false,"$title":"[TC.2.0.1][INPUT] Selecao Bandeiras","$position":{"top":"839px","left":"321.571px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"82358327-d2c4-40da-a143-48cc6a090bad":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e49b1f29-6b97-4331-a5e9-db2cad2b0715","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0f2ef715-e474-48e3-9642-ca975864c269","typeOfStateId":"state","$connId":"con_78","$id":"41318e27-1eba-4c23-952a-ce44edbcefe7","conditions":[{"source":"context","comparison":"equals","values":["Vendas Online"],"variable":"taxModality"},{"values":["Amex","Hiper"],"source":"context","comparison":"equals","variable":"taxCardFlag"}],"$invalid":false},{"stateId":"98c7523a-b7d2-49ab-bab8-c47926549497","typeOfStateId":"state","$connId":"con_83","$id":"77b3b24c-ec41-4614-85e9-ac4cfb7c2744","conditions":[{"source":"context","comparison":"equals","values":["Vendas Físicas"],"variable":"taxModality"},{"values":["Amex","Hiper"],"source":"context","comparison":"equals","variable":"taxCardFlag"}],"$invalid":false},{"stateId":"f518ebdc-b60f-4359-9584-38c43f13952d","typeOfStateId":"state","$connId":"con_88","$id":"ff7a7dd4-e58b-4b6e-bd9a-a6f7225748a6","conditions":[{"source":"context","comparison":"equals","values":["Vendas Online"],"variable":"taxModality"}],"$invalid":false},{"stateId":"e383d0a7-ef06-403b-9293-485753c8ceb0","typeOfStateId":"state","$connId":"con_93","$id":"4fef2789-2bfd-48cc-b907-f23ac2a31716","conditions":[{"source":"context","comparison":"equals","values":["Vendas Físicas"],"variable":"taxModality"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3095bc08-c646-4fcc-92c0-4c74df9052fc","$typeOfContent":"","type":"ExecuteScript","$title":"taxasExibir","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(taxaVendasBody, modalidade, bandeira) {\n\n\ttry {\n\n\n\t\tbandeira = bandeira.replace('Master', 'MSTC').replace('Visa', 'VISA').replace('Hiper', 'HIPC').replace('Elo', 'ELOC').replace('Amex', 'AMXC');\n\t\ttaxaVendasBody = JSON.parse(taxaVendasBody);\n\t\ttaxaVendasBody = taxaVendasBody.data\n\t\ttaxaVendasBody = taxaVendasBody.filter(taxaVendasBody => (taxaVendasBody.codigoBandeira == bandeira))\n\t\ttaxaVendasBody = taxaVendasBody[0]\n\n\n\t\tfunction formatarTaxa(taxa) {\n\t\t\treturn parseFloat(taxa).toFixed(2).toString().replace('.', ',');\n\t\t}\n\n\t\t// Formatar as taxas no objeto\n\t\ttaxaVendasBody.taxaDebitoAvista = formatarTaxa(taxaVendasBody.taxaDebitoAvista);\n\t\ttaxaVendasBody.taxaDebitoAvistaEcommerce = formatarTaxa(taxaVendasBody.taxaDebitoAvistaEcommerce);\n\t\ttaxaVendasBody.taxaDebitoPf = formatarTaxa(taxaVendasBody.taxaDebitoPf);\n\t\ttaxaVendasBody.taxaDebitoPfEcommerce = formatarTaxa(taxaVendasBody.taxaDebitoPfEcommerce);\n\t\ttaxaVendasBody.taxaCreditoAVista = formatarTaxa(taxaVendasBody.taxaCreditoAVista);\n\t\ttaxaVendasBody.taxaCreditoAVistaEcommerce = formatarTaxa(taxaVendasBody.taxaCreditoAVistaEcommerce);\n\t\ttaxaVendasBody.taxaCreditoParcLojista2a6 = formatarTaxa(taxaVendasBody.taxaCreditoParcLojista2a6);\n\t\ttaxaVendasBody.taxaCreditoParcLojista2a6Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParcLojista2a6Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParcLojista7a12 = formatarTaxa(taxaVendasBody.taxaCreditoParcLojista7a12);\n\t\ttaxaVendasBody.taxaCreditoParcLojista7a12Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParcLojista7a12Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParcEmissor = formatarTaxa(taxaVendasBody.taxaCreditoParcEmissor);\n\t\ttaxaVendasBody.taxaCreditoParcEmissorEcommerce = formatarTaxa(taxaVendasBody.taxaCreditoParcEmissorEcommerce);\n\t\ttaxaVendasBody.taxaCreditoParc2 = formatarTaxa(taxaVendasBody.taxaCreditoParc2);\n\t\ttaxaVendasBody.taxaCreditoParc2Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc2Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc3 = formatarTaxa(taxaVendasBody.taxaCreditoParc3);\n\t\ttaxaVendasBody.taxaCreditoParc3Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc3Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc4 = formatarTaxa(taxaVendasBody.taxaCreditoParc4);\n\t\ttaxaVendasBody.taxaCreditoParc4Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc4Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc5 = formatarTaxa(taxaVendasBody.taxaCreditoParc5);\n\t\ttaxaVendasBody.taxaCreditoParc5Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc5Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc6 = formatarTaxa(taxaVendasBody.taxaCreditoParc6);\n\t\ttaxaVendasBody.taxaCreditoParc6Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc6Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc7 = formatarTaxa(taxaVendasBody.taxaCreditoParc7);\n\t\ttaxaVendasBody.taxaCreditoParc7Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc7Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc8 = formatarTaxa(taxaVendasBody.taxaCreditoParc8);\n\t\ttaxaVendasBody.taxaCreditoParc8Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc8Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc9 = formatarTaxa(taxaVendasBody.taxaCreditoParc9);\n\t\ttaxaVendasBody.taxaCreditoParc9Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc9Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc10 = formatarTaxa(taxaVendasBody.taxaCreditoParc10);\n\t\ttaxaVendasBody.taxaCreditoParc10Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc10Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc11 = formatarTaxa(taxaVendasBody.taxaCreditoParc11);\n\t\ttaxaVendasBody.taxaCreditoParc11Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc11Ecommerce);\n\t\ttaxaVendasBody.taxaCreditoParc12 = formatarTaxa(taxaVendasBody.taxaCreditoParc12);\n\t\ttaxaVendasBody.taxaCreditoParc12Ecommerce = formatarTaxa(taxaVendasBody.taxaCreditoParc12Ecommerce);\n\n\n\t\treturn JSON.stringify(taxaVendasBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaVendasBody","taxModality","taxCardFlag"],"outputVariable":"taxasExibir","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a802b057-33f7-4a54-bad9-e22e7e336276","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {{state.name}} validacao\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validacao","action":"{{taxModality}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxModality"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-d8a31454-d848-4be6-b740-f6937b2180be","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-cc827f75-0b0b-478d-b120-ac237196384c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"82358327-d2c4-40da-a143-48cc6a090bad","root":false,"$title":"[TC.2.0.2][SET] \"taxasExibir\"","$position":{"top":"1765.75px","left":"323px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"64033608-d1fe-4704-aebe-31662a651f61":{"$contentActions":[{"action":{"$id":"36baba7b-a8d0-4106-b820-6e6a8bd18365","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"18e6a934-a151-4bb7-872d-8887f80bac91","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"18e6a934-a151-4bb7-872d-8887f80bac91","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d6c68d38-7014-4fc3-bfdc-8c1441d50bae","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b6679cd5-e998-4a2e-8a3e-ed2446fb073c","type":"text/plain","content":"Por gentileza, digite, em poucas palavras, o motivo da sua solicitação de revisão de lançamento. ","metadata":{}},"$cardContent":{"document":{"id":"b6679cd5-e998-4a2e-8a3e-ed2446fb073c","type":"text/plain","content":"Por gentileza, digite, em poucas palavras, o motivo da sua solicitação de revisão de lançamento. "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea0411d0-285d-4394-bb28-7e700f3871d5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"faf5caf6-e19a-42eb-9d38-2e4e58acae88","typeOfStateId":"state","$connId":"con_98","$id":"60af1b1b-1cdc-4a88-bc52-d8f5e762df02","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6138dcc7-8d28-4836-9fec-7bd712c70b86","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"49787b51-0156-44fc-8565-77b607d79509","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-5d987bc5-fed7-4e83-9a2d-e69cfc26ec86","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7ebbd7a3-0082-41c5-b9bd-1276c7e81591","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"64033608-d1fe-4704-aebe-31662a651f61","root":false,"$title":"[TC.7.0.1][MSG] Outro Motivo","$position":{"top":"877.714px","left":"3546.71px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"83910691-760e-4cc7-b210-e3aa8c707efa":{"$contentActions":[{"action":{"$id":"b6502dd7-688f-4c38-ad87-7ae5cbdf9939","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"2ff17d64-5871-485c-b2ec-ef3fc8c27323","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"2ff17d64-5871-485c-b2ec-ef3fc8c27323","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"db9f433e-7884-4e29-a9a7-0755cfe8c739","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"3576eedf-1d52-44fa-8018-41112a232738","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3468fd40-a03c-45dc-b438-f0066d5aee17","typeOfStateId":"state","$connId":"con_103","$id":"ea739db2-e6e6-48f2-8263-c98a9af09947","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"667c6ac4-bb04-4eaf-a048-20bc29f734f2","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesType) {\n    try {\n        let buttons = [\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"1\",\n                    \"title\": \"Aluguel\"\n                }\n            },\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"2\",\n                    \"title\": \"Comprada\"\n                }\n            }\n        ];\n\n        const headerText = \"Você possui máquinas habilitadas nas modalidades Aluguel e Comprada. Selecione qual deseja consultar. 👇\";\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"button\",\n                \"body\": {\n                    \"text\": headerText,\n                },\n                \"action\": {\n                    buttons\n                }\n            }\n        };\n    } catch (err) {\n        return false;\n    }\n}","inputVariables":["salesType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a0f98036-5458-49f0-b352-322f3681552e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-1e7e4a8c-9426-4a5a-a023-4a2b83007d45","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4a976bff-4acd-4a91-a581-9f3a931a2033","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e5873f1f-0a13-4da6-a2ca-4248b8e5110e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"83910691-760e-4cc7-b210-e3aa8c707efa","root":false,"$title":"[TC.4.3.0][MSG] Alugada ou Comprada","$position":{"top":"681.889px","left":"1184.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e66b1d69-3e83-4e4d-9f57-5c2d84cd1ce5":{"$contentActions":[{"action":{"$id":"a7559ef9-604b-4b61-bb44-80a554f17f2b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3ff29f1b-1be6-412b-ab1c-5883b8f4f7b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3ff29f1b-1be6-412b-ab1c-5883b8f4f7b4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6da4ea77-f424-47c6-86dd-b2a533224d46","$typeOfContent":"text","type":"SendMessage","settings":{"id":"29f8529d-076c-4c21-8e18-809d6b00838b","type":"text/plain","content":"{{mensagemMaquinaAlugada}}","metadata":{}},"$cardContent":{"document":{"id":"29f8529d-076c-4c21-8e18-809d6b00838b","type":"text/plain","content":"{{mensagemMaquinaAlugada}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f0c472da-c63a-4870-9520-42afef193343","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"df93c738-b6f9-4397-b7d0-e675bb78c31a","typeOfStateId":"state","$connId":"con_108","$id":"dd243811-9c3f-4f57-8174-e2a5ef65144f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"743e198d-4686-487b-881b-25d8d49d3ece","$typeOfContent":"","type":"TrackEvent","$title":"Chamada de API","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"Chamada de API","action":"Consulta Máquinas e traz alugadas."},"conditions":[]},{"$id":"b4375fd5-30ea-4508-9cb1-8c0f6b52aa4d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroLogico\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina, numeroSerie) {\n\ttry {\n\t\tconsultMaquina = JSON.parse(consultMaquina);\n\t\tconsultMaquina = consultMaquina.data.filter(consultMaquina => (consultMaquina.numeroSerie == numeroSerie))\n\t\tlet numeroLogico = consultMaquina[0].numeroLogico\n\t\treturn numeroLogico;\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\n","inputVariables":["consultMaquina","numeroSerie"],"outputVariable":"numeroLogico","LocalTimeZoneEnabled":false},"conditions":[{"values":["1"],"source":"context","comparison":"notEquals","variable":"sizeMaquinas"}]},{"$id":"f945c26c-3927-4b58-ab32-2952c7ff388f","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyAlugueis\" (alugueis)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/alugueis?tipoFiltro=EC&valorFiltro={{selectedEc@codigoEc}}","responseStatusVariable":"statusAlugueis","responseBodyVariable":"bodyAlugueis"},"conditions":[]},{"$id":"ef93b2bc-a02a-4af5-973c-5c458110dede","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyApolice\" (apolices)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/vendas-servicos/vendas/seguros/assistente-virtual/v1/clientes/{{contaSelecionada@doc}}/apolices?codigoProduto=7105","responseStatusVariable":"statusApolice","responseBodyVariable":"bodyApolice"},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"statusAlugueis"}]},{"$id":"ccc207e0-7789-4e3f-acd3-bf663d6f6534","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyFaturamentoAnual\" (Faturamento Anual)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/faturamentos?codigoEstabelecimentoComercial={{selectedEc@codigoEc}}&view=Anual","responseStatusVariable":"statusFaturamentoAnual","responseBodyVariable":"bodyFaturamentoAnual"},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"statusAlugueis"}]},{"$id":"9bd06132-6d83-48c5-b4a0-2e51b97ecf41","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyFaturamentoMensal\" (Faturamento Mensal)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/dados-referencias/gerenciamento-produtos/catalogo-produtos/assistente-virtual/v1/faturamentos?codigoEstabelecimentoComercial={{selectedEc@codigoEc}}&view=Mensal","responseStatusVariable":"statusFaturamentoMensal","responseBodyVariable":"bodyFaturamentoMensal"},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"statusAlugueis"}]},{"$id":"3e2d9fbf-e178-4d07-bfcb-f232e7753a58","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"nomeTipoEquipamento\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(numeroSerie, consultMaquina, tipoMaquina) {\n\ttry {\n\t\tconsultMaquina = JSON.parse(consultMaquina);\n\t\tconsultMaquina = consultMaquina.data.filter(consultMaquina => (consultMaquina.numeroSerie == numeroSerie))\n\t\tlet codigoTipoEquipamento = consultMaquina[0].codigoTipoEquipamento\n\t\tcodigoTipoEquipamento = codigoTipoEquipamento.toString()\n\t\tif (consultMaquina == \"C\") {\n\t\t\tif (codigoTipoEquipamento == 1 || codigoTipoEquipamento == 5) {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Mini'\n\t\t\t} else if (codigoTipoEquipamento == 2) {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Slim'\n\t\t\t} else if (codigoTipoEquipamento == 3) {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Pro'\n\t\t\t} else {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Smart'\n\t\t\t}\n\t\t} else {\n\t\t\tif (codigoTipoEquipamento == 15) {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Mini'\n\t\t\t} else if (codigoTipoEquipamento == 5) {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Slim'\n\t\t\t} else if (codigoTipoEquipamento == 1) {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Pro'\n\t\t\t} else {\n\t\t\t\tcodigoTipoEquipamento = 'SafraPay Smart'\n\t\t\t}\n\t\t}\n\t\treturn codigoTipoEquipamento;\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}\n\n","inputVariables":["numeroSerie","consultMaquina","tipoMaquina"],"outputVariable":"nomeTipoEquipamento","LocalTimeZoneEnabled":false},"conditions":[],"continueOnError":true},{"$id":"81a93fda-a400-4250-abe2-9795c97ee2a3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"descricaoStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyApolice) {\n\ttry {\n\t\tlet bodyApolice = JSON.parse(bodyApolice);\n\t\tlet descricaoStatus = bodyApolice.data[0].descricaoStatus\n\t\treturn descricaoStatus\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["bodyApolice"],"outputVariable":"descricaoStatus","LocalTimeZoneEnabled":false},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"statusApolice"}],"continueOnError":true},{"$id":"3f09cd4c-bd14-4a30-8ceb-a0fd50182141","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"mensagemMaquinaAlugada\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyApolice, bodyAlugueis, bodyFaturamentoMensal, bodyFaturamentoAnual, numeroSerie, numeroLogico, consultMaquina) {\n    try {\n        mensagem = ''\n        bodyAlugueis = JSON.parse(bodyAlugueis);\n        bodyApolice = JSON.parse(bodyApolice);\n        consultMaquina = JSON.parse(consultMaquina);\n        bodyFaturamentoMensal = JSON.parse(bodyFaturamentoMensal);\n        bodyFaturamentoAnual = JSON.parse(bodyFaturamentoAnual);\n\n        const formartValue = (valor) => {\n            return `R$ ${\n                parseFloat(valor)\n                    .toFixed(2)\n                    .replace(\".\", \",\")\n                    .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\")}`;\n        }\n        if (consultMaquina.data) {\n            consultMaquina = consultMaquina.data.filter(consultMaquina => (consultMaquina.numeroSerie === numeroSerie))\n            mensagem += `<b>{{nomeTipoEquipamento}}</b>\\n<b>N° de série:</b> ${numeroSerie}\\n\\n`\n        }\n        if (bodyAlugueis.data.length > 0) {\n            bodyAlugueis = bodyAlugueis.data.filter(bodyAlugueis => (bodyAlugueis.numeroSerie === numeroSerie))\n            mensagem += `<b>Aluguel contratual:</b> ${formartValue(bodyAlugueis[0].valorTabela)}/ mês \\n<b>Último valor pago:</b> ${formartValue(bodyAlugueis[0].valorPago)}\\n\\n`\n        }\n        if (bodyApolice.data) {\n            bodyApolice = bodyApolice.data.filter(bodyApolice => (bodyApolice.numeroSerie === numeroSerie))\n            if (bodyApolice.descricaoStatus === 'Vigente') {\n                mensagem += `<b>Seguro:</b> R$9,90/ mês\\n\\n`\n            }\n        }\n        if (bodyFaturamentoMensal.data) {\n            if (bodyFaturamentoMensal.data.length > 0) {\n                bodyFaturamentoMensal = bodyFaturamentoMensal.data.filter(bodyFaturamentoMensal => (bodyFaturamentoMensal.numeroLogico === numeroLogico))\n                if (bodyFaturamentoMensal.length > 0) {\n                    mensagem += `Valor realizado até agora: \\n• <b>Mensal:</b> ${formartValue(bodyFaturamentoMensal[0].vopRealizado)} \\n`\n                }\n            }\n        }\n        if (bodyFaturamentoAnual.data) {\n            if (bodyFaturamentoAnual.data.length > 0) {\n                bodyFaturamentoAnual = bodyFaturamentoAnual.data.filter(bodyFaturamentoAnual => (bodyFaturamentoAnual.numeroLogico === numeroLogico))\n                if (bodyFaturamentoAnual.length > 0) {\n                    mensagem += `• <b>Anual:</b> ${formartValue(bodyFaturamentoAnual[0].valorVop)} \\n`\n                }\n            }\n        }\n        return mensagem\n\n    }\n    catch (e) {\n        return e.message;\n    }\n}","inputVariables":["bodyApolice","bodyAlugueis","bodyFaturamentoMensal","bodyFaturamentoAnual","numeroSerie","numeroLogico","consultMaquina"],"outputVariable":"mensagemMaquinaAlugada","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"331d0cfe-8f21-4e6b-87ea-bd016f72fca6","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[]},{"$id":"a165671c-1bc6-43c1-8c62-d50531a04443","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"773fb672-7ef9-4df9-8e90-7fea3e31c9e0","$typeOfContent":"","type":"TrackEvent","$title":"Track api status","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status","action":"{{statusAlugueis}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusAlugueis"}]},{"$id":"e51f1266-ddf0-4ee0-bb32-27cd18cd0f5a","$typeOfContent":"","type":"TrackEvent","$title":"Track api status","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status 2","action":"{{statusApolice}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusApolice"}]},{"$id":"0ab29457-7b41-4896-9e3b-e7c99792296e","$typeOfContent":"","type":"TrackEvent","$title":"Track api status","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status 3","action":"{{statusFaturamentoAnual}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusFaturamentoAnual"}]},{"$id":"f1b9ae80-d4d3-441e-9dc8-35273e3e2f1b","$typeOfContent":"","type":"TrackEvent","$title":"Track api status","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status 4","action":"{{statusFaturamentoMensal}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusFaturamentoMensal"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-22912198-c026-430b-a600-390bbc059519","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-141b1644-1e64-45ca-8157-4f04f13fbfa4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-15dfe48c-7a53-4c33-9366-b2cea4d475cc","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-47129550-a4e9-4ea4-9587-5e86e43e5ef2","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-b96ba007-f71b-42a5-9081-776276e27e18","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e66b1d69-3e83-4e4d-9f57-5c2d84cd1ce5","root":false,"$title":"[TC.4.5.0][HTTP][SET] Alugada","$position":{"top":"2083px","left":"1154.78px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"df93c738-b6f9-4397-b7d0-e675bb78c31a":{"$contentActions":[{"action":{"$id":"7f442139-388f-41b4-b584-dfb5f1dc1bd7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7acb39b1-40fd-4972-8e3e-efd09394049e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7acb39b1-40fd-4972-8e3e-efd09394049e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1c708b57-8db0-4314-8a23-45b6ca625343","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"c09eb3c6-5ad9-4da9-a29d-62a22852e804","type":"application/vnd.lime.select+json","content":{"text":"Como deseja prosseguir?","scope":"immediate","options":[{"text":"Fazer outra consulta","previewText":"Fazer outra consulta","value":null,"index":0,"type":null},{"index":-1,"text":"Encerrar","previewText":"Encerrar","type":null,"value":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"c09eb3c6-5ad9-4da9-a29d-62a22852e804","type":"application/vnd.lime.select+json","content":{"text":"Como deseja prosseguir?","scope":"immediate","options":[{"text":"Fazer outra consulta","previewText":"Fazer outra consulta","value":null,"index":0,"type":null},{"index":-1,"text":"Encerrar","previewText":"Encerrar","type":null,"value":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"73db3d78-b7a6-40d2-aed0-09ed45b00c7d","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a987eb86-a520-4671-9e28-bcc98388eff4","typeOfStateId":"state","$connId":"con_113","$id":"5a504020-bbcf-44d3-8358-f38efe497ed6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e89a9dc1-f632-4dda-8ae2-a187c0eda3fe","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"873bff77-5942-43cf-b93e-c243b97775c1","$typeOfContent":"","type":"TrackEvent","$title":"Track validação","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{input.content}}"},"conditions":[{"values":["Fazer outra consulta","Encerrar"],"source":"input","comparison":"equals"}]},{"$id":"9a451ad2-91d5-434e-9fc7-77d891eabd8f","$typeOfContent":"","type":"TrackEvent","$title":"Track input inesperado","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["Fazer outra consulta","Encerrar"],"source":"input","comparison":"notEquals"},{"values":[],"source":"input","comparison":"exists"}]}],"$inputSuggestions":["Fazer outra consulta","Encerrar"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-22a36f0b-75bf-4cd7-af19-fe796cfcccb7","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-bb71fe07-7ba2-4742-a33a-ad6f9b169258","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"df93c738-b6f9-4397-b7d0-e675bb78c31a","root":false,"$title":"[TC.4.6.0][MSG] Como deseja prosseguir?","$position":{"top":"2349.33px","left":"1126.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f518ebdc-b60f-4359-9584-38c43f13952d":{"$contentActions":[{"action":{"$id":"11aa876f-fde7-49af-8a72-fbf853e78f87","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ede2dd51-d983-4110-9657-7d5373c6dc4c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ede2dd51-d983-4110-9657-7d5373c6dc4c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b9ef5e3-768e-463f-84f4-f00369df3685","$typeOfContent":"text","type":"SendMessage","settings":{"id":"439641e4-ca3c-45f0-96e4-ab2c403e23c0","type":"text/plain","content":"Estas são as taxas administrativas para a bandeira selecionada.👇","metadata":{}},"$cardContent":{"document":{"id":"439641e4-ca3c-45f0-96e4-ab2c403e23c0","type":"text/plain","content":"Estas são as taxas administrativas para a bandeira selecionada.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"778d041a-aed1-4440-9b45-f0f691cf4ee6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fdf01824-3e78-47c0-9ff6-a1cc7374b189","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"fdf01824-3e78-47c0-9ff6-a1cc7374b189","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4df37b47-c05d-4694-9b73-7d0527269b0f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"368339fd-ff04-4381-88eb-10c104782801","type":"text/plain","content":"<b>Taxas de Venda</b>            \nDébito {{taxasExibir@taxaDebitoAvistaEcommerce}}%\n\nCrédito à vista {{taxasExibir@taxaCreditoAVistaEcommerce}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2Ecommerce}}%\n3x {{taxasExibir@taxaCreditoParc3Ecommerce}}%\n4x {{taxasExibir@taxaCreditoParc4Ecommerce}}%\n5x {{taxasExibir@taxaCreditoParc5Ecommerce}}%\n6x {{taxasExibir@taxaCreditoParc6Ecommerce}}%\n7x {{taxasExibir@taxaCreditoParc7Ecommerce}}%\n8x {{taxasExibir@taxaCreditoParc8Ecommerce}}%\n9x {{taxasExibir@taxaCreditoParc9Ecommerce}}%\n10x {{taxasExibir@taxaCreditoParc10Ecommerce}}%\n11x {{taxasExibir@taxaCreditoParc11Ecommerce}}%\n12x {{taxasExibir@taxaCreditoParc12Ecommerce}}%","metadata":{}},"$cardContent":{"document":{"id":"368339fd-ff04-4381-88eb-10c104782801","type":"text/plain","content":"<b>Taxas de Venda</b>            \nDébito {{taxasExibir@taxaDebitoAvistaEcommerce}}%\n\nCrédito à vista {{taxasExibir@taxaCreditoAVistaEcommerce}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2Ecommerce}}%\n3x {{taxasExibir@taxaCreditoParc3Ecommerce}}%\n4x {{taxasExibir@taxaCreditoParc4Ecommerce}}%\n5x {{taxasExibir@taxaCreditoParc5Ecommerce}}%\n6x {{taxasExibir@taxaCreditoParc6Ecommerce}}%\n7x {{taxasExibir@taxaCreditoParc7Ecommerce}}%\n8x {{taxasExibir@taxaCreditoParc8Ecommerce}}%\n9x {{taxasExibir@taxaCreditoParc9Ecommerce}}%\n10x {{taxasExibir@taxaCreditoParc10Ecommerce}}%\n11x {{taxasExibir@taxaCreditoParc11Ecommerce}}%\n12x {{taxasExibir@taxaCreditoParc12Ecommerce}}%"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f45b6fd7-48d0-4900-a660-0a1d2a5afa4b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d75d80be-8d8a-4598-91c3-378a699d59c1","typeOfStateId":"state","$connId":"con_118","$id":"8d328538-b312-4a47-b244-c1009e93ed53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ec98b5c3-6785-4cc0-a384-c4c54cd055ce","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-154183fe-2b75-4a83-8387-03a8ab206815","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fed192f8-5bd8-4098-bc99-ba015316571b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f518ebdc-b60f-4359-9584-38c43f13952d","root":false,"$title":"[TC.2.0.3][MSG] Vendas Online","$position":{"top":"2022px","left":"124px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c4fec3d1-c20d-43de-9160-8a93f67989eb":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c9ba908c-18ee-43c9-8df0-e67e932e5074","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59d0589a-4bfe-427b-bcc3-37affdafab98","typeOfStateId":"state","$connId":"con_123","$id":"618ddfc5-3861-4bf8-bf0f-09716a47ed2f","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6351dc22-dbf5-45ef-8b20-20b11ec58f10","$typeOfContent":"","type":"TrackEvent","$title":"Track \"Chamada de API\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"Chamada de API","action":"taxas de venda"},"conditions":[]},{"$id":"d26ebb81-ba5a-4b15-819d-0d6958cb3e2d","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"taxaVendasBody\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json"},"method":"GET","uri":"{{config.urlCHT}}/chat-assistente/safra-pay/v1/taxas?idEstabelecimento={{selectedEc@codigoEc}}","responseStatusVariable":"taxaVendasStatus","responseBodyVariable":"taxaVendasBody"},"conditions":[]},{"$id":"d4ce97b8-edb3-4487-9f2e-fe595994d156","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"65307932-92ca-4dc3-bd89-e10747cf3189","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{assunto}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"assunto"}]},{"$id":"782f10e2-21c3-45f2-a538-9e38096e71ac","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["taxaVendasStatus"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4c7456f8-b627-4dad-9114-140625a2d85f","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/safra-pay/v1/taxas?idEstabelecimento={{selectedEc@codigoEc}} | GET| {{taxaVendasStatus}} | {{taxaVendasBody}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"cf099b84-c643-44a6-b404-de4b22643e5b","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"taxaVendasStatus"}]},{"$id":"277fd422-273e-4a88-be82-1d17db2f376c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{taxaVendasStatus}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxaVendasStatus"}]},{"$id":"56f05097-38b4-44f2-ac67-51e8bf30bd7a","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-501d9f3b-2419-4bee-aa78-f504a72c9561","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0369c734-f75e-4587-ab60-1de8f38ac78e","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-1736d355-f962-46b5-b082-307c71ca4e5e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5a90ab75-f67f-49a9-8a11-b749d8dbf03b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"c4fec3d1-c20d-43de-9160-8a93f67989eb","root":false,"$title":"[TC.2.0.0][HTTP] API Taxas de Venda","$position":{"top":"418px","left":"323px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e383d0a7-ef06-403b-9293-485753c8ceb0":{"$contentActions":[{"action":{"$id":"11aa876f-fde7-49af-8a72-fbf853e78f87","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ede2dd51-d983-4110-9657-7d5373c6dc4c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ede2dd51-d983-4110-9657-7d5373c6dc4c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b9ef5e3-768e-463f-84f4-f00369df3685","$typeOfContent":"text","type":"SendMessage","settings":{"id":"439641e4-ca3c-45f0-96e4-ab2c403e23c0","type":"text/plain","content":"Estas são as taxas administrativas para a bandeira selecionada.👇","metadata":{}},"$cardContent":{"document":{"id":"439641e4-ca3c-45f0-96e4-ab2c403e23c0","type":"text/plain","content":"Estas são as taxas administrativas para a bandeira selecionada.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a8268dd6-051b-4645-be9c-6d892c9de125","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"464e7155-32b8-4d20-99b5-a36cdc87e0d3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"464e7155-32b8-4d20-99b5-a36cdc87e0d3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ee0f713e-1ae3-4702-a494-79e02c4d66b2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bda2880e-1fb3-4256-bc1b-a378648f5ae4","type":"text/plain","content":"<b>Taxas de Venda</b>              \nDébito {{taxasExibir@taxaDebitoAvista}}%\n\nCrédito à vista {{taxasExibir@taxaCreditoAVista}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2}}%\n3x {{taxasExibir@taxaCreditoParc3}}%\n4x {{taxasExibir@taxaCreditoParc4}}%\n5x {{taxasExibir@taxaCreditoParc5}}%\n6x {{taxasExibir@taxaCreditoParc6}}%\n7x {{taxasExibir@taxaCreditoParc7}}%\n8x {{taxasExibir@taxaCreditoParc8}}%\n9x {{taxasExibir@taxaCreditoParc9}}%\n10x {{taxasExibir@taxaCreditoParc10}}%\n11x {{taxasExibir@taxaCreditoParc11}}%\n12x {{taxasExibir@taxaCreditoParc12}}%","metadata":{}},"$cardContent":{"document":{"id":"bda2880e-1fb3-4256-bc1b-a378648f5ae4","type":"text/plain","content":"<b>Taxas de Venda</b>              \nDébito {{taxasExibir@taxaDebitoAvista}}%\n\nCrédito à vista {{taxasExibir@taxaCreditoAVista}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2}}%\n3x {{taxasExibir@taxaCreditoParc3}}%\n4x {{taxasExibir@taxaCreditoParc4}}%\n5x {{taxasExibir@taxaCreditoParc5}}%\n6x {{taxasExibir@taxaCreditoParc6}}%\n7x {{taxasExibir@taxaCreditoParc7}}%\n8x {{taxasExibir@taxaCreditoParc8}}%\n9x {{taxasExibir@taxaCreditoParc9}}%\n10x {{taxasExibir@taxaCreditoParc10}}%\n11x {{taxasExibir@taxaCreditoParc11}}%\n12x {{taxasExibir@taxaCreditoParc12}}%"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f45b6fd7-48d0-4900-a660-0a1d2a5afa4b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d75d80be-8d8a-4598-91c3-378a699d59c1","typeOfStateId":"state","$connId":"con_128","$id":"2b19bb33-2cc7-40d2-929f-3a0129508c75","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b0aee7cc-d081-4b06-8483-6fe6978a463c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-bf416dd1-0014-4f10-a1c5-c8b074c9a88d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f7865115-b000-435c-a31b-f6963bda7659","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e383d0a7-ef06-403b-9293-485753c8ceb0","root":false,"$title":"[TC.2.0.4][MSG] Vendas Físicas","$position":{"top":"2016px","left":"512px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b8de541a-4234-4125-9502-46ade2ce536a":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"0f933b67-ad42-44b2-bcfd-df79cd621cb1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"5d8a18cc-a583-4083-9025-67ca4d472aaf","typeOfStateId":"state","$connId":"con_133","$contentId":"5ee9ede9-f00e-4aa8-912e-ca7d4f80e845","$id":"3377e1e8-dab7-400d-85bf-33928652051d","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"9262b032-7ea2-45d2-b782-2649ddad61b9","typeOfStateId":"state","$connId":"con_138","$id":"686eaa78-4b81-443f-88e2-a0818ad41a76","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"e87ccb23-260e-4848-9c4d-86856a602879","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const validInputMessage = \"Input inesperado\"\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"n[ãa]o|naum\": \"Não\",\n      \"sim|sin\": \"Sim\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return validInputMessage\n  } catch (err) {\n    return validInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4a07e14c-4fff-4c1e-99e0-aba5811f4fa7","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"82cbc05c-b485-4cbd-b6cf-22003b02f606","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"da4c1bc5-231c-4d5d-9a14-8f6da7cb821e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-d9f2f466-2dd6-4a04-8cb5-1a75feafb26f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c910c335-4ad0-4ea8-95c4-6e540c762748","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-7f9e11a6-0f4e-414d-b290-9d9094ab3f79","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f08f4db0-8569-4b08-be6c-1db6e8dfb9ca","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b8de541a-4234-4125-9502-46ade2ce536a","root":false,"$title":"[TC.2.2.1][INPUT] Consultar Taxas","$position":{"top":"3225.7px","left":"349.435px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5645aa88-959e-46a7-af25-0e32ed445e49":{"$contentActions":[{"action":{"$id":"7dc6c119-7d10-4d3b-b6a6-ea3e5a8433e7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cdd809de-7203-4b20-81da-23a4f30cf05d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cdd809de-7203-4b20-81da-23a4f30cf05d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"97a00499-b5cf-430e-a016-5ffb5474ff9f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7a8e5044-1ad8-4261-b4d8-2bb8d6bb06c4","type":"text/plain","content":"Estas são as taxas de antecipação do seu plano 👇\n\nCrédito à vista: <b>{{taxaAnteAuto@taxaAVista}}%</b>\n\nCrédito parcelado: <b>{{taxaAnteAuto@taxaParcelado}}%</b>\n\nTaxa Link de Pagamento: <b>R$ 0,90 por transação + MDR E-commerce</b>","metadata":{}},"$cardContent":{"document":{"id":"7a8e5044-1ad8-4261-b4d8-2bb8d6bb06c4","type":"text/plain","content":"Estas são as taxas de antecipação do seu plano 👇\n\nCrédito à vista: <b>{{taxaAnteAuto@taxaAVista}}%</b>\n\nCrédito parcelado: <b>{{taxaAnteAuto@taxaParcelado}}%</b>\n\nTaxa Link de Pagamento: <b>R$ 0,90 por transação + MDR E-commerce</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"134f75db-4f3c-4658-91e9-26e165171534","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7320750f-5a23-4919-af98-035b1dbcb917","typeOfStateId":"state","$connId":"con_143","$id":"915085d6-f45c-432e-9da4-b2aa72db323a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ac61989a-4ee1-47fc-bfed-17ffe2bd31e1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxaAnteAuto\"","$invalid":false,"settings":{"function":"run","source":"function run(taxaBody) {\n\ttry {\n\t\tlet taxaBody = JSON.parse(taxaBody);\n\t\ttaxaBody = taxaBody.automatica\n\t\ttaxaBody.taxaAVista = parseFloat(taxaBody.taxaAVista).toFixed(2).toString().replace('.', ',')\n\t\ttaxaBody.taxaParcelado = parseFloat(taxaBody.taxaParcelado).toFixed(2).toString().replace('.', ',')\n\t\treturn JSON.stringify(taxaBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaAntecipacao"],"outputVariable":"taxaAnteAuto","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4a99a272-e297-495d-b3a5-3e10d0eeff74","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e255f20d-1de9-44c8-a819-278e10ba80cc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2c0713d5-534d-4715-8915-0a68dd89a7ae","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-c0888505-53cd-4309-96d8-4e0f42c4ff95","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"5645aa88-959e-46a7-af25-0e32ed445e49","root":false,"$title":"[TC.3.1.0][MSG] Exibe Taxas de Antecipação","$position":{"top":"660.667px","left":"670.667px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6159148f-ca32-497c-a843-838a5bc20b0e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"e6e9700d-c3f2-487e-a7db-d5bd68c88280","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"ba86d697-73e1-47ee-9a6a-0c58a46a207b","typeOfStateId":"state","$connId":"con_148","$contentId":"6936603a-fa1f-4d47-be1b-68d6e7924e62","$id":"b872a097-7b98-44b8-a3d6-f9790c7a3217","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"e1923532-1bfa-4ab5-8de3-6eba5248bfa6","typeOfStateId":"state","$connId":"con_153","$contentId":"6936603a-fa1f-4d47-be1b-68d6e7924e62","$id":"85006734-a60f-4298-b5bf-a2ad964e01fb","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"13e8c63a-d63d-43c5-aba3-e2dffeb86b4b","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const validInputMessage = \"Input inesperado\"\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"n[ãa]o|naum\": \"Não\",\n      \"sim|sin\": \"Sim\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return validInputMessage\n  } catch (err) {\n    return validInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"55b0637c-cd7c-4bda-ae00-0c782a849a39","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"dda0d594-7c05-4f4b-aa7c-d3b2160c4d54","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"a8298872-dd92-4fba-86ce-1bf343943c9a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-76cd2484-8388-47db-9a15-6101c8ea55f5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c0c04b57-8ed4-438e-8424-6fd92438ece8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6b859342-9426-4266-ab90-a642594b38ed","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-08d670da-ed5a-43ff-a9b2-7a80d10c86ff","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"6159148f-ca32-497c-a843-838a5bc20b0e","root":false,"$title":"[TC.2.2.2][INPUT] Taxa atual","$position":{"top":"3236px","left":"907.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a65258c3-241a-4ab6-94b7-d3b0cfdb7ccd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c9ba908c-18ee-43c9-8df0-e67e932e5074","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c950fde0-4616-49b2-9f39-a0ba859beab4","typeOfStateId":"state","$connId":"con_158","$id":"22905db9-e90e-43ff-8696-1c5190ea55bf","conditions":[{"source":"context","comparison":"equals","values":["SEM ARV","\"SEM ARV\""],"variable":"taxaModalidade"}],"$invalid":false},{"stateId":"c07b1d82-9004-40cc-a93c-f0cabb17f9a7","typeOfStateId":"state","$connId":"con_163","$id":"57625472-6942-43b7-acc1-422abf536dd2","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"taxaModalidade"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bd4ca2d9-b36e-40a4-9cae-085b4e5e085a","$typeOfContent":"","type":"TrackEvent","$title":"Chamada de API","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"Chamada de API","action":"consulta taxas de atencipação do plano"},"conditions":[]},{"$id":"e448899d-10fa-4137-81e9-3cf6f9cd8551","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"taxaBody\" (taxa)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/operacoes-execucoes/servicos-consumidores/antecipacoes-recebiveis/assistente-virtual/v1/estabelecimentos/{{selectedEc@codigoEc}}?view=taxas-antecipacao","responseStatusVariable":"taxaStatus","responseBodyVariable":"taxaBody"},"conditions":[]},{"$id":"695557b3-8de1-433c-9df5-df9491e5b200","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxaAntecipacao\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(taxaBody) {\n\ttry {\n\t\tlet taxaBody = JSON.parse(taxaBody);\n\t\ttaxaBody = taxaBody.data\n\t\treturn JSON.stringify(taxaBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaBody"],"outputVariable":"taxaAntecipacao","LocalTimeZoneEnabled":false},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"taxaStatus"}]},{"$id":"8a14a865-fe46-4720-a100-febd2918a05f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxaModalidade\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(taxaBody) {\n\ttry {\n\t\tlet taxaBody = JSON.parse(taxaBody);\n\t\ttaxaBody = taxaBody.modalidade\n\t\treturn JSON.stringify(taxaBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaAntecipacao"],"outputVariable":"taxaModalidade","LocalTimeZoneEnabled":false},"conditions":[{"values":["200"],"source":"context","comparison":"equals","variable":"taxaStatus"}]},{"$id":"33134da2-5316-46f3-b06b-23738c3b2e35","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"taxaVendasBody\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json"},"method":"GET","uri":"{{config.urlCHT}}/chat-assistente/safra-pay/v1/taxas?idEstabelecimento={{selectedEc@codigoEc}}","responseStatusVariable":"taxaVendasStatus","responseBodyVariable":"taxaVendasBody"},"conditions":[]},{"$id":"d567bfc0-f86e-4dea-b20e-af94875bb1bc","$typeOfContent":"","type":"SetVariable","$title":"menuTaxaAntecipacao","$invalid":false,"settings":{"variable":"menuTaxaAntecipacao","value":"true"},"conditions":[]},{"$id":"8c64ff42-a17e-4704-b6db-f97d8a4fb8c6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"928746a8-2536-43c8-8978-eeeafd5edd6e","$typeOfContent":"","type":"TrackEvent","$title":"Track api status","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status","action":"{{taxaVendasStatus}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxaVendasStatus"}]},{"$id":"fcc265ea-5b13-4088-aeeb-cd4b162e7049","$typeOfContent":"","type":"TrackEvent","$title":"Track api status","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} api status","action":"{{taxaStatus}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxaStatus"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-54270fa7-b904-42a7-aa20-4f86561217db","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ca891754-087d-445d-b06d-0eaff87bba67","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-bc347ebd-6872-4c71-8c6d-6944b9ff149e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-dcab2308-52e1-425c-86d8-f09467c4d2f1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"a65258c3-241a-4ab6-94b7-d3b0cfdb7ccd","root":false,"$title":"[TC.2.2.0][HTTP] API Taxas de Antecipação","$position":{"top":"2724.3px","left":"616.652px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"17828cf7-5217-4cf1-bf9e-1393e96afaac":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"0b3f2fd0-0767-43e5-bf5c-0e68bd381735","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"ba86d697-73e1-47ee-9a6a-0c58a46a207b","typeOfStateId":"state","$connId":"con_168","$id":"bce4a201-43c2-46d5-a792-7893d09d71cc","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"9262b032-7ea2-45d2-b782-2649ddad61b9","typeOfStateId":"state","$connId":"con_173","$id":"74ac6ea0-7c09-48fe-8bf7-6e64f8221dcd","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b2db99-147a-41df-817a-5cec535467fb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const validInputMessage = \"Input inesperado\"\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"n[ãa]o|naum\": \"Não\",\n      \"sim|sin\": \"Sim\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return validInputMessage\n  } catch (err) {\n    return validInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3f3e7f55-532a-433c-804c-b2f0a140fc4f","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"10a069a8-1962-4edc-9831-5baf203f2394","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"f50f4e4c-8aa0-4bf2-bc9e-646575d0c32b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f5bce25a-ee66-4e13-b1d8-24dfc4ca8377","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5b1d6b6a-7cde-4929-8f6c-eb0dd93e9f9c","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c8f3e5da-17e5-47b1-bdde-fc6b68756d51","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-07d186eb-af2b-4aad-8fa7-4cc4503ec39f","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"17828cf7-5217-4cf1-bf9e-1393e96afaac","root":false,"$title":"[TC.2.2.3][INPUT] Questionar Transferência","$position":{"top":"3732px","left":"882px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"91dec6e6-2e08-462d-8d81-d38d2b223594":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c9ba908c-18ee-43c9-8df0-e67e932e5074","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e96a7ac0-b61c-4db5-b006-4b9ec1d43c9a","typeOfStateId":"state","$connId":"con_178","$id":"d55ad3ed-f8b1-496b-b01c-4626b5519d0f","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"2f2770af-6c97-4d04-80b0-169de09b0bc6","$typeOfContent":"","type":"TrackEvent","$title":"Track \"Chamada de API\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"Chamada de API","action":"Taxas Pix na Safrapay"},"conditions":[]},{"$id":"e448899d-10fa-4137-81e9-3cf6f9cd8551","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"taxaBody\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/operacoes-execucoes/servicos-consumidores/antecipacoes-recebiveis/assistente-virtual/v1/estabelecimentos/{{selectedEc@codigoEc}}?view=taxas-antecipacao","responseStatusVariable":"taxaStatus","responseBodyVariable":"taxaBody"},"conditions":[]},{"$id":"695557b3-8de1-433c-9df5-df9491e5b200","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxaAntecipacao\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(taxaBody) {\n\ttry {\n\t\tlet taxaBody = JSON.parse(taxaBody);\n\t\ttaxaBody = taxaBody.data\n\t\treturn JSON.stringify(taxaBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaBody"],"outputVariable":"taxaAntecipacao","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"8a14a865-fe46-4720-a100-febd2918a05f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxaModalidade\"","$invalid":false,"settings":{"function":"run","source":"function run(taxaBody) {\n\ttry {\n\t\tlet taxaBody = JSON.parse(taxaBody);\n\t\ttaxaBody = taxaBody.modalidade\n\t\treturn JSON.stringify(taxaBody);\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["taxaAntecipacao"],"outputVariable":"taxaModalidade","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"33134da2-5316-46f3-b06b-23738c3b2e35","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"taxaVendasBody\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json"},"method":"GET","uri":"{{config.urlCHT}}/chat-assistente/safra-pay/v1/taxas?idEstabelecimento={{selectedEc@codigoEc}}","responseStatusVariable":"taxaVendasStatus","responseBodyVariable":"taxaVendasBody"},"conditions":[]},{"$id":"491b740f-f7d9-45c5-af29-6333b4449505","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxasPix\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(taxaVendasBody) {\n\t\n\tlet taxaVendasBody =  JSON.parse(taxaVendasBody);\n\ttaxaVendasBody = taxaVendasBody.data\n\ttaxaVendasBody = taxaVendasBody.filter(taxaVendasBody => (taxaVendasBody.codigoBandeira == 'PIXD'))\n\ttaxaVendasBody = taxaVendasBody[0].taxaDebitoAvista\n\ttaxaVendasBody = taxaVendasBody.toString().replace('.', ',')\n\treturn taxaVendasBody;\n\n\t}","inputVariables":["taxaVendasBody"],"outputVariable":"taxasPix","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"195009ac-5895-4746-930f-26f8df5c95b7","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]},{"$id":"03a1c0ba-a345-4daa-a5de-905ae4b1e12f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"450b7e0a-0768-4f9e-a899-0aa21b56c4c5","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{assunto}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"assunto"}]},{"$id":"4127e20c-31ec-4313-80e2-d669c45b8ce3","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["taxaStatus"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"10214018-fed3-4950-aeb9-d697b527da11","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"{state.name} api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/operacoes-execucoes/servicos-consumidores/antecipacoes-recebiveis/assistente-virtual/v1/estabelecimentos/{{selectedEc@codigoEc}}?view=taxas-antecipacao | GET| {{taxaStatus}} | {{taxaBody}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"a8a3b25a-5c56-4024-a862-6255368d2a1b","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[]},{"$id":"7e15fb11-de23-458f-b2a4-f52a66f66f70","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{taxaStatus}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxaStatus"}]},{"$id":"43f159c7-9d9d-4fb3-be14-20f3a4df1ded","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status 2\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status 2","action":"{{taxaVendasStatus}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"taxaVendasStatus"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-0283febe-cc73-455e-99b7-4bbed723c277","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-65c4876f-183a-4c8e-b67e-ead7b86bf6ae","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-50479165-cf3a-446c-a92f-59bb3f32103e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2bd22ea2-d3de-4217-a778-14e826a3837b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"91dec6e6-2e08-462d-8d81-d38d2b223594","root":false,"$title":"[TC.5.0.0][HTTP] API Taxas Pix na SafraPay","$position":{"top":"396px","left":"2735px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"49787b51-0156-44fc-8565-77b607d79509":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"37286ef7-791d-4af5-938f-fd2600482e21","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a93d6907-ae20-48eb-afeb-42de5c3bc9ba","typeOfStateId":"state","$connId":"con_183","$id":"1a57abde-00c0-4694-aad8-3bec7368dbe7","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"18eb9e2c-4309-4ebc-81ee-6eecba46c7a3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"ebf8e269-e204-4873-a66f-b1157e4c5094","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivoProtocolo\" to \"questionarUmaCobranca\"","$invalid":false,"settings":{"variable":"motivoProtocolo","value":"questionarUmaCobranca"},"conditions":[]},{"$id":"d46ba7ea-d135-4cb2-9695-f43fc214c06e","type":"ExecuteScript","$title":"Process \"payloadProtocolo\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(contaSelecionada) {\n    try {\n        const { doc, codigoSegmento } = JSON.parse(contaSelecionada)\n        const payload = JSON.stringify({\n            origemDesc: \"CLIENTE\",\n            idSegmento: parseInt(codigoSegmento),\n            CpfCnpj: doc,\n            canalDesc: \"WHATSAPP\",\n            statusDesc: 'ABERTO',\n            usuarioInclusao: 'USR_SPD'\n        })\n        return payload;\n    }\n    catch (e) {\n        return false;\n    }\n}\n\n","inputVariables":["contaSelecionada"],"outputVariable":"payloadProtocolo","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"70cd3530-a826-4b84-9381-0f299c51e143","type":"ProcessHttp","$title":"HTTP POST \"bodyProtocoloBpm\" (Cria Protocolo no Front)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Correlation-ID":"{{random.guid}}"},"method":"POST","body":"{{payloadProtocolo}}","uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos","responseStatusVariable":"statusProtocoloBpm","responseBodyVariable":"bodyProtocoloBpm"},"conditions":[]},{"$id":"df5da49c-4330-4f1e-902f-115da63bca8a","type":"ExecuteScript","$title":"Process \"idProtocoloBpm\" (Pega Id do protocolo BPM)","$invalid":false,"settings":{"function":"run","source":"function run(protocolo) {\n    try {\n        const protocoloId = JSON.parse(protocolo);\n        return protocoloId.data.id;\n    }\n    catch (err) {\n        return \"Falha ao abrir protocolo, tente novamente em alguns instantes.\"\n    }\n}\n","inputVariables":["bodyProtocoloBpm"],"outputVariable":"idProtocoloBpm","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dd7ad50b-8d3d-4de6-b79e-0589d7bbb546","type":"ExecuteScript","$title":"Process \"descricacaoProtocolo\"","$invalid":false,"settings":{"function":"run","source":"function run(idProtocolo, idSubMotivo, motivoQuestionamentoCobranca, origemCobranca, localVisualizacaoCobranca, dataCobranca, valorCobranca, contaSelecionada, identity) {\n    try {\n        const { doc } = JSON.parse(contaSelecionada);\n        let phone = identity.split('@')[0];\n        const observacaoSolucaoAtendimento = `Criação automática WhatsApp PJ CPF/CNPJ: ${doc} | Telefone: ${phone} | Origem da cobrança: ${origemCobranca} | Local de visualização: ${localVisualizacaoCobranca} | Data da cobrança: ${dataCobranca} | Valor da cobrança: ${valorCobranca} | Motivo do questionamento: ${motivoQuestionamentoCobranca}`\n        return observacaoSolucaoAtendimento;\n    }\n    catch (e) {\n        return e.message;\n    }\n}\n","inputVariables":["idProtocoloBpm","idSubMotivo","motivoQuestionamentoCobranca","origemCobranca","localVisualizacaoCobranca","dataCobranca","valorCobranca","contaSelecionada","contact.identity"],"outputVariable":"descricacaoProtocolo","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"statusProtocoloBpm","values":["200"]}]},{"$id":"1e6f0754-21fd-4a65-8ecf-d9945632b0e7","type":"ExecuteScript","$title":"Process \"payloadOcorrencia\" (Gera payload ocorrencia)","$invalid":false,"settings":{"function":"run","source":"function run(body, routerId, motivo, description) {\n    try {\n        const { tipoId, motivoId, subMotivoId } = JSON.parse(body)[routerId][motivo];\n        const newBody = {\n            tipoId,\n            motivoId,\n            subMotivoId,\n            statusProcessamentoDesc: 'ABERTO',\n            usuarioInclusao: 'USR_SPD',\n            observacaoSolucaoAtendimento: description || '',\n            origem: 'CLIENTE',\n        }\n        return newBody\n    } catch (err) {\n        return false\n    }\n}","inputVariables":["resource.taxionomiaProtocolos","tunnel.owner","motivoProtocolo","descricacaoProtocolo"],"outputVariable":"payloadOcorrencia","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fa02da61-b215-4245-b6e4-9797d84c4640","type":"ProcessHttp","$title":"HTTP POST \"bodyOcorrencia\" (Cria nova ocorrencia)","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"POST","body":"{{payloadOcorrencia}}","uri":"{{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}/ocorrencias","responseStatusVariable":"statusOcorrencia","responseBodyVariable":"bodyOcorrencia"},"conditions":[]},{"$id":"1a912343-f4cf-4034-9475-d65e6eb985c4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusOcorrencia","statusProtocoloBpm"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"9c568522-7ba7-443a-85ed-3614007b6b97","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[{"values":["200"],"source":"context","comparison":"notEquals","variable":"statusOcorrencia"}]},{"$id":"c23312f4-f674-4998-acbe-1c5b77ce59e8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{},"category":"{{state.name}} api status","action":"{{apiStatus}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"apiStatus"}]},{"$id":"a079121b-0d85-4eb2-aea4-41eb9f3c20c8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api resumo\" (POST) (PROTOCOLO)","$invalid":false,"settings":{"extras":{},"action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos | {{payloadProtocolo}} | {{statusProtocoloBpm}} | {{bodyProtocoloBpm}}","category":"{{state.name}} api resumo"},"conditions":[]},{"$id":"580ed6dc-82b4-4367-a2a3-a05c5676a816","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api resumo\" (POST) (OCORRENCIA)","$invalid":false,"settings":{"extras":{},"action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/protocolos/v1/protocolos/{{idProtocoloBpm}}/ocorrencias | {{payloadOcorrencia}} | {{statusOcorrencia}} | {{bodyOcorrencia}}","category":"{{state.name}} api resumo 2"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-f018482a-0b6c-4ea1-9848-7512de3b0cf5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e5ee23f6-622c-4b33-9bd1-6cbd7aa557b5","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-db15217c-8802-4627-a705-90547eeca118","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fbcf92d1-7791-4c0a-85f9-401e41936568","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false}],"id":"49787b51-0156-44fc-8565-77b607d79509","root":false,"$title":"[TC.7.4.0][HTTP] API Protocolo","$position":{"top":"2890.67px","left":"3067px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"46f819c5-9a97-4c4c-9a09-e363d6736ae1":{"$contentActions":[{"action":{"$id":"63f14278-b91e-4558-9eed-ed6d7a2eb3bb","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"83d18b92-19f5-42ec-ae50-e0da12377812","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"83d18b92-19f5-42ec-ae50-e0da12377812","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2789570d-4fd6-40c0-9611-cc39778c9f02","$typeOfContent":"text","type":"SendMessage","settings":{"id":"9d5499f9-da1f-4602-ab14-28cb51b8680c","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, por gentileza, digite o número de série da máquina que deseja consultar. ","metadata":{}},"$cardContent":{"document":{"id":"9d5499f9-da1f-4602-ab14-28cb51b8680c","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, por gentileza, digite o número de série da máquina que deseja consultar. "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"08e89268-5095-4ea9-ad7f-0f0acce72de2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7ded1836-11d0-4d83-b483-f13d21231cc1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"7ded1836-11d0-4d83-b483-f13d21231cc1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d14aaf51-691e-4e5a-a959-0c27d9b4d9bf","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b36fd54d-2c70-4f38-b720-a2a46535d8ae","type":"text/plain","content":"Você encontra esse número digitando <b>998</b> na sua maquininha.","metadata":{}},"$cardContent":{"document":{"id":"b36fd54d-2c70-4f38-b720-a2a46535d8ae","type":"text/plain","content":"Você encontra esse número digitando <b>998</b> na sua maquininha."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"dfd199b8-ed5e-44e2-b226-65990f659223","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"62786aa5-df6a-4069-9147-36ff1377b02c","typeOfStateId":"state","$connId":"con_188","$id":"4dd0c988-12da-4474-ae18-e5c5a8fa6be7","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"96b77a4f-874d-4f45-b466-86bd372dc95b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-241220de-f886-44cf-b25c-2253d86a0e11","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a9e28540-f56a-4078-8374-54db7ca887ee","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"46f819c5-9a97-4c4c-9a09-e363d6736ae1","root":false,"$title":"[TC.4.2.0][MSG] Numero de Série (Maquina> 10)","$position":{"top":"1197.5px","left":"867.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e96a7ac0-b61c-4db5-b006-4b9ec1d43c9a":{"$contentActions":[{"action":{"$id":"f8fa853e-700e-4f48-ba19-33f90b6e782f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e57eb20d-7921-4755-a04c-b41513ac6481","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e57eb20d-7921-4755-a04c-b41513ac6481","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ff75ff17-3c6e-4acb-82bb-8a0e45e129c3","$typeOfContent":"text","type":"SendMessage","settings":{"id":"dd1844a7-e15f-49a8-9ec9-9eebda2a8c7f","type":"text/plain","content":"É uma taxa de {{taxasPix}}% por transação, descontada de todo valor que você recebe vendendo por QR Code, Pix na maquininha e Pix no link de pagamento.\n\nO valor descontado é de no mínimo R$0,05 e no máximo R$10,00.","metadata":{}},"$cardContent":{"document":{"id":"dd1844a7-e15f-49a8-9ec9-9eebda2a8c7f","type":"text/plain","content":"É uma taxa de {{taxasPix}}% por transação, descontada de todo valor que você recebe vendendo por QR Code, Pix na maquininha e Pix no link de pagamento.\n\nO valor descontado é de no mínimo R$0,05 e no máximo R$10,00."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a99a7d66-b761-4ad6-b03b-8a30b7f3fcca","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"51355431-b5dd-488e-985b-a98da7ee0fe9","typeOfStateId":"state","$connId":"con_193","$id":"e3335c7b-8a2e-4d1d-87bb-a815e015cf94","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ea6d1af7-f481-4e9c-8c48-cb3937f7b9a0","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9bf5884a-794b-488a-8e6d-089cef56d473","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4ad2700f-e053-4f36-b238-e8491924922f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e96a7ac0-b61c-4db5-b006-4b9ec1d43c9a","root":false,"$title":"[TC.5.1.0][MSG] Exibir Taxas Pix na SafraPay","$position":{"top":"609px","left":"2735px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0e6bc8ca-977f-40d6-9ccf-23d15a44268b":{"$contentActions":[{"action":{"$id":"5f6b87a3-3944-4115-bc8e-f78cc3186984","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7e0aa8c5-c7e2-465c-adad-5f65ab2a9b85","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7e0aa8c5-c7e2-465c-adad-5f65ab2a9b85","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a167b679-ba67-479e-80f7-b1b7fccce5ff","$typeOfContent":"text","type":"SendMessage","settings":{"id":"cde791f3-9c29-44ec-a661-3110b752a236","type":"text/plain","content":"<b>{{nomeTipoEquipamento}}</b>\n<b>N° de série:</b> {{numeroserie}}\n\n<b>Comprada em:</b> {{dataInstalacao}}\n","metadata":{}},"$cardContent":{"document":{"id":"cde791f3-9c29-44ec-a661-3110b752a236","type":"text/plain","content":"<b>{{nomeTipoEquipamento}}</b>\n<b>N° de série:</b> {{numeroserie}}\n\n<b>Comprada em:</b> {{dataInstalacao}}\n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f0c472da-c63a-4870-9520-42afef193343","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"df93c738-b6f9-4397-b7d0-e675bb78c31a","typeOfStateId":"state","$connId":"con_198","$id":"1593e51d-6927-4b74-b690-c37b1d5d1995","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"93340493-deb2-4640-810a-bf5562534f58","$typeOfContent":"","type":"TrackEvent","$title":"Chamada de API","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"Chamada de API","action":"Consulta Máquinas e traz compradas."},"conditions":[]},{"$id":"b4375fd5-30ea-4508-9cb1-8c0f6b52aa4d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroLogico\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(consultMaquina, numeroSerie) {\n\tlet consultMaquina = JSON.parse(consultMaquina);\n\tconsultMaquina = consultMaquina.data.filter( consultMaquina => (consultMaquina.numeroSerie == numeroSerie))\n\tlet numeroLogico = consultMaquina[0].numeroLogico\n\treturn numeroLogico; \n}\n\n","inputVariables":["consultMaquina","numeroSerie"],"outputVariable":"numeroLogico","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3e2d9fbf-e178-4d07-bfcb-f232e7753a58","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"nomeTipoEquipamento\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(numeroSerie, consultMaquina, tipoMaquina) {\n\tlet consultMaquina = JSON.parse(consultMaquina);\n\tconsultMaquina = consultMaquina.data.filter(consultMaquina => (consultMaquina.numeroSerie == numeroSerie))\n\tlet codigoTipoEquipamento = consultMaquina[0].codigoTipoEquipamento\n\tcodigoTipoEquipamento = codigoTipoEquipamento.toString()\n\tif (consultMaquina == \"C\") {\n\t\tif (codigoTipoEquipamento == 1 || codigoTipoEquipamento == 5) {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Mini'\n\t\t} else if (codigoTipoEquipamento == 2) {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Slim'\n\t\t} else if (codigoTipoEquipamento == 3) {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Pro'\n\t\t} else {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Smart'\n\t\t}\n\t} else {\n\t\tif (codigoTipoEquipamento == 15) {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Mini'\n\t\t} else if (codigoTipoEquipamento == 5) {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Slim'\n\t\t} else if (codigoTipoEquipamento == 1) {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Pro'\n\t\t} else {\n\t\t\tcodigoTipoEquipamento = 'SafraPay Smart'\n\t\t}\n\t}\n\treturn codigoTipoEquipamento;\n}\n\n","inputVariables":["numeroSerie","consultMaquina","tipoMaquina"],"outputVariable":"nomeTipoEquipamento","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"151e23a0-7abf-48e2-a272-1471fc338f46","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dataInstalacao\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(consultMaquina, numeroSerie) {\n\tlet consultMaquina = JSON.parse(consultMaquina);\n\tconsultMaquina = consultMaquina.data.filter(consultMaquina => (consultMaquina.numeroSerie == numeroSerie))\n\tlet dataInstalacao = consultMaquina[0].dataInstalacao\n\n\n\t// Criando um objeto Date com a data fornecida\n\tconst dataObj = new Date(dataInstalacao);\n\n\t// Obtendo os componentes da data\n\tconst dia = String(dataObj.getDate()).padStart(2, '0');\n\tconst mes = String(dataObj.getMonth() + 1).padStart(2, '0'); // Os meses começam do zero, então somamos 1\n\tconst ano = dataObj.getFullYear();\n\n\t// Criando a string no formato desejado: DD/MM/YYYY\n\tconst dataFormatada = `${dia}/${mes}/${ano}`;\n\n\n\treturn dataFormatada;\n}\n\n","inputVariables":["consultMaquina","numeroSerie"],"outputVariable":"dataInstalacao","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"85fd4b6a-c3fb-4d4c-b576-978af3f1de83","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"df93c738-b6f9-4397-b7d0-e675bb78c31a","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-89266eb8-b772-4ce3-9043-edf3860b576c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-46c3f670-70e1-42b4-ab2a-b29dd4d4d840","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fc88451b-377c-4328-aa25-87ab3fc077c6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0e6bc8ca-977f-40d6-9ccf-23d15a44268b","root":false,"$title":"[TC.4.5.1][MSG][SET] Comprada","$position":{"top":"1692px","left":"1112px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"bb74c3c9-73bc-4030-ae90-62acb134db5e":{"$contentActions":[{"action":{"$id":"28455e34-63ca-4fe3-95c1-e20694e88271","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f3ce0512-1fe9-4f1c-b290-983461954f53","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f3ce0512-1fe9-4f1c-b290-983461954f53","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"00dde603-ebd0-4723-9f48-f59e65dcdc31","$typeOfContent":"text","type":"SendMessage","settings":{"id":"326ac554-de3a-4273-83a8-5031ef1d92d4","type":"text/plain","content":"Foram encontradas as seguintes máquinas. ","metadata":{}},"$cardContent":{"document":{"id":"326ac554-de3a-4273-83a8-5031ef1d92d4","type":"text/plain","content":"Foram encontradas as seguintes máquinas. "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"97dd9187-fee3-4a51-8ce1-f30c52e74098","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0501d701-210e-4b5d-afcd-3ca0d770bbdb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0501d701-210e-4b5d-afcd-3ca0d770bbdb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"91bfb221-581d-409a-8d4d-002d9b077ccc","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e69e16b4-16ee-473d-a011-60f82eb75eaf","type":"text/plain","content":"Por gentileza, digite a opção desejada.👇","metadata":{}},"$cardContent":{"document":{"id":"e69e16b4-16ee-473d-a011-60f82eb75eaf","type":"text/plain","content":"Por gentileza, digite a opção desejada.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"cf8612be-9289-42f4-87c1-91cc95bc07b2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6ffeca96-9efe-41fb-bb2f-eebc9d113d05","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{}},"$cardContent":{"document":{"id":"6ffeca96-9efe-41fb-bb2f-eebc9d113d05","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5cd2d31f-56e0-46fb-82e2-ec919b529fe4","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"text/plain","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f72881e8-f826-4b73-bc74-af0c6c5c0994","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8e0fcca7-a496-4ef1-a91b-2549e02cacfc","typeOfStateId":"state","$connId":"con_203","$id":"50f092bc-48ac-4223-81df-ccc2f3632da4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"09b07a4f-c428-4128-b9cb-b8d9a45b0aa9","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina, tipoMaquina, modalidadeMaquina) {\n  try {\n\n    let consultMaquina = JSON.parse(consultMaquina);\n    consultMaquina = consultMaquina.data\n    let modalidadeMaquina = modalidadeMaquina.replace('Comprada', 'V')\n    var aux = '';\n    var count = 1;\n    if (modalidadeMaquina == 'V') {\n      consultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'V')\n    } else if (modalidadeMaquina != '') {\n      consultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'A' || modalidade.modalidade == 'C')\n    }\n    consultMaquina.forEach(function (element) {\n      aux = aux.concat(\n        '<b>',\n        count,\n        '</b>',\n        ' - ',\n        'Nº série: ',\n        element.numeroSerie,\n        '\\n'\n      );\n      count++;\n    });\n\n    return aux;\n\n  }\n  catch (e) {\n    return e.message;\n  }\n\n}","inputVariables":["consultMaquina","tipoMaquina","modalidadeMaquina"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"372031cc-e467-405f-8c6c-fa19f48b6882","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"sizeMaquinas\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina, tipoMaquina, modalidadeMaquina) {\n  try {\n    let consultMaquina = JSON.parse(consultMaquina);\n    consultMaquina = consultMaquina.data\n    let modalidadeMaquina = modalidadeMaquina.replace('Comprada', 'V')\n    if (modalidadeMaquina == 'V') {\n      consultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'V')\n    } else if (modalidadeMaquina != '') {\n      consultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'A' || modalidade.modalidade == 'C')\n    }\n\n    consultMaquina = consultMaquina.length\n    return consultMaquina\n  }\n  catch (e) {\n    return e.message;\n  }\n\n}","inputVariables":["consultMaquina","tipoMaquina","modalidadeMaquina"],"outputVariable":"sizeMaquinas","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e789ac4a-274b-445a-9127-c69d64f88ed3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ffbe5a9e-2fbe-4a4d-9b9e-574b2793504f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7660314f-b2de-41aa-abcf-20e8238d8c6c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1debee40-faf0-4108-81bf-a2e9f8c87843","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bb74c3c9-73bc-4030-ae90-62acb134db5e","root":false,"$title":"[TC.4.4.0][MSG] Lista número S (Maquina< = 10)","$position":{"top":"1176.75px","left":"1520.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0f2ef715-e474-48e3-9642-ca975864c269":{"$contentActions":[{"action":{"$id":"778d041a-aed1-4440-9b45-f0f691cf4ee6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fdf01824-3e78-47c0-9ff6-a1cc7374b189","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"fdf01824-3e78-47c0-9ff6-a1cc7374b189","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4df37b47-c05d-4694-9b73-7d0527269b0f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"368339fd-ff04-4381-88eb-10c104782801","type":"text/plain","content":"<b>Taxas de Venda</b>                \nCrédito à vista {{taxasExibir@taxaCreditoAVistaEcommerce}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2Ecommerce}}%\n3x {{taxasExibir@taxaCreditoParc3Ecommerce}}%\n4x {{taxasExibir@taxaCreditoParc4Ecommerce}}%\n5x {{taxasExibir@taxaCreditoParc5Ecommerce}}%\n6x {{taxasExibir@taxaCreditoParc6Ecommerce}}%\n7x R${{taxasExibir@taxaCreditoParc7Ecommerce}}%\n8x {{taxasExibir@taxaCreditoParc8Ecommerce}}%\n9x {{taxasExibir@taxaCreditoParc9Ecommerce}}%\n10x {{taxasExibir@taxaCreditoParc10Ecommerce}}%\n11x {{taxasExibir@taxaCreditoParc11Ecommerce}}%\n12x {{taxasExibir@taxaCreditoParc12Ecommerce}}%","metadata":{}},"$cardContent":{"document":{"id":"368339fd-ff04-4381-88eb-10c104782801","type":"text/plain","content":"<b>Taxas de Venda</b>                \nCrédito à vista {{taxasExibir@taxaCreditoAVistaEcommerce}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2Ecommerce}}%\n3x {{taxasExibir@taxaCreditoParc3Ecommerce}}%\n4x {{taxasExibir@taxaCreditoParc4Ecommerce}}%\n5x {{taxasExibir@taxaCreditoParc5Ecommerce}}%\n6x {{taxasExibir@taxaCreditoParc6Ecommerce}}%\n7x R${{taxasExibir@taxaCreditoParc7Ecommerce}}%\n8x {{taxasExibir@taxaCreditoParc8Ecommerce}}%\n9x {{taxasExibir@taxaCreditoParc9Ecommerce}}%\n10x {{taxasExibir@taxaCreditoParc10Ecommerce}}%\n11x {{taxasExibir@taxaCreditoParc11Ecommerce}}%\n12x {{taxasExibir@taxaCreditoParc12Ecommerce}}%"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f45b6fd7-48d0-4900-a660-0a1d2a5afa4b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d75d80be-8d8a-4598-91c3-378a699d59c1","typeOfStateId":"state","$connId":"con_208","$id":"d9f34647-5a72-4f73-833b-68361b143449","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"d50f971d-da7c-4c16-a789-c0bab627922e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-e0a2efd1-e90e-4e97-9c70-61655e2901f6","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fba243be-b323-408e-803f-0b9b739512b1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"0f2ef715-e474-48e3-9642-ca975864c269","root":false,"$title":"Vendas Online - Amex e Hiper","$position":{"top":"2175.45px","left":"0px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"98c7523a-b7d2-49ab-bab8-c47926549497":{"$contentActions":[{"action":{"$id":"11aa876f-fde7-49af-8a72-fbf853e78f87","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ede2dd51-d983-4110-9657-7d5373c6dc4c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ede2dd51-d983-4110-9657-7d5373c6dc4c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1b9ef5e3-768e-463f-84f4-f00369df3685","$typeOfContent":"text","type":"SendMessage","settings":{"id":"439641e4-ca3c-45f0-96e4-ab2c403e23c0","type":"text/plain","content":"Estas são as taxas administrativas para a bandeira selecionada.👇","metadata":{}},"$cardContent":{"document":{"id":"439641e4-ca3c-45f0-96e4-ab2c403e23c0","type":"text/plain","content":"Estas são as taxas administrativas para a bandeira selecionada.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a8268dd6-051b-4645-be9c-6d892c9de125","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"464e7155-32b8-4d20-99b5-a36cdc87e0d3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"464e7155-32b8-4d20-99b5-a36cdc87e0d3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ee0f713e-1ae3-4702-a494-79e02c4d66b2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bda2880e-1fb3-4256-bc1b-a378648f5ae4","type":"text/plain","content":"<b>Taxas de Venda</b>                \nCrédito à vista {{taxasExibir@taxaCreditoAVista}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2}}%\n3x {{taxasExibir@taxaCreditoParc3}}%\n4x {{taxasExibir@taxaCreditoParc4}}%\n5x {{taxasExibir@taxaCreditoParc5}}%\n6x {{taxasExibir@taxaCreditoParc6}}%\n7x {{taxasExibir@taxaCreditoParc7}}%\n8x {{taxasExibir@taxaCreditoParc8}}%\n9x {{taxasExibir@taxaCreditoParc9}}%\n10x {{taxasExibir@taxaCreditoParc10}}%\n11x {{taxasExibir@taxaCreditoParc11}}%\n12x {{taxasExibir@taxaCreditoParc12}}%","metadata":{}},"$cardContent":{"document":{"id":"bda2880e-1fb3-4256-bc1b-a378648f5ae4","type":"text/plain","content":"<b>Taxas de Venda</b>                \nCrédito à vista {{taxasExibir@taxaCreditoAVista}}%\n\nCrédito parcelado\n2x {{taxasExibir@taxaCreditoParc2}}%\n3x {{taxasExibir@taxaCreditoParc3}}%\n4x {{taxasExibir@taxaCreditoParc4}}%\n5x {{taxasExibir@taxaCreditoParc5}}%\n6x {{taxasExibir@taxaCreditoParc6}}%\n7x {{taxasExibir@taxaCreditoParc7}}%\n8x {{taxasExibir@taxaCreditoParc8}}%\n9x {{taxasExibir@taxaCreditoParc9}}%\n10x {{taxasExibir@taxaCreditoParc10}}%\n11x {{taxasExibir@taxaCreditoParc11}}%\n12x {{taxasExibir@taxaCreditoParc12}}%"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f45b6fd7-48d0-4900-a660-0a1d2a5afa4b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d75d80be-8d8a-4598-91c3-378a699d59c1","typeOfStateId":"state","$connId":"con_213","$id":"f3ab5963-fad2-418e-b947-47b833541ed8","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bd42b150-f365-444e-9f64-23b6d0d63000","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-771ee6ca-fe36-4284-a887-1e3c9cd9812a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a6c4cb95-4fea-4e1c-9dd8-7373139c7e2c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"98c7523a-b7d2-49ab-bab8-c47926549497","root":false,"$title":"Vendas Físicas - Amex e Hiper","$position":{"top":"2170px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"45ec8433-22a9-4498-8005-c3c52f7ce6bc":{"$contentActions":[{"action":{"$id":"9f914be7-a101-4c0c-b2a6-2e7756fbc90b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"29120039-d78c-42a0-b26c-65c4b3dfe7f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"29120039-d78c-42a0-b26c-65c4b3dfe7f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a116a8f2-171d-4a21-a6bb-4df55afa042e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"cbc3333f-4381-4f46-a839-746660c1fbf5","type":"text/plain","content":"Desculpe, parece que você ainda não possui máquinas contratadas. ","metadata":{}},"$cardContent":{"document":{"id":"cbc3333f-4381-4f46-a839-746660c1fbf5","type":"text/plain","content":"Desculpe, parece que você ainda não possui máquinas contratadas. "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b9fbbd09-86d7-4431-91f6-f7ac91644065","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ffee8e57-be55-4cc0-a112-feeb18c79b94","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ffee8e57-be55-4cc0-a112-feeb18c79b94","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6c0ee702-0049-4c0f-8017-a208c77d55ff","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b2ec0d82-b63d-40d7-aa6d-f5c8e49957a2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"aece7772-1087-427c-9eb8-891be0b4a004","typeOfStateId":"state","$connId":"con_218","$contentId":"dfe6266e-798d-41a8-be00-132d80f31d26","$id":"c6e1a949-9960-4315-a3b8-55713947e24c","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b278a3b6-9248-46f6-b834-4ff244862109","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(salesType) {\n    try {\n        let buttons = [\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"1\",\n                    \"title\": \"Sim\"\n                }\n            },\n            {\n                \"type\": \"reply\",\n                \"reply\": {\n                    \"id\": \"2\",\n                    \"title\": \"Não\"\n                }\n            }\n        ];\n\n        const headerText = \"Gostaria de saber mais sobre contratação de máquinas? 🤔\";\n        return {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            \"interactive\": {\n                \"type\": \"button\",\n                \"body\": {\n                    \"text\": headerText,\n                },\n                \"action\": {\n                    buttons\n                }\n            }\n        };\n    } catch (err) {\n        return false;\n    }\n}","inputVariables":["salesType"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c94dadc4-743e-44d7-ba34-264ff584ae59","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4b665ba8-4b24-430c-9011-c36978f07371","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9a9d7630-fa0e-4899-8cbf-45e33bfb832f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0f237791-60bb-4879-8425-2ced254e0ae3","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"45ec8433-22a9-4498-8005-c3c52f7ce6bc","root":false,"$title":"[TC.4.1.0][MSG] Sem máquinas","$position":{"top":"458px","left":"1761px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ad3f23f8-0c79-4faf-8b19-06ad242f99d2":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"7aebb419-33f3-45b5-b419-e07f22807255","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a1463090-6db0-47f5-9840-36d1cd830c25","typeOfStateId":"state","$connId":"con_223","$id":"1c096d11-bece-4380-87e1-6a9548f52b86","conditions":[{"source":"context","comparison":"equals","values":["ok"],"variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b0263ba7-3e7a-44d7-9be3-32b335524c22","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyDomicilio\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/chat-assistente/safra-pay/v1/domicilios?idEstabelecimento={{selectedEc@codigoEc}}","responseStatusVariable":"statusDomicilio","responseBodyVariable":"bodyDomicilio"},"conditions":[]},{"$id":"03bb27d6-949c-4096-b56b-b5ab0da3a021","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyGeraldomicilio\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","User-Agent":"Fiddler","Content-Type":"application/json","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/safrapay/vendas-servicos/vendas/prospeccoes-clientes/assistente-virtual/v1/domicilios-bancarios","responseStatusVariable":"statusGeraldomicilio","responseBodyVariable":"bodyGeraldomicilio"},"conditions":[{"values":["false"],"source":"context","comparison":"notEquals","variable":"config.domicilio"}]},{"$id":"62a8348e-035c-4db1-ad67-7d3acf50f585","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {{state.name}} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"a7e2e2d2-d37b-411d-a590-9ab2346ef640","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"tamanhoRetornoDomicilio\"","$invalid":false,"settings":{"function":"run","source":"/**\n* All input variables needs to be passed as function param;\n* Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n* Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n**/\nfunction run(bodyDomicilio, bodyGeraldomicilio) {\n\ttry {\n\t\tbodyDomicilio = JSON.parse(bodyDomicilio);\n\t\tbodyGeraldomicilio = JSON.parse(bodyGeraldomicilio);\n\n\t\treturn {\n\t\t\t\"bodyDomicilio\": bodyDomicilio.data.length,\n\t\t\t\"bodyGeraldomicilio\": bodyGeraldomicilio.data.length,\n\t\t}\n\t}\n\tcatch (err) {\n\t\treturn {\n\t\t\t\"bodyDomicilio\": \"Erro\",\n\t\t\t\"bodyGeraldomicilio\": \"Erro\",\n\t\t\t\"Erro\":err.message\n\t\t}\n\t}\n}","inputVariables":["bodyDomicilio","bodyGeraldomicilio"],"outputVariable":"tamanhoRetornoDomicilio","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"953100b9-67d7-4a22-b584-845170bdef99","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {{state.name}} tamanho array dados\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} tamanho array dados","action":"{{tamanhoRetornoDomicilio@bodyDomicilio}} | {{tamanhoRetornoDomicilio@bodyGeraldomicilio}} | {{tamanhoRetornoDomicilio@Erro}}"},"conditions":[]},{"$id":"b4873d0d-a412-4033-b24a-e341a06f1660","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"4a8fb64c-ddf2-4b2a-a382-161a0d0fcfdc","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{assunto}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"assunto"}]},{"$id":"aa4bd660-a379-4cbb-b623-c82236a68bf5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusDomicilio","statusGeraldomicilio"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2678cc4e-668a-40c9-8503-b33371d928c1","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"{state.name} api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/safra-pay/v1/domicilios?idEstabelecimento={{selectedEc@codigoEc}} | GET| {{statusDomicilio}} | {{bodyDomicilio}}"},"conditions":[]},{"$id":"d698b742-0a2d-49fe-81d1-73c97b96ca6b","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"{state.name} api resumo 2\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo 2","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/safrapay/vendas-servicos/vendas/prospeccoes-clientes/assistente-virtual/v1/domicilios-bancarios | GET| {{statusGeraldomicilio}} | {{bodyGeraldomicilio}}"},"conditions":[]},{"$id":"4ac3327b-2456-4f3a-8824-dd13d5d77994","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"{{statusDomicilio}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusDomicilio"}]},{"$id":"4a76361b-8056-452c-a5bb-f0530aff8448","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status 2\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status 2","action":"{{statusGeraldomicilio}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusGeraldomicilio"}]}],"$leavingCustomActions":[{"$id":"d10d0ba5-1077-4a9d-bded-8e1072db99ff","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]},{"$id":"3d30b78a-c7f3-485d-938e-26118932c276","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a480a2f6-2dfc-4e9e-add9-89b9f3874237","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-3dec9bea-c29a-48dd-84ec-c7d8b21e2b13","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3550e4f5-46f4-4cf7-90ee-91e3318ae864","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ab1485dd-6388-4563-b6b7-a1cddf874868","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"ad3f23f8-0c79-4faf-8b19-06ad242f99d2","root":false,"$title":"[TC.6.0.0][HTTP] API Domicilio bancario","$position":{"top":"400.5px","left":"2281.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8c27acb8-d48a-43b9-a815-6af6e6f03405":{"$contentActions":[{"action":{"$id":"244231f5-ccfb-4965-b257-4cbb6710d158","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"41855f54-55f9-45dc-a2f3-399f1b1be773","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"41855f54-55f9-45dc-a2f3-399f1b1be773","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"023344a3-819b-4047-961f-2f190e1f1d0a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4fcaae27-88c2-4843-adad-620602518acd","type":"text/plain","content":"Você receberá os pagamentos feitos na bandeira <b>{{taxCardFlag}}</b>, na conta bancária abaixo, da seguinte forma.👇","metadata":{}},"$cardContent":{"document":{"id":"4fcaae27-88c2-4843-adad-620602518acd","type":"text/plain","content":"Você receberá os pagamentos feitos na bandeira <b>{{taxCardFlag}}</b>, na conta bancária abaixo, da seguinte forma.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a3eaa0ee-47e0-42fd-9a2e-1548901ecc42","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4bbf8688-4625-416d-8f78-295ee386dc74","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4bbf8688-4625-416d-8f78-295ee386dc74","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"61fa1cf6-40a9-455d-b5e6-1c55c5832698","$typeOfContent":"text","type":"SendMessage","settings":{"id":"0a62f500-54eb-427b-8266-7e81c85e01a0","type":"text/plain","content":"<b>Crédito</b>\n<b>Banco</b>: {{domicilioDados@nomeBanco1}}\nAgência: {{domicilioDados@codigoAgencia1}}\nConta Corrente: {{domicilioDados@contaCorrente1}}-{{domicilioDados@codigoDigito1}}                                                               ","metadata":{}},"$cardContent":{"document":{"id":"0a62f500-54eb-427b-8266-7e81c85e01a0","type":"text/plain","content":"<b>Crédito</b>\n<b>Banco</b>: {{domicilioDados@nomeBanco1}}\nAgência: {{domicilioDados@codigoAgencia1}}\nConta Corrente: {{domicilioDados@contaCorrente1}}-{{domicilioDados@codigoDigito1}}                                                               "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d62f8461-4a45-433f-b02b-7cd89d72ea4a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1840a1a5-4cc8-48c2-9926-908420e34bc5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1840a1a5-4cc8-48c2-9926-908420e34bc5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7aebb419-33f3-45b5-b419-e07f22807255","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"75e170b4-92d5-40c1-a211-a754270514c6","typeOfStateId":"state","$connId":"con_228","$id":"d974cc08-c322-44c8-9734-52dd8029267f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"40cc6e05-124c-4839-836b-43aa75b01b0b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a5eeca9f-a4ea-414d-b2c0-0bf0c27cd09f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8446a6db-6ba1-472c-b3ad-57c900f27e48","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8c27acb8-d48a-43b9-a815-6af6e6f03405","root":false,"$title":"[TC.6.1.1][MSG] Exibir Taxas Crédito","$position":{"top":"1129.89px","left":"1902px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b5f695eb-d85d-45fd-bb2e-20d377d958dd":{"$contentActions":[{"action":{"$id":"244231f5-ccfb-4965-b257-4cbb6710d158","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"41855f54-55f9-45dc-a2f3-399f1b1be773","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"41855f54-55f9-45dc-a2f3-399f1b1be773","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"023344a3-819b-4047-961f-2f190e1f1d0a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4fcaae27-88c2-4843-adad-620602518acd","type":"text/plain","content":"Você receberá os pagamentos feitos na bandeira <b>{{taxCardFlag}}</b>, na conta bancária abaixo, da seguinte forma.👇","metadata":{}},"$cardContent":{"document":{"id":"4fcaae27-88c2-4843-adad-620602518acd","type":"text/plain","content":"Você receberá os pagamentos feitos na bandeira <b>{{taxCardFlag}}</b>, na conta bancária abaixo, da seguinte forma.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5730f73d-45aa-4c87-97f2-941c88f20bd2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cf427407-3a18-4775-9216-7a99336c2fb1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cf427407-3a18-4775-9216-7a99336c2fb1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"128a4e69-277c-42fa-8f65-8b34ee83fedb","$typeOfContent":"text","type":"SendMessage","settings":{"id":"cce9f01a-6302-412a-93bb-f8454dd65f7d","type":"text/plain","content":"<b>Débito</b>      \n<b>Banco</b>: {{domicilioDados@nomeBanco1}}\nAgência:{{domicilioDados@codigoAgencia1}}\nConta Corrente: {{domicilioDados@contaCorrente1}}-{{domicilioDados@codigoDigito1}}                                                             \n                              \n<b>Crédito</b>                  \n<b>Banco</b>: {{domicilioDados@nomeBanco2}}\nAgência: {{domicilioDados@codigoAgencia2}}\nConta Corrente: {{domicilioDados@contaCorrente2}}-{{domicilioDados@codigoDigito2}}","metadata":{}},"$cardContent":{"document":{"id":"cce9f01a-6302-412a-93bb-f8454dd65f7d","type":"text/plain","content":"<b>Débito</b>      \n<b>Banco</b>: {{domicilioDados@nomeBanco1}}\nAgência:{{domicilioDados@codigoAgencia1}}\nConta Corrente: {{domicilioDados@contaCorrente1}}-{{domicilioDados@codigoDigito1}}                                                             \n                              \n<b>Crédito</b>                  \n<b>Banco</b>: {{domicilioDados@nomeBanco2}}\nAgência: {{domicilioDados@codigoAgencia2}}\nConta Corrente: {{domicilioDados@contaCorrente2}}-{{domicilioDados@codigoDigito2}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7aebb419-33f3-45b5-b419-e07f22807255","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"75e170b4-92d5-40c1-a211-a754270514c6","typeOfStateId":"state","$connId":"con_233","$id":"4685050e-7ceb-4328-b86b-ce847ec7e554","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"4a7b6160-d93c-4dd3-a1ae-939c73e192df","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8f69ee9b-5e91-4a4e-89fb-41d646799e3b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9f7be985-498a-4d25-90d3-3a8c79cabcf7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b5f695eb-d85d-45fd-bb2e-20d377d958dd","root":false,"$title":"[TC.6.1.2][MSG] Exibir Taxas Ambos","$position":{"top":"1144px","left":"2283.11px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"871d092b-90c5-4e0e-afbb-023cdb94f094":{"$contentActions":[{"action":{"$id":"244231f5-ccfb-4965-b257-4cbb6710d158","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"41855f54-55f9-45dc-a2f3-399f1b1be773","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"41855f54-55f9-45dc-a2f3-399f1b1be773","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"023344a3-819b-4047-961f-2f190e1f1d0a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4fcaae27-88c2-4843-adad-620602518acd","type":"text/plain","content":"Você receberá os pagamentos feitos na bandeira <b>{{taxCardFlag}}</b>, na conta bancária abaixo, da seguinte forma.👇","metadata":{}},"$cardContent":{"document":{"id":"4fcaae27-88c2-4843-adad-620602518acd","type":"text/plain","content":"Você receberá os pagamentos feitos na bandeira <b>{{taxCardFlag}}</b>, na conta bancária abaixo, da seguinte forma.👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"80173726-3262-4bce-b360-68ff43d9679c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"44954c06-7e1e-406f-830d-0da8009da4e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"44954c06-7e1e-406f-830d-0da8009da4e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a4ea41e0-2f99-451d-9229-379b6925902c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e1958806-9dd6-49e1-85df-da631bf238c2","type":"text/plain","content":"<b>Débito</b>                    \n<b>Banco</b>: {{domicilioDados@nomeBanco1}}\nAgência: {{domicilioDados@codigoAgencia1}}\nConta Corrente: {{domicilioDados@contaCorrente1}}-{{domicilioDados@codigoDigito1}}                                                            ","metadata":{}},"$cardContent":{"document":{"id":"e1958806-9dd6-49e1-85df-da631bf238c2","type":"text/plain","content":"<b>Débito</b>                    \n<b>Banco</b>: {{domicilioDados@nomeBanco1}}\nAgência: {{domicilioDados@codigoAgencia1}}\nConta Corrente: {{domicilioDados@contaCorrente1}}-{{domicilioDados@codigoDigito1}}                                                            "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7aebb419-33f3-45b5-b419-e07f22807255","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"75e170b4-92d5-40c1-a211-a754270514c6","typeOfStateId":"state","$connId":"con_238","$id":"114ac98b-129e-4455-8e12-350a3d43074c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"a7ce9db9-c492-49b5-906b-a4156915a769","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8a2041ed-ffd0-4d95-a628-9caac5d67a6a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a942f3e4-b145-408b-94b9-9c8676895473","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"871d092b-90c5-4e0e-afbb-023cdb94f094","root":false,"$title":"[TC.6.1.3][MSG] Exibir Taxas Débito","$position":{"top":"1143.33px","left":"2638.56px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b9ad166b-910b-43a2-b6e1-7e3ae4171339":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f15eb474-f67b-44ba-b09f-8901a2490810","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"dd50398e-90ff-4bcb-b1ce-68f2571a065f","typeOfStateId":"state","$connId":"con_243","$id":"d5b7d14a-6b65-48fb-aefa-f31136985ce8","conditions":[{"source":"context","comparison":"equals","values":["{\"data\":[]}","\"data\":[]"],"variable":"bodyPacote"},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false},{"stateId":"f7e2b91b-47c7-4363-89e2-d3ffc57f9e88","typeOfStateId":"state","$connId":"con_248","$id":"e1ac8cc3-52c1-4d1a-be67-6fd3b9f38c9e","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["ok"],"source":"context","comparison":"equals","variable":"apiStatus"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f9afd3ff-340e-4fab-bf6d-294cd1815005","$typeOfContent":"","type":"ProcessHttp","$title":"HTTP GET \"bodyPacote\"","$invalid":false,"settings":{"headers":{"Authorization":"Bearer {{bodyToken@access_token}}","Content-Type":"application/json","User-Agent":"Fiddler","Safra-Correlation-ID":"{{random.guid}}"},"method":"GET","uri":"{{config.urlCHT}}/chat-assistente/safra-pay/v1/pacotes?agencia={{contaSelecionada@agencia}}&conta={{contaSelecionada@conta}}","responseStatusVariable":"statusPacote","responseBodyVariable":"bodyPacote"},"conditions":[]},{"$id":"410a931a-c855-4e00-953d-e3b6a9cdaf55","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"erroApi\"","$invalid":false,"settings":{"variable":"exceptionType","value":"erroApi"},"conditions":[]},{"$id":"93a48c9b-03ba-4b84-9ded-9e2a040d9a8d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"2ac3da8d-b09e-4ca9-bee7-0cce075fdc5c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"assuntos\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"assuntos","action":"{{assunto}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"assunto"}]},{"$id":"eb950751-5d3d-408e-b7a1-e1c53508bc4f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"apiStatus\"","$invalid":false,"settings":{"function":"run","source":"function run(...apiStatus) {\n\ttry {\n\t\tif (apiStatus.some((status) => status == 401)) {\n\t\t\treturn 'unauthorized'\n\t\t}\n\t\tif (apiStatus.some((status) => status != 200)) {\n\t\t\treturn 'erro api'\n\t\t}\n\t\treturn 'ok'\n\t} catch (err) {\n\t\treturn \"erro api\"\n\t}\n}","inputVariables":["statusPacote"],"outputVariable":"apiStatus","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5866436c-1def-4be7-955a-81f9e7616f2a","$typeOfContent":"","type":"TrackEvent","$title":"Tracking \"{state.name} api resumo\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api resumo","action":"{{idSessao}} | {{contact.identity}} | {{calendar.datetime}} | {{config.urlCHT}}/chat-assistente/safra-pay/v1/pacotes?agencia={{contaSelecionada@agencia}}&conta={{contaSelecionada@conta}} | GET| {{statusPacote}} | {{bodyPacote}}"},"conditions":[]},{"$id":"adbd25d9-5e5e-4daf-b3c4-7750f162fdf9","$typeOfContent":"","type":"TrackEvent","$title":"Track \"{state.name} api status\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"{{state.name}} api status","action":"statusPacote"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"statusPacote"}]}],"$leavingCustomActions":[{"$id":"1567c9dd-6df9-469a-a45a-72ba09d8e13c","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-340f1dbc-b805-421c-9e36-2f6982f767e1","label":"ProcessHttp","background":"#7762E3","canChangeBackground":false},{"id":"blip-tag-c9784ce3-470f-45b6-890a-bb4f9506e6b2","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-9652596b-e2bb-4a0f-bc4e-d0e1ff64f872","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-80819ec2-1ad0-40d3-a492-33977daf9a77","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"b9ad166b-910b-43a2-b6e1-7e3ae4171339","root":false,"$title":"[TC.8.0.0][HTTP] API Pacotes","$position":{"top":"373.333px","left":"4251px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"dd50398e-90ff-4bcb-b1ce-68f2571a065f":{"$contentActions":[{"action":{"$id":"830dc22e-05b5-4846-ad0a-b0942056e6da","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b23bbad8-f440-4e04-afee-76696df30d2e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b23bbad8-f440-4e04-afee-76696df30d2e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2a4a5ec3-f094-4baf-b0c5-eff6930c982d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d55fc062-6b49-49a7-9d2c-f80fbe4cca96","type":"text/plain","content":"{{nome}}, você não possui pacotes de serviço cadastrados. ","metadata":{}},"$cardContent":{"document":{"id":"d55fc062-6b49-49a7-9d2c-f80fbe4cca96","type":"text/plain","content":"{{nome}}, você não possui pacotes de serviço cadastrados. "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"aa7f4cb0-ab7d-41d9-a97b-933d665cdfa3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ab0adeac-f86e-442b-a933-60fa68af47ee","typeOfStateId":"state","$connId":"con_253","$id":"d12b034e-b2bb-4e95-a547-1e2a64e1e5bc","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"462ef3b3-6e21-4ccb-9511-71e7027054f4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-84289d99-0970-4a24-ab2c-8d5b9b365a93","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2966aa7f-c43d-4deb-aa6b-b38557db6267","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"dd50398e-90ff-4bcb-b1ce-68f2571a065f","root":false,"$title":"[TC.8.1.0][MSG] Não possui pacotes","$position":{"top":"606px","left":"4094px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f7e2b91b-47c7-4363-89e2-d3ffc57f9e88":{"$contentActions":[{"action":{"$id":"be51e4c1-0a2d-4317-a70c-3a4e2dabc78c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"6c93093a-6c58-407c-ac45-77c600bce2f5","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, este é o seu pacote de serviços contratado:👇","metadata":{}},"$cardContent":{"document":{"id":"6c93093a-6c58-407c-ac45-77c600bce2f5","type":"text/plain","content":"{{contaSelecionada@primeiroNome}}, este é o seu pacote de serviços contratado:👇"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6a9199be-d406-473c-9467-2cd7b13f31eb","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b233c255-aff1-46e8-be1a-57c6cce55760","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b233c255-aff1-46e8-be1a-57c6cce55760","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"43fce40b-0ef3-4893-ae77-565f1b3aa02b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"c1519c0c-33f5-46e0-b0e3-198a9a7a6c4a","type":"text/plain","content":"{{pacote}}","metadata":{}},"$cardContent":{"document":{"id":"c1519c0c-33f5-46e0-b0e3-198a9a7a6c4a","type":"text/plain","content":"{{pacote}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fac17be3-0201-4328-b945-debc0327d360","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9b168af3-065a-4ea3-b277-61fb23ef1d7f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9b168af3-065a-4ea3-b277-61fb23ef1d7f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0d7ad388-3ac7-4cdc-948b-1ae362d68905","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ab0adeac-f86e-442b-a933-60fa68af47ee","typeOfStateId":"state","$connId":"con_258","$id":"1618012f-9044-4cef-a73d-c91603287b9d","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"e1050974-d7c4-460a-9e94-b1973ab21086","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"pacote\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyPacote) {\n  try {\n    let jsonData = JSON.parse(bodyPacote)\n    // Extrair valores\n    let primeiroItem = jsonData.data[0];\n    let nome = primeiroItem.nome;\n    let valor = primeiroItem.valor;\n\n    // Convertendo o número para uma string\n    let valorString = valor.toString();\n\n    // Substituindo ponto por vírgula\n    let valorFormatado = valorString.replace('.', ',');\n\n    // Formatando como moeda\n    valorFormatado = valorFormatado.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });\n\n    // Verificando se há ponto e vírgula na formatação\n    if (valorFormatado.indexOf('.') !== -1 && valorFormatado.indexOf(',') !== -1) {\n      let splitVirgula = valorFormatado.split(',');\n      let decimais = splitVirgula[1] + '00';\n      valor = splitVirgula[0] + ',' + decimais.substring(0, 2);\n    } else if (valorFormatado.indexOf('.') !== -1) {\n      valor = valorFormatado + ',00';\n    } else if (valorFormatado.indexOf(',') !== -1) {\n      let splitVirgula = valorFormatado.split(',');\n      let decimais = splitVirgula[1] + '00';\n      let milhar = splitVirgula[0].replace(/\\D/g, '');\n      milhar = milhar.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\n      valor = milhar + ',' + decimais.substring(0, 2);\n    } else {\n      let milhar = valorFormatado.replace(/\\D/g, '');\n      milhar = milhar.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\n      valor = milhar + ',00';\n    }\n    return (`Nome do serviço: ${nome}\\nValor: R$${valor}`);\n\n  }\n  catch (e) {\n    return e.message;\n  }\n}","inputVariables":["bodyPacote"],"LocalTimeZoneEnabled":false,"outputVariable":"pacote"},"conditions":[]},{"$id":"51f9e661-fd2c-4120-9f56-2d984ef79796","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-181dd29e-e97b-47ce-9242-bbee5820c03b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-52baafe9-7f5d-46a5-89c5-cba07f27abae","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-50464302-a97a-4e4b-ae9b-32dbd3351918","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f7e2b91b-47c7-4363-89e2-d3ffc57f9e88","root":false,"$title":"[TC.8.2.0][MSG] Possui pacotes","$position":{"top":"611px","left":"4434px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a9a96de6-7c5c-4625-8765-bd797a7e9c86":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"49787b51-0156-44fc-8565-77b607d79509","typeOfStateId":"state","$connId":"con_263","$id":"ed4b98d3-d6f8-4e76-9b69-fbeb08e72afd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n    const invalidInputMessage = 'input inesperado';\n    try {\n        if (!inputUsuario) {\n            return 'inatividade';\n        }\n\n        let regex = /^(\\d{1,3}(\\.\\d{3})*|\\d+)(\\,\\d{1,2})?$/gmi;\n        let validInput = new RegExp(regex).test(inputUsuario);\n\n        if (validInput) {\n            return inputUsuario;\n        }\n        return invalidInputMessage;\n    } catch (err) {\n        return invalidInputMessage;\n    }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"34019300-5d25-4ff2-98f8-b9d25d503ee0","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"valor\"","$invalid":false,"settings":{"variable":"exceptionType","value":"valor"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"8c3ab915-52f6-45d0-92ab-22c7133e3745","$typeOfContent":"","type":"SetVariable","$title":"Set \"valorCobranca\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"valorCobranca","value":"R$ {{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"99b1e8ad-0086-4a95-9fc8-bd03e20d5b10","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"ce9800c9-f24b-454e-ba84-51c52e751181","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6b1569c0-b945-4367-a51b-157d45317229","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-9751bdbe-2ca7-4725-9d62-bdca7125daa0","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ddba01b8-93ff-45b1-878a-e57aebefa58f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-57dc681d-b6e9-406f-81e6-bcc190aa513a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"a9a96de6-7c5c-4625-8765-bd797a7e9c86","root":false,"$title":"[TC.7.3.0][INPUT] Solicita valor da cobrança","$position":{"top":"2661px","left":"3068.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f676f5a4-86d1-4e05-a2b8-485b8dd91725":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Por favor, informe a data da compra.\n\nComo neste exemplo:\n👉 {{currentDate}}","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Por favor, informe a data da compra.\n\nComo neste exemplo:\n👉 {{currentDate}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7bf80e9d-79e9-4578-acba-c963f814037e","typeOfStateId":"state","$connId":"con_268","$id":"07dead61-4794-4857-95f0-1beaaa14e586","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"8f6bbd3f-4073-4bf6-9597-ad195981452b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cb47a53d-9b72-47b8-95ab-a1d285958733","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-5aad59bf-8ba8-4870-87c7-19381e384f28","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"f676f5a4-86d1-4e05-a2b8-485b8dd91725","root":false,"$title":"[TC.7.2.0][MSG] Solicita data da cobrança","$position":{"top":"1950.5px","left":"3068px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bbc18d76-6b5d-4a90-ad31-fcabb1586308":{"$contentActions":[{"action":{"$id":"7a84390c-d7bf-45b1-af5d-460041b6dd5a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"97cc80c5-b47b-4c1a-9d46-d05db5123273","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"97cc80c5-b47b-4c1a-9d46-d05db5123273","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"250e83be-d97c-4677-a1ab-6f7bc5fc71ec","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"59491125-e819-46e7-80c4-a3cb59697a47","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9cb5ee14-0641-4154-91a2-384720f31f85","typeOfStateId":"state","$connId":"con_273","$id":"288ee9a9-16a3-41fa-baf3-b580beaf0acd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"531aa867-6ced-4d5d-b2b7-a3f702c3ebdd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Aluguel\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"MDR\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"ARV\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Por gentileza, informe a origem da cobrança.👇\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a3fac0be-f389-4dc0-a30d-1fd3ddac1a97","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4fa943a3-aece-4a06-8a44-48cfec5c7af8","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-aa0cb9ff-340d-4abe-b326-802e97ed19e7","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-56942aa7-cf5a-4e3c-8046-3e4d61d72b6b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bbc18d76-6b5d-4a90-ad31-fcabb1586308","root":false,"$title":"[TC.7.0.2][MSG] Origem da cobrança","$position":{"top":"887.571px","left":"3069px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e695d17c-2f37-44ac-9508-6986fb99b351":{"$contentActions":[{"action":{"$id":"c48e492f-0ae6-45b7-a511-cd0a79ec93ee","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ae8b5e52-a561-44e5-98d8-7c1c17f15ec8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ae8b5e52-a561-44e5-98d8-7c1c17f15ec8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4d4404d0-777a-45ec-8b2a-10fb6c28cd88","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"59491125-e819-46e7-80c4-a3cb59697a47","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1d4c3b8a-0f56-437e-beec-2c5ba9efea28","typeOfStateId":"state","$connId":"con_278","$id":"98a6a3d9-9e3c-4464-ad66-768762d5fd76","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"905868b1-3dad-4266-a028-e8e981a0afc4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Conta Corrente\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Agenda\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Certo, onde visualizou a cobrança?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b29a7541-0d10-4801-b01d-b444f13744fb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c49ef7f1-35af-4130-9fff-45d6f01d4fa9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c994df8d-5aff-468a-9087-bf0f66c3f1e0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-fbcc2507-d163-490e-854e-a4df3030eeac","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e695d17c-2f37-44ac-9508-6986fb99b351","root":false,"$title":"[TC.7.1.0][MSG] Onde visualizou a cobrança","$position":{"top":"1410px","left":"3068px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"85c901f2-e8b4-49ca-97d4-e1becccc4cb1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cede0f5a-5453-45c2-a4fd-e95e478bdd14","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c7eb5b06-ca45-4d7e-be53-b9e17da7fd6d","type":"Redirect","$title":"Redirect to {service} sending {state@lastInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e0d720bf-8092-4390-8802-a843772e77a2","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"85c901f2-e8b4-49ca-97d4-e1becccc4cb1","root":false,"$title":"[Redirect] To cascata","$position":{"top":"21.6667px","left":"462.333px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59d0589a-4bfe-427b-bcc3-37affdafab98":{"$contentActions":[{"action":{"$id":"7b152004-8a47-4677-b19b-7ef84b9c72c4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bcdbce09-279f-438b-b1bd-b5d41903e9b5","type":"text/plain","content":"A Taxa administrativa (MDR) é cobrada sobre as transações realizadas de forma física (em uma máquina de cartão) ou de forma online (link de pagamento), tanto no crédito quanto no débito. \n","metadata":{}},"$cardContent":{"document":{"id":"bcdbce09-279f-438b-b1bd-b5d41903e9b5","type":"text/plain","content":"A Taxa administrativa (MDR) é cobrada sobre as transações realizadas de forma física (em uma máquina de cartão) ou de forma online (link de pagamento), tanto no crédito quanto no débito. \n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c810e386-4922-4496-9cf5-fb65ca671e9a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0c95b10d-9b80-4142-90e4-ec71b94e2c93","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1733eb2d-e9c4-4fe4-97fe-6c879ae50803","$typeOfContent":"text","type":"SendMessage","settings":{"id":"6741cd3e-4102-4382-b087-7b3268a1322b","type":"text/plain","content":"Todas as empresas que fornecem solução de pagamento, cobram esse tipo de taxa.\n","metadata":{}},"$cardContent":{"document":{"id":"6741cd3e-4102-4382-b087-7b3268a1322b","type":"text/plain","content":"Todas as empresas que fornecem solução de pagamento, cobram esse tipo de taxa.\n"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"1cb8a46a-308e-4c07-8d8a-f0476c022498","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d82acf75-4b40-4e5c-a926-6e507dac5f6b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d82acf75-4b40-4e5c-a926-6e507dac5f6b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"86f79972-a169-4480-babb-4261f1b5a4f4","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"action":{"$id":"4d8a8eab-bedf-4943-8b9d-cc66c82d45c2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9b17c3aa-f9c2-4025-95d3-d4be61e16f01","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9b17c3aa-f9c2-4025-95d3-d4be61e16f01","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b38e7f6a-5a97-4966-ba49-f9b7915d436e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"4dfbe4df-5b62-4c68-9130-ab7ccec1756b","typeOfStateId":"state","$connId":"con_283","$id":"ece7e9ed-eee5-4361-abdc-46680eebb110","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"43c3a7b6-6035-4c73-b26a-1dece10ecbee","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"1\",\n\t\t\t\t\"title\": \"Master\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"2\",\n\t\t\t\t\"title\": \"Visa\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"3\",\n\t\t\t\t\"title\": \"Elo\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"4\",\n\t\t\t\t\"title\": \"Amex\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"5\",\n\t\t\t\t\"title\": \"Hiper\"\n\t\t\t}\n\t\t]\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Selecione a bandeira desejada para conhecer as taxas administrativas.👇`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Escolha uma opção\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn err.message;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"99120e14-d345-44e3-baf8-0e6d1e8d7d6d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e7ec7cd4-a1f7-4886-b60f-d7244bf258de","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-60eaae45-7b13-40ef-85e6-e2eb18fd80d2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7ab77230-751c-4f5b-b999-24cc7280c7c9","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"59d0589a-4bfe-427b-bcc3-37affdafab98","root":false,"$title":"[TC.2.0.1] [MSG] Selecao Bandeira","$position":{"top":"631px","left":"321.571px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"313d8fd3-b86e-48a6-91d5-803adf2aa7d6":{"$contentActions":[{"action":{"$id":"b00b58af-c4a0-4b88-acc6-bfd375877d98","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87cd5126-0e6d-401b-8e15-fc57f4b1139f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c3541272-a652-4112-9a0f-665d23c0136e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e912e94c-247f-4ad6-abec-f42562d981a0","typeOfStateId":"state","$connId":"con_288","$id":"2dd516a5-7698-42c9-9e4b-a732f67c3279","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc6afd4-c708-460d-842d-5021f952c686","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Vendas Online\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Vendas Física\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Você possui as seguintes modalidades habilitadas, selecione qual deseja consultar.👇\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a9e89828-78fd-4d85-9b99-0e6f16e11dc7","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5291d479-7106-4be7-87a3-dd9c55c65f6b","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ff14f455-e8e4-488f-8e70-132b38f8ed0e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a4202611-b946-4e32-a5a2-cca5ce6eb0b0","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"313d8fd3-b86e-48a6-91d5-803adf2aa7d6","root":false,"$title":"[TC.2.0.2][MSG] Modalidade de venda","$position":{"top":"1090.43px","left":"293.357px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d75d80be-8d8a-4598-91c3-378a699d59c1":{"$contentActions":[{"action":{"$id":"63ffff3b-b00e-46a0-bdef-4647bb008ae0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"303cfc97-f485-485d-b20c-26afb9569905","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"303cfc97-f485-485d-b20c-26afb9569905","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5a9fe635-ca3b-454d-a94c-d284431b325e","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f45b6fd7-48d0-4900-a660-0a1d2a5afa4b","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"21b3d22d-2312-4cff-a73c-ae1b6746e33e","typeOfStateId":"state","$connId":"con_293","$id":"76dbdd35-3211-4aad-ac6d-633aa12b1051","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"47aab5e5-83a4-43a0-bb83-13da9057c8b0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Gostaria de selecionar outra bandeira?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fecb3166-b76a-4d3f-83d2-9f1e5bc14837","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-9cff021d-2156-4ff4-a864-00e0e982e3f5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f51a06c0-8569-453d-8294-c57aa1741ea5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9af9db99-8963-4c43-99dc-bda1fddd7cf4","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"d75d80be-8d8a-4598-91c3-378a699d59c1","root":false,"$title":"[TC.2.1.0][MSG] Selecionar outra bandeira","$position":{"top":"2222.24px","left":"317.121px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"21b3d22d-2312-4cff-a73c-ae1b6746e33e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"c12d2d8f-bda5-4363-a9eb-46662315b7ee","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"e8951280-a57e-494d-851d-140dbca41a1e","typeOfStateId":"state","$connId":"con_298","$id":"fc8a046a-31c9-431c-9b8b-97fefe95b232","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"a65258c3-241a-4ab6-94b7-d3b0cfdb7ccd","typeOfStateId":"state","$connId":"con_303","$id":"be379e42-cdaa-4cda-b698-77abfd0d3439","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f3f13f29-3b2b-445d-a0fb-b7b74579cd8a","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const validInputMessage = \"Input inesperado\"\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"n[ãa]o|naum\": \"Não\",\n      \"sim|sin\": \"Sim\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return validInputMessage\n  } catch (err) {\n    return validInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e475018a-0819-41ec-9389-84a2334b2919","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"c46b65a2-9c94-4ee2-ae4e-a973b40a5618","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"3fa94059-5bc1-4a18-a151-3fe461a3d034","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3e14e629-e5da-441d-a2de-0f4e1637b73a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-56e1e51a-22e7-4252-8455-b478d2d53179","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-3ea65451-ef54-4f31-83f7-61245a3ff700","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-baf32f1a-4f00-4b7c-b41c-3c877d67b73e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"21b3d22d-2312-4cff-a73c-ae1b6746e33e","root":false,"$title":"[TC.2.1.0][INPUT] Selecionar outra bandeira","$position":{"top":"2493.29px","left":"317.071px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5d8a18cc-a583-4083-9025-67ca4d472aaf":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"88a86fe9-9c4e-4e81-8040-5cd06273375f","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"cac63fde-6671-4aa1-9a67-efc2f5336711","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"5d8a18cc-a583-4083-9025-67ca4d472aaf","root":false,"$title":"[GO TO] TC.3.0.0 Taxas de Antecipação","$position":{"top":"3978px","left":"204.333px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e8951280-a57e-494d-851d-140dbca41a1e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a7108ccd-d976-4326-8820-7ccb9966b66e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"59d0589a-4bfe-427b-bcc3-37affdafab98","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e8951280-a57e-494d-851d-140dbca41a1e","root":false,"$title":"[GO TO] TC.2.0.1 Selecao Bandeira","$position":{"top":"2708.13px","left":"34.913px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9262b032-7ea2-45d2-b782-2649ddad61b9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"582ae6c9-728b-49d6-afb5-8af40ffe3320","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9262b032-7ea2-45d2-b782-2649ddad61b9","root":false,"$title":"[GO GO] Redirect to Finalizacao","$position":{"top":"4001px","left":"484px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c07b1d82-9004-40cc-a93c-f0cabb17f9a7":{"$contentActions":[{"action":{"$id":"cb570a41-fc3b-4cbc-90be-16858e4c3eb5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bebac43a-3e93-4b95-95e4-a2ab2acb3046","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bebac43a-3e93-4b95-95e4-a2ab2acb3046","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8bbd06a9-445f-4628-9901-cdf7a46d11a9","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ddc5af8f-9630-479a-8623-8b37698ab647","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b8de541a-4234-4125-9502-46ade2ce536a","typeOfStateId":"state","$connId":"con_308","$id":"032ea9f2-4db4-4fd4-8520-500616ef7b9a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bc28845d-702b-47ec-91a2-ae6432e7b336","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Gostaria de consultar as taxas de antecipação?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c914f7a1-0280-46c0-9ddd-7171ddfa515a","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cf8ef76e-6262-400e-8564-258f682fb8f3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-702e34a0-3f41-403f-b680-6f0a37bd522f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0a951623-bf36-40a5-b990-373d519350b8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c07b1d82-9004-40cc-a93c-f0cabb17f9a7","root":false,"$title":"[TC.2.2.1][MSG] Consultar Taxas","$position":{"top":"2918.35px","left":"349.435px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c950fde0-4616-49b2-9f39-a0ba859beab4":{"$contentActions":[{"action":{"$id":"cb570a41-fc3b-4cbc-90be-16858e4c3eb5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bebac43a-3e93-4b95-95e4-a2ab2acb3046","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bebac43a-3e93-4b95-95e4-a2ab2acb3046","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8bbd06a9-445f-4628-9901-cdf7a46d11a9","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ddc5af8f-9630-479a-8623-8b37698ab647","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"6159148f-ca32-497c-a843-838a5bc20b0e","typeOfStateId":"state","$connId":"con_313","$id":"7ede612e-ed6f-4c1d-88c6-f9d9e142e389","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bc28845d-702b-47ec-91a2-ae6432e7b336","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = `Você pode contratar a antecipação automática e receber suas vendas na hora, ou em 1(um) dia. \n\nGostaria de aproveitar e contratar? 😍`;\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7c7a590f-a499-432a-8137-85bc594d397d","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7793331e-dbe2-47d0-bbb6-e77c6c4888f6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-a2a81dfa-4c24-444d-894d-e2ffedda943e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-239038e6-f9e8-4bfd-9b43-598a863a6444","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c950fde0-4616-49b2-9f39-a0ba859beab4","root":false,"$title":"[TC.2.2.2][MSG] Taxa atual","$position":{"top":"2930px","left":"908px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ba86d697-73e1-47ee-9a6a-0c58a46a207b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"07d40eca-e745-4092-bc11-bf6444a7a197","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"5724999e-4ebb-443e-8b1d-4c15ef40251e","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"ba86d697-73e1-47ee-9a6a-0c58a46a207b","root":false,"$title":"[GO TO] Redirect WhatsApp PJ (Humano)","$position":{"top":"3452px","left":"592.333px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e1923532-1bfa-4ab5-8de3-6eba5248bfa6":{"$contentActions":[{"action":{"$id":"2e9a6cda-a31d-442e-80cb-22546f176fcf","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6b9efbfa-cbfc-4a4c-a973-38023c32e235","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6b9efbfa-cbfc-4a4c-a973-38023c32e235","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a63fd407-f2dc-4b78-bc77-b5f5a72f1d6f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"efe77ef5-87d2-444e-9b46-bca0e9c012ca","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"17828cf7-5217-4cf1-bf9e-1393e96afaac","typeOfStateId":"state","$connId":"con_318","$id":"ee82c8ec-1c5e-40b1-88c7-a0586afd0ec0","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f2a2f1cf-22af-4e91-84c3-5ff5677f11ef","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Sim\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Não\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = `Gostaria de falar com um de nossos atendentes e conhecer mais?`;\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2c6c4e3e-7ba4-4a20-93c2-a40a67e3bfbb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-001d22ec-9b78-447d-9a03-5712a588a053","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b3fb38c9-c2d7-4a33-acda-4c4833f3bfa0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7cbd67f7-f732-4296-a343-5f204f97e59d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e1923532-1bfa-4ab5-8de3-6eba5248bfa6","root":false,"$title":"[TC.2.2.3][MSG] Questionar Transferência","$position":{"top":"3467px","left":"1108px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7320750f-5a23-4919-af98-035b1dbcb917":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"582ae6c9-728b-49d6-afb5-8af40ffe3320","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"7320750f-5a23-4919-af98-035b1dbcb917","root":false,"$title":"[GO GO] Redirect to Finalizacao","$position":{"top":"867.667px","left":"670.667px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"51355431-b5dd-488e-985b-a98da7ee0fe9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9429bf66-f37f-4057-986f-c0a2f1bd4194","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"51355431-b5dd-488e-985b-a98da7ee0fe9","root":false,"$title":"[GO TO] Redirect to Finalizacao","$position":{"top":"813px","left":"2735px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a1463090-6db0-47f5-9840-36d1cd830c25":{"$contentActions":[{"action":{"$id":"83e94468-aa05-4776-ad63-5972bf36598e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"150cd459-36ad-41eb-a7fc-e6c9d20e5d5b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"150cd459-36ad-41eb-a7fc-e6c9d20e5d5b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c45f0565-6dbc-40bf-977a-551769a50d76","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7aebb419-33f3-45b5-b419-e07f22807255","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c13070f5-3f89-4975-90ec-c628e04a66ce","typeOfStateId":"state","$connId":"con_323","$id":"45492c8e-9956-43e8-ad06-63a1a6bc42be","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"8622daec-b61a-4065-924a-263f45fe99d5","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyDomicilio) {\n  try {\n    // Mapeamento de correção de texto para bandeiras\n    const correcaoTexto = {\n      \"ELO \": \"Elo\",\n      \"MCRD\": \"Master\",\n      \"VISA\": \"Visa\",\n      \"AMEX\": \"Amex\",\n      \"HIPR\": \"Hiper\"\n    };\n\n    // Filtrar os dados conforme as condições\n    let bodyDomicilio = JSON.parse(bodyDomicilio)\n    let bandeirasFiltradas = {};\n    bodyDomicilio.data.forEach(item => {\n      if (correcaoTexto[item.codigoBandeira] && (item.codigoProduto === '01' || item.codigoProduto === '02')) {\n        bandeirasFiltradas[item.codigoBandeira] = correcaoTexto[item.codigoBandeira];\n      }\n    });\n\n    // Preencher o menu com as bandeiras filtradas\n    let defaultMenuOptions = [];\n    for (const key in bandeirasFiltradas) {\n      defaultMenuOptions.push({\n        \"id\": key,\n        \"title\": bandeirasFiltradas[key]\n      });\n    }\n\n    return {\n      \"recipient_type\": \"individual\",\n      \"type\": \"interactive\",\n      \"interactive\": {\n        \"type\": \"list\",\n        \"header\": {\n          \"type\": \"text\",\n          \"text\": \"\"\n        },\n        \"body\": {\n          \"text\": `Selecione abaixo a bandeira, para saber onde vai receber as vendas feitas com ela (domicílio bancário).👇`\n        },\n        \"action\": {\n          \"button\": \"Escolha uma opção\",\n          \"sections\": [\n            {\n              \"title\": \"\",\n              \"rows\": defaultMenuOptions\n            }\n          ]\n        }\n      }\n    }\n  } catch (err) {\n    return err.message;\n  }\n}","inputVariables":["bodyDomicilio"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fd74f320-ccff-43b5-b472-f83f33f25dec","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-88e374a5-467d-4f4d-bb26-651f1a697066","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7faff650-5474-49d6-9871-badd6688192c","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4160c17c-48f8-4ebd-92dd-aa142e594fba","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a1463090-6db0-47f5-9840-36d1cd830c25","root":false,"$title":"[TC.6.1.0][MSG] Selecionar bandeira","$position":{"top":"635.75px","left":"2283px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c13070f5-3f89-4975-90ec-c628e04a66ce":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"7aebb419-33f3-45b5-b419-e07f22807255","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"b5f695eb-d85d-45fd-bb2e-20d377d958dd","typeOfStateId":"state","$connId":"con_328","$id":"12e772c0-ad73-43a7-b064-1ee63332a2ac","conditions":[{"source":"context","comparison":"equals","values":["Ambos"],"variable":"domicilioDados@codigoProduto"},{"values":["Visa","Master","Elo","Hiper","Amex"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"8c27acb8-d48a-43b9-a815-6af6e6f03405","typeOfStateId":"state","$connId":"con_333","$id":"28f12109-2549-4963-a5b5-3a420c79f59c","conditions":[{"source":"context","comparison":"equals","values":["Crédito"],"variable":"domicilioDados@codigoProduto"},{"values":["Visa","Master","Elo","Hiper","Amex"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"871d092b-90c5-4e0e-afbb-023cdb94f094","typeOfStateId":"state","$connId":"con_338","$id":"7e85cde1-1409-4caf-bb85-559af437d35c","conditions":[{"source":"context","comparison":"equals","values":["Débito"],"variable":"domicilioDados@codigoProduto"},{"values":["Visa","Master","Elo","Hiper","Amex"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"25dc5f69-8be6-4e53-928a-b8a814402c0d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"Master\": \"Master\",\n      \"Visa\": \"Visa\",\n      \"Elo\": \"Elo\",\n      \"Amex\": \"Amex\",\n      \"Hiper\": \"Hiper\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e53ed1eb-46d7-4aed-b17f-4021e8926240","$typeOfContent":"","type":"SetVariable","$title":"Set \"taxCardFlag\"","$invalid":false,"settings":{"variable":"taxCardFlag","value":"{{userInput}}"},"conditions":[]},{"$id":"704405c6-b4b7-4cf7-9b10-e8e0290a06df","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"c5e8a7ff-b292-4479-a667-d6589d6fb73f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"domicilioDados\"","$invalid":false,"settings":{"function":"run","source":"function run(bodyDomicilio, bodyGeralDomicilio, bandeira) {\n    try {\n        const bodyDomicilioObj = JSON.parse(bodyDomicilio);\n        const bodyGeralDomicilioObj = JSON.parse(bodyGeralDomicilio);\n        let codigoBandeira = bandeira.toUpperCase();\n        codigoBandeira = codigoBandeira.replace('MASTER', 'MCRD').replace('VISA', 'VISA').replace('HIPER', 'HIPR').replace('ELO', 'ELO').replace('AMEX', 'AMEX');\n\n        const getDomicilioDataPorBandeira = (codigoBandeira, propriedade) => {\n            const filteredData = bodyDomicilioObj.data.filter(item =>\n                item.codigoBandeira.trim() == codigoBandeira.trim() &&\n                (item.codigoProduto == \"01\" || item.codigoProduto == \"02\")\n            );\n\n            return filteredData.map(item => {\n                if (propriedade == 'banco') {\n                    return item.domicilio[propriedade].replace(/^0+/, '').padStart(3, '0') || null;\n                }\n                if (propriedade == 'codigoProduto') {\n                    return item[propriedade] || 'null';\n                }\n                return item.domicilio[propriedade] || 'null';\n            });\n        }\n        const getNomeBancoPorCodigo = (codigoBanco) => {\n            return codigoBanco.map(codigo => {\n                const banco = bodyGeralDomicilioObj.data.find(item => item.codigo === codigo);\n                return banco ? banco.nome : null;\n            });\n        }\n\n        let domicilioDados = {};\n        const codigoProduto = getDomicilioDataPorBandeira(codigoBandeira, 'codigoProduto');\n        const codigosBanco = getDomicilioDataPorBandeira(codigoBandeira, 'banco');\n        const codigosAgencia = getDomicilioDataPorBandeira(codigoBandeira, 'agencia');\n        const codigosContaCorrente = getDomicilioDataPorBandeira(codigoBandeira, 'contaCorrente');\n        const codigosDigito = getDomicilioDataPorBandeira(codigoBandeira, 'digitoContaCorrente');\n        const nomesBanco = getNomeBancoPorCodigo(codigosBanco);\n\n        for (let i = 0; i < codigosBanco.length; i++) {\n            domicilioDados[`codigoBanco${i + 1}`] = codigosBanco[i];\n        }\n        for (let i = 0; i < codigosAgencia.length; i++) {\n            domicilioDados[`codigoAgencia${i + 1}`] = codigosAgencia[i].replace(/^0+/, '');\n        }\n        for (let i = 0; i < codigosDigito.length; i++) {\n            domicilioDados[`codigoDigito${i + 1}`] = codigosDigito[i];\n        }\n        for (let i = 0; i < nomesBanco.length; i++) {\n            domicilioDados[`nomeBanco${i + 1}`] = nomesBanco[i];\n        }\n        for (let i = 0; i < codigosContaCorrente.length; i++) {\n            domicilioDados[`contaCorrente${i + 1}`] = codigosContaCorrente[i].replace(/^0+/, '');\n        }\n        if (codigoProduto.includes(\"01\") && codigoProduto.includes(\"02\")) {\n            domicilioDados.codigoProduto = \"Ambos\";\n        }\n        else if (codigoProduto.includes(\"02\")) {\n            domicilioDados.codigoProduto = \"Crédito\";\n        } else if (codigoProduto.includes(\"01\")) {\n            domicilioDados.codigoProduto = \"Débito\";\n        }\n        return domicilioDados;\n\n    } catch (err) {\n        return err.message;\n    }\n}","inputVariables":["bodyDomicilio","bodyGeralDomicilio","taxCardFlag"],"outputVariable":"domicilioDados","LocalTimeZoneEnabled":false},"conditions":[{"values":["Visa","Master","Elo","Hiper","Amex"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"05a8fce7-4994-4940-a879-29def9504887","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"43cc4036-13c4-4808-9326-a488da59d88b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bd5ab0a4-49d4-400c-9bb0-8bbba10b511c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f1038e66-06a7-4c5f-93f3-014bc31842f8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-b4786f44-e273-47fa-b4ca-b4ac12e40702","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6e08359a-240b-4c3d-92da-dd7ad1b3c14b","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"c13070f5-3f89-4975-90ec-c628e04a66ce","root":false,"$title":"[TC.6.1.0][INPUT] Selecionar bandeira","$position":{"top":"860px","left":"2282.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"75e170b4-92d5-40c1-a211-a754270514c6":{"$contentActions":[{"action":{"$id":"b00b58af-c4a0-4b88-acc6-bfd375877d98","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"77493d5b-9a1e-4064-ad0b-8a832afdf10d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"87cd5126-0e6d-401b-8e15-fc57f4b1139f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c3541272-a652-4112-9a0f-665d23c0136e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"006286b7-e8d7-4b83-9872-ad9d389e8b86","typeOfStateId":"state","$connId":"con_343","$id":"c09edcfb-0f9f-4f6a-8645-bf6d48a01006","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"efc6afd4-c708-460d-842d-5021f952c686","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run() {\n\ttry {\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Outras bandeiras\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"type\": \"reply\",\n\t\t\t\t\"reply\": {\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Encerrar atendimento\"\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tconst headerText = \"Como deseja prosseguir?\";\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": headerText,\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\tbuttons\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":[],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0f33f515-fb87-4d9e-a1dd-91d3b3e1883f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dfb72a1d-bdef-418d-95f2-015faf9dbc48","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-68da95f7-7b5a-4cc8-97c0-3e564e1d1aa9","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-75cee0a0-a7ce-4ecb-bf73-54ed0c776cad","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"75e170b4-92d5-40c1-a211-a754270514c6","root":false,"$title":"[TC.6.2.0][MSG] Prosseguir","$position":{"top":"1406.33px","left":"2283px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"006286b7-e8d7-4b83-9872-ad9d389e8b86":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"06094d8f-981b-4ac3-a526-af631e3f4600","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"1bd26f72-4287-4f83-9213-ca282c18ab23","typeOfStateId":"state","$connId":"con_348","$id":"208d9650-9890-4f86-940a-353bc6ce531e","conditions":[{"source":"context","comparison":"equals","values":["Encerrar atendimento"],"variable":"userInput"}],"$invalid":false},{"stateId":"dc6146ef-b6d2-4944-bc07-4b32c8467bd9","typeOfStateId":"state","$connId":"con_353","$id":"5a064d2e-f3b8-4cf7-a334-512f56c018c9","conditions":[{"source":"context","comparison":"equals","values":["Outras bandeiras"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"22544a01-53d2-4dcb-aced-ddb4bb463c2e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"encerrar atendimento|encerrar\": \"Encerrar atendimento\",\n      \"Outras bandeiras|outras\": \"Outras bandeiras\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c054b662-39ca-4707-92a1-404817bd887a","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"b5d2c7d5-7c3b-4597-b21a-a1584163b867","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"765886d2-9abd-4add-8e03-45e58b1d809b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Master","Visa","Elo","Amex","Hiper"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-4e3b067b-dd5c-4c3d-bdf5-c1aa09c76644","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7775833f-3c3d-42f8-b327-804868258113","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-05565eca-fe4e-43df-b373-1ab84a446d48","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-d0ab567a-c962-4f0b-aafc-6c4be200f434","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"006286b7-e8d7-4b83-9872-ad9d389e8b86","root":false,"$title":"[TC.6.2.0][INPUT] Prosseguir","$position":{"top":"1583.33px","left":"2283px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"1bd26f72-4287-4f83-9213-ca282c18ab23":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d646fbe5-ed8c-4f61-a3c0-d14fa2ff76e1","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"1bd26f72-4287-4f83-9213-ca282c18ab23","root":false,"$title":"[GO TO] Finalizacao","$position":{"top":"1947px","left":"2086.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"dc6146ef-b6d2-4944-bc07-4b32c8467bd9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e87965d8-8d76-4dd6-82df-338546e2c5eb","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a1463090-6db0-47f5-9840-36d1cd830c25","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"dc6146ef-b6d2-4944-bc07-4b32c8467bd9","root":false,"$title":"[GO TO] TC.6.1.0 Selecionar bandeira","$position":{"top":"1929px","left":"2431px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"722bd745-fd0f-4ade-9937-852d7db9e165":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"c9ba908c-18ee-43c9-8df0-e67e932e5074","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"bbc18d76-6b5d-4a90-ad31-fcabb1586308","typeOfStateId":"state","$connId":"con_358","$contentId":"b881df70-82f9-4f96-9e69-716b162fdb40","$id":"4f7480d3-8048-4b59-8455-ae5aedfbaef7","conditions":[{"source":"context","comparison":"equals","values":["Valor divergente"],"variable":"userInput"}],"$invalid":false},{"stateId":"bbc18d76-6b5d-4a90-ad31-fcabb1586308","typeOfStateId":"state","$connId":"con_363","$contentId":"b881df70-82f9-4f96-9e69-716b162fdb40","$id":"2f99ccf7-df36-441d-ad0e-b5c793e89914","conditions":[{"source":"context","comparison":"equals","values":["Cobrança duplicada"],"variable":"userInput"}],"$invalid":false},{"stateId":"64033608-d1fe-4704-aebe-31662a651f61","typeOfStateId":"state","$connId":"con_368","$contentId":"b881df70-82f9-4f96-9e69-716b162fdb40","$id":"9a712681-4fac-4d7f-baa0-34fb7863e1fe","conditions":[{"source":"context","comparison":"equals","values":["Outros motivos"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"9409a2fd-7527-45fe-b569-22becbc867b8","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    let regexDictionary = {\n      \"valor divergente|valor\": \"Valor divergente\",\n      \"cobran[cç]a duplicada\": \"Cobrança duplicada\",\n      \"outros motivos|outros\": \"Outros motivos\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"a0c0d83b-9bdb-4ebb-a5f2-300e12409057","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"b02e9c56-1603-4244-b2c6-792c3cedaa2e","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"b8c2902e-5b08-4ffd-880b-0e14b21ee87f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Valor divergente","Cobrança duplicada","Outros motivos"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-2b443c0d-fa38-498f-863e-34064f8897af","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-844a4f77-5038-48d6-9e65-e6fbd12ee524","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2f357214-f8c7-4578-87ee-cf1d2361b578","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-a22fbb14-3032-446c-8e54-2bdeb691f587","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"722bd745-fd0f-4ade-9937-852d7db9e165","root":false,"$title":"[TC.7.0.0][INPUT] Questionar uma cobrança","$position":{"top":"673px","left":"3265.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"faf5caf6-e19a-42eb-9d38-2e4e58acae88":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"ea0411d0-285d-4394-bb28-7e700f3871d5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"bbc18d76-6b5d-4a90-ad31-fcabb1586308","typeOfStateId":"state","$connId":"con_373","$id":"b6242e51-095a-495f-bd48-1457612f253e","conditions":[{"source":"context","comparison":"notEquals","values":["inatividade"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"1e5a0305-f860-43b3-92ca-5ab64de4c1de","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    return inputUsuario\n    \n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"01f6aa41-2411-41e1-a1e4-5364dbde0813","$typeOfContent":"","type":"SetVariable","$title":"Set \"motivoChamado\" with userInput","$invalid":false,"settings":{"variable":"motivoChamado","value":"{{userInput}}"},"conditions":[]},{"$id":"0a63dbc9-395d-471a-a600-19d9db12e4f3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"f5613662-6e68-459f-b205-cedc2e836b52","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-890f4de5-444a-4ad8-812e-4fbfaf7f40f4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4b038776-f88a-42b4-ba3a-036bd5557dd2","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-53d59894-bac4-4266-991d-5509a127f802","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-471bcc07-e113-440a-831d-347957a150de","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"faf5caf6-e19a-42eb-9d38-2e4e58acae88","root":false,"$title":"[TC.7.0.1][INPUT] Outro Motivo","$position":{"top":"1087.86px","left":"3546.71px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"9cb5ee14-0641-4154-91a2-384720f31f85":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"59491125-e819-46e7-80c4-a3cb59697a47","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"e695d17c-2f37-44ac-9508-6986fb99b351","typeOfStateId":"state","$connId":"con_378","$id":"288ee9a9-16a3-41fa-baf3-b580beaf0acd","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bda34732-837d-43e2-ab6a-c26cfa80004d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n\tconst invalidInputMessage = 'input inesperado';\n\ttry {\n\t\tif (!inputUsuario) {\n\t\t\treturn 'inatividade'\n\t\t}\n\t\tconst regexDictionary = {\n\t\t\t\"^aluguel$\": \"Aluguel\",\n\t\t\t\"^mdr$\": \"MDR\",\n\t\t\t\"^arv$\": \"ARV\"\n\t\t};\n\t\tfor (let regex in regexDictionary) {\n\t\t\tif (new RegExp(regex, 'i').test(inputUsuario)) {\n\t\t\t\treturn regexDictionary[regex];\n\t\t\t}\n\t\t}\n\t\treturn invalidInputMessage;\n\t} catch (err) {\n\t\treturn invalidInputMessage;\n\t}\n}\n","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"452cb59f-11b3-49e9-b5cf-da9096835ee5","$typeOfContent":"","type":"SetVariable","$title":"Set \"origemCobranca\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"origemCobranca","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"6d2aaf40-ad2d-40a8-b4f5-7dca201fa403","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"275c4181-9284-4540-a618-de6d28fbefb4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"987328df-bfa7-4ef7-b39b-c5e03ac0aa7b","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Aluguel","MDR","ARV"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6eaccd5c-30be-425f-a242-a701e4cbb24a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3ac9e3e8-4e6a-46fc-99c1-a0977920ea3c","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-4a43f556-9172-48c2-a5f6-c40353f71eaa","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-40cc7cbb-04df-4856-9b86-8680e5fbd1ff","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"9cb5ee14-0641-4154-91a2-384720f31f85","root":false,"$title":"[TC.7.0.2][INPUT] Origem da cobrança","$position":{"top":"1118.57px","left":"3069.29px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1d4c3b8a-0f56-437e-beec-2c5ba9efea28":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"59491125-e819-46e7-80c4-a3cb59697a47","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"f676f5a4-86d1-4e05-a2b8-485b8dd91725","typeOfStateId":"state","$connId":"con_383","$id":"98a6a3d9-9e3c-4464-ad66-768762d5fd76","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bda34732-837d-43e2-ab6a-c26cfa80004d","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado';\n  try {\n    if (!inputUsuario) {\n\t\t\treturn 'inatividade'\n\t\t}\n    const regexDictionary = {\n      \"^c[oó]nt[aá]\\\\s*c[oó]rr[eé]nt[eé]$\": \"Conta corrente\",\n      \"^ag[eé]nd[aá]$\": \"Agenda\"\n    };\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex];\n      }\n    }\n    return invalidInputMessage;\n  } catch (err) {\n    return invalidInputMessage;\n  }\n}\n","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b77f2239-5e1d-4756-a5ab-f2aa237643d7","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"ce4db9f6-5647-4644-8abc-b0119d9e0493","$typeOfContent":"","type":"SetVariable","$title":"Set \"localVisualizacaoCobranca\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"localVisualizacaoCobranca","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"ce585957-fc6f-481c-a6b9-9b6331f4c0d9","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"ac17e99c-87e2-4b0b-9811-e16136d70cc1","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Conta Corrente","Agenda"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-80b5af56-7974-44f3-b8aa-5638bea795d0","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-305c00ff-df7e-4fd7-b4d4-91eb2009dcc4","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-38cfb079-d1f1-49d2-89f8-9579c8ff270b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7a812918-22ab-4c8a-bdf5-48d1f7e68105","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1d4c3b8a-0f56-437e-beec-2c5ba9efea28","root":false,"$title":"[TC.7.1.0][INPUT] Onde visualizou a cobrança","$position":{"top":"1685.57px","left":"3067.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7bf80e9d-79e9-4578-acba-c963f814037e":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"604db07f-4e0d-4909-aaef-d23754b5bc65","typeOfStateId":"state","$connId":"con_388","$id":"ef04e652-526a-411f-9385-a603df4c7b38","conditions":[{"source":"context","comparison":"notEquals","values":["input inesperado"],"variable":"userInput"},{"values":["inatividade"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c95438ca-ada8-4352-bc3d-48620479c866","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(data) {\n\ttry {\n\t\tif (!data) {\n\t\t\treturn 'inatividade'\n\t\t}\n\t\tconst regex = /^(\\d{2})[\\/\\-]?(\\d{2})[\\/\\-]?(\\d{4})$/;\n\t\tif (!regex.test(data)) return 'input inesperado';\n\n\t\tlet dia = parseInt(data.substring(0, 2));\n\t\tlet mes = parseInt(data.substring(3, 5));\n\t\tlet ano = parseInt(data.substring(6, 10));\n\n\t\tif (dia < 1 || dia > 31) return 'input inesperado';\n\t\tif (mes < 1 || mes > 12) return 'input inesperado';\n\t\tif ((mes == 4 || mes == 6 || mes == 9 || mes == 11) && dia == 31) return 'input inesperado';\n\t\tif (mes == 2) {\n\t\t\tconst bissexto = (ano % 4 == 0 && (ano % 100 != 0 || ano % 400 == 0));\n\t\t\tif (dia > 29 || (dia == 29 && !bissexto)) return 'input inesperado';\n\t\t}\n\t\treturn dia.toString().padStart(2, '0') + '/' + mes.toString().padStart(2, '0') + '/' + ano;\n\t} catch (err) {\n\t\treturn 'input inesperado'\n\t}\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f7d7e70b-45f0-457f-89e9-82943b64c561","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"data\"","$invalid":false,"settings":{"variable":"exceptionType","value":"data"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"ccce0800-0113-4088-b71c-3aae12d436d0","$typeOfContent":"","type":"SetVariable","$title":"Set \"dataCobranca\" to \"{userInput}\"","$invalid":false,"settings":{"variable":"dataCobranca","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"d4776bf5-4b99-494e-a76c-049a18cd868f","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"734a31ab-a5a0-41df-8fcb-fe7031f3c55c","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-31d209c5-a545-4790-b94f-dd80a23bf951","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ee1f3711-3bf3-4caf-b720-c649c3ddeba9","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-e0713714-392b-46dc-b35e-34f5262ee047","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b7f6d299-dba1-4158-a8bb-6588fa6c6ddf","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7bf80e9d-79e9-4578-acba-c963f814037e","root":false,"$title":"[TC.7.2.0][INPUT] Solicita data da cobrança","$position":{"top":"2152px","left":"3068px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"604db07f-4e0d-4909-aaef-d23754b5bc65":{"$contentActions":[{"action":{"$id":"5506b830-1b9b-4ca6-89fa-06039b587e70","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4fdd0aaa-a27c-46b7-9b7f-2c9a90c3bef6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"d73b6cc2-9e25-4b12-97af-7d6d54a53677","$typeOfContent":"text","type":"SendMessage","settings":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Por último, informe o valor exato da cobrança.\n\nComo neste exemplo:\n👉 3.500,00","metadata":{}},"$cardContent":{"document":{"id":"756fb519-1456-4184-ae4d-116c43fafb54","type":"text/plain","content":"Por último, informe o valor exato da cobrança.\n\nComo neste exemplo:\n👉 3.500,00"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cea78e8d-1507-414e-bf38-32e9e970fc57","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a9a96de6-7c5c-4625-8765-bd797a7e9c86","typeOfStateId":"state","$connId":"con_393","$id":"73a052ad-a897-4086-af37-45c8bf7a56e3","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0f2b4506-1c0f-4e4a-a601-60a727e4d1ac","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-99780e53-0fea-4dae-860a-a42ce1158b80","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-6a52363d-a85d-4cf7-98f3-10d5df574172","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"604db07f-4e0d-4909-aaef-d23754b5bc65","root":false,"$title":"[TC.7.3.0][MSG] Solicita valor da cobrança","$position":{"top":"2407.33px","left":"3068px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a93d6907-ae20-48eb-afeb-42de5c3bc9ba":{"$contentActions":[{"action":{"$id":"289f49df-035c-409b-b964-e77f22a2e773","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d535b8e5-e90f-468c-a07b-49e1714c77b5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d535b8e5-e90f-468c-a07b-49e1714c77b5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ac23b5d8-55c8-4e45-8cb9-7c5f919d8aa0","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f8431b5c-018b-46fe-a5ae-d5ca83a2b909","type":"text/plain","content":"O seu pedido de revisão foi enviado com sucesso! \nEste é o número do seu protocolo \n👉 <b>{{idProtocoloBpm}}</b>","metadata":{}},"$cardContent":{"document":{"id":"f8431b5c-018b-46fe-a5ae-d5ca83a2b909","type":"text/plain","content":"O seu pedido de revisão foi enviado com sucesso! \nEste é o número do seu protocolo \n👉 <b>{{idProtocoloBpm}}</b>"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3f755d35-df5f-43f2-9d1c-79379e2f4074","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"90bb9419-878e-4ab4-b26f-ba9a32da265f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"},"metadata":{}},"$cardContent":{"document":{"id":"90bb9419-878e-4ab4-b26f-ba9a32da265f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"2000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c23f71b4-d97c-44b8-a6ae-026bcc9ee708","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2a277fbd-bb76-403d-8243-e2f447aeca3b","type":"text/plain","content":"O prazo para análise é de até 4 dias úteis.","metadata":{}},"$cardContent":{"document":{"id":"2a277fbd-bb76-403d-8243-e2f447aeca3b","type":"text/plain","content":"O prazo para análise é de até 4 dias úteis."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"37286ef7-791d-4af5-938f-fd2600482e21","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ce357aaf-62ad-433e-8e14-0695d22dd8c9","typeOfStateId":"state","$connId":"con_398","$id":"c5e218ce-0c5f-4d2a-b638-93dcb76cd382","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b6e6bd79-16cf-4654-b664-5d125d392d49","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-87784b6c-764b-4036-a063-7671c2fcd0bb","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-674231cf-f6d1-4ae4-bfad-c02db0fba861","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a93d6907-ae20-48eb-afeb-42de5c3bc9ba","root":false,"$title":"[TC.7.5.0][MSG] Protocolo Criado","$position":{"top":"3097.67px","left":"3066.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"ce357aaf-62ad-433e-8e14-0695d22dd8c9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"667f8c27-83a8-46b6-a0d6-22f1f3aaf496","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"ce357aaf-62ad-433e-8e14-0695d22dd8c9","root":false,"$title":"[GO TO] Finalizacao ","$position":{"top":"3297.67px","left":"3067.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ab0adeac-f86e-442b-a933-60fa68af47ee":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"7d3b7196-f824-4926-88ec-84fdd31f45d0","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"ab0adeac-f86e-442b-a933-60fa68af47ee","root":false,"$title":"[GO TO] Finalizacao  ","$position":{"top":"840px","left":"4280.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"aece7772-1087-427c-9eb8-891be0b4a004":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"b2ec0d82-b63d-40d7-aa6d-f5c8e49957a2","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3eb16c87-6c3e-411d-b7ef-b9e49c13d2df","typeOfStateId":"state","$connId":"con_403","$id":"3db349a2-b3ca-4eec-b3f9-a644abf8841d","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"userInput"}],"$invalid":false},{"stateId":"e40040f5-edd2-4063-b02c-b6d2d2490b53","typeOfStateId":"state","$connId":"con_408","$id":"e4631e8c-6545-4e15-aeb3-951eea10d7f0","conditions":[{"source":"context","comparison":"equals","values":["Não"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"7f43624c-b91c-4c93-af22-e9716ed292f1","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"41261742-2361-4d4e-b1b3-066bb20246bb","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"47d922f8-1468-4475-a997-0eff3ac2f8cc","$typeOfContent":"","type":"SetVariable","$title":"Set \"pesquisa\" to \"resolutividade\"","$invalid":false,"settings":{"variable":"pesquisa","value":"resolutividade"},"conditions":[]},{"$id":"7a818d3d-00c5-4aa1-b3dd-54cc5e6c2966","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"24a1bb27-405d-41eb-8989-88e0a045d857","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8ee7b748-ec4e-4c7e-95ad-f14375419dcb","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-62c29f89-5030-4add-b3f4-cce78176d01d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8ecfef12-39e8-411f-8eb4-ce3cc68d3219","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-0e1d8bbc-f73c-421b-a462-1e47db5640dc","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"aece7772-1087-427c-9eb8-891be0b4a004","root":false,"$title":"[TC.4.1.0][INPUT] Sem máquinas","$position":{"top":"656px","left":"1761px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"62786aa5-df6a-4069-9147-36ff1377b02c":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"dfd199b8-ed5e-44e2-b226-65990f659223","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"e66b1d69-3e83-4e4d-9f57-5c2d84cd1ce5","typeOfStateId":"state","$connId":"con_413","$id":"85090cee-f4fc-479b-aac1-028aef06464b","conditions":[{"source":"context","comparison":"equals","values":["Aluguel","Alugada"],"variable":"modalidadeMaquina"},{"values":["Valido"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"0e6bc8ca-977f-40d6-9ccf-23d15a44268b","typeOfStateId":"state","$connId":"con_418","$id":"edb80c29-d63b-4d76-8371-02ea5457feac","conditions":[{"source":"context","comparison":"equals","values":["Comprada","Compra"],"variable":"modalidadeMaquina"},{"values":["Valido"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"5bf2a0db-0d48-4d71-8e84-d22c890f3b21","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n    try {\n        if (!userInput) {\n            return 'inatividade'\n        }\n        const alphanumericRegex = /^\\w+$/;\n        if (alphanumericRegex.test(userInput)) {\n            return \"Valido\"\n        }\n        return \"Input inesperado\"\n    }\n    catch (e) {\n        return \"Input inesperado\";\n    }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"811c5e0e-585b-4b14-b865-b5c64a1564e9","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"numeroSerie\"","$invalid":false,"settings":{"variable":"exceptionType","value":"numeroSerie"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"fb1a70e8-f34e-4dfa-b57c-716e389d29eb","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroSerie\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(userInput) {\n\ttry {\n\t\tuserInput = userInput.toString();\n\t\treturn `${userInput}`\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["input.content"],"outputVariable":"numeroSerie","LocalTimeZoneEnabled":false},"conditions":[{"values":["Valido"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"3916ceef-75b5-4956-8bd4-11a107c43e60","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"291f6c32-bbc4-4531-b3f3-38add7613d92","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-98d03ff8-4e83-4852-9ae4-acc245ff6c3c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ca2adf87-3231-4e39-bab2-c869f469202f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-49ead6f1-a335-4cc8-a0ad-0ade71dd847b","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b46fce4c-fa72-4b06-a913-ed6fd8d031c6","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"62786aa5-df6a-4069-9147-36ff1377b02c","root":false,"$title":"[TC.4.2.0][INPUT] Numero de Série","$position":{"top":"1436.57px","left":"867px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3468fd40-a03c-45dc-b438-f0066d5aee17":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"3576eedf-1d52-44fa-8018-41112a232738","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"e66b1d69-3e83-4e4d-9f57-5c2d84cd1ce5","typeOfStateId":"state","$connId":"con_423","$id":"490794ee-f656-48f1-8b54-03aa40ebe9ae","conditions":[{"source":"context","comparison":"equals","values":["1"],"variable":"sizeMaquinas"},{"values":["Aluguel"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"0e6bc8ca-977f-40d6-9ccf-23d15a44268b","typeOfStateId":"state","$connId":"con_428","$id":"958376d9-52a0-4f92-a0c0-d9e20f895648","conditions":[{"source":"context","comparison":"equals","values":["1"],"variable":"sizeMaquinas"},{"values":["Comprada"],"source":"context","comparison":"equals","variable":"userInput"}],"$invalid":false},{"stateId":"bb74c3c9-73bc-4030-ae90-62acb134db5e","typeOfStateId":"state","$connId":"con_433","$id":"5c557a36-cee0-437b-8115-4716988b35a1","conditions":[{"source":"context","comparison":"lessThanOrEquals","values":["10"],"variable":"sizeMaquinas"},{"values":["Aluguel","Comprada"],"source":"context","variable":"userInput","comparison":"equals"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d20490b5-904a-4416-a731-06ac23f66cca","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"40e65a97-519f-4ef8-b4db-25c479101d3b","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"9ef7b366-4cbf-4bbb-8790-e8a8befc0e8e","$typeOfContent":"","type":"SetVariable","$title":"Set \"modalidadeMaquina\"","$invalid":false,"settings":{"variable":"modalidadeMaquina","value":"{{userInput}}"},"conditions":[{"values":["Input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"74f7c8ea-d813-4e50-a691-98c71491c048","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"sizeMaquinas\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina, modalidadeMaquina) {\n  try {\n    let consultMaquina = JSON.parse(consultMaquina);\n    consultMaquina = consultMaquina.data\n    let modalidadeMaquina = modalidadeMaquina.replace('Comprada', 'V')\n    if (modalidadeMaquina == 'V') {\n      consultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'V')\n    } else if (modalidadeMaquina != '') {\n      consultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'A' || modalidade.modalidade == 'C')\n    }\n    consultMaquina = consultMaquina.length\n    return consultMaquina\n  }\n  catch (e) {\n    return e.message;\n  }\n}","inputVariables":["consultMaquina","modalidadeMaquina"],"outputVariable":"sizeMaquinas","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6baaa566-b9aa-4df4-b7d0-046529d05cd4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"bd0b215d-8c11-43ae-a726-c8bd1f911fbc","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Aluguel","Comprada"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-24bb27c8-a54f-46b3-a313-fa0fbf34a484","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d05fc307-1367-42d8-a583-42f795d74f12","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-7c3c558a-165d-49bb-afc7-78b97e563fcf","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-222b57ec-4a56-4fe6-95ce-6d746f5aa695","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"3468fd40-a03c-45dc-b438-f0066d5aee17","root":false,"$title":"[TC.4.3.0][INPUT] Alugada ou Comprada","$position":{"top":"988px","left":"1185px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"8e0fcca7-a496-4ef1-a91b-2549e02cacfc":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"f72881e8-f826-4b73-bc74-af0c6c5c0994","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"0e6bc8ca-977f-40d6-9ccf-23d15a44268b","typeOfStateId":"state","$connId":"con_438","$id":"d7fb1924-201b-4e29-8f70-6e777f865a04","conditions":[{"values":["Valido"],"source":"context","comparison":"equals","variable":"userInput"},{"values":["Comprada"],"source":"context","comparison":"equals","variable":"modalidadeMaquina"}],"$invalid":false},{"stateId":"e66b1d69-3e83-4e4d-9f57-5c2d84cd1ce5","typeOfStateId":"state","$connId":"con_443","$id":"d38a6001-fe63-41df-bb96-bb9051d71203","conditions":[{"source":"context","comparison":"equals","values":["Valido"],"variable":"userInput"},{"values":["Aluguel","Alugada"],"source":"context","comparison":"equals","variable":"modalidadeMaquina"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"597789dd-9eee-4107-8355-8ea81ea0edb0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"\nfunction run(sizeMaquinas, userInput) {\n\ttry {\n\t\tif (!userInput) {\n\t\t\treturn 'inatividade'\n\t\t}\n\t\tlet selecao = parseInt(userInput)\n\t\tsizeMaquinas = parseInt(sizeMaquinas)\n\t\tif (selecao > sizeMaquinas) {\n\t\t\treturn \"Input inesperado\";\n\t\t}\n\t\tconst numericRegex = /^[1-9]+$/;\n\t\tif (numericRegex.test(userInput)) {\n\t\t\treturn \"Valido\"\n\t\t}\n\t\treturn \"Input inesperado\"\n\t}\n\tcatch (e) {\n\t\treturn \"Input inesperado\";\n\t}\n\n}","inputVariables":["sizeMaquinas","input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"95509247-703a-4126-a125-02246fc47f23","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"listaNumerica\"","$invalid":false,"settings":{"variable":"exceptionType","value":"listaNumerica"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"d1510921-7c4a-43c5-91ca-2295f39701b4","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"numeroSerie\"","$invalid":false,"settings":{"function":"run","source":"function run(consultMaquina, modalidadeMaquina, index) {\n\ttry {\n\t\tconsultMaquina = JSON.parse(consultMaquina).data;\n\t\tif (modalidadeMaquina == 'Comprada') {\n\t\t\tconsultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'V')\n\t\t} else if (modalidadeMaquina != '') {\n\t\t\tconsultMaquina = consultMaquina.filter((modalidade) => modalidade.modalidade == 'A' || modalidade.modalidade == 'C')\n\t\t}\n\t\tlet numeroSerie = consultMaquina[index - 1].numeroSerie\n\t\treturn numeroSerie;\n\t}\n\tcatch (e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["consultMaquina","modalidadeMaquina","input.content"],"outputVariable":"numeroSerie","LocalTimeZoneEnabled":false},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"36f7b9e5-515e-4fd7-b7a3-1340b551f8eb","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"005b381c-b2a3-4491-827c-64597b4084c4","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-262caf7f-b443-49e0-a4c2-53f5b6b4cf8c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3005ac25-a0f3-48c5-a5a8-8e1a46f6c928","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-759a2605-7fe1-446b-99f6-0e8ff008ee20","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-58074e5d-7d5a-45ea-b86a-0d434441c019","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"8e0fcca7-a496-4ef1-a91b-2549e02cacfc","root":false,"$title":"[TC.4.4.0][INPUT] Lista número série","$position":{"top":"1858.75px","left":"1521px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e40040f5-edd2-4063-b02c-b6d2d2490b53":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"efda90b4-9f46-480a-bb50-99aaa9fab7d3","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"e40040f5-edd2-4063-b02c-b6d2d2490b53","root":false,"$title":"[GO TO] Finalizacao   ","$position":{"top":"863px","left":"1861px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3eb16c87-6c3e-411d-b7ef-b9e49c13d2df":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"229f22dc-d3ef-4637-b03c-34bbe1bf1dcd","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"5724999e-4ebb-443e-8b1d-4c15ef40251e","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"3eb16c87-6c3e-411d-b7ef-b9e49c13d2df","root":false,"$title":"[GO TO] Redirect WhatsApp PJ (Humano) ","$position":{"top":"850px","left":"1663px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a987eb86-a520-4671-9e28-bcc98388eff4":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"73db3d78-b7a6-40d2-aed0-09ed45b00c7d","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"6509358e-b1fb-45d3-977c-cbf4b94cc5c4","typeOfStateId":"state","$connId":"con_448","$id":"e69b0346-b308-4615-abd4-6552913f322f","conditions":[{"source":"context","comparison":"equals","values":["Fazer outra consulta"],"variable":"userInput"}],"$invalid":false},{"stateId":"78b67e8d-1f89-44d8-955b-04e979597b42","typeOfStateId":"state","$connId":"con_453","$id":"9f7d87fe-79f3-4360-a478-690ad42d6183","conditions":[{"source":"context","comparison":"equals","values":["Encerrar"],"variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"dd68f93e-519d-433f-8787-edc0883dd5c8","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} exibição","action":"Exibição"},"conditions":[]}],"$leavingCustomActions":[{"$id":"61002fc4-da61-4953-b74d-595b0722758e","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario) {\n  const invalidInputMessage = 'input inesperado'\n  try {\n    if (!inputUsuario) {\n      return 'inatividade'\n    }\n    const regexDictionary = {\n      \"fazer outra consulta|outra\": \"Fazer outra consulta\",\n      \"encerrar|sair\": \"Encerrar\"\n    }\n    for (let regex in regexDictionary) {\n      if (new RegExp(regex, 'i').test(inputUsuario)) {\n        return regexDictionary[regex]\n      }\n    }\n    return invalidInputMessage\n  } catch (err) {\n    return invalidInputMessage\n  }\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"bd2f427e-8424-4eed-b643-112de920d73f","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"quickReply\"","$invalid":false,"settings":{"variable":"exceptionType","value":"quickReply"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"298d04e9-0948-499c-abdd-9965c3c463af","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"39d726e0-bba1-4817-a15c-9f20d340a7a3","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":["Fazer outra consulta","Encerrar"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-82dd3692-c8d7-4176-ba9d-f28e838c2c7f","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-b1491b5b-6cc5-418d-954b-2f7198459cef","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-44aadf8e-633e-43e0-a82f-15b72d105e54","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ecdc2b1e-fef3-4ef1-90f0-4fec4300cc7e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"a987eb86-a520-4671-9e28-bcc98388eff4","root":false,"$title":"[TC.4.6.0][INPUT] Como deseja prosseguir?","$position":{"top":"2578.5px","left":"1125.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"6509358e-b1fb-45d3-977c-cbf4b94cc5c4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5c476535-bee3-4b71-acf9-506ce9c3db95","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"24ee326c-2f65-4cf1-944e-2b178eaf2a82","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"6509358e-b1fb-45d3-977c-cbf4b94cc5c4","root":false,"$title":"[GO TO] TC.4.0.0 Nova Consulta","$position":{"top":"2470px","left":"1436px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"78b67e8d-1f89-44d8-955b-04e979597b42":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"17e3ccf6-6750-4341-81e5-fdbce4945d37","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"820d335f-0c95-466f-9009-35cac24c6ea4","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"78b67e8d-1f89-44d8-955b-04e979597b42","root":false,"$title":"[GO TO] Finalizacao    ","$position":{"top":"2732px","left":"1430px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"820d335f-0c95-466f-9009-35cac24c6ea4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"3a432035-25be-47a0-9375-c12071e5d655","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c01ef50f-0400-45b9-b882-805edc3533c0","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `finalizacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terror: err.message,\n\t\t\tlastInput\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"cc1d6a0c-4326-4288-96bf-aea4570ddbb4","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um serviço","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@lastInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-ffe658b0-9361-47aa-900f-bdfe96d24d4c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f7e8f948-152d-4c88-a2b9-547ba48e09b6","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"820d335f-0c95-466f-9009-35cac24c6ea4","root":false,"$title":"[Redirect] To Finalizacao (Welcome)","$position":{"top":"0px","left":"957px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5724999e-4ebb-443e-8b1d-4c15ef40251e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"53ecccb3-e087-49da-8667-d20438985d9a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"8d3a9912-951d-4bfc-ac47-2a281fc57f02","$typeOfContent":"","type":"SetVariable","$title":"Set \"atendimento\" to \"humano\"","$invalid":false,"settings":{"variable":"atendimento","value":"humano"},"conditions":[]},{"$id":"b0e87449-cedc-4403-99b9-f0a312c926bd","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\t\t\tlet match = previousStateName.match(/\\[(.*?)\\]/);\n\t\tlet stateNameOrigin = match ? match[1] : previousStateName;\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tstateNameOrigin,\n\t\t\tbotDestination: `Whatsapp PJ ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: \"atendente\",\n\t\t\tintent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockId,\n\t\t\t// stateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\terror: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"899b0fcf-a95a-42db-ab36-2b708dd3f4c9","$typeOfContent":"","type":"Redirect","$title":"Redirect to {service} sending \"atendente\"","$invalid":false,"settings":{"context":{"type":"text/plain","value":"atendente"},"address":"WhatsApp PJ"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-83959036-599b-420d-b0db-372afb821e14","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-d157bed4-18d2-40a7-b366-d5bd364f3ed7","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-dec93541-7844-4ef5-8d8b-1c1a0ef3101d","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"5724999e-4ebb-443e-8b1d-4c15ef40251e","root":false,"$title":"[Redirect] To WhatsApp PJ (atendente)","$position":{"top":"0px","left":"1166px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a5ddf643-13c0-4a81-a174-e1aa9dd86873":{"$contentActions":[{"action":{"$id":"66dcccdd-84cf-418f-921d-62b42de562cd","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"351051cd-4798-413e-a702-ef0e2978bc81","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"351051cd-4798-413e-a702-ef0e2978bc81","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"7712099a-1707-4bb2-ae75-112db962bb0d","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{{dynamicContent}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a893a955-6a21-4015-bd79-42b681faa3ce","typeOfStateId":"state","$connId":"con_458","$id":"a8589e38-4f1d-411c-96c1-79f84e25bbd0","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"97385bad-2724-4c43-8eda-2f52b32381f2","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e condições {state.name} exibição\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e condições {{state.name}} exibição","action":"Exibição"},"conditions":[]},{"$id":"c0af04a5-2b02-4fd8-9642-603e586aa13f","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"dynamicContent\"","$invalid":false,"settings":{"function":"run","source":"function run(ec) {\n\ttry {\n\t\tlet defaultMenuOptions = [\n\t\t\t{\n\t\t\t\t\"id\": \"6\",\n\t\t\t\t\"title\": \"Questionar uma cobrança\",\n\t\t\t\t\"description\": \"\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"7\",\n\t\t\t\t\"title\": \"Pacotes contratados\",\n\t\t\t\t\"description\": \"\"\n\t\t\t}\n\t\t]\n\n\t\tif (ec) {\n\t\t\tconst ecOnlyOptions = [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"1\",\n\t\t\t\t\t\"title\": \"Taxas de Venda\",\n\t\t\t\t\t\"description\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"2\",\n\t\t\t\t\t\"title\": \"Taxas de Antecipação\",\n\t\t\t\t\t\"description\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"3\",\n\t\t\t\t\t\"title\": \"Consultar Máquinas\",\n\t\t\t\t\t\"description\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"4\",\n\t\t\t\t\t\"title\": \"Domicilio bancário\",\n\t\t\t\t\t\"description\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"5\",\n\t\t\t\t\t\"title\": \"Taxas Pix na SafraPay\",\n\t\t\t\t\t\"description\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"8\",\n\t\t\t\t\t\"title\": \"Contratar antecipação\",\n\t\t\t\t\t\"description\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t\tdefaultMenuOptions = [...defaultMenuOptions, ...ecOnlyOptions].sort((a, b) => a.id - b.id)\n\t\t}\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"list\",\n\t\t\t\t\"header\": {\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\"\n\t\t\t\t},\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": `Certo! Sobre Condições e Taxas, do que você precisa?\n\t\t\t\t\t\nEscolha na lista a seguir. 👇`\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"button\": \"Escolha uma opção\",\n\t\t\t\t\t\"sections\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"title\": \"\",\n\t\t\t\t\t\t\t\"rows\": defaultMenuOptions\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\treturn false;\n\t}\n}","inputVariables":["selectedEc"],"outputVariable":"dynamicContent","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-9bba86b2-7866-4ed0-873e-5f68e8dffdf2","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-e483f50d-b5c5-4590-a9f3-abd7bc176300","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-35c797e0-4e40-48b3-ae05-4198104ed25b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a5ddf643-13c0-4a81-a174-e1aa9dd86873","$title":"[TC.1.0.0][MSG] Menu Taxas e condições","$position":{"top":"11.6667px","left":"2417.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"a893a955-6a21-4015-bd79-42b681faa3ce":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:8"},"$invalid":false}],"$conditionOutputs":[{"stateId":"708a01ab-973e-404f-8e0f-fe4a312b5100","typeOfStateId":"state","$connId":"con_463","$id":"66cc2330-ecd8-4fae-8804-6a5918304e5d","conditions":[{"source":"context","comparison":"notEquals","values":["inatividade"],"variable":"userInput"},{"values":["Input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"ff58f2fb-9134-4b51-a9c6-0f8c18db95be","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"userInput\"","$invalid":false,"settings":{"function":"run","source":"function run(inputUsuario, dynamicContent) {\n    const posicoes = {\n        \"1\": \"primeir[oa]|u[mn]\",\n        \"2\": \"segund[ao]|do[ie]s\",\n        \"3\": \"terceir[ao]|tr[eê]s\",\n        \"4\": \"quart[ao]|[qc]uat(r)?o\",\n        \"5\": \"quint[ao]|[sc]inc[ou]\",\n        \"6\": \"sext[ao]|[sc]inc[uo]\",\n        \"7\": \"s[eé]tim[ao]|[sc]et[ei]\",\n        \"8\": \"oitav[ao]|oit[ou]\",\n        \"9\": \"non[ao]|nov[ei]\",\n        \"10\": \"d[eé][cs]im[ou]|d[ée][sz]\"\n    }\n    try {\n        if (!inputUsuario) return 'inatividade'\n        const regexDictionary = {}\n        const { rows } = JSON.parse(dynamicContent).interactive.action.sections[0]\n        rows.forEach((button, index) => {\n            const key = `\\\\b${index + 1}\\\\b|${posicoes[index + 1]}|${button.title.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase()}`\n            regexDictionary[key] = button.title\n        })\n        for (let regex in regexDictionary) {\n            if (new RegExp(regex, 'i').test(inputUsuario.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"))) {\n                return regexDictionary[regex]\n            }\n        }\n        return 'input inesperado'\n    } catch (err) {\n        return 'input inesperado'\n    }\n}","inputVariables":["input.content","dynamicContent"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"12a40833-d247-4e44-bcf0-2bdba8ac1207","$typeOfContent":"","type":"SetVariable","$title":"SET \"assunto\" TO \"{userInput}\"","$invalid":false,"settings":{"variable":"assunto","value":"{{userInput}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"notEquals","variable":"userInput"}]},{"$id":"fcf8f81f-9420-4f56-8d83-0e0d398f8165","$typeOfContent":"","type":"SetVariable","$title":"Set \"exceptionType\" to \"lista\"","$invalid":false,"settings":{"variable":"exceptionType","value":"lista"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"}]},{"$id":"ccb97f39-b531-4101-a552-4924b142b8cd","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} validação\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} validação","action":"{{userInput}}"},"conditions":[{"comparison":"exists","source":"context","values":[],"variable":"userInput"}]},{"$id":"ef360673-a420-41df-a8d3-1970582a23df","$typeOfContent":"","type":"TrackEvent","$title":"Track \"SPD Taxas e Condicoes {state.name} input inesperado\"","$invalid":false,"settings":{"extras":{"IdSessao":" {{idSessao}}","Identity":"{{contact.identity}}","Doc":"{{contaSelecionada@doc}}","EC":"{{selectedEc@codigoEc}}"},"category":"SPD Taxas e Condicoes {{state.name}} input inesperado","action":"{{input.content}}"},"conditions":[{"values":["input inesperado"],"source":"context","comparison":"equals","variable":"userInput"},{"comparison":"exists","source":"context","values":[],"variable":"input.content"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-06cdd08f-79b1-487d-a411-38d44e7545f2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b38381c3-3103-40ff-af69-b162f3f89c4a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-d4565e95-caf9-4b64-8594-08e86d21d145","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-85326295-7732-43f5-92e0-b1a22a647fe1","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"a893a955-6a21-4015-bd79-42b681faa3ce","$title":"[TC.1.0.0][INPUT] Menu Taxas e condições","$position":{"top":"11.6667px","left":"2770.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false,"invalidOutputs":true},"708a01ab-973e-404f-8e0f-fe4a312b5100":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fc91a80b-e435-4824-a9a0-aef920267d7e","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"600692ef-a2f0-4208-b2ca-3f6ab0b3ee71","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"state\"","$invalid":false,"settings":{"function":"run","source":"function run(previousBlockid, previousStateName, lastInput, intent, serviceName, env) {\n\ttry {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: '0e2bd49d-1b56-477b-883f-badf39288863',\n\t\t\tstateNameOrigin: previousStateName.replace(/.*\\[(.*?)\\].*/, '$1'),\n\t\t\tbotDestination: `autenticacao ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\tlastInput: lastInput || intent,\n\t\t\tintent,\n\t\t\tuserInput: intent\n\t\t}\n\t} catch (err) {\n\t\treturn {\n\t\t\tbotOrigin: serviceName,\n\t\t\tstateOrigin: previousBlockid,\n\t\t\tbotDestination: `Bot Main ${env || \"\"}`.trim(),\n\t\t\tstateDestination: 'welcome',\n\t\t\terr: err.message\n\t\t}\n\t}\n}","inputVariables":["state.previous.id","state.previous.name","input.content","userInput","config.serviceName","config.env"],"outputVariable":"state","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"870ef835-04b3-42dd-aa18-d945e8343f26","type":"Redirect","$title":"Redirect to {state} sending {userInput}","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{state@userInput}}"},"address":"{{state@botDestination}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"onboarding"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e892fa82-4ebe-4799-84b4-0754bb5371a9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7960653c-e3d8-4d06-bf32-16b59b51197a","label":"Redirect","background":"#1EA1FF","canChangeBackground":false}],"id":"708a01ab-973e-404f-8e0f-fe4a312b5100","root":false,"$title":"[Redirect] To \"Autenticacao\"","$position":{"top":"23px","left":"3083px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"0e2bd49d-1b56-477b-883f-badf39288863":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"bc19e92a-5dec-4c18-8668-f309c11acbe2","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{taxMenuDestinationId}}","typeOfStateId":"variable","$id":"fd0178bc-b7e5-4d2a-8cfe-4eb954a47cdc","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1b70ffe8-7dfc-49a6-90ee-dd50830dbed9","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"taxMenuDestinationId\"","$invalid":false,"settings":{"function":"run","source":"function run(userInput) {\n\tswitch (userInput) {\n\t\tcase 'Taxas de Venda':\n\t\t\treturn 'c4fec3d1-c20d-43de-9160-8a93f67989eb';\n\t\tcase 'Taxas de Antecipação':\n\t\t\treturn 'cac63fde-6671-4aa1-9a67-efc2f5336711';\n\t\tcase 'Consultar Máquinas':\n\t\t\treturn '24ee326c-2f65-4cf1-944e-2b178eaf2a82';\n\t\tcase 'Domicilio bancário':\n\t\t\treturn 'ad3f23f8-0c79-4faf-8b19-06ad242f99d2';\n\t\tcase 'Taxas Pix na SafraPay':\n\t\t\treturn '91dec6e6-2e08-462d-8d81-d38d2b223594';\n\t\tcase 'Contratar antecipação':\n\t\t\treturn '5724999e-4ebb-443e-8b1d-4c15ef40251e';\n\t\tcase 'Pacotes contratados':\n\t\t\treturn 'b9ad166b-910b-43a2-b6e1-7e3ae4171339';\n\t\tcase 'Questionar uma cobrança':\n\t\t\treturn '4a101355-7808-4bb7-a96d-7053a966074a';\n\t\tdefault:\n\t\t\treturn 'a5ddf643-13c0-4a81-a174-e1aa9dd86873';\n\t}\n}","inputVariables":["userInput"],"outputVariable":"taxMenuDestinationId","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"id":"blip-tag-bb508331-36d7-479d-a7eb-96efdece9fb7","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"0e2bd49d-1b56-477b-883f-badf39288863","$title":"[TC.1.0.0][SET] Menu Taxas e condições","$position":{"top":"17px","left":"3296.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false,"invalidOutputs":true},"b65a4661-93a2-446e-bbb9-fc7405861e2e":{"$contentActions":[{"action":{"$id":"f555cb84-901f-4a8e-99ce-4ee32cc6a05b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"91df1a59-1d8b-40c9-834e-886b45ef4d2b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"91df1a59-1d8b-40c9-834e-886b45ef4d2b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:1251"},{"action":{"$id":"0ca77ce7-52ff-41b0-b26b-686fbbed0613","$typeOfContent":"text","type":"SendMessage","settings":{"id":"c065c6c5-41d0-4260-82c0-e5eada83c4bf","type":"text/plain","content":"TESTE","metadata":{}},"$cardContent":{"document":{"id":"c065c6c5-41d0-4260-82c0-e5eada83c4bf","type":"text/plain","content":"TESTE"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:1252"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f7685964-6449-4f0b-8f40-45936a172a5d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:1253"}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-78561233-f2f9-450e-a840-71fb7cfd4b1b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"b65a4661-93a2-446e-bbb9-fc7405861e2e","root":false,"$title":"[TESTE INTERNO] beta","$position":{"top":"156.5px","left":"2066px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"true","builder:#localTimeZone":"E. South America Standard Time","builder:useTunnelOwnerContext":"true","clientId":"BLIP","grantType":"client_credentials","urlToken":"https://sts-api-hml.safra.com.br","urlCHT":"https://api-hml.safra.com.br","cnpj":"084197016000126","clientSecret":"ee1f5004-2400-4ab1-9af7-d9168d517204","builder:stateExpiration":"0.00:15:00","TraceTargetType":"Http","TraceMode":"All","TraceTarget":"https://take-api-beholder.cs.blip.ai/api/traces/spdtaxasecondicoes","serviceName":"Bot Taxas e Condições"},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"7a495c11-0bfe-4786-864b-142219181490","$typeOfContent":"","type":"ExecuteScript","$title":"Process \"voltarState\"","$invalid":false,"settings":{"function":"run","source":"function ignoreBlock(stateName) {\n    try {\n        const match = stateName.match(/\\[(.*?)\\]/);\n        const stateNameOrigin = match ? match[1] : stateName;\n        const regex = /Redirect|Redirecionar/i;\n        const ignore = !regex.test(stateNameOrigin);\n        return ignore;\n    } catch (err) {\n        return false\n    }\n}\n\n\nfunction run(voltarState, blockId, botOrigin, lastVoltarState, previousStateName) {\n    const state = JSON.parse(voltarState)\n    try {\n        if (!voltarState) {\n            const state = {}\n            state[botOrigin] = [blockId]\n            return state\n        }\n        const isIgnoredBlock = ignoreBlock(previousStateName)\n        if (state[botOrigin][state[botOrigin].length - 1] !== blockId && blockId !== 'onboarding' && !isIgnoredBlock && blockId !== lastVoltarState) {\n            state[botOrigin].push(blockId)\n        }\n        return state\n    } catch (err) {\n        state[botOrigin] = [blockId]\n        return state\n    }\n}","inputVariables":["voltarState","state.previous.id","config.serviceName","lastVoltarState","state.previous.name"],"outputVariable":"voltarState","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}